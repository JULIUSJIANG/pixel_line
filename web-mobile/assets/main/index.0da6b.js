window.__require=function t(e,i,o){function n(s,a){if(!i[s]){if(!e[s]){var l=s.split("/");if(l=l[l.length-1],!e[l]){var c="function"==typeof __require&&__require;if(!a&&c)return c(l,!0);if(r)return r(l,!0);throw new Error("Cannot find module '"+s+"'")}s=l}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){return n(e[s][1][t]||t)},u,u.exports,t,e,i,o)}return i[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<o.length;s++)n(o[s]);return n}({B2ControllerRS:[function(t,e,i){"use strict";cc._RF.push(e,"676c5OIft9DmL7CdgPHZjab","B2ControllerRS"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../../box2d_ts/Box2D"),n=t("../../basic/UtilObjPool"),r=t("../../basic/UtilObjPoolType"),s=t("./B2EleSetting"),a="B2ControllerRS",l=function(){function t(){}return t.Pop=function(e,i,o){var r=n.default.Pop(t._t,e);return r.type=i,r.drawer=o,t._mapInst.set(i,r),r},t._t=new r.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:a}),t}();(function(t){t._mapInst=n.default.Pop(n.default.typeMap,a),t.buoyancy=t.Pop(a,o.b2BuoyancyController,function(t,e){var i=s.default.farLen,o=n.default.Pop(n.default.typeB2Vec2,a);o.x=t.normal.x,o.y=t.normal.y,o.Normalize();var r=n.default.Pop(n.default.typeB2Vec2,a),l=n.default.Pop(n.default.typeB2Vec2,a);r.x=o.x*t.offset+o.y*i,r.y=o.y*t.offset-o.x*i,l.x=o.x*t.offset-o.y*i,l.y=o.y*t.offset+o.x*i,e.StraightLine(r.x,r.y,l.x,l.y,e.Pixel(s.default.lineWidth),s.default.color.controller.b2BuoyancyController),n.default.Push(o),n.default.Push(r),n.default.Push(l)})})(l||(l={})),i.default=l,cc._RF.pop()},{"../../../../box2d_ts/Box2D":"Box2D","../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType","./B2EleSetting":"B2EleSetting"}],B2DrableWorld:[function(t,e,i){"use strict";cc._RF.push(e,"fee25q1ncxA4qV8YcuSFtXh","B2DrableWorld"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../../box2d_ts/Box2D"),n=t("../../basic/UtilObjPool"),r=t("../../basic/UtilObjPoolType"),s="B2DrableWorld",a=function(){function t(){}return t.Pop=function(e,i){var o=n.default.Pop(t._t,e);o._b2w=i;var r=n.default.Pop(n.default.typeBodyDef,s);return o._ground=o._b2w.CreateBody(r),o},t.prototype.MouseDown=function(t){var e;if(this._b2w.QueryPointAABB(t,function(i){return i.GetBody().GetType()!==o.b2BodyType.b2_dynamicBody||!i.TestPoint(t)||(e=i,!1)}),e){var i=e.GetBody(),r=n.default.Pop(n.default.typeB2MouseJointDef,s);r.bodyA=this._ground,r.bodyB=i,r.target.Copy(t),r.maxForce=1e3*i.GetMass(),this._mouseJoint=this._b2w.CreateJoint(r),i.SetAwake(!0)}},t.prototype.MouseMove=function(t){this._mouseJoint&&this._mouseJoint.SetTarget(t)},t.prototype.MouseUp=function(){this._mouseJoint&&(this._b2w.DestroyJoint(this._mouseJoint),this._mouseJoint=null)},t._t=new r.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:s}),t}();i.default=a,cc._RF.pop()},{"../../../../box2d_ts/Box2D":"Box2D","../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType"}],B2EleSetting:[function(t,e,i){"use strict";cc._RF.push(e,"d68fdJx53pE3KA515knK+6Y","B2EleSetting"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n="b2EleSetting",r=o.default.Pop(o.default.typeB2Vec2,n),s=o.default.Pop(o.default.typeB2Vec2,n);s.x=1;var a,l=o.default.Pop(o.default.typeB2Vec2,n);l.y=1,function(t){t.lineWidth=3,t.dotRadius=6,t.farLen=100,t.color={shape:{outline:o.default.PopCCColor(n,100,255,100,255),body:o.default.PopCCColor(n,100,255,100,100)},aabb:o.default.PopCCColor(n,0,0,255,255),joint:{areaBegin:o.default.PopCCColor(n,255,0,0,255),areaEnd:o.default.PopCCColor(n,255,100,100,255),dot:o.default.PopCCColor(n,255,255,255,255)},transform:{xColor:o.default.PopCCColor(n,255,0,0,255),yColor:o.default.PopCCColor(n,0,255,0,255)},contactPoint:{dot:o.default.PopCCColor(n,255,255,100,255)},particle:{fill:o.default.PopCCColor(n,100,100,255,100),stroke:o.default.PopCCColor(n,100,100,255,255)},controller:{b2BuoyancyController:o.default.PopCCColor(n,255,100,100,100)}},t.transformLen=1,t.posO=r,t.xAxis=s,t.yAxis=l}(a||(a={})),i.default=a,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool"}],B2ElementRS:[function(t,e,i){"use strict";cc._RF.push(e,"e3631HvZVRBKp+fXBxlSZ/P","B2ElementRS"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("./B2ControllerRS"),r=t("./B2EleSetting"),s=t("./B2JointRS"),a=t("./B2ShapeRS"),l=t("../../basic/UtilObjPoolType"),c="B2ElementRS",u=function(){},_=new l.default({instantiate:function(){return new u},onPop:function(){},onPush:function(){},tag:"ShapeRecord"}),p=function(){function t(){}return t.Pop=function(e,i,n,r){var s=o.default.Pop(t._t,e);return s.drawAbleTag=i,s.arrayGetter=n,s.tDrawer=r,t.eleDrawFuncList.push(function(t,e,s){if(s&i){var a=o.default.Pop(o.default.typeArray,c);n(t,a),a.forEach(function(t){r(t,e)}),o.default.Push(a)}}),s},t._t=new l.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:c}),t.eleDrawFuncList=o.default.Pop(o.default.typeArray,c),t}();(function(t){t.joint=t.Pop(c,Math.pow(2,0),function(t,e){for(var i=t.GetJointList();i;i=i.GetNext())e.push(i);return e},function(t,e){if(null!=t){var i=t.GetBodyA(),n=t.GetBodyB(),a=i.m_xf,l=n.m_xf,u=a.p,_=l.p,p=o.default.Pop(o.default.typeB2Vec2,c);t.GetAnchorA(p);var m=o.default.Pop(o.default.typeB2Vec2,c);t.GetAnchorB(m),s.default._instMap.has(t.m_type)?s.default._instMap.get(t.m_type).drawer(t,p,m,e):(e.StraightLine(u.x,u.y,p.x,p.y,e.Pixel(r.default.lineWidth),r.default.color.joint.areaBegin),e.StraightLine(p.x,p.y,m.x,m.y,e.Pixel(r.default.lineWidth),r.default.color.joint.areaBegin),e.StraightLine(_.x,_.y,m.x,m.y,e.Pixel(r.default.lineWidth),r.default.color.joint.areaEnd)),o.default.Push(p),o.default.Push(m)}}),t.bodyTransform=t.Pop(c,Math.pow(2,1),function(t,e){for(var i=t.GetBodyList();i;i=i.GetNext())e.push(i);return e},function(t,e){var i=o.default.Pop(o.default.typeB2Vec2,c);t.GetWorldPoint(r.default.xAxis,i);var n=o.default.Pop(o.default.typeB2Vec2,c);t.GetWorldPoint(r.default.yAxis,n);var s=o.default.Pop(o.default.typeB2Vec2,c);t.GetWorldPoint(r.default.posO,s),e.StraightLine(s.x,s.y,i.x,i.y,e.Pixel(r.default.lineWidth),r.default.color.transform.xColor),e.StraightLine(s.x,s.y,n.x,n.y,e.Pixel(r.default.lineWidth),r.default.color.transform.yColor),o.default.Push(i),o.default.Push(n),o.default.Push(s)}),t.aabb=t.Pop(c,Math.pow(2,2),function(t,e){for(var i=t.GetBodyList();i;i=i.GetNext())for(var o=i.GetFixtureList();o;o=o.GetNext())for(var n=0;n<o.m_proxyCount;n++){var r=o.m_proxies[n];e.push(r.treeNode.aabb)}return e},function(t,e){var i=o.default.Pop(o.default.typeArray,c),n=o.default.Pop(o.default.typeB2Vec2,c);n.Set(t.lowerBound.x,t.lowerBound.y),i.push(n);var s=o.default.Pop(o.default.typeB2Vec2,c);s.Set(t.upperBound.x,t.lowerBound.y),i.push(s);var a=o.default.Pop(o.default.typeB2Vec2,c);a.Set(t.upperBound.x,t.upperBound.y),i.push(a);var l=o.default.Pop(o.default.typeB2Vec2,c);l.Set(t.lowerBound.x,t.upperBound.y),i.push(l),e.CyclePosSetAll(i,e.Pixel(r.default.lineWidth),r.default.color.aabb);for(var u=0;u<i.length;u++)o.default.Push(i[u]);o.default.Push(i)}),t.shape=t.Pop(c,Math.pow(2,3),function(t,e){for(var i=t.GetBodyList();i;i=i.GetNext())for(var n=i.GetFixtureList();n;n=n.GetNext()){var r=o.default.Pop(_,c);r.shape=n.GetShape(),r.body=i,e.push(r)}return e},function(t,e){a.default._mapInst.has(t.shape.m_type)&&a.default._mapInst.get(t.shape.m_type).drawer(t.shape,t.body,e),o.default.Push(t)}),t.particle=t.Pop(c,Math.pow(2,4),function(t,e){for(var i=t.GetParticleSystemList();i;i=i.GetNext())e.push(i);return e},function(t,e){for(var i=t.GetRadius(),o=t.GetParticleCount(),n=t.GetPositionBuffer(),s=0;s<o;s++){var a=n[s];e.RoundFill(a.x,a.y,i,r.default.color.particle.fill),e.RoundLine(a.x,a.y,i,e.Pixel(r.default.lineWidth),r.default.color.particle.fill)}}),t.controller=t.Pop(c,Math.pow(2,5),function(t,e){for(var i=t.m_controllerList;i;i=i.GetNext())e.push(i);return e},function(t,e){n.default._mapInst.has(t.constructor)&&n.default._mapInst.get(t.constructor).drawer(t,e)}),t.contact=t.Pop(c,Math.pow(2,6),function(t,e){for(var i=o.default.Pop(o.default.typeB2WorldManifold,c),n=t.GetContactManager().m_contactList;n;n=n.GetNext())n.GetWorldManifold(i),e.push.apply(e,i.points);return o.default.Push(i),e},function(t,e){e.RoundFill(t.x,t.y,e.Pixel(r.default.dotRadius),r.default.color.contactPoint.dot)})})(p||(p={})),i.default=p,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType","./B2ControllerRS":"B2ControllerRS","./B2EleSetting":"B2EleSetting","./B2JointRS":"B2JointRS","./B2ShapeRS":"B2ShapeRS"}],B2Extend:[function(t,e,i){"use strict";cc._RF.push(e,"f842eUKQ9JHwaeSElsJ17t3","B2Extend"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("../../../../box2d_ts/Box2D"),r=t("../../basic/UtilObjPool"),s="b2Extend";(function(t){function e(t){var e=Math.cos(t),i=Math.sin(t),o=r.default.Pop(r.default.typeB2Mat33,s);return o.SetVVV({x:e,y:i,z:0},{x:-i,y:e,z:0},{x:0,y:0,z:1}),o}function i(t,e){var i=r.default.Pop(r.default.typeB2Mat33,s);return i.SetVVV({x:1,y:0,z:0},{x:0,y:1,z:0},{x:t,y:e,z:1}),i}function o(t,e){var i=r.default.Pop(r.default.typeB2Vec3,s),o=r.default.Pop(r.default.typeB2Vec3,s),a=r.default.Pop(r.default.typeB2Vec3,s);n.b2Mat33.MulM33V3(t,e.ex,i),n.b2Mat33.MulM33V3(t,e.ey,o),n.b2Mat33.MulM33V3(t,e.ez,a);var l=r.default.Pop(r.default.typeB2Mat33,s);return l.SetVVV(i,o,a),l}t.GetDistanceJoint=function(t){if(null!=t)return t.m_type==n.b2JointType.e_distanceJoint?t:void 0},t.GetPulleyJoint=function(t){if(null!=t)return t.m_type==n.b2JointType.e_pulleyJoint?t:void 0},t.GetMouseJoint=function(t){if(null!=t)return t.m_type==n.b2JointType.e_motorJoint?t:void 0},t.Getb2BuoyancyController=function(t){if(null!=t)return t instanceof n.b2BuoyancyController?t:void 0},t.GetChainShape=function(t){if(null!=t)return t.GetType()==n.b2ShapeType.e_chainShape?t:void 0},t.GetEdgeShape=function(t){if(null!=t)return t.GetType()==n.b2ShapeType.e_edgeShape?t:void 0},t.GetPolygonShape=function(t){if(null!=t)return t.GetType()==n.b2ShapeType.e_polygonShape?t:null},t.GetCircleShape=function(t){if(null!=t)return t.GetType()==n.b2ShapeType.e_circleShape?t:null},t.GetTransMat=function(t){var n=t.GetAngle(),r=t.GetPosition();return o(i(r.x,r.y),e(n))},t.GetRotateMat=e,t.GetPosMat=i,t.MergeMat=o,t.GetMatStr=function(t){return t.ex.x+", "+t.ey.x+", "+t.ez.x+"\n"+t.ex.y+", "+t.ey.y+", "+t.ez.y+"\n"+t.ex.z+", "+t.ey.z+", "+t.ez.z},t.GetV3Str=function(t){return t.x+", "+t.y+", "+t.z},t.leftMat=e(Math.PI/2),t.rightMat=e(-Math.PI/2)})(o||(o={})),i.default=o,cc._RF.pop()},{"../../../../box2d_ts/Box2D":"Box2D","../../basic/UtilObjPool":"UtilObjPool"}],B2JointRS:[function(t,e,i){"use strict";cc._RF.push(e,"d149bPy4pRDcoCiuqbELp/j","B2JointRS"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../../../box2d_ts/Box2D"),n=t("../../basic/UtilObjPool"),r=t("../../basic/UtilObjPoolType"),s=t("./B2EleSetting"),a="B2JointRS",l=function(){function t(){}return t.Pop=function(e,i,o){var r=n.default.Pop(t._t,e);return r.type=i,r.drawer=o,t._instMap.set(i,r),r},t._t=new r.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:a}),t}();(function(t){t._instMap=n.default.Pop(n.default.typeMap,a),t.distance=t.Pop(a,o.b2JointType.e_distanceJoint,function(t,e,i,o){o.StraightLine(e.x,e.y,i.x,i.y,o.Pixel(s.default.lineWidth),s.default.color.joint.areaBegin)}),t.pulley=t.Pop(a,o.b2JointType.e_pulleyJoint,function(t,e,i,o){var n=t.GetGroundAnchorA(),r=t.GetGroundAnchorB();o.StraightLine(n.x,n.y,e.x,e.y,o.Pixel(s.default.lineWidth),s.default.color.joint.areaBegin),o.StraightLine(r.x,r.y,i.x,i.y,o.Pixel(s.default.lineWidth),s.default.color.joint.areaBegin),o.StraightLine(n.x,n.y,r.x,r.y,o.Pixel(s.default.lineWidth),s.default.color.joint.areaEnd)}),t.mouse=t.Pop(a,o.b2JointType.e_mouseJoint,function(t,e,i,o){o.RoundFill(e.x,e.y,o.Pixel(s.default.dotRadius),s.default.color.joint.dot),o.RoundFill(i.x,i.y,o.Pixel(s.default.dotRadius),s.default.color.joint.dot),o.StraightLine(e.x,e.y,i.x,i.y,o.Pixel(s.default.dotRadius),s.default.color.joint.areaBegin)})})(l||(l={})),i.default=l,cc._RF.pop()},{"../../../../box2d_ts/Box2D":"Box2D","../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType","./B2EleSetting":"B2EleSetting"}],B2ShapeRS:[function(t,e,i){"use strict";cc._RF.push(e,"0ebbd2ypkhAw4ktJPDSiVqs","B2ShapeRS"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("../../../../box2d_ts/Box2D"),r=t("./B2EleSetting"),s=t("../../basic/UtilObjPoolType"),a="B2ShapeRS",l=function(){function t(){}return t.Pop=function(e,i,n){var r=o.default.Pop(t._t,e);return r.type=i,r.drawer=n,t._mapInst.set(i,r),r},t._t=new s.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:a}),t}();(function(t){t._mapInst=o.default.Pop(o.default.typeMap,a),t.circle=t.Pop(a,n.b2ShapeType.e_circleShape,function(t,e,i){var n=o.default.Pop(o.default.typeB2Vec2,a);e.GetWorldPoint(t.m_p,n);var s=t.m_radius;i.RoundFill(n.x,n.y,s,r.default.color.shape.body),i.RoundLine(n.x,n.y,s,i.Pixel(r.default.lineWidth),r.default.color.shape.outline),o.default.Push(n)}),t.edge=t.Pop(a,n.b2ShapeType.e_edgeShape,function(t,e,i){var n=o.default.Pop(o.default.typeB2Vec2,a);e.GetWorldPoint(t.m_vertex1,o.default.Pop(o.default.typeB2Vec2,a));var s=o.default.Pop(o.default.typeB2Vec2,a);e.GetWorldPoint(t.m_vertex2,o.default.Pop(o.default.typeB2Vec2,a)),i.StraightLine(n.x,n.y,s.x,s.y,i.Pixel(r.default.lineWidth),r.default.color.shape.outline),o.default.Push(n),o.default.Push(s)}),t.chain=t.Pop(a,n.b2ShapeType.e_chainShape,function(t,e,i){var n=t.m_count,s=t.m_vertices,l=o.default.Pop(o.default.typeB2Vec2,a);if(e.GetWorldPoint(s[0],l),i.RoundFill(l.x,l.y,i.Pixel(r.default.dotRadius),r.default.color.shape.outline),t.m_hasPrevVertex){var c=o.default.Pop(o.default.typeB2Vec2,a);e.GetWorldPoint(t.m_prevVertex,c),i.StraightLine(c.x,c.y,l.x,l.y,i.Pixel(r.default.lineWidth),r.default.color.shape.outline),i.RoundFill(c.x,c.y,i.Pixel(r.default.dotRadius),r.default.color.shape.outline),o.default.Push(c)}for(var u=1;u<n;u++){var _=o.default.Pop(o.default.typeB2Vec2,a);e.GetWorldPoint(s[u],_),i.StraightLine(l.x,l.y,_.x,_.y,i.Pixel(r.default.lineWidth),r.default.color.shape.outline),i.RoundFill(_.x,_.y,i.Pixel(r.default.dotRadius),r.default.color.shape.outline),l.Set(_.x,_.y),o.default.Push(_)}if(t.m_hasNextVertex){var p=o.default.Pop(o.default.typeB2Vec2,a);e.GetWorldPoint(t.m_nextVertex,p),i.StraightLine(p.x,p.y,l.x,l.y,i.Pixel(r.default.lineWidth),r.default.color.shape.outline),i.RoundFill(p.x,p.y,i.Pixel(r.default.dotRadius),r.default.color.shape.outline),o.default.Push(p)}o.default.Push(l)}),t.polygon=t.Pop(a,n.b2ShapeType.e_polygonShape,function(t,e,i){for(var n=t.m_vertices,s=o.default.Pop(o.default.typeArray,a),l=0;l<t.m_count;l++){var c=n[l];s.push(e.GetWorldPoint(c,o.default.Pop(o.default.typeB2Vec2,a)))}for(i.FillPosSetAll(s,r.default.color.shape.body),i.CyclePosSetAll(s,i.Pixel(r.default.lineWidth),r.default.color.shape.outline),l=0;l<s.length;l++)o.default.Push(s[l]);o.default.Push(s)})})(l||(l={})),i.default=l,cc._RF.pop()},{"../../../../box2d_ts/Box2D":"Box2D","../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType","./B2EleSetting":"B2EleSetting"}],BCCollection:[function(t,e,i){"use strict";cc._RF.push(e,"0b85bWg1etAfL/oMC9d92Qi","BCCollection"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./UtilObjPool"),n=t("./UtilObjPoolType"),r="BCCollection",s=function(){function t(){this._list=o.default.Pop(o.default.typeArray,r),this._map=o.default.Pop(o.default.typeMap,r)}return t.Pop=function(e){return o.default.Pop(t._t,e)},t.prototype.add=function(t){this._list.push(t),this._map.forEach(function(e,i){e.forEach(function(e,o){i(t)==o&&e.add(t)})})},t.prototype.rem=function(t){this._list.splice(this._list.indexOf(t),1),this._map.forEach(function(e,i){e.forEach(function(e,o){i(t)==o&&e.rem(t)})})},t.prototype.select=function(e,i){if(!this._map.has(e)){this._map.set(e,o.default.Pop(o.default.typeMap,r));for(var n=0;n<this._list.length;n++){var s=this._list[n],a=e(s);this._map.get(e).get(a)||this._map.get(e).set(a,t.Pop(r)),this._map.get(e).get(a).add(s)}}return this._map.get(e).has(i)||this._map.get(e).set(i,t.Pop(r)),this._map.get(e).get(i)},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:r}),t}();i.default=s,cc._RF.pop()},{"./UtilObjPool":"UtilObjPool","./UtilObjPoolType":"UtilObjPoolType"}],BCCounter:[function(t,e,i){"use strict";cc._RF.push(e,"8ec7dUO5o5CH6A84d5AWHWd","BCCounter"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./UtilObjPool"),n=t("./UtilObjPoolType"),r="BCCounter",s=function(){function t(){this._genId=0,this._set=o.default.Pop(o.default.typeSet,r)}return t.Pop=function(e){return o.default.Pop(t._t,e)},Object.defineProperty(t.prototype,"active",{get:function(){return 0<this._set.size},enumerable:!1,configurable:!0}),t.prototype.Apply=function(){var t=++this._genId;return this._set.add(t),t},t.prototype.Cancel=function(t){this._set.delete(t)},t.prototype.Clear=function(){this._set.clear()},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:r}),t}();i.default=s,cc._RF.pop()},{"./UtilObjPool":"UtilObjPool","./UtilObjPoolType":"UtilObjPoolType"}],BCEventer:[function(t,e,i){"use strict";cc._RF.push(e,"b5388YmNaFNzY+R+HH1lDgr","BCEventer"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./BCIdGeneration"),n=t("./UtilObjPool"),r=t("./UtilObjPoolType"),s="BCEventer",a=function(){function t(){this.idGen=o.default.Pop(s),this.listenMap=n.default.Pop(n.default.typeMap,s)}return t.Pop=function(e){return n.default.Pop(t._t,e)},t.prototype.Once=function(t){var e,i=this;e=this.On(function(o){i.Off(e),t(o)})},t.prototype.On=function(t){var e=this.idGen.GenId();return this.listenMap.set(e,t),e},t.prototype.Off=function(t){this.listenMap.delete(t)},t.prototype.Call=function(t){this.listenMap.forEach(function(e){e(t)})},t.prototype.Clear=function(){this.listenMap.clear()},t._t=new r.default({instantiate:function(){return new t},onPop:function(){},onPush:function(t){t.listenMap.clear()},tag:s}),t}();i.default=a,cc._RF.pop()},{"./BCIdGeneration":"BCIdGeneration","./UtilObjPool":"UtilObjPool","./UtilObjPoolType":"UtilObjPoolType"}],BCIdGeneration:[function(t,e,i){"use strict";cc._RF.push(e,"03c80AIcldGY4PjozY/A9Ud","BCIdGeneration"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./UtilObjPool"),n=t("./UtilObjPoolType"),r=function(){function t(){this._genId=0}return t.Pop=function(e){return o.default.Pop(t._t,e)},t.prototype.GenId=function(){return++this._genId},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"BCIdGeneration"}),t}();i.default=r,cc._RF.pop()},{"./UtilObjPool":"UtilObjPool","./UtilObjPoolType":"UtilObjPoolType"}],BCPromiseCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"2f435eW6CtGfItyonQVymPU","BCPromiseCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./UtilObjPool"),n=t("./UtilObjPoolType"),r="BCPromiseCtrl",s=function(){function t(){this.isResulted=!1,this.isResolved=!1,this._resolve=null,this.isRejected=!1,this._reject=null}return t.Pop=function(e){var i=o.default.Pop(t._t,e);return i._promise=o.default.PopPromise(r,function(t,e){i._resolve=t,i._reject=e}),i},t.prototype.resolve=function(t){this.isResulted||(this.isResulted=!0,this.isResolved=!0,this._resolve(t))},t.prototype.reject=function(t){this.isResulted||(this.isResulted=!0,this.isRejected=!0,this._reject(t))},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:r}),t}();i.default=s,cc._RF.pop()},{"./UtilObjPool":"UtilObjPool","./UtilObjPoolType":"UtilObjPoolType"}],BCType:[function(t,e,i){"use strict";cc._RF.push(e,"80224+JQH9KB46Bmw8eQ0z8","BCType"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./UtilObjPool"),n=t("./UtilObjPoolType"),r="BCType",s=function(){function t(){}return t.Pop=function(e,i,n,r){var s=o.default.Pop(t._t,e);return s._equal=i,s._release=n,s._clone=r,s},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:r}),t}();(function(t){t.typeNumber=t.Pop(r,function(t,e){return t==e},function(){},function(t){return t}),t.typeString=t.Pop(r,function(t,e){return t==e},function(){},function(t){return t}),t.typeBoolean=t.Pop(r,function(t,e){return t==e},function(){},function(t){return t}),t.typeArray=t.Pop(r,function(t,e){if(null==t&&null==e)return!1;if(null==t)return!1;if(null==e)return!1;if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!=e[i])return!1;return!0},function(t){o.default.Push(t)},function(t){var e=o.default.Pop(o.default.typeArray,r);return e.push.apply(e,t),e})})(s||(s={})),i.default=s,cc._RF.pop()},{"./UtilObjPool":"UtilObjPool","./UtilObjPoolType":"UtilObjPoolType"}],Box2D:[function(t,e,i){"use strict";cc._RF.push(e,"9e550hkQyNNkYZO/YiigcTl","Box2D");var o=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){void 0===o&&(o=i),t[o]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||o(e,t,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(t("./Common/b2Settings"),i),n(t("./Common/b2Math"),i),n(t("./Common/b2Draw"),i),n(t("./Common/b2Timer"),i),n(t("./Common/b2GrowableStack"),i),n(t("./Common/b2BlockAllocator"),i),n(t("./Common/b2StackAllocator"),i),n(t("./Collision/b2Collision"),i),n(t("./Collision/b2Distance"),i),n(t("./Collision/b2BroadPhase"),i),n(t("./Collision/b2DynamicTree"),i),n(t("./Collision/b2TimeOfImpact"),i),n(t("./Collision/b2CollideCircle"),i),n(t("./Collision/b2CollidePolygon"),i),n(t("./Collision/b2CollideEdge"),i),n(t("./Collision/Shapes/b2Shape"),i),n(t("./Collision/Shapes/b2CircleShape"),i),n(t("./Collision/Shapes/b2PolygonShape"),i),n(t("./Collision/Shapes/b2EdgeShape"),i),n(t("./Collision/Shapes/b2ChainShape"),i),n(t("./Dynamics/b2Fixture"),i),n(t("./Dynamics/b2Body"),i),n(t("./Dynamics/b2World"),i),n(t("./Dynamics/b2WorldCallbacks"),i),n(t("./Dynamics/b2Island"),i),n(t("./Dynamics/b2TimeStep"),i),n(t("./Dynamics/b2ContactManager"),i),n(t("./Dynamics/Contacts/b2Contact"),i),n(t("./Dynamics/Contacts/b2ContactFactory"),i),n(t("./Dynamics/Contacts/b2ContactSolver"),i),n(t("./Dynamics/Contacts/b2CircleContact"),i),n(t("./Dynamics/Contacts/b2PolygonContact"),i),n(t("./Dynamics/Contacts/b2PolygonAndCircleContact"),i),n(t("./Dynamics/Contacts/b2EdgeAndCircleContact"),i),n(t("./Dynamics/Contacts/b2EdgeAndPolygonContact"),i),n(t("./Dynamics/Contacts/b2ChainAndCircleContact"),i),n(t("./Dynamics/Contacts/b2ChainAndPolygonContact"),i),n(t("./Dynamics/Joints/b2Joint"),i),n(t("./Dynamics/Joints/b2AreaJoint"),i),n(t("./Dynamics/Joints/b2DistanceJoint"),i),n(t("./Dynamics/Joints/b2FrictionJoint"),i),n(t("./Dynamics/Joints/b2GearJoint"),i),n(t("./Dynamics/Joints/b2MotorJoint"),i),n(t("./Dynamics/Joints/b2MouseJoint"),i),n(t("./Dynamics/Joints/b2PrismaticJoint"),i),n(t("./Dynamics/Joints/b2PulleyJoint"),i),n(t("./Dynamics/Joints/b2RevoluteJoint"),i),n(t("./Dynamics/Joints/b2RopeJoint"),i),n(t("./Dynamics/Joints/b2WeldJoint"),i),n(t("./Dynamics/Joints/b2WheelJoint"),i),n(t("./Controllers/b2Controller"),i),n(t("./Controllers/b2BuoyancyController"),i),n(t("./Controllers/b2ConstantAccelController"),i),n(t("./Controllers/b2ConstantForceController"),i),n(t("./Controllers/b2GravityController"),i),n(t("./Controllers/b2TensorDampingController"),i),n(t("./Particle/b2Particle"),i),n(t("./Particle/b2ParticleGroup"),i),n(t("./Particle/b2ParticleSystem"),i),n(t("./Rope/b2Rope"),i),cc._RF.pop()},{"./Collision/Shapes/b2ChainShape":"b2ChainShape","./Collision/Shapes/b2CircleShape":"b2CircleShape","./Collision/Shapes/b2EdgeShape":"b2EdgeShape","./Collision/Shapes/b2PolygonShape":"b2PolygonShape","./Collision/Shapes/b2Shape":"b2Shape","./Collision/b2BroadPhase":"b2BroadPhase","./Collision/b2CollideCircle":"b2CollideCircle","./Collision/b2CollideEdge":"b2CollideEdge","./Collision/b2CollidePolygon":"b2CollidePolygon","./Collision/b2Collision":"b2Collision","./Collision/b2Distance":"b2Distance","./Collision/b2DynamicTree":"b2DynamicTree","./Collision/b2TimeOfImpact":"b2TimeOfImpact","./Common/b2BlockAllocator":"b2BlockAllocator","./Common/b2Draw":"b2Draw","./Common/b2GrowableStack":"b2GrowableStack","./Common/b2Math":"b2Math","./Common/b2Settings":"b2Settings","./Common/b2StackAllocator":"b2StackAllocator","./Common/b2Timer":"b2Timer","./Controllers/b2BuoyancyController":"b2BuoyancyController","./Controllers/b2ConstantAccelController":"b2ConstantAccelController","./Controllers/b2ConstantForceController":"b2ConstantForceController","./Controllers/b2Controller":"b2Controller","./Controllers/b2GravityController":"b2GravityController","./Controllers/b2TensorDampingController":"b2TensorDampingController","./Dynamics/Contacts/b2ChainAndCircleContact":"b2ChainAndCircleContact","./Dynamics/Contacts/b2ChainAndPolygonContact":"b2ChainAndPolygonContact","./Dynamics/Contacts/b2CircleContact":"b2CircleContact","./Dynamics/Contacts/b2Contact":"b2Contact","./Dynamics/Contacts/b2ContactFactory":"b2ContactFactory","./Dynamics/Contacts/b2ContactSolver":"b2ContactSolver","./Dynamics/Contacts/b2EdgeAndCircleContact":"b2EdgeAndCircleContact","./Dynamics/Contacts/b2EdgeAndPolygonContact":"b2EdgeAndPolygonContact","./Dynamics/Contacts/b2PolygonAndCircleContact":"b2PolygonAndCircleContact","./Dynamics/Contacts/b2PolygonContact":"b2PolygonContact","./Dynamics/Joints/b2AreaJoint":"b2AreaJoint","./Dynamics/Joints/b2DistanceJoint":"b2DistanceJoint","./Dynamics/Joints/b2FrictionJoint":"b2FrictionJoint","./Dynamics/Joints/b2GearJoint":"b2GearJoint","./Dynamics/Joints/b2Joint":"b2Joint","./Dynamics/Joints/b2MotorJoint":"b2MotorJoint","./Dynamics/Joints/b2MouseJoint":"b2MouseJoint","./Dynamics/Joints/b2PrismaticJoint":"b2PrismaticJoint","./Dynamics/Joints/b2PulleyJoint":"b2PulleyJoint","./Dynamics/Joints/b2RevoluteJoint":"b2RevoluteJoint","./Dynamics/Joints/b2RopeJoint":"b2RopeJoint","./Dynamics/Joints/b2WeldJoint":"b2WeldJoint","./Dynamics/Joints/b2WheelJoint":"b2WheelJoint","./Dynamics/b2Body":"b2Body","./Dynamics/b2ContactManager":"b2ContactManager","./Dynamics/b2Fixture":"b2Fixture","./Dynamics/b2Island":"b2Island","./Dynamics/b2TimeStep":"b2TimeStep","./Dynamics/b2World":"b2World","./Dynamics/b2WorldCallbacks":"b2WorldCallbacks","./Particle/b2Particle":"b2Particle","./Particle/b2ParticleGroup":"b2ParticleGroup","./Particle/b2ParticleSystem":"b2ParticleSystem","./Rope/b2Rope":"b2Rope"}],CfgBuffProps:[function(t,e,i){"use strict";cc._RF.push(e,"442e4cYBjJL36Qfw/3QoEl1","CfgBuffProps"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("../../basic/UtilObjPoolType"),r=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n.id=i[0],n.res_display=i[1],n.layer_max=i[2],n.layer_keep_ms=i[3],n.logic=i[4],n},t.idGetter=function(t){return t.id},t.res_displayGetter=function(t){return t.res_display},t.layer_maxGetter=function(t){return t.layer_max},t.layer_keep_msGetter=function(t){return t.layer_keep_ms},t.logicGetter=function(t){return t.logic},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"CfgBuffProps"}),t}();i.default=r,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType"}],CfgCommon:[function(t,e,i){"use strict";cc._RF.push(e,"e511fbNtD9BaYHO+BQZKpuk","CfgCommon"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("../../basic/UtilObjPoolType"),r=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n.tips_ms=i[0],n.book_info_count_per_page=i[1],n.unit_count_per_chapter=i[2],n.level_count_per_unit=i[3],n.rain_speed_x=i[4],n.rain_speed_y=i[5],n.rain_count_per_ms_max=i[6],n.snow_speed_x=i[7],n.snow_speed_y=i[8],n.snow_count_per_ms_max=i[9],n.particle_random_offset=i[10],n},t.tips_msGetter=function(t){return t.tips_ms},t.book_info_count_per_pageGetter=function(t){return t.book_info_count_per_page},t.unit_count_per_chapterGetter=function(t){return t.unit_count_per_chapter},t.level_count_per_unitGetter=function(t){return t.level_count_per_unit},t.rain_speed_xGetter=function(t){return t.rain_speed_x},t.rain_speed_yGetter=function(t){return t.rain_speed_y},t.rain_count_per_ms_maxGetter=function(t){return t.rain_count_per_ms_max},t.snow_speed_xGetter=function(t){return t.snow_speed_x},t.snow_speed_yGetter=function(t){return t.snow_speed_y},t.snow_count_per_ms_maxGetter=function(t){return t.snow_count_per_ms_max},t.particle_random_offsetGetter=function(t){return t.particle_random_offset},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"CfgCommon"}),t}();i.default=r,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType"}],CfgEff:[function(t,e,i){"use strict";cc._RF.push(e,"2a214nlEVNFfpF9auWP4H98","CfgEff"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("../../basic/UtilObjPoolType"),r=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n.id=i[0],n.res=i[1],n.life=i[2],n},t.idGetter=function(t){return t.id},t.resGetter=function(t){return t.res},t.lifeGetter=function(t){return t.life},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"CfgEff"}),t}();i.default=r,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType"}],CfgEquipmentLevel:[function(t,e,i){"use strict";cc._RF.push(e,"d0db3XafANEy6mOYZu5Xhbm","CfgEquipmentLevel"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("../../basic/UtilObjPoolType"),r=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n.lev=i[0],n.count=i[1],n},t.levGetter=function(t){return t.lev},t.countGetter=function(t){return t.count},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"CfgEquipmentLevel"}),t}();i.default=r,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType"}],CfgEquipmentProps:[function(t,e,i){"use strict";cc._RF.push(e,"d99cdHTVEZJlKXhjJojfnK+","CfgEquipmentProps"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("../../basic/UtilObjPoolType"),r=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n.id=i[0],n.name=i[1],n.props_atk=i[2],n.props_cost=i[3],n.props_cd=i[4],n.repel=i[5],n.info=i[6],n.res=i[7],n.arrow=i[8],n.logic=i[9],n.prop_0=i[10],n.prop_1=i[11],n.prop_2=i[12],n.prop_3=i[13],n.prop_4=i[14],n.prop_5=i[15],n.prop_6=i[16],n.prop_7=i[17],n.prop_8=i[18],n.prop_9=i[19],n.prop_10=i[20],n.prop_11=i[21],n.prop_12=i[22],n.prop_13=i[23],n.prop_14=i[24],n.prop_15=i[25],n.prop_16=i[26],n.prop_17=i[27],n.prop_18=i[28],n.prop_19=i[29],n.prop_20=i[30],n.prop_21=i[31],n.prop_22=i[32],n.prop_23=i[33],n.prop_24=i[34],n.prop_25=i[35],n.prop_26=i[36],n.prop_27=i[37],n.prop_28=i[38],n.prop_29=i[39],n.prop_30=i[40],n.prop_31=i[41],n},t.idGetter=function(t){return t.id},t.nameGetter=function(t){return t.name},t.props_atkGetter=function(t){return t.props_atk},t.props_costGetter=function(t){return t.props_cost},t.props_cdGetter=function(t){return t.props_cd},t.repelGetter=function(t){return t.repel},t.infoGetter=function(t){return t.info},t.resGetter=function(t){return t.res},t.arrowGetter=function(t){return t.arrow},t.logicGetter=function(t){return t.logic},t.prop_0Getter=function(t){return t.prop_0},t.prop_1Getter=function(t){return t.prop_1},t.prop_2Getter=function(t){return t.prop_2},t.prop_3Getter=function(t){return t.prop_3},t.prop_4Getter=function(t){return t.prop_4},t.prop_5Getter=function(t){return t.prop_5},t.prop_6Getter=function(t){return t.prop_6},t.prop_7Getter=function(t){return t.prop_7},t.prop_8Getter=function(t){return t.prop_8},t.prop_9Getter=function(t){return t.prop_9},t.prop_10Getter=function(t){return t.prop_10},t.prop_11Getter=function(t){return t.prop_11},t.prop_12Getter=function(t){return t.prop_12},t.prop_13Getter=function(t){return t.prop_13},t.prop_14Getter=function(t){return t.prop_14},t.prop_15Getter=function(t){return t.prop_15},t.prop_16Getter=function(t){return t.prop_16},t.prop_17Getter=function(t){return t.prop_17},t.prop_18Getter=function(t){return t.prop_18},t.prop_19Getter=function(t){return t.prop_19},t.prop_20Getter=function(t){return t.prop_20},t.prop_21Getter=function(t){return t.prop_21},t.prop_22Getter=function(t){return t.prop_22},t.prop_23Getter=function(t){return t.prop_23},t.prop_24Getter=function(t){return t.prop_24},t.prop_25Getter=function(t){return t.prop_25},t.prop_26Getter=function(t){return t.prop_26},t.prop_27Getter=function(t){return t.prop_27},t.prop_28Getter=function(t){return t.prop_28},t.prop_29Getter=function(t){return t.prop_29},t.prop_30Getter=function(t){return t.prop_30},t.prop_31Getter=function(t){return t.prop_31},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"CfgEquipmentProps"}),t}();i.default=r,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType"}],CfgGameElement:[function(t,e,i){"use strict";cc._RF.push(e,"4567aTFROZGj4E5woBhH2zz","CfgGameElement"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("../../basic/UtilObjPoolType"),r=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n.id=i[0],n.name=i[1],n.icon=i[2],n.book=i[3],n.drop_item=i[4],n.drop_rate=i[5],n.txt_info=i[6],n.res=i[7],n.logic=i[8],n.prop_0=i[9],n.prop_1=i[10],n.prop_2=i[11],n.prop_3=i[12],n.prop_4=i[13],n.prop_5=i[14],n.prop_6=i[15],n.prop_7=i[16],n.prop_8=i[17],n.prop_9=i[18],n.prop_10=i[19],n.prop_11=i[20],n.prop_12=i[21],n.prop_13=i[22],n.prop_14=i[23],n.prop_15=i[24],n.prop_16=i[25],n.prop_17=i[26],n.prop_18=i[27],n.prop_19=i[28],n.prop_20=i[29],n.prop_21=i[30],n.prop_22=i[31],n.prop_23=i[32],n.prop_24=i[33],n.prop_25=i[34],n.prop_26=i[35],n.prop_27=i[36],n.prop_28=i[37],n.prop_29=i[38],n.prop_30=i[39],n.prop_31=i[40],n},t.idGetter=function(t){return t.id},t.nameGetter=function(t){return t.name},t.iconGetter=function(t){return t.icon},t.bookGetter=function(t){return t.book},t.drop_itemGetter=function(t){return t.drop_item},t.drop_rateGetter=function(t){return t.drop_rate},t.txt_infoGetter=function(t){return t.txt_info},t.resGetter=function(t){return t.res},t.logicGetter=function(t){return t.logic},t.prop_0Getter=function(t){return t.prop_0},t.prop_1Getter=function(t){return t.prop_1},t.prop_2Getter=function(t){return t.prop_2},t.prop_3Getter=function(t){return t.prop_3},t.prop_4Getter=function(t){return t.prop_4},t.prop_5Getter=function(t){return t.prop_5},t.prop_6Getter=function(t){return t.prop_6},t.prop_7Getter=function(t){return t.prop_7},t.prop_8Getter=function(t){return t.prop_8},t.prop_9Getter=function(t){return t.prop_9},t.prop_10Getter=function(t){return t.prop_10},t.prop_11Getter=function(t){return t.prop_11},t.prop_12Getter=function(t){return t.prop_12},t.prop_13Getter=function(t){return t.prop_13},t.prop_14Getter=function(t){return t.prop_14},t.prop_15Getter=function(t){return t.prop_15},t.prop_16Getter=function(t){return t.prop_16},t.prop_17Getter=function(t){return t.prop_17},t.prop_18Getter=function(t){return t.prop_18},t.prop_19Getter=function(t){return t.prop_19},t.prop_20Getter=function(t){return t.prop_20},t.prop_21Getter=function(t){return t.prop_21},t.prop_22Getter=function(t){return t.prop_22},t.prop_23Getter=function(t){return t.prop_23},t.prop_24Getter=function(t){return t.prop_24},t.prop_25Getter=function(t){return t.prop_25},t.prop_26Getter=function(t){return t.prop_26},t.prop_27Getter=function(t){return t.prop_27},t.prop_28Getter=function(t){return t.prop_28},t.prop_29Getter=function(t){return t.prop_29},t.prop_30Getter=function(t){return t.prop_30},t.prop_31Getter=function(t){return t.prop_31},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"CfgGameElement"}),t}();i.default=r,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType"}],CfgLevel:[function(t,e,i){"use strict";cc._RF.push(e,"98c7fXDO4lGf4Aw6XPSSw04","CfgLevel"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("../../basic/UtilObjPoolType"),r=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n.id=i[0],n.alpha_year=i[1],n.alpha_day=i[2],n.part_0_triger_ms=i[3],n.part_0_monster_id=i[4],n.part_0_monster_delay=i[5],n.part_0_monster_x=i[6],n.part_1_triger_ms=i[7],n.part_1_monster_id=i[8],n.part_1_monster_delay=i[9],n.part_1_monster_x=i[10],n.part_2_triger_ms=i[11],n.part_2_monster_id=i[12],n.part_2_monster_delay=i[13],n.part_2_monster_x=i[14],n},t.idGetter=function(t){return t.id},t.alpha_yearGetter=function(t){return t.alpha_year},t.alpha_dayGetter=function(t){return t.alpha_day},t.part_0_triger_msGetter=function(t){return t.part_0_triger_ms},t.part_0_monster_idGetter=function(t){return t.part_0_monster_id},t.part_0_monster_delayGetter=function(t){return t.part_0_monster_delay},t.part_0_monster_xGetter=function(t){return t.part_0_monster_x},t.part_1_triger_msGetter=function(t){return t.part_1_triger_ms},t.part_1_monster_idGetter=function(t){return t.part_1_monster_id},t.part_1_monster_delayGetter=function(t){return t.part_1_monster_delay},t.part_1_monster_xGetter=function(t){return t.part_1_monster_x},t.part_2_triger_msGetter=function(t){return t.part_2_triger_ms},t.part_2_monster_idGetter=function(t){return t.part_2_monster_id},t.part_2_monster_delayGetter=function(t){return t.part_2_monster_delay},t.part_2_monster_xGetter=function(t){return t.part_2_monster_x},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"CfgLevel"}),t}();i.default=r,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType"}],CfgVoiceOgg:[function(t,e,i){"use strict";cc._RF.push(e,"4462f6kWcZD0pfmU10MO9nz","CfgVoiceOgg"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("../../basic/UtilObjPoolType"),r=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n.id=i[0],n.name=i[1],n.res=i[2],n},t.idGetter=function(t){return t.id},t.nameGetter=function(t){return t.name},t.resGetter=function(t){return t.res},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"CfgVoiceOgg"}),t}();i.default=r,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType"}],ComponentNodeEventer:[function(t,e,i){"use strict";cc._RF.push(e,"13b03wcJfhIz7oowVY52rFx","ComponentNodeEventer");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../basic/BCEventer"),a=cc._decorator,l=a.ccclass,c=(a.property,"ComponentNodeEventer"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.evterTouchStart=s.default.Pop(c),e.evterTouchMove=s.default.Pop(c),e.evterTouchEnd=s.default.Pop(c),e.evterEditDidBegan=s.default.Pop(c),e.evterEditDidChanged=s.default.Pop(c),e.evterEditDidEnd=s.default.Pop(c),e.evterEditReturn=s.default.Pop(c),e.evterSlide=s.default.Pop(c),e.evterScrolling=s.default.Pop(c),e.evterAnimFinished=s.default.Pop(c),e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(e){e.target,t.evterTouchStart.Call(e)}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.evterTouchMove.Call(e)}),null==this.node.getComponent(cc.Button)?this.node.on(cc.Node.EventType.TOUCH_END,function(e){t.evterTouchEnd.Call(e)}):this.node.on("click",function(e){t.evterTouchEnd.Call(e)}),this.node.on("editing-did-began",function(e){t.evterEditDidBegan.Call(e)}),this.node.on("text-changed",function(e){t.evterEditDidChanged.Call(e)}),this.node.on("editing-did-ended",function(e){t.evterEditDidEnd.Call(e)}),this.node.on("editing-return",function(e){t.evterEditReturn.Call(e)}),this.editBox=this.node.getComponent(cc.EditBox),this.node.on("slide",function(e){t.evterSlide.Call(e)}),this.slider=this.node.getComponent(cc.Slider),this.node.on("scrolling",function(e){t.evterScrolling.Call(e)}),this.scroll=this.node.getComponent(cc.ScrollView),this.anim=this.node.getComponent(cc.Animation),null!=this.anim&&this.anim.on(cc.Animation.EventType.FINISHED,function(e){t.evterAnimFinished.Call(e)})},e.prototype.OffAll=function(){this.isValid&&(this.evterTouchStart.Clear(),this.evterTouchMove.Clear(),this.evterTouchEnd.Clear(),this.evterEditDidBegan.Clear(),this.evterEditDidChanged.Clear(),this.evterEditDidEnd.Clear(),this.evterEditReturn.Clear(),this.evterSlide.Clear())},r([l],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../basic/BCEventer":"BCEventer"}],DebugViewBtn:[function(t,e,i){"use strict";cc._RF.push(e,"ae6c2VEKqdAKLceJKAaFVB/","DebugViewBtn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../IndexModule"),a=t("../basic/BCType"),l=t("../component/ComponentNodeEventer"),c=t("../global/Jiang"),u=t("../ui/UINodeType"),_=t("../ui/UIViewComponent"),p=t("./DebugViewDefine"),m=cc._decorator,h=m.ccclass,f=m.property,d="DebugViewBtn",b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txt=null,e.btn=null,e.nodeMask=null,e}var i;return n(e,t),i=e,e.nodeType=u.default.Pop(d,{prefabPath:"DebugViewBtn",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[u.default.ModuleStyle.Pop(d,{listRefModule:[s.default.DEFAULT,s.default.DEBUG_VIEW],propsFilter:function(t,e,i){var o=p.default.groupList.findIndex(function(t){return t.id==i}),n=p.default.groupList[o];t.node.name=t.txt.string=""+n.name,t.nodeMask.active=e.moduleIndex!=o,t.btn.evterTouchEnd.On(function(){e.moduleIndex=o,c.default.mgrUI.ModuleRefresh(s.default.DEBUG_VIEW)})}})],childrenCreator:[],propsType:a.default.typeNumber}),r([f(cc.Label)],e.prototype,"txt",void 0),r([f(l.default)],e.prototype,"btn",void 0),r([f(cc.Node)],e.prototype,"nodeMask",void 0),i=r([h],e)}(_.default);i.default=b,cc._RF.pop()},{"../../IndexModule":"IndexModule","../basic/BCType":"BCType","../component/ComponentNodeEventer":"ComponentNodeEventer","../global/Jiang":"Jiang","../ui/UINodeType":"UINodeType","../ui/UIViewComponent":"UIViewComponent","./DebugViewDefine":"DebugViewDefine"}],DebugViewDefine:[function(t,e,i){"use strict";cc._RF.push(e,"6cbd7wrJUpNM68gBDjZYsr5","DebugViewDefine"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("./DebugViewGroupFast"),r=t("./DebugViewGroupModule"),s=t("./DebugViewGroupMessage"),a=t("../basic/UtilObjPoolType"),l=t("../basic/UtilObjPool"),c="DebugViewDefine";(function(t){var e=function(){function t(){}return t.Pop=function(e,i,o,n,r){var s=l.default.Pop(t._t,e);return s.b2w=i,s.cameraPixelPerSize=o,s.cameraX=n,s.cameraY=r,s},t._t=new a.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"B2DrawInfo"}),t}();t.B2DrawInfo=e,t.b2wList=l.default.Pop(l.default.typeArray,c);var i=function(){function t(){this.id=++t.id}return t.Pop=function(e,i,o){var n=l.default.Pop(t._t,e);return n.name=i,n.nodeType=o,n},t._t=new a.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"DebugViewGroup"}),t.id=0,t}();t.DebugViewGroup=i,t.groupList=[i.Pop(c,"\u5feb\u6377\u65b9\u5f0f",n.default.nodeType),i.Pop(c,"\u6a21\u5757\u5f00\u5173",r.default.nodeType),i.Pop(c,"\u4fe1\u606f\u5c55\u793a",s.default.nodeType)],t.moduleList=l.default.Pop(l.default.typeArray,c);var o=function(){function e(){}return e.Pop=function(i,o,n){var r=l.default.Pop(e._t,i);return r.name=o,r.dataItem=n,t.moduleList.push(r),r},e._t=new a.default({instantiate:function(){return new e},onPop:function(){},onPush:function(){},tag:"ModuleInfo"}),e}();t.ModuleInfo=o,t.fastGroupList=l.default.Pop(l.default.typeArray,c);var u=function(){function e(){}return e.Pop=function(i,o,n){var r=l.default.Pop(e._t,i);return r._name=o,r._act=n,t.fastGroupList.push(r),r},e._t=new a.default({instantiate:function(){return new e},onPop:function(){},onPush:function(){},tag:"FastGroup"}),e}();t.FastGroup=u,t.msgList=l.default.Pop(l.default.typeArray,c);var _=function(){function e(){}return e.Pop=function(i,o,n){var r=l.default.Pop(e._t,i);return r._name=o,r._act=n,t.msgList.push(r),r},e._t=new a.default({instantiate:function(){return new e},onPop:function(){},onPush:function(){},tag:"MsgGroup"}),e}();t.MsgGroup=_})(o||(o={})),i.default=o,cc._RF.pop()},{"../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType","./DebugViewGroupFast":"DebugViewGroupFast","./DebugViewGroupMessage":"DebugViewGroupMessage","./DebugViewGroupModule":"DebugViewGroupModule"}],DebugViewGraphics:[function(t,e,i){"use strict";cc._RF.push(e,"622119rSKdHbL63QApaJBh9","DebugViewGraphics");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../basic/BCType"),a=t("../extend/b2_extend/B2ElementRS"),l=t("../extend/graphics_drawer/GraphicsDrawer"),c=t("../../IndexDebugModuleCtrl"),u=t("../../IndexModule"),_=t("../ui/UINodeType"),p=t("../ui/UIViewComponent"),m=t("./DebugViewDefine"),h=t("./DebugViewState"),f=cc._decorator,d=f.ccclass,b=f.property,y="DebugViewGraphics",v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.graphics=null,e}var i;return n(e,t),i=e,e.prototype.onLoad=function(){this.graphicsDrawer=l.default.Pop(y,this.graphics)},e.nodeType=_.default.Pop(y,{prefabPath:"DebugViewGraphics",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[_.default.ModuleStyle.Pop(y,{listRefModule:[u.default.DEFAULT,u.default.DEBUG_VIEW],propsFilter:function(t){t.graphics.clear();var e=0;h.default.CheckModuleActive(c.default.drawB2joint)&&(e+=a.default.joint.drawAbleTag),h.default.CheckModuleActive(c.default.drawB2transform)&&(e+=a.default.bodyTransform.drawAbleTag),h.default.CheckModuleActive(c.default.drawB2aabb)&&(e+=a.default.aabb.drawAbleTag),h.default.CheckModuleActive(c.default.drawB2shape)&&(e+=a.default.shape.drawAbleTag),h.default.CheckModuleActive(c.default.drawB2particle)&&(e+=a.default.particle.drawAbleTag),h.default.CheckModuleActive(c.default.drawB2controller)&&(e+=a.default.controller.drawAbleTag),h.default.CheckModuleActive(c.default.drawB2contact)&&(e+=a.default.contact.drawAbleTag),m.default.b2wList.forEach(function(i){t.graphicsDrawer.SetTransform(i.cameraPixelPerSize,i.cameraX,i.cameraY),a.default.eleDrawFuncList.forEach(function(o){o(i.b2w,t.graphicsDrawer,e)})})}})],childrenCreator:[],propsType:s.default.typeNumber}),r([b(cc.Graphics)],e.prototype,"graphics",void 0),i=r([d],e)}(p.default);i.default=v,cc._RF.pop()},{"../../IndexDebugModuleCtrl":"IndexDebugModuleCtrl","../../IndexModule":"IndexModule","../basic/BCType":"BCType","../extend/b2_extend/B2ElementRS":"B2ElementRS","../extend/graphics_drawer/GraphicsDrawer":"GraphicsDrawer","../ui/UINodeType":"UINodeType","../ui/UIViewComponent":"UIViewComponent","./DebugViewDefine":"DebugViewDefine","./DebugViewState":"DebugViewState"}],DebugViewGroupFastBtn:[function(t,e,i){"use strict";cc._RF.push(e,"709e2K0fkdLTIU5qD65HdS2","DebugViewGroupFastBtn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../basic/BCType"),a=t("../component/ComponentNodeEventer"),l=t("../../IndexModule"),c=t("../ui/UINodeType"),u=t("../ui/UIViewComponent"),_=t("./DebugViewDefine"),p=cc._decorator,m=p.ccclass,h=p.property,f="DebugViewGroupFastBtn",d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txt=null,e.btn=null,e}var i;return n(e,t),i=e,e.nodeType=c.default.Pop(f,{prefabPath:"DebugViewGroupFastBtn",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[c.default.ModuleStyle.Pop(f,{listRefModule:[l.default.DEFAULT,l.default.DEBUG_VIEW],propsFilter:function(t,e,i){var o=_.default.fastGroupList[i];t.txt.string=o._name,t.btn.evterTouchEnd.On(function(){o._act(e.txt)})}})],childrenCreator:[],propsType:s.default.typeNumber}),r([h(cc.Label)],e.prototype,"txt",void 0),r([h(a.default)],e.prototype,"btn",void 0),i=r([m],e)}(u.default);i.default=d,cc._RF.pop()},{"../../IndexModule":"IndexModule","../basic/BCType":"BCType","../component/ComponentNodeEventer":"ComponentNodeEventer","../ui/UINodeType":"UINodeType","../ui/UIViewComponent":"UIViewComponent","./DebugViewDefine":"DebugViewDefine"}],DebugViewGroupFast:[function(t,e,i){"use strict";cc._RF.push(e,"c66877zPEFDtq5wLu4pC/L3","DebugViewGroupFast");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../basic/BCType"),a=t("../component/ComponentNodeEventer"),l=t("../global/Jiang"),c=t("../../IndexModule"),u=t("../ui/UINodeType"),_=t("../ui/UIViewComponent"),p=t("./DebugViewGroupFastBtn"),m=t("./DebugViewDefine"),h=cc._decorator,f=h.ccclass,d=h.property,b="DebugViewGroupFast",y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.containerBtn=null,e.editProp=null,e}var i;return n(e,t),i=e,e.nodeType=u.default.Pop(b,{prefabPath:"DebugViewGroupFast",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[u.default.ModuleStyle.Pop(b,{listRefModule:[c.default.DEFAULT,c.default.DEBUG_VIEW],propsFilter:function(t,e){t.editProp.editBox.string=""+e.txt,t.editProp.evterEditDidChanged.On(function(){e.txt=t.editProp.editBox.string,l.default.mgrUI.ModuleRefresh(c.default.DEBUG_VIEW)})}})],childrenCreator:[u.default.ChildrenGeneration.Pop(b,{containerGetter:function(t){return t.containerBtn},uiNodeCreator:function(t,e,i){for(var o=0;o<m.default.fastGroupList.length;o++)m.default.fastGroupList[o],i.push(p.default.nodeType.CreateNode(t,o,o))}})],propsType:s.default.typeNumber}),r([d(cc.Node)],e.prototype,"containerBtn",void 0),r([d(a.default)],e.prototype,"editProp",void 0),i=r([f],e)}(_.default);i.default=y,cc._RF.pop()},{"../../IndexModule":"IndexModule","../basic/BCType":"BCType","../component/ComponentNodeEventer":"ComponentNodeEventer","../global/Jiang":"Jiang","../ui/UINodeType":"UINodeType","../ui/UIViewComponent":"UIViewComponent","./DebugViewDefine":"DebugViewDefine","./DebugViewGroupFastBtn":"DebugViewGroupFastBtn"}],DebugViewGroupMessageBtn:[function(t,e,i){"use strict";cc._RF.push(e,"d668f6yEo9BxoCtIjd5oZX9","DebugViewGroupMessageBtn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../IndexModule"),a=t("../basic/BCType"),l=t("../component/ComponentNodeEventer"),c=t("../global/Jiang"),u=t("../ui/UINodeType"),_=t("../ui/UIViewComponent"),p=t("./DebugViewDefine"),m=cc._decorator,h=m.ccclass,f=m.property,d="DebugViewGroupMessageBtn",b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txt=null,e.btn=null,e}var i;return n(e,t),i=e,e.nodeType=u.default.Pop(d,{prefabPath:"DebugViewGroupMessageBtn",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[u.default.ModuleStyle.Pop(d,{listRefModule:[s.default.DEFAULT,s.default.DEBUG_VIEW],propsFilter:function(t,e,i){var o=p.default.msgList[i];t.txt.string=o._name,t.btn.node.active=i!=e.msgIdx,t.btn.evterTouchEnd.On(function(){e.msgIdx=i,c.default.mgrUI.ModuleRefresh(s.default.DEBUG_VIEW)})}})],childrenCreator:[],propsType:a.default.typeNumber}),r([f(cc.Label)],e.prototype,"txt",void 0),r([f(l.default)],e.prototype,"btn",void 0),i=r([h],e)}(_.default);i.default=b,cc._RF.pop()},{"../../IndexModule":"IndexModule","../basic/BCType":"BCType","../component/ComponentNodeEventer":"ComponentNodeEventer","../global/Jiang":"Jiang","../ui/UINodeType":"UINodeType","../ui/UIViewComponent":"UIViewComponent","./DebugViewDefine":"DebugViewDefine"}],DebugViewGroupMessageTxt:[function(t,e,i){"use strict";cc._RF.push(e,"ace454XyixJmb35W5IOcFuE","DebugViewGroupMessageTxt");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../IndexModule"),a=t("../basic/BCType"),l=t("../ui/UINodeType"),c=t("../ui/UIViewComponent"),u=cc._decorator,_=u.ccclass,p=u.property,m="DebugViewGroupMessageTxt",h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txt=null,e}var i;return n(e,t),i=e,e.nodeType=l.default.Pop(m,{prefabPath:"DebugViewGroupMessageTxt",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[l.default.ModuleStyle.Pop(m,{listRefModule:[s.default.DEFAULT,s.default.DEBUG_VIEW],propsFilter:function(t,e,i){t.txt.string!=e.msgListTxt[i]&&(t.txt.string=e.msgListTxt[i])}})],childrenCreator:[],propsType:a.default.typeNumber}),r([p(cc.Label)],e.prototype,"txt",void 0),i=r([_],e)}(c.default);i.default=h,cc._RF.pop()},{"../../IndexModule":"IndexModule","../basic/BCType":"BCType","../ui/UINodeType":"UINodeType","../ui/UIViewComponent":"UIViewComponent"}],DebugViewGroupMessage:[function(t,e,i){"use strict";cc._RF.push(e,"54a2fyywphPsKtkpxCqtAH3","DebugViewGroupMessage");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../basic/BCType"),a=t("../../IndexModule"),l=t("../ui/UINodeType"),c=t("../ui/UIViewComponent"),u=t("./DebugViewDefine"),_=t("./DebugViewGroupMessageBtn"),p=t("./DebugViewGroupMessageTxt"),m=cc._decorator,h=m.ccclass,f=m.property,d="DebugViewGroupMessage",b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.containerTxt=null,e.containerBtn=null,e}var i;return n(e,t),i=e,e.nodeType=l.default.Pop(d,{prefabPath:"DebugViewGroupMessage",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[l.default.ModuleStyle.Pop(d,{listRefModule:[a.default.DEFAULT,a.default.DEBUG_VIEW],propsFilter:function(){}})],childrenCreator:[l.default.ChildrenGeneration.Pop(d,{containerGetter:function(t){return t.containerTxt},uiNodeCreator:function(t,e,i){for(var o=0;o<t.msgListTxt.length;o++)i.push(p.default.nodeType.CreateNode(t,o,o))}}),l.default.ChildrenGeneration.Pop(d,{containerGetter:function(t){return t.containerBtn},uiNodeCreator:function(t,e,i){for(var o=0;o<u.default.msgList.length;o++)i.push(_.default.nodeType.CreateNode(t,o,o))}})],propsType:s.default.typeNumber}),r([f(cc.Node)],e.prototype,"containerTxt",void 0),r([f(cc.Node)],e.prototype,"containerBtn",void 0),i=r([h],e)}(c.default);i.default=b,cc._RF.pop()},{"../../IndexModule":"IndexModule","../basic/BCType":"BCType","../ui/UINodeType":"UINodeType","../ui/UIViewComponent":"UIViewComponent","./DebugViewDefine":"DebugViewDefine","./DebugViewGroupMessageBtn":"DebugViewGroupMessageBtn","./DebugViewGroupMessageTxt":"DebugViewGroupMessageTxt"}],DebugViewGroupModuleBtn:[function(t,e,i){"use strict";cc._RF.push(e,"68c52GIPQtIE5pt0hPch3rL","DebugViewGroupModuleBtn");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../basic/BCType"),a=t("../component/ComponentNodeEventer"),l=t("../global/Jiang"),c=t("../../IndexModule"),u=t("../ui/UINodeType"),_=t("../ui/UIViewComponent"),p=t("./DebugViewDefine"),m=cc._decorator,h=m.ccclass,f=m.property,d="DebugViewGroupModuleBtn",b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txt=null,e.btn=null,e.nodeMask=null,e}var i;return n(e,t),i=e,e.nodeType=u.default.Pop(d,{prefabPath:"DebugViewGroupModuleBtn",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[u.default.ModuleStyle.Pop(d,{listRefModule:[c.default.DEFAULT,c.default.DEBUG_VIEW],propsFilter:function(t,e,i){var o=p.default.moduleList[i];t.txt.string=""+o.name,t.nodeMask.active=!l.default.mgrData.Get(o.dataItem),t.btn.evterTouchEnd.On(function(){l.default.mgrData.Set(o.dataItem,!l.default.mgrData.Get(o.dataItem)),l.default.mgrUI.ModuleRefresh(c.default.DEBUG_VIEW)})}})],childrenCreator:[],propsType:s.default.typeNumber}),r([f(cc.Label)],e.prototype,"txt",void 0),r([f(a.default)],e.prototype,"btn",void 0),r([f(cc.Node)],e.prototype,"nodeMask",void 0),i=r([h],e)}(_.default);i.default=b,cc._RF.pop()},{"../../IndexModule":"IndexModule","../basic/BCType":"BCType","../component/ComponentNodeEventer":"ComponentNodeEventer","../global/Jiang":"Jiang","../ui/UINodeType":"UINodeType","../ui/UIViewComponent":"UIViewComponent","./DebugViewDefine":"DebugViewDefine"}],DebugViewGroupModule:[function(t,e,i){"use strict";cc._RF.push(e,"83c29xpZqtB6rQ0dSen8aBP","DebugViewGroupModule");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../basic/BCType"),a=t("../../IndexModule"),l=t("../ui/UINodeType"),c=t("../ui/UIViewComponent"),u=t("./DebugViewDefine"),_=t("./DebugViewGroupModuleBtn"),p=cc._decorator,m=p.ccclass,h=p.property,f="DebugViewGroupModule",d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.containerBtn=null,e}var i;return n(e,t),i=e,e.nodeType=l.default.Pop(f,{prefabPath:"DebugViewGroupModule",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[l.default.ModuleStyle.Pop(f,{listRefModule:[a.default.DEFAULT,a.default.DEBUG_VIEW],propsFilter:function(){}})],childrenCreator:[l.default.ChildrenGeneration.Pop(f,{containerGetter:function(t){return t.containerBtn},uiNodeCreator:function(t,e,i){for(var o=0;o<u.default.moduleList.length;o++)i.push(_.default.nodeType.CreateNode(t,o,o))}})],propsType:s.default.typeNumber}),r([h(cc.Node)],e.prototype,"containerBtn",void 0),i=r([m],e)}(c.default);i.default=d,cc._RF.pop()},{"../../IndexModule":"IndexModule","../basic/BCType":"BCType","../ui/UINodeType":"UINodeType","../ui/UIViewComponent":"UIViewComponent","./DebugViewDefine":"DebugViewDefine","./DebugViewGroupModuleBtn":"DebugViewGroupModuleBtn"}],DebugViewState:[function(t,e,i){"use strict";cc._RF.push(e,"af337N2U5VI97eVvi3oji9a","DebugViewState");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("../global/Jiang"),s=t("../../IndexModule"),a=t("../../IndexLayer"),l=t("../ui/ViewState"),c=t("./DebugViewDefine"),u=t("../basic/UtilObjPoolType"),_=t("../basic/UtilObjPool"),p=t("./DebugViewGroupMessage"),m="DebugViewState",h=function(t){function e(){var e=t.call(this,a.default.SYSTEM,l.default.BG_TYPE.NONE,!1)||this;return e.contentEnable=!1,e.moduleIndex=0,e.txt="\u8bf7\u8f93\u5165\u53c2\u6570",e.msgIdx=0,e.msgListTxt=_.default.Pop(_.default.typeArray,m),r.default.mgrUI.evterUpdate.On(function(){if(e.contentEnable&&c.default.groupList[e.moduleIndex].nodeType==p.default.nodeType){var t=c.default.msgList[e.msgIdx]._act().split(/\n/g);for(e.msgListTxt.length=0;0<t.length;)e.msgListTxt.push(t.splice(0,100).join("\n"));r.default.mgrUI.ModuleRefresh(s.default.DEBUG_VIEW)}0<c.default.b2wList.length&&r.default.mgrUI.ModuleRefresh(s.default.DEBUG_VIEW)}),e}return n(e,t),e.Pop=function(t){return _.default.Pop(e._t,t)},e.Init=function(){e.inst=e.Pop(m)},e.prototype.Open=function(){this.contentEnable=!0,r.default.mgrUI.ModuleRefresh(s.default.DEBUG_VIEW)},e.prototype.Close=function(){this.contentEnable=!1,r.default.mgrUI.ModuleRefresh(s.default.DEBUG_VIEW)},e.CheckModuleActive=function(t){return r.default.mgrData.Get(t.dataItem)},e._t=new u.default({instantiate:function(){return new e},onPop:function(){},onPush:function(){},tag:m}),e}(l.default);i.default=h,cc._RF.pop()},{"../../IndexLayer":"IndexLayer","../../IndexModule":"IndexModule","../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType","../global/Jiang":"Jiang","../ui/ViewState":"ViewState","./DebugViewDefine":"DebugViewDefine","./DebugViewGroupMessage":"DebugViewGroupMessage"}],DebugView:[function(t,e,i){"use strict";cc._RF.push(e,"951eftE8vNI/7Hu1mSt1D+o","DebugView");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../IndexModule"),a=t("../basic/BCType"),l=t("../component/ComponentNodeEventer"),c=t("../ui/UINodeType"),u=t("../ui/UIViewComponent"),_=t("./DebugViewBtn"),p=t("./DebugViewDefine"),m=t("./DebugViewGraphics"),h=cc._decorator,f=h.ccclass,d=h.property,b="DebugView",y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeContent=null,e.btnToggle=null,e.btnClose=null,e.btnBg=null,e.containerBtn=null,e.containerCurrent=null,e.containerB2Graphics=null,e}var i;return n(e,t),i=e,e.nodeType=c.default.Pop(b,{prefabPath:"DebugView",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[c.default.ModuleStyle.Pop(b,{listRefModule:[s.default.DEFAULT,s.default.DEBUG_VIEW],propsFilter:function(t,e){t.nodeContent.active=e.contentEnable,t.btnToggle.evterTouchEnd.On(function(){e.Open()}),t.btnClose.evterTouchEnd.On(function(){e.Close()}),t.btnBg.evterTouchEnd.On(function(){})}})],childrenCreator:[c.default.ChildrenGeneration.Pop(b,{containerGetter:function(t){return t.containerB2Graphics},uiNodeCreator:function(t,e,i){i.push(m.default.nodeType.CreateNode(t,null,0))}}),c.default.ChildrenGeneration.Pop(b,{containerGetter:function(t){return t.containerBtn},uiNodeCreator:function(t,e,i){if(t.contentEnable)for(var o=0;o<p.default.groupList.length;o++){var n=p.default.groupList[o];i.push(_.default.nodeType.CreateNode(t,n.id,n.id))}}}),c.default.ChildrenGeneration.Pop(b,{containerGetter:function(t){return t.containerCurrent},uiNodeCreator:function(t,e,i){if(t.contentEnable){var o=p.default.groupList[t.moduleIndex];i.push(o.nodeType.CreateNode(t,null,0))}}})],propsType:a.default.typeNumber}),r([d(cc.Node)],e.prototype,"nodeContent",void 0),r([d(l.default)],e.prototype,"btnToggle",void 0),r([d(l.default)],e.prototype,"btnClose",void 0),r([d(l.default)],e.prototype,"btnBg",void 0),r([d(cc.Node)],e.prototype,"containerBtn",void 0),r([d(cc.Node)],e.prototype,"containerCurrent",void 0),r([d(cc.Node)],e.prototype,"containerB2Graphics",void 0),i=r([f],e)}(u.default);i.default=y,cc._RF.pop()},{"../../IndexModule":"IndexModule","../basic/BCType":"BCType","../component/ComponentNodeEventer":"ComponentNodeEventer","../ui/UINodeType":"UINodeType","../ui/UIViewComponent":"UIViewComponent","./DebugViewBtn":"DebugViewBtn","./DebugViewDefine":"DebugViewDefine","./DebugViewGraphics":"DebugViewGraphics"}],GraphicsDrawer:[function(t,e,i){"use strict";cc._RF.push(e,"77f64c5UVBHKoNydI7/u01X","GraphicsDrawer"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../basic/UtilObjPool"),n=t("../../basic/UtilObjPoolType"),r=function(){function t(){this._cameraPixelPerSize=1,this._cameraX=0,this._cameraY=0}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n._graphics=i,n},t.prototype.SetTransform=function(t,e,i){this._cameraPixelPerSize=t,this._cameraX=e,this._cameraY=i},t.prototype.FillPosSetAll=function(t,e){this.FillPosOrigin(t,t.length,e)},t.prototype.FillPosOrigin=function(t,e,i){this._graphics.fillColor=i,this.GraphMoveTo(t[0].x,t[0].y);for(var o=1;o<e;o++)this.GraphLineTo(t[o].x,t[o].y);this.GraphLineTo(t[0].x,t[0].y),this._graphics.fill()},t.prototype.CyclePosSetAll=function(t,e,i){this.CyclePosOrigin(t,t.length,e,i)},t.prototype.CyclePosOrigin=function(t,e,i,o){for(var n=0;n<e;n++){var r=t[n],s=t[(n+1)%t.length];this.StraightLine(r.x,r.y,s.x,s.y,i,o)}},t.prototype.ConnectPosSetAll=function(t,e,i){this.ConnectPosOrigin(t,t.length,e,i)},t.prototype.ConnectPosOrigin=function(t,e,i,o){for(var n=0;n<e-1;n++){var r=t[n],s=t[(n+1)%t.length];this.StraightLine(r.x,r.y,s.x,s.y,i,o)}},t.prototype.RoundFill=function(t,e,i,o){this._graphics.fillColor=o,this.GraphArc(t,e,i),this._graphics.fill()},t.prototype.RoundLine=function(t,e,i,o,n){this._graphics.strokeColor=n,this._graphics.lineWidth=o*this._cameraPixelPerSize,this.GraphArc(t,e,i),this._graphics.stroke()},t.prototype.StraightLine=function(t,e,i,o,n,r){this._graphics.strokeColor=r,this._graphics.lineWidth=n*this._cameraPixelPerSize,this.GraphMoveTo(t,e),this.GraphLineTo(i,o),this._graphics.stroke()},t.prototype.Pixel=function(t){return t/this._cameraPixelPerSize},t.prototype.GraphMoveTo=function(t,e){this._graphics.moveTo(this.TransformX(t),this.TransformY(e))},t.prototype.GraphLineTo=function(t,e){this._graphics.lineTo(this.TransformX(t),this.TransformY(e))},t.prototype.GraphArc=function(t,e,i){this._graphics.arc(this.TransformX(t),this.TransformY(e),i*this._cameraPixelPerSize,0,360,!0)},t.prototype.TransformX=function(t){return(t-this._cameraX)*this._cameraPixelPerSize},t.prototype.TransformY=function(t){return(t-this._cameraY)*this._cameraPixelPerSize},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"GraphicsDrawer"}),t}();i.default=r,cc._RF.pop()},{"../../basic/UtilObjPool":"UtilObjPool","../../basic/UtilObjPoolType":"UtilObjPoolType"}],IndexDebugModuleConsole:[function(t,e,i){"use strict";cc._RF.push(e,"d9a49nLENVP5K1Ir5wwqoGI","IndexDebugModuleConsole"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("./frame/basic/UtilObjPool"),r=t("./frame/debug/DebugViewDefine"),s="indexCommon";n.default.Pop(n.default.typeArray,s),n.default.Pop(n.default.typeArray,s),function(t){t.tree=r.default.MsgGroup.Pop(s,"hello world",function(){return"hello world"})}(o||(o={})),i.default=o,cc._RF.pop()},{"./frame/basic/UtilObjPool":"UtilObjPool","./frame/debug/DebugViewDefine":"DebugViewDefine"}],IndexDebugModuleCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"f8502in8T1KW7WMbEL/lMmX","IndexDebugModuleCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("./frame/data/MgrDataItem"),r=t("./frame/data/MgrDataType"),s=t("./frame/debug/DebugViewDefine"),a="indexCtrlModule";(function(t){t.drawB2joint=s.default.ModuleInfo.Pop(a,"b2-\u7ed8\u5236\u5173\u8282",n.default.Pop(a,"drawB2joint",r.default.typeBool,!1)),t.drawB2transform=s.default.ModuleInfo.Pop(a,"b2-\u7ed8\u5236\u53d8\u6362",n.default.Pop(a,"drawB2transform",r.default.typeBool,!1)),t.drawB2aabb=s.default.ModuleInfo.Pop(a,"b2-\u7ed8\u5236\u7bb1\u76d2",n.default.Pop(a,"drawB2aabb",r.default.typeBool,!1)),t.drawB2shape=s.default.ModuleInfo.Pop(a,"b2-\u7ed8\u5236\u5f62\u72b6",n.default.Pop(a,"drawB2shape",r.default.typeBool,!1)),t.drawB2particle=s.default.ModuleInfo.Pop(a,"b2-\u7ed8\u5236\u7c92\u5b50",n.default.Pop(a,"drawB2particle",r.default.typeBool,!1)),t.drawB2controller=s.default.ModuleInfo.Pop(a,"b2-\u7ed8\u5236\u9a6c\u8fbe",n.default.Pop(a,"drawB2controller",r.default.typeBool,!1)),t.drawB2contact=s.default.ModuleInfo.Pop(a,"b2-\u7ed8\u5236\u78b0\u649e",n.default.Pop(a,"drawB2contact",r.default.typeBool,!1))})(o||(o={})),i.default=o,cc._RF.pop()},{"./frame/data/MgrDataItem":"MgrDataItem","./frame/data/MgrDataType":"MgrDataType","./frame/debug/DebugViewDefine":"DebugViewDefine"}],IndexDebugModuleFast:[function(t,e,i){"use strict";cc._RF.push(e,"76763v+jW9HCrgkGebyCCM9","IndexDebugModuleFast"),Object.defineProperty(i,"__esModule",{value:!0}),cc._RF.pop()},{}],IndexLayer:[function(t,e,i){"use strict";var o;cc._RF.push(e,"c59d6WlWg1Cb7EuheU7Tx4k","IndexLayer"),Object.defineProperty(i,"__esModule",{value:!0}),function(t){t[t.GAME=1]="GAME",t[t.SYSTEM=2]="SYSTEM"}(o||(o={})),i.default=o,cc._RF.pop()},{}],IndexModule:[function(t,e,i){"use strict";var o;cc._RF.push(e,"c30e3e9hL1BqZuslzYPCqLT","IndexModule"),Object.defineProperty(i,"__esModule",{value:!0}),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.DEBUG_VIEW=1]="DEBUG_VIEW",t[t.INDEX=2]="INDEX"}(o||(o={})),i.default=o,cc._RF.pop()},{}],IndexStorageItem:[function(t,e,i){"use strict";cc._RF.push(e,"067b4Ykrp5Jxp0k/+BBWwvJ","IndexStorageItem"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("./frame/data/MgrDataItem"),r=t("./frame/data/MgrDataType");(function(t){t.touchedPos=n.default.Pop("indexDataStorageItem","touchedPos_3",r.default.typeObject,null)})(o||(o={})),i.default=o,cc._RF.pop()},{"./frame/data/MgrDataItem":"MgrDataItem","./frame/data/MgrDataType":"MgrDataType"}],IndexViewState:[function(t,e,i){"use strict";cc._RF.push(e,"d55d5RMoaJCmoM2CKTp3ETq","IndexViewState");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("./frame/basic/UtilObjPool"),s=t("./frame/basic/UtilObjPoolType"),a=t("./frame/global/Jiang"),l=t("./frame/ui/ViewState"),c=t("./IndexLayer"),u=t("./IndexModule"),_=function(t){function e(){return t.call(this,c.default.GAME,l.default.BG_TYPE.SELF,!1)||this}return n(e,t),e.Pop=function(t){return r.default.Pop(e._t,t)},e.prototype.OnInit=function(){a.default.mgrUI.evterUpdate.On(function(){a.default.mgrUI.ModuleRefresh(u.default.INDEX)})},e._t=new s.default({instantiate:function(){return new e},onPop:function(){},onPush:function(){},tag:"IndexViewState"}),e}(l.default);i.default=_,cc._RF.pop()},{"./IndexLayer":"IndexLayer","./IndexModule":"IndexModule","./frame/basic/UtilObjPool":"UtilObjPool","./frame/basic/UtilObjPoolType":"UtilObjPoolType","./frame/global/Jiang":"Jiang","./frame/ui/ViewState":"ViewState"}],IndexViewTouchPos:[function(t,e,i){"use strict";cc._RF.push(e,"6c76b1anVRLXZF4d/Qq+HID","IndexViewTouchPos"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(t){this.evter=t},cc._RF.pop()},{}],IndexView:[function(t,e,i){"use strict";cc._RF.push(e,"9b5b6JBY0xLeZdX4KWtLTXd","IndexView");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("./frame/basic/BCType"),a=t("./frame/basic/UtilObjPool"),l=t("./frame/component/ComponentNodeEventer"),c=t("./frame/extend/graphics_drawer/GraphicsDrawer"),u=t("./frame/global/Jiang"),_=t("./frame/ui/UINodeType"),p=t("./frame/ui/UIViewComponent"),m=t("./IndexModule"),h=t("./IndexStorageItem"),f=t("./IndexViewTouchPos"),d=cc._decorator,b=d.ccclass,y=d.property,v="IndexView",V=new cc.Color(125,125,125),C=new cc.Color(0,255,0,255),g=new cc.Color(255,255,255,150),x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.graphicsTouch=null,e.graphicsGridLine=null,e.graphicsGridFill=null,e.grahpicsGridDot=null,e.listNodeTouchPos=[],e.listNodeTouchPosRec=[],e}var i;return n(e,t),i=e,e.prototype.onLoad=function(){this.graphicsTouchDrawer=c.default.Pop(v,this.graphicsTouch),this.graphicsGridLineDrawer=c.default.Pop(v,this.graphicsGridLine),this.graphicsGridFillDrawer=c.default.Pop(v,this.graphicsGridFill),this.grahpicsGridDotDrawer=c.default.Pop(v,this.grahpicsGridDot);for(var t=0;t<this.listNodeTouchPos.length;t++)this.listNodeTouchPosRec.push(new f.default(this.listNodeTouchPos[t]))},e.nodeType=_.default.Pop(v,{prefabPath:"IndexView",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[_.default.ModuleStyle.Pop(v,{listRefModule:[m.default.INDEX],propsFilter:function(t){t.graphicsGridLineDrawer._graphics.clear();for(var e=Math.floor(u.default.mgrUI._containerUI.width/2/30),i=Math.floor(u.default.mgrUI._containerUI.height/2/30),o=0;o<=e;o++)t.graphicsGridLineDrawer.StraightLine(30*o,-u.default.mgrUI._containerUI.height/2,30*o,u.default.mgrUI._containerUI.height/2,4,V),0!=o&&t.graphicsGridLineDrawer.StraightLine(30*-o,-u.default.mgrUI._containerUI.height/2,30*-o,u.default.mgrUI._containerUI.height/2,4,V);for(o=0;o<=i;o++)t.graphicsGridLineDrawer.StraightLine(-u.default.mgrUI._containerUI.width/2,30*o,u.default.mgrUI._containerUI.width/2,30*o,4,V),0!=o&&t.graphicsGridLineDrawer.StraightLine(-u.default.mgrUI._containerUI.width/2,30*-o,u.default.mgrUI._containerUI.width/2,30*-o,4,V);if(t.graphicsTouchDrawer._graphics.clear(),null==u.default.mgrData.Get(h.default.touchedPos)){var n=[];for(o=0;o<t.listNodeTouchPosRec.length;o++)n.push(0,0);u.default.mgrData.Set(h.default.touchedPos,n)}var r=function(e){var i=e,o=t.listNodeTouchPosRec[e];o.evter.node.x=u.default.mgrData.Get(h.default.touchedPos)[2*e],o.evter.node.y=u.default.mgrData.Get(h.default.touchedPos)[2*e+1],t.graphicsTouchDrawer.RoundLine(o.evter.node.x,o.evter.node.y,7.5*(e+1),4,C);var n=(e+1)%t.listNodeTouchPosRec.length,r=u.default.mgrData.Get(h.default.touchedPos)[2*n],s=u.default.mgrData.Get(h.default.touchedPos)[2*n+1];t.graphicsTouchDrawer.StraightLine(o.evter.node.x,o.evter.node.y,r,s,4,C),o.evter.evterTouchStart.On(function(t){u.default.mgrData.Get(h.default.touchedPos)[2*i]=t.getLocationX()-u.default.mgrUI._containerUI.width/2,u.default.mgrData.Get(h.default.touchedPos)[2*i+1]=t.getLocationY()-u.default.mgrUI._containerUI.height/2}),o.evter.evterTouchMove.On(function(t){u.default.mgrData.Get(h.default.touchedPos)[2*i]=t.getLocationX()-u.default.mgrUI._containerUI.width/2,u.default.mgrData.Get(h.default.touchedPos)[2*i+1]=t.getLocationY()-u.default.mgrUI._containerUI.height/2})};for(o=0;o<t.listNodeTouchPosRec.length;o++)r(o);t.graphicsGridFillDrawer._graphics.clear(),t.grahpicsGridDotDrawer._graphics.clear();var s,l=t.listNodeTouchPosRec[2],c=t.listNodeTouchPosRec[1],_=t.listNodeTouchPosRec[0],p=l.evter.node.x-c.evter.node.x,m=l.evter.node.y-c.evter.node.y,f=_.evter.node.x-c.evter.node.x,d=p*(_.evter.node.y-c.evter.node.y)-m*f;for(0<d&&(s=function(t){return 0<t}),d<0&&(s=function(t){return t<0}),o=0;o<t.listNodeTouchPosRec.length;o++){var b=t.listNodeTouchPosRec[o],y=(o+1)%t.listNodeTouchPosRec.length,x=u.default.mgrData.Get(h.default.touchedPos)[2*y]-u.default.mgrData.Get(h.default.touchedPos)[2*o],S=u.default.mgrData.Get(h.default.touchedPos)[2*y+1]-u.default.mgrData.Get(h.default.touchedPos)[2*o+1];b.vecLeftX=Math.cos(Math.PI/2)*x-Math.sin(Math.PI/2)*S,b.vecLeftY=Math.sin(Math.PI/2)*x+Math.cos(Math.PI/2)*S}var B=e+1,A=-i-1,P=i+1;for(o=-e-1;o<=B;o++)for(var w=A;w<=P;w++){for(var M=30*(o+.5),D=30*(w+.5),I=!0,G=0;G<t.listNodeTouchPosRec.length;G++){var T=M-(b=t.listNodeTouchPosRec[G]).evter.node.x,R=D-b.evter.node.y;s(T*b.vecLeftX+R*b.vecLeftY)||(I=!1)}if(I){var F=a.default.Pop(a.default.typeccVec2,v);F.x=M-15,F.y=D-15;var O=a.default.Pop(a.default.typeccVec2,v);O.x=M+15,O.y=D-15;var L=a.default.Pop(a.default.typeccVec2,v);L.x=M+15,L.y=D+15;var j=a.default.Pop(a.default.typeccVec2,v);j.x=M-15,j.y=D+15;var J=a.default.Pop(a.default.typeArray,v);J.push(F,O,L,j),t.graphicsGridFillDrawer.FillPosSetAll(J,g),t.grahpicsGridDotDrawer.RoundFill(M,D,2,C);for(var E=0;E<J.length;E++)a.default.Push(J[E]);a.default.Push(J)}I||t.grahpicsGridDotDrawer.RoundFill(M,D,2,V)}}})],childrenCreator:[],propsType:s.default.typeNumber}),r([y(cc.Graphics)],e.prototype,"graphicsTouch",void 0),r([y(cc.Graphics)],e.prototype,"graphicsGridLine",void 0),r([y(cc.Graphics)],e.prototype,"graphicsGridFill",void 0),r([y(cc.Graphics)],e.prototype,"grahpicsGridDot",void 0),r([y([l.default])],e.prototype,"listNodeTouchPos",void 0),i=r([b],e)}(p.default);i.default=x,cc._RF.pop()},{"./IndexModule":"IndexModule","./IndexStorageItem":"IndexStorageItem","./IndexViewTouchPos":"IndexViewTouchPos","./frame/basic/BCType":"BCType","./frame/basic/UtilObjPool":"UtilObjPool","./frame/component/ComponentNodeEventer":"ComponentNodeEventer","./frame/extend/graphics_drawer/GraphicsDrawer":"GraphicsDrawer","./frame/global/Jiang":"Jiang","./frame/ui/UINodeType":"UINodeType","./frame/ui/UIViewComponent":"UIViewComponent"}],Index:[function(t,e,i){"use strict";cc._RF.push(e,"2f4c5zQACBJlZQv82hC1obT","Index");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0}),i.Index=void 0;var s=t("../debug/DebugView"),a=t("../debug/DebugViewBtn"),l=t("../debug/DebugViewGraphics"),c=t("../debug/DebugViewGroupFast"),u=t("../debug/DebugViewGroupFastBtn"),_=t("../debug/DebugViewGroupMessage"),p=t("../debug/DebugViewGroupModule"),m=t("../debug/DebugViewGroupModuleBtn"),h=t("../debug/DebugViewState"),f=t("../../IndexView"),d=t("../ui/UIMask"),b=t("./Jiang"),y=t("../debug/DebugViewGroupMessageBtn"),v=t("../debug/DebugViewGroupMessageTxt"),V=t("../../IndexViewState"),C=cc._decorator,g=C.ccclass,x=C.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cameraUI=null,e.nodeUIContainer=null,e.prefabLoading=null,e.prefabMask=null,e.prefabDebugGroupFastBtn=null,e.prefabDebugGroupFast=null,e.prefabDebugGroupModuleBtn=null,e.prefabDebugGroupModule=null,e.prefabDebugGroupGraphics=null,e.prefabDebugGroupMessage=null,e.prefabDebugGroupMessageBtn=null,e.prefabDebugGroupMessageTxt=null,e.prefabDebugViewBtn=null,e.prefabDebug=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this;Promise.resolve().then(function(){b.default.mgrUI.Init(t.cameraUI,t.nodeUIContainer),b.default.mgrRes._staticPrefabCache.set(f.default.nodeType._prefabPath,t.prefabLoading),b.default.mgrRes._staticPrefabCache.set(d.default.nodeType._prefabPath,t.prefabMask),b.default.mgrRes._staticPrefabCache.set(u.default.nodeType._prefabPath,t.prefabDebugGroupFastBtn),b.default.mgrRes._staticPrefabCache.set(c.default.nodeType._prefabPath,t.prefabDebugGroupFast),b.default.mgrRes._staticPrefabCache.set(m.default.nodeType._prefabPath,t.prefabDebugGroupModuleBtn),b.default.mgrRes._staticPrefabCache.set(p.default.nodeType._prefabPath,t.prefabDebugGroupModule),b.default.mgrRes._staticPrefabCache.set(l.default.nodeType._prefabPath,t.prefabDebugGroupGraphics),b.default.mgrRes._staticPrefabCache.set(_.default.nodeType._prefabPath,t.prefabDebugGroupMessage),b.default.mgrRes._staticPrefabCache.set(y.default.nodeType._prefabPath,t.prefabDebugGroupMessageBtn),b.default.mgrRes._staticPrefabCache.set(v.default.nodeType._prefabPath,t.prefabDebugGroupMessageTxt),b.default.mgrRes._staticPrefabCache.set(a.default.nodeType._prefabPath,t.prefabDebugViewBtn),b.default.mgrRes._staticPrefabCache.set(s.default.nodeType._prefabPath,t.prefabDebug),h.default.Init(),b.default.mgrUI.Open(s.default.nodeType,h.default.inst),b.default.mgrData.Init(),b.default.mgrUI.Open(f.default.nodeType,V.default.Pop("Index"))})},r([x({displayName:"UI \u76f8\u673a",type:cc.Node})],e.prototype,"cameraUI",void 0),r([x({displayName:"UI \u5bb9\u5668",type:cc.Node})],e.prototype,"nodeUIContainer",void 0),r([x({displayName:"\u901a\u7528\u7684 ui \u906e\u7f69",type:cc.Prefab})],e.prototype,"prefabLoading",void 0),r([x({displayName:"\u901a\u7528\u7684 ui \u906e\u7f69",type:cc.Prefab})],e.prototype,"prefabMask",void 0),r([x({displayName:"debug \u5de5\u5177-\u5feb\u6377\u65b9\u5f0f-\u6309\u94ae",type:cc.Prefab})],e.prototype,"prefabDebugGroupFastBtn",void 0),r([x({displayName:"debug \u5de5\u5177-\u5feb\u6377\u65b9\u5f0f",type:cc.Prefab})],e.prototype,"prefabDebugGroupFast",void 0),r([x({displayName:"debug \u5de5\u5177-\u6a21\u5757\u5f00\u5173-\u6309\u94ae",type:cc.Prefab})],e.prototype,"prefabDebugGroupModuleBtn",void 0),r([x({displayName:"debug \u5de5\u5177-\u6a21\u5757\u5f00\u5173",type:cc.Prefab})],e.prototype,"prefabDebugGroupModule",void 0),r([x({displayName:"debug \u5de5\u5177-\u753b\u7b14",type:cc.Prefab})],e.prototype,"prefabDebugGroupGraphics",void 0),r([x({displayName:"debug \u5de5\u5177-\u4fe1\u606f",type:cc.Prefab})],e.prototype,"prefabDebugGroupMessage",void 0),r([x({displayName:"debug \u5de5\u5177-\u4fe1\u606f\u6309\u94ae",type:cc.Prefab})],e.prototype,"prefabDebugGroupMessageBtn",void 0),r([x({displayName:"debug \u5de5\u5177-\u4fe1\u606f\u6587\u672c",type:cc.Prefab})],e.prototype,"prefabDebugGroupMessageTxt",void 0),r([x({displayName:"debug \u5de5\u5177-\u6309\u94ae",type:cc.Prefab})],e.prototype,"prefabDebugViewBtn",void 0),r([x({displayName:"debug \u5de5\u5177",type:cc.Prefab})],e.prototype,"prefabDebug",void 0),r([g],e)}(cc.Component);i.Index=S,cc._RF.pop()},{"../../IndexView":"IndexView","../../IndexViewState":"IndexViewState","../debug/DebugView":"DebugView","../debug/DebugViewBtn":"DebugViewBtn","../debug/DebugViewGraphics":"DebugViewGraphics","../debug/DebugViewGroupFast":"DebugViewGroupFast","../debug/DebugViewGroupFastBtn":"DebugViewGroupFastBtn","../debug/DebugViewGroupMessage":"DebugViewGroupMessage","../debug/DebugViewGroupMessageBtn":"DebugViewGroupMessageBtn","../debug/DebugViewGroupMessageTxt":"DebugViewGroupMessageTxt","../debug/DebugViewGroupModule":"DebugViewGroupModule","../debug/DebugViewGroupModuleBtn":"DebugViewGroupModuleBtn","../debug/DebugViewState":"DebugViewState","../ui/UIMask":"UIMask","./Jiang":"Jiang"}],Jiang:[function(t,e,i){"use strict";cc._RF.push(e,"ba18dJ6OAdC2bqCDbz/ocwS","Jiang"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("../config/MgrCfg"),r=t("../data/MgrData"),s=t("../evter/MgrEvter"),a=t("../res/MgrRes"),l=t("../ui/MgrUI");(function(t){t.mgrRes=a.default.inst,t.mgrUI=l.default.inst,t.mgrCfg=n.default.inst,t.mgrData=r.default.inst,t.mgrEvter=s.default.inst})(o||(o={})),window.jiang=o,i.default=o,cc._RF.pop()},{"../config/MgrCfg":"MgrCfg","../data/MgrData":"MgrData","../evter/MgrEvter":"MgrEvter","../res/MgrRes":"MgrRes","../ui/MgrUI":"MgrUI"}],MgrCfg:[function(t,e,i){"use strict";cc._RF.push(e,"2bf43+3nw1GIojnLvDAVrcI","MgrCfg"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/BCCollection"),n=t("../basic/UtilObjPool"),r=t("../basic/UtilObjPoolType"),s=t("../res/MgrRes"),a=t("./src/CfgBuffProps"),l=t("./src/CfgCommon"),c=t("./src/CfgEff"),u=t("./src/CfgEquipmentLevel"),_=t("./src/CfgEquipmentProps"),p=t("./src/CfgGameElement"),m=t("./src/CfgLevel"),h=t("./src/CfgVoiceOgg"),f="MgrCfg",d=function(){function t(){this.cfgBuffProps=o.default.Pop(f),this.cfgCommon=o.default.Pop(f),this.cfgEff=o.default.Pop(f),this.cfgEquipmentLevel=o.default.Pop(f),this.cfgEquipmentProps=o.default.Pop(f),this.cfgGameElement=o.default.Pop(f),this.cfgLevel=o.default.Pop(f),this.cfgVoiceOgg=o.default.Pop(f)}return t.Pop=function(e){return n.default.Pop(t._t,e)},t.prototype.Init=function(){var t=this;this.promiseArr=[s.default.inst.CertainLoadAsset("json_config/CfgBuffProps").loadingPromise.then(function(e){e.json.forEach(function(e){t.cfgBuffProps.add(a.default.Pop(f,e))})}),s.default.inst.CertainLoadAsset("json_config/CfgCommon").loadingPromise.then(function(e){e.json.forEach(function(e){t.cfgCommon.add(l.default.Pop(f,e))})}),s.default.inst.CertainLoadAsset("json_config/CfgEff").loadingPromise.then(function(e){e.json.forEach(function(e){t.cfgEff.add(c.default.Pop(f,e))})}),s.default.inst.CertainLoadAsset("json_config/CfgEquipmentLevel").loadingPromise.then(function(e){e.json.forEach(function(e){t.cfgEquipmentLevel.add(u.default.Pop(f,e))})}),s.default.inst.CertainLoadAsset("json_config/CfgEquipmentProps").loadingPromise.then(function(e){e.json.forEach(function(e){t.cfgEquipmentProps.add(_.default.Pop(f,e))})}),s.default.inst.CertainLoadAsset("json_config/CfgGameElement").loadingPromise.then(function(e){e.json.forEach(function(e){t.cfgGameElement.add(p.default.Pop(f,e))})}),s.default.inst.CertainLoadAsset("json_config/CfgLevel").loadingPromise.then(function(e){e.json.forEach(function(e){t.cfgLevel.add(m.default.Pop(f,e))})}),s.default.inst.CertainLoadAsset("json_config/CfgVoiceOgg").loadingPromise.then(function(e){e.json.forEach(function(e){t.cfgVoiceOgg.add(h.default.Pop(f,e))})})]},t._t=new r.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:f}),t.inst=t.Pop(f),t}();i.default=d,cc._RF.pop()},{"../basic/BCCollection":"BCCollection","../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType","../res/MgrRes":"MgrRes","./src/CfgBuffProps":"CfgBuffProps","./src/CfgCommon":"CfgCommon","./src/CfgEff":"CfgEff","./src/CfgEquipmentLevel":"CfgEquipmentLevel","./src/CfgEquipmentProps":"CfgEquipmentProps","./src/CfgGameElement":"CfgGameElement","./src/CfgLevel":"CfgLevel","./src/CfgVoiceOgg":"CfgVoiceOgg"}],MgrDataItem:[function(t,e,i){"use strict";cc._RF.push(e,"062b8UJpgdL4JUUel5zjzgf","MgrDataItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/UtilObjPool"),n=t("../basic/UtilObjPoolType"),r=t("./MgrData"),s=function(){function t(){}return t.Pop=function(e,i,n,s){var a=o.default.Pop(t._t,e);return a.tag=i,a.valType=n,a.defVal=s,r.default.inst.AddModule(a),a},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"MgrDataItem"}),t}();i.default=s,cc._RF.pop()},{"../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType","./MgrData":"MgrData"}],MgrDataType:[function(t,e,i){"use strict";cc._RF.push(e,"d10c1aa6DZPIr5+3S38N8+y","MgrDataType"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/UtilObjPool"),n=t("../basic/UtilObjPoolType"),r="MgrDataType",s=function(){function t(){}return t.Pop=function(e,i,n){var r=o.default.Pop(t._t,e);return r.toString=i,r.toVal=n,r},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:r}),t}();(function(t){t.typeNumber=t.Pop(r,function(t){return""+t},function(t){return Number(t)}),t.typeString=t.Pop(r,function(t){return t},function(t){return t}),t.typeBool=t.Pop(r,function(t){return""+t},function(t){return"true"==t}),t.typeObject=t.Pop(r,function(t){return JSON.stringify(t)},function(t){return JSON.parse(t)})})(s||(s={})),i.default=s,cc._RF.pop()},{"../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType"}],MgrData:[function(t,e,i){"use strict";cc._RF.push(e,"66181lbGedGf6+DA37Rxg+y","MgrData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/BCPromiseCtrl"),n=t("../basic/UtilObjPool"),r=t("../basic/UtilObjPoolType"),s=t("../basic/UtilString"),a=t("../sdk/MgrSdk"),l="MgrData",c=function(){function t(){this._moduleSet=n.default.Pop(n.default.typeSet,l),this._dataCache=n.default.Pop(n.default.typeMap,l),this.promiseArr=n.default.Pop(n.default.typeArray,l),this.initPromise=o.default.Pop(l)}return t.Pop=function(e){return n.default.Pop(t._t,e)},t.prototype.AddModule=function(t){this._moduleSet.add(t)},t.prototype.Init=function(){var t=this;this._moduleSet.forEach(function(e){t.promiseArr.push(t.InitDataItem(e))}),Promise.all(this.promiseArr).then(function(){t.initPromise.resolve(null)})},t.prototype.InitDataItem=function(t){var e=this;return n.default.PopPromise(l,function(i){e._dataCache.has(t)?i():a.default.inst.core.Get(t.tag).then(function(o){s.default.CheckIsNullOrEmpty(o)?e._dataCache.set(t,t.defVal):e._dataCache.set(t,t.valType.toVal(o)),i()})}).then(function(){return Promise.resolve(e._dataCache.get(t))})},t.prototype.Get=function(t){return this._dataCache.get(t)},t.prototype.Set=function(t,e){this._dataCache.set(t,e)},t.prototype.Save=function(){this._dataCache.forEach(function(t,e){var i=e.valType.toString(t);a.default.inst.core.Set(e.tag,i)})},t._t=new r.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:l}),t.inst=t.Pop(l),t}();i.default=c,cc.game.on(cc.game.EVENT_HIDE,function(){c.inst.Save()}),cc._RF.pop()},{"../basic/BCPromiseCtrl":"BCPromiseCtrl","../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType","../basic/UtilString":"UtilString","../sdk/MgrSdk":"MgrSdk"}],MgrEvter:[function(t,e,i){"use strict";cc._RF.push(e,"2781cPFwo9PHI15qoG8XnkE","MgrEvter"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/BCEventer"),n=t("../basic/UtilObjPool"),r=t("../basic/UtilObjPoolType"),s="MgrEvter",a=function(){function t(){var t=this;this.evterKeyDown=o.default.Pop(s),this.evterKeyUp=o.default.Pop(s),this.evterHide=o.default.Pop(s),this.evterShow=o.default.Pop(s);var e=n.default.Pop(n.default.typeSet,s);cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(i){e.has(i.keyCode)||(e.add(i.keyCode),t.evterKeyDown.Call(i.keyCode))}),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(i){e.delete(i.keyCode),t.evterKeyUp.Call(i.keyCode)}),cc.game.on(cc.game.EVENT_HIDE,function(){t.evterHide.Call(null)}),cc.game.off(cc.game.EVENT_SHOW,function(){t.evterShow.Call(null)})}return t.Pop=function(e){return n.default.Pop(t._t,e)},t._t=new r.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:s}),t.inst=t.Pop(s),t}();i.default=a,cc._RF.pop()},{"../basic/BCEventer":"BCEventer","../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType"}],MgrRes:[function(t,e,i){"use strict";cc._RF.push(e,"d4a64Nu+j1D6IuFQlJWKOzb","MgrRes"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/BCPromiseCtrl"),n=t("../basic/UtilObjPool"),r=t("../basic/UtilObjPoolType"),s="MgrRes",a=n.default.Pop(n.default.typeArray,s);a.length=1;for(var l=0;l<a.length;l++)a[l]=Promise.resolve();var c=0,u=function(){function t(){this._assetsCtrlRec=n.default.Pop(n.default.typeMap,s),this._staticPrefabCache=n.default.Pop(n.default.typeMap,s),this._prefabGetterCache=n.default.Pop(n.default.typeMap,s),this._sprfMap=n.default.Pop(n.default.typeMap,s),this._jsonMap=n.default.Pop(n.default.typeMap,s),this._listBundle=n.default.Pop(n.default.typeArray,s),this._symCache=Symbol("SYM_CACHE"),this.instantiateCountMap=n.default.Pop(n.default.typeMap,s)}return t.Pop=function(e){return n.default.Pop(t._t,e)},t.prototype.CertainLoadBundle=function(t){var e=this._assetsCtrlRec.get(t);return null==e&&(e=this.DoLoadBundle(t),this._assetsCtrlRec.set(t,e)),e},t.prototype.CertainLoadAsset=function(t){var e=this._assetsCtrlRec.get(t);return null==e&&(e=this.DoLoadAsset(t),this._assetsCtrlRec.set(t,e)),e},t.prototype.GetTexture2D=function(t){return this.CertainLoadAsset(t).content},t.prototype.GetPrefab=function(t){return this._staticPrefabCache.has(t)?this._staticPrefabCache.get(t):this.CertainLoadAsset(t).content},t.prototype.DoGetPrefab=function(t){return this._staticPrefabCache.has(t)?this._staticPrefabCache.get(t):this.CertainLoadAsset(t).content},t.prototype.GetSpriteFrame=function(t){if(!this._sprfMap.has(t)){var e=this.CertainLoadAsset(t);if(null!=e.content){var i=n.default.Pop(n.default.typeCCSpriteFrame,s);i.setTexture(e.content),this._sprfMap.set(t,i)}}return this._sprfMap.get(t)},t.prototype.GetJson=function(t){if(!this._jsonMap.has(t)){var e=this.CertainLoadAsset(t);null!=e.content&&this._jsonMap.set(t,e.content.json)}return this._jsonMap.get(t)},t.prototype.DoLoadBundle=function(e){var i=this,n=o.default.Pop(s),r=++c%a.length;return a[r]=a[r].then(function(){return console.log("\u52a0\u8f7d ["+e+"].."),cc.assetManager.loadBundle(e,function(t){if(t)n.reject(t);else{var o=cc.assetManager.getBundle(e);i._listBundle.push(o),n.resolve(o)}}),n._promise}),t.AssetLoadCtrl.Pop(s,n._promise)},t.prototype.DoLoadAsset=function(e){var i=this,n=o.default.Pop(s),r=++c%a.length;return a[r]=a[r].then(function(){console.log("\u52a0\u8f7d ["+e+"]..");for(var t=function(t){var o=i._listBundle[t];return o.getInfoWithPath(e)?(o.load(e,function(t){t?n.reject(t):n.resolve(o.get(e))}),{value:n._promise}):"continue"},o=0;o<i._listBundle.length;o++){var r=t(o);if("object"==typeof r)return r.value}return cc.resources.load(e,function(t){t?n.reject(t):n.resolve(cc.resources.get(e))}),n._promise}),t.AssetLoadCtrl.Pop(s,n._promise)},t.prototype.GetInst=function(t){this.instantiateCountMap.has(t)||this.instantiateCountMap.set(t,{prefab:t,instCount:0,pool:n.default.Pop(n.default.typeArray,s)});var e,i=this.instantiateCountMap.get(t),o=i.pool;return 0<o.length?e=o.pop():(this.instantiateCountMap.get(t).instCount++,(e=cc.instantiate(t))[this._symCache]=i),e.active=!0,e},t.prototype.RecoverChildren=function(t){if(null!=t)for(;0<t.childrenCount;)this.Recover(t.children[0])},t.prototype.Recover=function(t){var e=t[this._symCache];null!=e?(t.setParent(null),t.active=!1,e.pool.push(t)):t.destroy()},t._t=new r.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:s}),t.inst=t.Pop(s),t}();(function(t){var e=function(){function t(){this.loadingPromise=null}return t.Pop=function(e,i){var o=n.default.Pop(t._t,e);return i.then(function(t){o.content=t}),o.loadingPromise=i,o},t._t=new r.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"AssetLoadCtrl"}),t}();t.AssetLoadCtrl=e})(u||(u={})),i.default=u,cc._RF.pop()},{"../basic/BCPromiseCtrl":"BCPromiseCtrl","../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType"}],MgrSdkCoreH5:[function(t,e,i){"use strict";cc._RF.push(e,"c6ed2PXaUNPM5OU/S6cJ00S","MgrSdkCoreH5");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=t("../basic/UtilObjPool"),s=t("../basic/UtilObjPoolType"),a=function(t){function e(){return t.call(this)||this}return n(e,t),e.Pop=function(t){return r.default.Pop(e._t,t)},e.prototype.Set=function(t,e){return localStorage.setItem(t,e),Promise.resolve()},e.prototype.Get=function(t){return Promise.resolve(localStorage.getItem(t))},e.prototype.Video=function(){return Promise.resolve({code:0,ctx:null})},e._t=new s.default({instantiate:function(){return new e},onPop:function(){},onPush:function(){},tag:"MgrSdkCoreH5"}),e}(t("./MgrSdkCore").default);i.default=a,cc._RF.pop()},{"../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType","./MgrSdkCore":"MgrSdkCore"}],MgrSdkCore:[function(t,e,i){"use strict";cc._RF.push(e,"8ad23ZS2NJM74P12PygiDNH","MgrSdkCore"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(){},cc._RF.pop()},{}],MgrSdk:[function(t,e,i){"use strict";cc._RF.push(e,"b627aXiknlMDqjBL06aep2o","MgrSdk"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/UtilObjPool"),n=t("../basic/UtilObjPoolType"),r=t("./MgrSdkCoreH5"),s="MgrSdk",a=function(){function t(){this.core=r.default.Pop(s)}return t.Pop=function(e){return o.default.Pop(t._t,e)},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:s}),t.inst=t.Pop(s),t}();i.default=a,cc._RF.pop()},{"../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType","./MgrSdkCoreH5":"MgrSdkCoreH5"}],MgrUI:[function(t,e,i){"use strict";cc._RF.push(e,"e7841dA5GZIIJ6oAWUEHWiC","MgrUI"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/BCEventer"),n=t("../basic/BCIdGeneration"),r=t("../basic/UtilObjPool"),s=t("./ViewState"),a=t("../basic/UtilObjPoolType"),l="MgrUI",c=function(){function t(){this.evterUpdate=o.default.Pop(l),this._idGenView=n.default.Pop(l),this._listViewInfo=r.default.Pop(r.default.typeArray,l),this._listViewDisplay=r.default.Pop(r.default.typeArray,l),this._setDisplay=r.default.Pop(r.default.typeSet,l),this._moduleToVersionMap=r.default.Pop(r.default.typeMap,l)}return t.Pop=function(e){return r.default.Pop(t._t,e)},t.prototype.Init=function(t,e){this._cameraUI=t,this._containerUI=e,this._sizePerPixel=10/Math.min(this._containerUI.width,this._containerUI.height)*5},t.prototype.Open=function(e,i){var o=r.default.Pop(t.poolType,l);return o.nodeType=e,o.tState=i,o.tProps=null,o.id=this._idGenView.GenId(),i.Init(o.id),this._listViewInfo.push(o),this.OnListViewChanged(),o.id},t.prototype.Close=function(t){var e=this._listViewInfo.findIndex(function(e){return e.id==t});e<0||(this._listViewInfo[e].tState._evterDestory.Call(null),this._listViewInfo.splice(e,1),this.OnListViewChanged())},t.prototype.OnListViewChanged=function(){this._listViewInfo.sort(function(t,e){return t.tState._layer!=e.tState._layer?t.tState._layer-e.tState._layer:t.id-e.id});for(var t=!1,e=this._listViewInfo.length-1;0<=e;e--){var i=this._listViewInfo[e];t?(this._listViewInfo.splice(e,1),i.tState._evterDestory.Call(null)):i.tState._bgStatus==s.default.BG_TYPE.SELF&&(i.tState._isCloseAble||(t=!0))}var o=!1;for(this._listViewDisplay.length=0,e=this._listViewInfo.length-1;0<=e;e--){if((i=this._listViewInfo[e]).tState._bgStatus==s.default.BG_TYPE.MASK){if(o)continue;o=!0}if(this._listViewDisplay.unshift(i),i.tState._bgStatus==s.default.BG_TYPE.SELF)break}for(this._maskIdx=null,e=this._listViewDisplay.length-1;0<=e&&(i=this._listViewDisplay[e]).tState._bgStatus!=s.default.BG_TYPE.SELF;e--)if(i.tState._bgStatus==s.default.BG_TYPE.MASK){this._maskIdx=e;break}for(e=0;e<this._listViewDisplay.length;e++)i=this._listViewDisplay[e],this._setDisplay.has(i.id)||i.tState.OnDisplay();for(this._setDisplay.clear(),e=0;e<this._listViewDisplay.length;e++)i=this._listViewDisplay[e],this._setDisplay.add(i.id)},t.prototype.ModuleGetVersion=function(t){return this.Promise(t),this._moduleToVersionMap.get(t)},t.prototype.ModuleRefresh=function(t){this.Promise(t),this._moduleToVersionMap.set(t,this._moduleToVersionMap.get(t)+1)},t.prototype.Promise=function(t){this._moduleToVersionMap.has(t)||this._moduleToVersionMap.set(t,0)},t._t=new a.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:l}),t}();(function(t){t.inst=t.Pop(l);var e=function(){};t.ViewInfo=e,t.poolType=new a.default({instantiate:function(){return new e},onPop:function(){},onPush:function(t){t.nodeType=null,t.tState=null,t.tProps=null,t.id=null},tag:"ViewInfo"})})(c||(c={})),i.default=c,cc._RF.pop()},{"../basic/BCEventer":"BCEventer","../basic/BCIdGeneration":"BCIdGeneration","../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType","./ViewState":"ViewState"}],PlayAnimationOnEnable:[function(t,e,i){"use strict";cc._RF.push(e,"21190CtPf1A/4eJxOmeR/iV","PlayAnimationOnEnable");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this._anim=this.getComponent(cc.Animation)},e.prototype.onDisable=function(){this._anim.stop()},e.prototype.Reset=function(){null!=this._anim&&this._anim.play()},e.prototype.onEnable=function(){this.Reset()},r([a],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],PlayAudioOnEnable:[function(t,e,i){"use strict";cc._RF.push(e,"1e188PtsBhGJrHrghXlMKGM","PlayAudioOnEnable");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this._audio=this.getComponent(cc.AudioSource)},e.prototype.onDisable=function(){this._audio.stop()},e.prototype.Reset=function(){null!=this._audio&&this._audio.play()},e.prototype.onEnable=function(){this.Reset()},r([a],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],UIMask:[function(t,e,i){"use strict";cc._RF.push(e,"9d7c7CoA0VE874vgDHVAkHq","UIMask");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../IndexModule"),a=t("../basic/BCType"),l=t("../component/ComponentNodeEventer"),c=t("../global/Jiang"),u=t("./UINodeType"),_=t("./UIViewComponent"),p=cc._decorator,m=p.ccclass,h=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnMask=null,e}var i;return n(e,t),i=e,e.nodeType=u.default.Pop("UIMask",{prefabPath:"UIMask",componentGetter:function(t){return t.getComponent(i)},listModuleStyle:[u.default.ModuleStyle.Pop("UIMask",{listRefModule:[s.default.DEFAULT],propsFilter:function(t){t.btnMask.evterTouchEnd.On(function(){c.default.mgrUI._listViewDisplay[c.default.mgrUI._maskIdx].tState.OnMaskTouch()})}})],childrenCreator:[],propsType:a.default.typeNumber}),r([h(l.default)],e.prototype,"btnMask",void 0),i=r([m],e)}(_.default);i.default=f,cc._RF.pop()},{"../../IndexModule":"IndexModule","../basic/BCType":"BCType","../component/ComponentNodeEventer":"ComponentNodeEventer","../global/Jiang":"Jiang","./UINodeType":"UINodeType","./UIViewComponent":"UIViewComponent"}],UINodeType:[function(t,e,i){"use strict";cc._RF.push(e,"ab723XXtzVFPYuvB/o94723","UINodeType"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/UtilObjPool"),n=t("./MgrUI"),r=t("./UINode"),s=t("../basic/UtilObjPoolType"),a="UINodeType",l=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n._prefabPath=i.prefabPath,n._componentGetter=i.componentGetter,n._listModuleStyle=i.listModuleStyle,n._childrenCreator=i.childrenCreator,n._propsType=i.propsType,t.totalPrefabPathList.push(n._prefabPath),n},t.prototype.CreateNode=function(t,e,i){var s=o.default.Pop(r.default._t,a);s.nodeType=this;for(var l=0;l<this._listModuleStyle.length;l++){for(var c=this._listModuleStyle[l],u=0,_=0;_<c._listRefModule.length;_++)u+=n.default.inst.ModuleGetVersion(c._listRefModule[_]);s.listStyleVersion.push(u)}for(s.state=t,s.props=e,l=0;l<this._childrenCreator.length;l++){var p=this._childrenCreator[l],m=o.default.Pop(o.default.typeArray,a);p._uiNodeCreator(t,e,m),s.listChildrenNode.push(m)}return s.id=i,s},t._t=new s.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:a}),t.totalPrefabPathList=o.default.Pop(o.default.typeArray,a),t}();(function(t){var e=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n._listRefModule=i.listRefModule,n._propsFilter=i.propsFilter,n},t._t=new s.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"ModuleStyle"}),t}();t.ModuleStyle=e;var i=function(){function t(){}return t.Pop=function(e,i){var n=o.default.Pop(t._t,e);return n._containerGetter=i.containerGetter,n._uiNodeCreator=i.uiNodeCreator,n},t._t=new s.default({instantiate:function(){return new t},onPop:function(){},onPush:function(){},tag:"ChildrenGeneration"}),t}();t.ChildrenGeneration=i})(l||(l={})),i.default=l,cc._RF.pop()},{"../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType","./MgrUI":"MgrUI","./UINode":"UINode"}],UINode:[function(t,e,i){"use strict";cc._RF.push(e,"fc3b5342eJHoIC1SAWZ9PJU","UINode"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/UtilObjPool"),n=t("../basic/UtilObjPoolType"),r="UINode",s=0,a=function(){function t(){this._id=++s}return t.Pop=function(e){return o.default.Pop(t._t,e)},t.prototype.MapPropsTo=function(t){var e;null!=t.props&&t.nodeType._propsType._release(t.props),t.nodeType=this.nodeType,t.listStyleVersion.length=0,(e=t.listStyleVersion).push.apply(e,this.listStyleVersion),t.state=this.state,t.props=t.nodeType._propsType._clone(this.props),t.id=this.id},t.prototype.CopyShallow=function(){var e=o.default.Pop(t._t,r);this.MapPropsTo(e);for(var i=0;i<this.listChildrenNode.length;i++)e.listChildrenNode.push(o.default.Pop(o.default.typeArray,r));return e},t._t=new n.default({instantiate:function(){return new t},onPop:function(t){t.listStyleVersion=o.default.Pop(o.default.typeArray,r),t.listChildrenNode=o.default.Pop(o.default.typeArray,r)},onPush:function(t){t.nodeType._propsType._release(t.props),t.nodeType=null,o.default.Push(t.listStyleVersion),t.listStyleVersion=null,t.state=null,t.props=null;for(var e=0;e<t.listChildrenNode.length;e++){for(var i=t.listChildrenNode[e],n=0;n<i.length;n++){var r=i[n];o.default.Push(r)}o.default.Push(i)}o.default.Push(t.listChildrenNode),t.listChildrenNode=null,t.id=null,t.match=null,t.com=null},tag:r}),t}();i.default=a,cc._RF.pop()},{"../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType"}],UIRootTreeJson:[function(t,e,i){"use strict";cc._RF.push(e,"0f5f08WmRNBE7o/YG8PH12X","UIRootTreeJson"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/UtilObjPool"),n=t("../basic/UtilObjPoolType"),r=function(){function t(){}return t.Pop=function(e,i,n){var r=o.default.Pop(t._t,e);return r.res=i,r.children=n,r},t._t=new n.default({instantiate:function(){return new t},onPop:function(){},onPush:function(t){for(var e=0;e<t.children.length;e++){var i=t.children[e];o.default.Push(i)}o.default.Push(t.children),t.res=null,t.children=null},tag:"UIRootTreeJson"}),t}();i.default=r,cc._RF.pop()},{"../basic/UtilObjPool":"UtilObjPool","../basic/UtilObjPoolType":"UtilObjPoolType"}],UIRoot:[function(t,e,i){"use strict";cc._RF.push(e,"b4293ioFhdA+YxAORI3XV2p","UIRoot");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},s=this&&this.__generator||function(t,e){var i,o,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return l([t,e])}}function l(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(n=2&r[0]?o.return:r[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,r[1])).done)return n;switch(o=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(a){r=[6,a],o=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(i,"__esModule",{value:!0});var l=t("../basic/UtilObjPool"),c=t("./UIViewComponent"),u=t("./MgrUI"),_=t("../res/MgrRes"),p=t("../global/Jiang"),m=t("./UIMask"),h=t("../basic/UtilNode"),f=t("./UIRootTreeJson"),d="UIRoot",b=cc._decorator,y=b.ccclass,v=(b.property,function(t){function e(){var e=t.call(this)||this;return e._moduleToVersion=l.default.Pop(l.default.typeMap,d),e._listChangedModule=l.default.Pop(l.default.typeArray,d),e._frameId=0,e.viewListCurrent=l.default.Pop(l.default.typeArray,d),e.viewListWill=l.default.Pop(l.default.typeArray,d),e.count=0,e._map=l.default.Pop(l.default.typeMap,d),i.inst=e,e}var i;return n(e,t),i=e,e.prototype.update=function(t){var e=this,o=Date.now();this._frameId=++i._frameIdGen,u.default.inst.evterUpdate.Call(1e3*t);var n=this._currViewRefreshedId!=u.default.inst._idGenView._genId;this._currViewRefreshedId=u.default.inst._idGenView._genId;var r=this._currViewRefreshedCount!=u.default.inst._listViewDisplay.length;this._currViewRefreshedCount=u.default.inst._listViewDisplay.length,this._listChangedModule.length=0,u.default.inst._moduleToVersionMap.forEach(function(t,i){e._moduleToVersion.get(i)!=t&&(e._moduleToVersion.set(i,t),e._listChangedModule.push(i))});for(var s=0<this._listChangedModule.length,a=0;a<u.default.inst._listViewInfo.length;a++)for(var l=0;l<this._listChangedModule.length;l++)u.default.inst._listViewInfo[a].tState.OnChange(this._listChangedModule[l]);if(n||r||s){if(!n&&!r&&!s)return;this.Refresh()}for(;!(this.renderIteratorResult.done||(this.renderIteratorResult=this.renderIterator.next(),1e3/30<=Date.now()-o)););},e.prototype.Refresh=function(){for(var t=0;t<this.viewListWill.length;t++)l.default.Push(this.viewListWill[t]);for(this.viewListWill.length=0,t=0;t<u.default.inst._listViewDisplay.length;t++){var e=u.default.inst._listViewDisplay[t];this.viewListWill.push(e.nodeType.CreateNode(e.tState,e.tProps,e.id))}null!=p.default.mgrUI._maskIdx&&this.viewListWill.splice(p.default.mgrUI._maskIdx,0,m.default.nodeType.CreateNode(0,0,0)),this.renderIterator=this.DisputeList(this.node,this.viewListCurrent,this.viewListWill),this.renderIteratorResult=this.renderIterator.next()},e.GetTreeTxt=function(t){for(var e=l.default.Pop(l.default.typeArray,d),o=0;o<t.length;o++)e.push(i.CreateTreeNode(t[o]));var n=JSON.stringify(e,null,4);for(o=0;o<e.length;o++)this.DestoryTreeNode(e[o]);return l.default.Push(e),n},e.CreateTreeNode=function(t){for(var e=l.default.Pop(l.default.typeArray,d),o=0;o<t.listChildrenNode.length;o++){for(var n=t.listChildrenNode[o],r=l.default.Pop(l.default.typeArray,d),s=0;s<n.length;s++){var a=n[s];r.push(i.CreateTreeNode(a))}e.push(r)}return f.default.Pop(d,"["+t._id+"]"+t.nodeType._prefabPath,e)},e.DestoryTreeNode=function(t){for(var e=0;e<t.children.length;e++)for(var i=t.children[e],o=0;o<i.length;o++){var n=i[o];this.DestoryTreeNode(n)}l.default.Push(t)},e.prototype.DisputeList=function(t,e,i){var o,n,r,c,u,_,p,m,h;return s(this,function(s){switch(s.label){case 0:for(_=0;_<e.length;)null==e[_]?e.splice(_,1):_++;for(_=0;_<i.length;)null==i[_]?i.splice(_,1):_++;for(o=l.default.Pop(l.default.typeMap,d),_=0;_<e.length;_++)(h=e[_]).match=null,null!=h.id&&(o.has(h.id)?console.error("id \u51b2\u7a81["+t.name+"]"):o.set(h.id,h));for(_=0;_<i.length;_++)(p=i[_]).match=null,null!=p.id&&o.has(p.id)&&null==(h=o.get(p.id)).match&&h.nodeType._prefabPath==p.nodeType._prefabPath&&(p.match=h,h.match=p);for(l.default.Push(o),_=0;_<i.length;_++)if(null==(p=i[_]).match)for(n=0;n<e.length;n++)if(null==(h=e[n]).match&&h.nodeType._prefabPath==p.nodeType._prefabPath){if(null!=p.id){for(r=0;r<h.com._animOnEnable.length;r++)h.com._animOnEnable[r].Reset();for(c=0;c<h.com._audioOnEnable.length;c++)h.com._audioOnEnable[c].Reset()}p.match=h,h.match=p;break}for(u=0;u<e.length;)null==(h=e[u]).match?this.Delete(t,e,u):u++;_=0,s.label=1;case 1:if(!(_<i.length))return[3,8];if(null==(p=i[_]).match)return[3,3];if(p.match!=e[_]){for(m=_;m<e.length&&(h=e[m])!=p.match;m++);this.Move(t,e,m,_)}return[5,a(this.Modify(t.children[_],e[_],i[_]))];case 2:return s.sent(),[3,6];case 3:return[5,a(this.Insert(t,e,p,_))];case 4:return s.sent(),this.count++,[4];case 5:s.sent(),s.label=6;case 6:s.label=7;case 7:return _++,[3,1];case 8:return[2]}})},e.prototype.Insert=function(t,e,i,o){var n,r,l,c,u,_,p;return s(this,function(s){switch(s.label){case 0:for(n=i.CopyShallow(),e.splice(o,0,n),(r=this.Pop(n.nodeType,t)).setSiblingIndex(o),r.scale=1,l=n.nodeType._componentGetter(r),n.com=l,c=0;c<n.nodeType._listModuleStyle.length;c++)0==c&&l.OffAll(),n.nodeType._listModuleStyle[c]._propsFilter(l,n.state,n.props);for(c=0;c<n.nodeType._childrenCreator.length;c++)for(u=n.nodeType._childrenCreator[c],_=u._containerGetter(l);0<_.children.length;)p=_.children[_.children.length-1],console.error(h.default.GetPath(p)+" \u53ef\u63d0\u524d\u5220\u9664"),p.setParent(null),p.destroy();return[5,a(this.DisputeChildren(r,n,i))];case 1:return s.sent(),[2]}})},e.prototype.Delete=function(t,e,i){for(var o=t.children[i],n=e[i],r=n.nodeType._componentGetter(o),s=0;s<n.nodeType._childrenCreator.length;s++)for(var a=n.nodeType._childrenCreator[s]._containerGetter(r),c=n.listChildrenNode[s],u=c.length-1;0<=u;u--)this.Delete(a,c,u);o.setParent(null),this.Push(n.nodeType,o),e.splice(i,1),l.default.Push(n)},e.prototype.Modify=function(t,e,i){var o,n,r,l;return s(this,function(s){switch(s.label){case 0:for(o=i.nodeType._componentGetter(t),n=i.nodeType!=e.nodeType||i.state!=e.state||!i.nodeType._propsType._equal(i.props,e.props),r=0;r<i.nodeType._listModuleStyle.length;r++)l=i.nodeType._listModuleStyle[r],(n||i.listStyleVersion[r]!=e.listStyleVersion[r])&&(0==r&&o.OffAll(),l._propsFilter(o,i.state,i.props));return i.MapPropsTo(e),[5,a(this.DisputeChildren(t,e,i))];case 1:return s.sent(),[2]}})},e.prototype.Move=function(t,e,i,o){t.children[i].setSiblingIndex(o);var n=e[i];e.splice(i,1),e.splice(o,0,n)},e.prototype.DisputeChildren=function(t,e,i){var o,n,r,c,u,_,p,m,h;return s(this,function(s){switch(s.label){case 0:o=e.listChildrenNode,n=i.listChildrenNode,r=i.nodeType._componentGetter(t),c=i.nodeType._childrenCreator,u=0,s.label=1;case 1:if(!(u<c.length))return[3,4];for(_=c[u],p=_._containerGetter(r);o.length<=u;)o.push(l.default.Pop(l.default.typeArray,d));for(m=o[u];n.length<=u;)n.push(l.default.Pop(l.default.typeArray,d));return h=n[u],[5,a(this.DisputeList(p,m,h))];case 2:s.sent(),s.label=3;case 3:return u++,[3,1];case 4:return[2]}})},e.prototype.Pop=function(t,e){this.Promise(t._prefabPath);var i,o=this._map.get(t._prefabPath);if(0==o.length){var n=_.default.inst.GetPrefab(t._prefabPath);null==n&&console.error("\u8def\u5f84["+t._prefabPath+"]\u5bf9\u5e94\u7684\u9884\u5236\u4f53\u4e3a\u7a7a"),i=cc.instantiate(n);var r=t._componentGetter(i);null==r&&console.error("["+i.name+"]\u4e0a\u6302\u8f7d\u7684\u7ec4\u4ef6\u4e0d\u5339\u914d"),r.Record()}else i=o.pop();return i.setParent(e),i},e.prototype.Push=function(t,e){this.Promise(t._prefabPath),this._map.get(t._prefabPath).push(e)},e.prototype.Promise=function(t){this._map.has(t)||this._map.set(t,l.default.Pop(l.default.typeArray,d))},e._frameIdGen=0,i=r([y],e)}(c.default));i.default=v,cc._RF.pop()},{"../basic/UtilNode":"UtilNode","../basic/UtilObjPool":"UtilObjPool","../global/Jiang":"Jiang","../res/MgrRes":"MgrRes","./MgrUI":"MgrUI","./UIMask":"UIMask","./UIRootTreeJson":"UIRootTreeJson","./UIViewComponent":"UIViewComponent"}],UIViewComponent:[function(t,e,i){"use strict";cc._RF.push(e,"e75deGz/o1Az4h7SqKu1jOr","UIViewComponent");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../basic/UtilNode"),a=t("../basic/UtilObjPool"),l=t("../component/ComponentNodeEventer"),c=t("../component/PlayAnimationOnEnable"),u=t("../component/PlayAudioOnEnable"),_=cc._decorator,p=_.ccclass,m=(_.property,"UIViewComponent"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._nodeEvterList=a.default.Pop(a.default.typeArray,m),e._animOnEnable=a.default.Pop(a.default.typeArray,m),e._audioOnEnable=a.default.Pop(a.default.typeArray,m),e._listColor=a.default.Pop(a.default.typeMap,m),e}return n(e,t),e.prototype.Record=function(){var t=this;this._nodeEvterList=this.node.getComponentsInChildren(l.default),this._animOnEnable=this.node.getComponentsInChildren(c.default),this._audioOnEnable=this.node.getComponentsInChildren(u.default),s.default.WalkAllNode(this.node,function(e){var i=a.default.Pop(a.default.typeArray,m);i.push(e.color.r,e.color.g,e.color.b),t._listColor.set(e,i)})},e.prototype.SetGroup=function(t){this._listColor.forEach(function(e,i){i.isValid&&(i.groupIndex=t)})},e.prototype.BeGray=function(t){void 0===t&&(t=1),this._listColor.forEach(function(e,i){if(i.isValid){var o=e[0]+e[1]+e[2];o/=3,o*=t;var n=a.default.PopCCColor(m,o,o,o,e[3]);a.default.Push(i.color),i.color=n}})},e.prototype.BeColorFul=function(){this._listColor.forEach(function(t,e){if(e.isValid){var i=a.default.PopCCColor(m,t[0],t[1],t[2],t[3]);a.default.Push(e.color),e.color=i}})},e.prototype.OffAll=function(){this._nodeEvterList.forEach(function(t){t.isValid&&t.OffAll()})},r([p],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../basic/UtilNode":"UtilNode","../basic/UtilObjPool":"UtilObjPool","../component/ComponentNodeEventer":"ComponentNodeEventer","../component/PlayAnimationOnEnable":"PlayAnimationOnEnable","../component/PlayAudioOnEnable":"PlayAudioOnEnable"}],UtilCollection:[function(t,e,i){"use strict";var o;cc._RF.push(e,"55caaCnz8ZP0YdaveWOXhne","UtilCollection"),Object.defineProperty(i,"__esModule",{value:!0}),function(t){t.Random=function(t){return t[Math.floor(Math.random()*t.length)]},t.AllMatch=function(t,e){if(null==t&&null==e)return!0;if(null==t&&null!=e)return!1;if(null!=t&&null==e)return!1;if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!=e[i])return!1;return!0},t.CloneSet=function(t,e){return t.forEach(function(t){e.add(t)}),e},t.GetMapCollection=function(t,e){return t.forEach(function(t){e.push(t)}),e},t.GetSetCollection=function(t,e){return t.forEach(function(t){e.push(t)}),e},t.GetCollSet=function(t,e){return t.forEach(function(t){e.add(t)}),e}}(o||(o={})),i.default=o,cc._RF.pop()},{}],UtilMath:[function(t,e,i){"use strict";var o;cc._RF.push(e,"e24fedBqyNFs6jtqj3+dXfx","UtilMath"),Object.defineProperty(i,"__esModule",{value:!0}),function(t){t.Mod=function(t,e){return t%=e,(t+=e)%e},t.Step=function(t,e){return t<e?1:0},t.Lerp=function(t,e,i){return(1-i)*t+i*e}}(o||(o={})),i.default=o,cc._RF.pop()},{}],UtilNode:[function(t,e,i){"use strict";cc._RF.push(e,"199f6oYG2VKAbeBSTDiqMZA","UtilNode"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("./UtilObjPool");(function(t){t.GetPath=function(t){for(var e=n.default.Pop(n.default.typeArray,"utilNode");null!=t;)e.push(t.name),t=t.parent;return e.reverse(),e.join("/")},t.WalkAllNode=function t(e,i){i(e);for(var o=0;o<e.children.length;o++)t(e.children[o],i)}})(o||(o={})),i.default=o,cc._RF.pop()},{"./UtilObjPool":"UtilObjPool"}],UtilObjPoolType:[function(t,e,i){"use strict";cc._RF.push(e,"59f23rfsP9PJbLchHma9dCB","UtilObjPoolType"),Object.defineProperty(i,"__esModule",{value:!0});var o=function t(e){this._coll=new Array,this.instantiatedCount=0,this.instantiate=e.instantiate,this.onPop=e.onPop,this.onPush=e.onPush,this.tag=e.tag,t.mapTagToPoolType.has(e.tag)&&console.error("tag \u51b2\u7a81 ["+e.tag+"]"),t.mapTagToPoolType.set(e.tag,this)};(function(t){t.mapTagToPoolType=new Map})(o||(o={})),i.default=o,cc._RF.pop()},{}],UtilObjPool:[function(t,e,i){"use strict";cc._RF.push(e,"2cae0ikdShPzLFTYBIgzzyz","UtilObjPool"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("../../../box2d_ts/Box2D"),r=t("./UtilObjPoolType"),s=Symbol("UtilObjPool.Pop.Type"),a=Symbol("UtilObjPool.Pop.App");(function(t){function e(e,i){return null==e||null==i?null:(t.mapAppRefCount.has(i)||t.mapAppRefCount.set(i,new Map),t.mapAppRefCount.get(i).has(e)||t.mapAppRefCount.get(i).set(e,0),t.mapAppRefCount.get(i).set(e,t.mapAppRefCount.get(i).get(e)+1),0==e._coll.length?(o=e.instantiate(),e.instantiatedCount++,o[s]=e):o=e._coll.pop(),o[a]=i,e.onPop(o),o);var o}t.mapAppRefCount=new Map,t.Pop=e,t.Push=function(e){if(null!=e){var i=e[s];if(null!=i){var o=e[a];null!=o&&(e[a]=null,t.mapAppRefCount.has(o)||t.mapAppRefCount.set(o,new Map),t.mapAppRefCount.get(o).has(i)||t.mapAppRefCount.get(o).set(i,0),t.mapAppRefCount.get(o).set(i,t.mapAppRefCount.get(o).get(i)-1),i._coll.push(e),i.onPush(e))}}},t.typeccVec2=new r.default({instantiate:function(){return new cc.Vec2},onPop:function(){},onPush:function(t){t.x=0,t.y=0},tag:"cc.Vec2"}),t.typeB2Vec2=new r.default({instantiate:function(){return new n.b2Vec2},onPop:function(){},onPush:function(t){t.x=0,t.y=0},tag:"b2Vec2"}),t.typeB2Vec3=new r.default({instantiate:function(){return new n.b2Vec3},onPop:function(){},onPush:function(){},tag:"b2Vec3"}),t.typeB2Mat33=new r.default({instantiate:function(){return new n.b2Mat33},onPop:function(){},onPush:function(){},tag:"b2Mat33"}),t.typeArray=new r.default({instantiate:function(){return new Array},onPop:function(){},onPush:function(t){t.length=0},tag:"Array"}),t.typeMap=new r.default({instantiate:function(){return new Map},onPop:function(){},onPush:function(t){t.clear()},tag:"Map"}),t.typeSet=new r.default({instantiate:function(){return new Set},onPop:function(){},onPush:function(t){t.clear()},tag:"Set"}),t.typeB2WorldManifold=new r.default({instantiate:function(){return new n.b2WorldManifold},onPop:function(){},onPush:function(){},tag:"b2WorldManifold"}),t.typeBodyDef=new r.default({instantiate:function(){return new n.b2BodyDef},onPop:function(){},onPush:function(t){t.type=n.b2BodyType.b2_staticBody,t.position.x=0,t.position.y=0},tag:"b2BodyDef"}),t.typeFixtureDef=new r.default({instantiate:function(){return new n.b2FixtureDef},onPop:function(){},onPush:function(t){t.shape=null},tag:"b2FixtureDef"}),t.typeCircleShape=new r.default({instantiate:function(){return new n.b2CircleShape},onPop:function(){},onPush:function(){},tag:"b2CircleShape"}),t.typePolygonShape=new r.default({instantiate:function(){return new n.b2PolygonShape},onPop:function(){},onPush:function(){},tag:"b2PolygonShape"}),t.typeB2MouseJointDef=new r.default({instantiate:function(){return new n.b2MouseJointDef},onPop:function(){},onPush:function(){},tag:"b2MouseJointDef"}),t.typeB2EdgeShape=new r.default({instantiate:function(){return new n.b2EdgeShape},onPop:function(){},onPush:function(){},tag:"b2EdgeShape"}),t.typeCCSpriteFrame=new r.default({instantiate:function(){return new cc.SpriteFrame},onPop:function(){},onPush:function(){},tag:"cc.SpriteFrame"});var i=new r.default({instantiate:function(){return new cc.Color},onPop:function(){},onPush:function(){},tag:"cc.Color"});t.PopCCColor=function(t,o,n,r,s){var a=e(i,t);return a.r=o,a.g=n,a.b=r,a.a=s,a},t.PopPromise=function(t,e){return new Promise(e)},t.PopB2World=function(t,e){return new n.b2World({x:t,y:e})}})(o||(o={})),i.default=o,cc._RF.pop()},{"../../../box2d_ts/Box2D":"Box2D","./UtilObjPoolType":"UtilObjPoolType"}],UtilString:[function(t,e,i){"use strict";cc._RF.push(e,"fb0433xQtlLd6wkvBt5l8lC","UtilString"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=t("./UtilObjPool");(function(t){t.CheckIsNullOrEmpty=function(t){return null==t||""==t||"null"==t},t.ParseStrToCCColor=function(t){var e=t.split(",");return n.default.PopCCColor("utilString",Number.parseFloat(e[0]),Number.parseFloat(e[1]),Number.parseFloat(e[2]),255)}})(o||(o={})),i.default=o,cc._RF.pop()},{"./UtilObjPool":"UtilObjPool"}],ViewState:[function(t,e,i){"use strict";cc._RF.push(e,"14d98zJJ7lDupRRN6jAjE8n","ViewState"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../basic/BCEventer"),n="ViewState",r=function(){function t(t,e,i){var r=this;this._evterInit=o.default.Pop(n),this._evterDestory=o.default.Pop(n),this._layer=t,this._bgStatus=e,this._isCloseAble=i,this._evterInit.On(function(){r.OnInit()}),this._evterDestory.On(function(){r.OnDestory()})}return t.prototype.Init=function(t){this._idView=t,this._evterInit.Call(null)},t.prototype.OnInit=function(){},t.prototype.OnChange=function(){},t.prototype.OnMaskTouch=function(){},t.prototype.OnDestory=function(){},t.prototype.OnDisplay=function(){},t}();(function(t){(function(t){t[t.NONE=0]="NONE",t[t.SELF=1]="SELF",t[t.MASK=2]="MASK"})(t.BG_TYPE||(t.BG_TYPE={}))})(r||(r={})),i.default=r,cc._RF.pop()},{"../basic/BCEventer":"BCEventer"}],b2AreaJoint:[function(t,e,i){"use strict";cc._RF.push(e,"94848TzCctGcpocAsaEpbIo","b2AreaJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2AreaJoint=i.b2AreaJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=t("./b2DistanceJoint"),c=function(t){function e(){var e=t.call(this,a.b2JointType.e_areaJoint)||this;return e.bodies=[],e.frequencyHz=0,e.dampingRatio=0,e}return n(e,t),e.prototype.AddBody=function(t){this.bodies.push(t),1===this.bodies.length?this.bodyA=t:2===this.bodies.length&&(this.bodyB=t)},e}(a.b2JointDef);i.b2AreaJointDef=c;var u=function(t){function e(e){var i=t.call(this,e)||this;i.m_frequencyHz=0,i.m_dampingRatio=0,i.m_impulse=0,i.m_targetArea=0,i.m_delta=new s.b2Vec2,i.m_bodies=e.bodies,i.m_frequencyHz=r.b2Maybe(e.frequencyHz,0),i.m_dampingRatio=r.b2Maybe(e.dampingRatio,0),i.m_targetLengths=r.b2MakeNumberArray(e.bodies.length),i.m_normals=s.b2Vec2.MakeArray(e.bodies.length),i.m_joints=[],i.m_deltas=s.b2Vec2.MakeArray(e.bodies.length);var o=new l.b2DistanceJointDef;o.frequencyHz=i.m_frequencyHz,o.dampingRatio=i.m_dampingRatio,i.m_targetArea=0;for(var n=0;n<i.m_bodies.length;++n){var a=i.m_bodies[n],c=i.m_bodies[(n+1)%i.m_bodies.length],u=a.GetWorldCenter(),_=c.GetWorldCenter();i.m_targetLengths[n]=s.b2Vec2.DistanceVV(u,_),i.m_targetArea+=s.b2Vec2.CrossVV(u,_),o.Initialize(a,c,u,_),i.m_joints[n]=a.GetWorld().CreateJoint(o)}return i.m_targetArea*=.5,i}return n(e,t),e.prototype.GetAnchorA=function(t){return t},e.prototype.GetAnchorB=function(t){return t},e.prototype.GetReactionForce=function(t,e){return e},e.prototype.GetReactionTorque=function(){return 0},e.prototype.SetFrequency=function(t){this.m_frequencyHz=t;for(var e=0;e<this.m_joints.length;++e)this.m_joints[e].SetFrequency(t)},e.prototype.GetFrequency=function(){return this.m_frequencyHz},e.prototype.SetDampingRatio=function(t){this.m_dampingRatio=t;for(var e=0;e<this.m_joints.length;++e)this.m_joints[e].SetDampingRatio(t)},e.prototype.GetDampingRatio=function(){return this.m_dampingRatio},e.prototype.Dump=function(t){t("Area joint dumping is not supported.\n")},e.prototype.InitVelocityConstraints=function(t){for(var e=0;e<this.m_bodies.length;++e){var i=this.m_bodies[(e+this.m_bodies.length-1)%this.m_bodies.length],o=this.m_bodies[(e+1)%this.m_bodies.length],n=t.positions[i.m_islandIndex].c,r=t.positions[o.m_islandIndex].c,a=this.m_deltas[e];s.b2Vec2.SubVV(r,n,a)}if(t.step.warmStarting)for(this.m_impulse*=t.step.dtRatio,e=0;e<this.m_bodies.length;++e){var l=this.m_bodies[e],c=t.velocities[l.m_islandIndex].v;a=this.m_deltas[e],c.x+=l.m_invMass*a.y*.5*this.m_impulse,c.y+=l.m_invMass*-a.x*.5*this.m_impulse}else this.m_impulse=0},e.prototype.SolveVelocityConstraints=function(t){for(var e=0,i=0,o=0;o<this.m_bodies.length;++o){var n=this.m_bodies[o],r=t.velocities[n.m_islandIndex].v;e+=(l=this.m_deltas[o]).LengthSquared()/n.GetMass(),i+=s.b2Vec2.CrossVV(r,l)}var a=-2*i/e;for(this.m_impulse+=a,o=0;o<this.m_bodies.length;++o){n=this.m_bodies[o],r=t.velocities[n.m_islandIndex].v;var l=this.m_deltas[o];r.x+=n.m_invMass*l.y*.5*a,r.y+=n.m_invMass*-l.x*.5*a}},e.prototype.SolvePositionConstraints=function(t){for(var e=0,i=0,o=0;o<this.m_bodies.length;++o){var n=this.m_bodies[o],a=this.m_bodies[(o+1)%this.m_bodies.length],l=t.positions[n.m_islandIndex].c,c=t.positions[a.m_islandIndex].c,u=(m=s.b2Vec2.SubVV(c,l,this.m_delta)).Length();u<r.b2_epsilon&&(u=1),this.m_normals[o].x=m.y/u,this.m_normals[o].y=-m.x/u,e+=u,i+=s.b2Vec2.CrossVV(l,c)}i*=.5;var _=.5*(this.m_targetArea-i)/e,p=!0;for(o=0;o<this.m_bodies.length;++o){n=this.m_bodies[o],l=t.positions[n.m_islandIndex].c;var m,h=(o+1)%this.m_bodies.length;(m=s.b2Vec2.AddVV(this.m_normals[o],this.m_normals[h],this.m_delta)).SelfMul(_);var f=m.LengthSquared();f>s.b2Sq(r.b2_maxLinearCorrection)&&m.SelfMul(r.b2_maxLinearCorrection/s.b2Sqrt(f)),f>s.b2Sq(r.b2_linearSlop)&&(p=!1),l.x+=m.x,l.y+=m.y}return p},e}(a.b2Joint);i.b2AreaJoint=u,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2DistanceJoint":"b2DistanceJoint","./b2Joint":"b2Joint"}],b2BlockAllocator:[function(t,e,i){"use strict";cc._RF.push(e,"a4af9mgoFFOYayVgkegfQq4","b2BlockAllocator"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2BlockAllocator=void 0;i.b2BlockAllocator=function(){},cc._RF.pop()},{}],b2Body:[function(t,e,i){"use strict";cc._RF.push(e,"3bc97GxQslDYoou+mnUMNzR","b2Body"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Body=i.b2BodyDef=i.b2BodyType=void 0;var o,n=t("../Common/b2Settings"),r=t("../Common/b2Math"),s=t("../Collision/Shapes/b2Shape"),a=t("./b2Fixture");(function(t){t[t.b2_unknown=-1]="b2_unknown",t[t.b2_staticBody=0]="b2_staticBody",t[t.b2_kinematicBody=1]="b2_kinematicBody",t[t.b2_dynamicBody=2]="b2_dynamicBody"})(o=i.b2BodyType||(i.b2BodyType={}));i.b2BodyDef=function(){this.type=o.b2_staticBody,this.position=new r.b2Vec2(0,0),this.angle=0,this.linearVelocity=new r.b2Vec2(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.active=!0,this.userData=null,this.gravityScale=1};var l=function(){function t(t,e){this.m_type=o.b2_staticBody,this.m_islandFlag=!1,this.m_awakeFlag=!1,this.m_autoSleepFlag=!1,this.m_bulletFlag=!1,this.m_fixedRotationFlag=!1,this.m_activeFlag=!1,this.m_toiFlag=!1,this.m_islandIndex=0,this.m_xf=new r.b2Transform,this.m_xf0=new r.b2Transform,this.m_sweep=new r.b2Sweep,this.m_linearVelocity=new r.b2Vec2,this.m_angularVelocity=0,this.m_force=new r.b2Vec2,this.m_torque=0,this.m_prev=null,this.m_next=null,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_jointList=null,this.m_contactList=null,this.m_mass=1,this.m_invMass=1,this.m_I=0,this.m_invI=0,this.m_linearDamping=0,this.m_angularDamping=0,this.m_gravityScale=1,this.m_sleepTime=0,this.m_userData=null,this.m_controllerList=null,this.m_controllerCount=0,this.m_bulletFlag=n.b2Maybe(t.bullet,!1),this.m_fixedRotationFlag=n.b2Maybe(t.fixedRotation,!1),this.m_autoSleepFlag=n.b2Maybe(t.allowSleep,!0),this.m_awakeFlag=n.b2Maybe(t.awake,!0),this.m_activeFlag=n.b2Maybe(t.active,!0),this.m_world=e,this.m_xf.p.Copy(n.b2Maybe(t.position,r.b2Vec2.ZERO)),this.m_xf.q.SetAngle(n.b2Maybe(t.angle,0)),this.m_xf0.Copy(this.m_xf),this.m_sweep.localCenter.SetZero(),this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a=this.m_xf.q.GetAngle(),this.m_sweep.alpha0=0,this.m_linearVelocity.Copy(n.b2Maybe(t.linearVelocity,r.b2Vec2.ZERO)),this.m_angularVelocity=n.b2Maybe(t.angularVelocity,0),this.m_linearDamping=n.b2Maybe(t.linearDamping,0),this.m_angularDamping=n.b2Maybe(t.angularDamping,0),this.m_gravityScale=n.b2Maybe(t.gravityScale,1),this.m_force.SetZero(),this.m_torque=0,this.m_sleepTime=0,this.m_type=n.b2Maybe(t.type,o.b2_staticBody),t.type===o.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_userData=t.userData,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_controllerList=null,this.m_controllerCount=0}return t.prototype.CreateFixture=function(t,e){return void 0===e&&(e=0),t instanceof s.b2Shape?this.CreateFixtureShapeDensity(t,e):this.CreateFixtureDef(t)},t.prototype.CreateFixtureDef=function(t){if(this.m_world.IsLocked())throw new Error;var e=new a.b2Fixture(this,t);return this.m_activeFlag&&e.CreateProxies(),e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_density>0&&this.ResetMassData(),this.m_world.m_newFixture=!0,e},t.prototype.CreateFixtureShapeDensity=function(e,i){void 0===i&&(i=0);var o=t.CreateFixtureShapeDensity_s_def;return o.shape=e,o.density=i,this.CreateFixtureDef(o)},t.prototype.DestroyFixture=function(t){if(this.m_world.IsLocked())throw new Error;for(var e=this.m_fixtureList,i=null;null!==e;){if(e===t){i?i.m_next=t.m_next:this.m_fixtureList=t.m_next;break}i=e,e=e.m_next}for(var o=this.m_contactList;o;){var n=o.contact;o=o.next;var r=n.GetFixtureA(),s=n.GetFixtureB();t!==r&&t!==s||this.m_world.m_contactManager.Destroy(n)}this.m_activeFlag&&t.DestroyProxies(),t.m_next=null,t.Reset(),--this.m_fixtureCount,this.ResetMassData()},t.prototype.SetTransformVec=function(t,e){this.SetTransformXY(t.x,t.y,e)},t.prototype.SetTransformXY=function(t,e,i){if(this.m_world.IsLocked())throw new Error;this.m_xf.q.SetAngle(i),this.m_xf.p.Set(t,e),this.m_xf0.Copy(this.m_xf),r.b2Transform.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=i,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=i;for(var o=this.m_fixtureList;o;o=o.m_next)o.SynchronizeProxies(this.m_xf,this.m_xf,r.b2Vec2.ZERO);this.m_world.m_contactManager.FindNewContacts()},t.prototype.SetTransform=function(t){this.SetTransformVec(t.p,t.GetAngle())},t.prototype.GetTransform=function(){return this.m_xf},t.prototype.GetPosition=function(){return this.m_xf.p},t.prototype.SetPosition=function(t){this.SetTransformVec(t,this.GetAngle())},t.prototype.SetPositionXY=function(t,e){this.SetTransformXY(t,e,this.GetAngle())},t.prototype.GetAngle=function(){return this.m_sweep.a},t.prototype.SetAngle=function(t){this.SetTransformVec(this.GetPosition(),t)},t.prototype.GetWorldCenter=function(){return this.m_sweep.c},t.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},t.prototype.SetLinearVelocity=function(t){this.m_type!==o.b2_staticBody&&(r.b2Vec2.DotVV(t,t)>0&&this.SetAwake(!0),this.m_linearVelocity.Copy(t))},t.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},t.prototype.SetAngularVelocity=function(t){this.m_type!==o.b2_staticBody&&(t*t>0&&this.SetAwake(!0),this.m_angularVelocity=t)},t.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},t.prototype.GetDefinition=function(t){return t.type=this.GetType(),t.allowSleep=this.m_autoSleepFlag,t.angle=this.GetAngle(),t.angularDamping=this.m_angularDamping,t.gravityScale=this.m_gravityScale,t.angularVelocity=this.m_angularVelocity,t.fixedRotation=this.m_fixedRotationFlag,t.bullet=this.m_bulletFlag,t.awake=this.m_awakeFlag,t.linearDamping=this.m_linearDamping,t.linearVelocity.Copy(this.GetLinearVelocity()),t.position.Copy(this.GetPosition()),t.userData=this.GetUserData(),t},t.prototype.ApplyForce=function(t,e,i){void 0===i&&(i=!0),this.m_type===o.b2_dynamicBody&&(i&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))},t.prototype.ApplyForceToCenter=function(t,e){void 0===e&&(e=!0),this.m_type===o.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=t.x,this.m_force.y+=t.y))},t.prototype.ApplyTorque=function(t,e){void 0===e&&(e=!0),this.m_type===o.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))},t.prototype.ApplyLinearImpulse=function(t,e,i){void 0===i&&(i=!0),this.m_type===o.b2_dynamicBody&&(i&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)))},t.prototype.ApplyLinearImpulseToCenter=function(t,e){void 0===e&&(e=!0),this.m_type===o.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y))},t.prototype.ApplyAngularImpulse=function(t,e){void 0===e&&(e=!0),this.m_type===o.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))},t.prototype.GetMass=function(){return this.m_mass},t.prototype.GetInertia=function(){return this.m_I+this.m_mass*r.b2Vec2.DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter)},t.prototype.GetMassData=function(t){return t.mass=this.m_mass,t.I=this.m_I+this.m_mass*r.b2Vec2.DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter),t.center.Copy(this.m_sweep.localCenter),t},t.prototype.SetMassData=function(e){if(this.m_world.IsLocked())throw new Error;if(this.m_type===o.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&!this.m_fixedRotationFlag&&(this.m_I=e.I-this.m_mass*r.b2Vec2.DotVV(e.center,e.center),this.m_invI=1/this.m_I);var i=t.SetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e.center),r.b2Transform.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),r.b2Vec2.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,r.b2Vec2.SubVV(this.m_sweep.c,i,r.b2Vec2.s_t0),this.m_linearVelocity)}},t.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type===o.b2_staticBody||this.m_type===o.b2_kinematicBody)return this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);for(var e=t.ResetMassData_s_localCenter.SetZero(),i=this.m_fixtureList;i;i=i.m_next)if(0!==i.m_density){var n=i.GetMassData(t.ResetMassData_s_massData);this.m_mass+=n.mass,e.x+=n.center.x*n.mass,e.y+=n.center.y*n.mass,this.m_I+=n.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&!this.m_fixedRotationFlag?(this.m_I-=this.m_mass*r.b2Vec2.DotVV(e,e),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var s=t.ResetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e),r.b2Transform.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),r.b2Vec2.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,r.b2Vec2.SubVV(this.m_sweep.c,s,r.b2Vec2.s_t0),this.m_linearVelocity)},t.prototype.GetWorldPoint=function(t,e){return r.b2Transform.MulXV(this.m_xf,t,e)},t.prototype.GetWorldVector=function(t,e){return r.b2Rot.MulRV(this.m_xf.q,t,e)},t.prototype.GetLocalPoint=function(t,e){return r.b2Transform.MulTXV(this.m_xf,t,e)},t.prototype.GetLocalVector=function(t,e){return r.b2Rot.MulTRV(this.m_xf.q,t,e)},t.prototype.GetLinearVelocityFromWorldPoint=function(t,e){return r.b2Vec2.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,r.b2Vec2.SubVV(t,this.m_sweep.c,r.b2Vec2.s_t0),e)},t.prototype.GetLinearVelocityFromLocalPoint=function(t,e){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(t,e),e)},t.prototype.GetLinearDamping=function(){return this.m_linearDamping},t.prototype.SetLinearDamping=function(t){this.m_linearDamping=t},t.prototype.GetAngularDamping=function(){return this.m_angularDamping},t.prototype.SetAngularDamping=function(t){this.m_angularDamping=t},t.prototype.GetGravityScale=function(){return this.m_gravityScale},t.prototype.SetGravityScale=function(t){this.m_gravityScale=t},t.prototype.SetType=function(t){if(this.m_world.IsLocked())throw new Error;if(this.m_type!==t){this.m_type=t,this.ResetMassData(),this.m_type===o.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.SynchronizeFixtures()),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var e=this.m_contactList;e;){var i=e;e=e.next,this.m_world.m_contactManager.Destroy(i.contact)}this.m_contactList=null;for(var n=this.m_fixtureList;n;n=n.m_next)n.TouchProxies()}},t.prototype.GetType=function(){return this.m_type},t.prototype.SetBullet=function(t){this.m_bulletFlag=t},t.prototype.IsBullet=function(){return this.m_bulletFlag},t.prototype.SetSleepingAllowed=function(t){this.m_autoSleepFlag=t,t||this.SetAwake(!0)},t.prototype.IsSleepingAllowed=function(){return this.m_autoSleepFlag},t.prototype.SetAwake=function(t){t?(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},t.prototype.IsAwake=function(){return this.m_awakeFlag},t.prototype.SetActive=function(t){if(this.m_world.IsLocked())throw new Error;if(t!==this.IsActive())if(this.m_activeFlag=t,t)for(var e=this.m_fixtureList;e;e=e.m_next)e.CreateProxies();else{for(e=this.m_fixtureList;e;e=e.m_next)e.DestroyProxies();for(var i=this.m_contactList;i;){var o=i;i=i.next,this.m_world.m_contactManager.Destroy(o.contact)}this.m_contactList=null}},t.prototype.IsActive=function(){return this.m_activeFlag},t.prototype.SetFixedRotation=function(t){this.m_fixedRotationFlag!==t&&(this.m_fixedRotationFlag=t,this.m_angularVelocity=0,this.ResetMassData())},t.prototype.IsFixedRotation=function(){return this.m_fixedRotationFlag},t.prototype.GetFixtureList=function(){return this.m_fixtureList},t.prototype.GetJointList=function(){return this.m_jointList},t.prototype.GetContactList=function(){return this.m_contactList},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetUserData=function(){return this.m_userData},t.prototype.SetUserData=function(t){this.m_userData=t},t.prototype.GetWorld=function(){return this.m_world},t.prototype.Dump=function(t){var e=this.m_islandIndex;t("{\n"),t("  const bd: b2BodyDef = new b2BodyDef();\n");var i="";switch(this.m_type){case o.b2_staticBody:i="b2BodyType.b2_staticBody";break;case o.b2_kinematicBody:i="b2BodyType.b2_kinematicBody";break;case o.b2_dynamicBody:i="b2BodyType.b2_dynamicBody"}t("  bd.type = %s;\n",i),t("  bd.position.Set(%.15f, %.15f);\n",this.m_xf.p.x,this.m_xf.p.y),t("  bd.angle = %.15f;\n",this.m_sweep.a),t("  bd.linearVelocity.Set(%.15f, %.15f);\n",this.m_linearVelocity.x,this.m_linearVelocity.y),t("  bd.angularVelocity = %.15f;\n",this.m_angularVelocity),t("  bd.linearDamping = %.15f;\n",this.m_linearDamping),t("  bd.angularDamping = %.15f;\n",this.m_angularDamping),t("  bd.allowSleep = %s;\n",this.m_autoSleepFlag?"true":"false"),t("  bd.awake = %s;\n",this.m_awakeFlag?"true":"false"),t("  bd.fixedRotation = %s;\n",this.m_fixedRotationFlag?"true":"false"),t("  bd.bullet = %s;\n",this.m_bulletFlag?"true":"false"),t("  bd.active = %s;\n",this.m_activeFlag?"true":"false"),t("  bd.gravityScale = %.15f;\n",this.m_gravityScale),t("\n"),t("  bodies[%d] = this.m_world.CreateBody(bd);\n",this.m_islandIndex),t("\n");for(var n=this.m_fixtureList;n;n=n.m_next)t("  {\n"),n.Dump(t,e),t("  }\n");t("}\n")},t.prototype.SynchronizeFixtures=function(){var e=t.SynchronizeFixtures_s_xf1;e.q.SetAngle(this.m_sweep.a0),r.b2Rot.MulRV(e.q,this.m_sweep.localCenter,e.p),r.b2Vec2.SubVV(this.m_sweep.c0,e.p,e.p);for(var i=r.b2Vec2.SubVV(this.m_sweep.c,this.m_sweep.c0,t.SynchronizeFixtures_s_displacement),o=this.m_fixtureList;o;o=o.m_next)o.SynchronizeProxies(e,this.m_xf,i)},t.prototype.SynchronizeTransform=function(){this.m_xf.q.SetAngle(this.m_sweep.a),r.b2Rot.MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),r.b2Vec2.SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)},t.prototype.ShouldCollide=function(t){return(this.m_type!==o.b2_staticBody||t.m_type!==o.b2_staticBody)&&this.ShouldCollideConnected(t)},t.prototype.ShouldCollideConnected=function(t){for(var e=this.m_jointList;e;e=e.next)if(e.other===t&&!e.joint.m_collideConnected)return!1;return!0},t.prototype.Advance=function(t){this.m_sweep.Advance(t),this.m_sweep.c.Copy(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_xf.q.SetAngle(this.m_sweep.a),r.b2Rot.MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),r.b2Vec2.SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)},t.prototype.GetControllerList=function(){return this.m_controllerList},t.prototype.GetControllerCount=function(){return this.m_controllerCount},t.CreateFixtureShapeDensity_s_def=new a.b2FixtureDef,t.SetMassData_s_oldCenter=new r.b2Vec2,t.ResetMassData_s_localCenter=new r.b2Vec2,t.ResetMassData_s_oldCenter=new r.b2Vec2,t.ResetMassData_s_massData=new s.b2MassData,t.SynchronizeFixtures_s_xf1=new r.b2Transform,t.SynchronizeFixtures_s_displacement=new r.b2Vec2,t}();i.b2Body=l,cc._RF.pop()},{"../Collision/Shapes/b2Shape":"b2Shape","../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","./b2Fixture":"b2Fixture"}],b2BroadPhase:[function(t,e,i){"use strict";cc._RF.push(e,"3229bYZULlEx7TUngfITx4y","b2BroadPhase"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2PairLessThan=i.b2BroadPhase=i.b2Pair=void 0;var o=t("./b2DynamicTree");function n(t,e,i){var o=t[e];t[e]=t[i],t[i]=o}function r(t,e){return t<e}function s(t,e,i,o){void 0===e&&(e=0),void 0===i&&(i=t.length-e),void 0===o&&(o=r);for(var s=e,a=[],l=0;;){for(;s+1<i;i++){var c=t[s+Math.floor(Math.random()*(i-s))];a[l++]=i;for(var u=s-1;;){for(;o(t[++u],c););for(;o(c,t[--i]););if(u>=i)break;n(t,u,i)}}if(0===l)break;s=i,i=a[--l]}return t}var a=function(t,e){this.proxyA=t,this.proxyB=e};i.b2Pair=a;var l=function(){function t(){this.m_tree=new o.b2DynamicTree,this.m_proxyCount=0,this.m_moveCount=0,this.m_moveBuffer=[],this.m_pairCount=0,this.m_pairBuffer=[]}return t.prototype.CreateProxy=function(t,e){var i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i},t.prototype.DestroyProxy=function(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)},t.prototype.MoveProxy=function(t,e,i){this.m_tree.MoveProxy(t,e,i)&&this.BufferMove(t)},t.prototype.TouchProxy=function(t){this.BufferMove(t)},t.prototype.GetProxyCount=function(){return this.m_proxyCount},t.prototype.UpdatePairs=function(t){var e=this;this.m_pairCount=0;for(var i=function(t){var i=o.m_moveBuffer[t];if(null===i)return"continue";var n=i.aabb;o.m_tree.Query(n,function(t){if(t.m_id===i.m_id)return!0;var o,n;if(t.m_id<i.m_id?(o=t,n=i):(o=i,n=t),e.m_pairCount===e.m_pairBuffer.length)e.m_pairBuffer[e.m_pairCount]=new a(o,n);else{var r=e.m_pairBuffer[e.m_pairCount];r.proxyA=o,r.proxyB=n}return++e.m_pairCount,!0})},o=this,n=0;n<this.m_moveCount;++n)i(n);this.m_moveCount=0,s(this.m_pairBuffer,0,this.m_pairCount,c);for(var r=0;r<this.m_pairCount;){var l=this.m_pairBuffer[r];for(t(l.proxyA.userData,l.proxyB.userData),++r;r<this.m_pairCount;){var u=this.m_pairBuffer[r];if(u.proxyA.m_id!==l.proxyA.m_id||u.proxyB.m_id!==l.proxyB.m_id)break;++r}}},t.prototype.Query=function(t,e){this.m_tree.Query(t,e)},t.prototype.QueryPoint=function(t,e){this.m_tree.QueryPoint(t,e)},t.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)},t.prototype.GetTreeHeight=function(){return this.m_tree.GetHeight()},t.prototype.GetTreeBalance=function(){return this.m_tree.GetMaxBalance()},t.prototype.GetTreeQuality=function(){return this.m_tree.GetAreaRatio()},t.prototype.ShiftOrigin=function(t){this.m_tree.ShiftOrigin(t)},t.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveCount]=t,++this.m_moveCount},t.prototype.UnBufferMove=function(t){var e=this.m_moveBuffer.indexOf(t);this.m_moveBuffer[e]=null},t}();function c(t,e){return t.proxyA.m_id<e.proxyA.m_id||t.proxyA.m_id===e.proxyA.m_id&&t.proxyB.m_id<e.proxyB.m_id}i.b2BroadPhase=l,i.b2PairLessThan=c,cc._RF.pop()},{"./b2DynamicTree":"b2DynamicTree"}],b2BuoyancyController:[function(t,e,i){"use strict";cc._RF.push(e,"d0753jURcVJ75ZwoslrI3wn","b2BuoyancyController");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2BuoyancyController=void 0;var r=t("./b2Controller"),s=t("../Common/b2Math"),a=t("../Common/b2Settings"),l=t("../Common/b2Draw"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.normal=new s.b2Vec2(0,1),e.offset=0,e.density=0,e.velocity=new s.b2Vec2(0,0),e.linearDrag=0,e.angularDrag=0,e.useDensity=!1,e.useWorldGravity=!0,e.gravity=new s.b2Vec2(0,0),e}return n(e,t),e.prototype.Step=function(){if(this.m_bodyList){this.useWorldGravity&&this.gravity.Copy(this.m_bodyList.body.GetWorld().GetGravity());for(var t=this.m_bodyList;t;t=t.nextBody){var e=t.body;if(e.IsAwake()){for(var i=new s.b2Vec2,o=new s.b2Vec2,n=0,r=0,l=e.GetFixtureList();l;l=l.m_next){var c=new s.b2Vec2,u=l.GetShape().ComputeSubmergedArea(this.normal,this.offset,e.GetTransform(),c);n+=u,i.x+=u*c.x,i.y+=u*c.y;var _;r+=u*(_=this.useDensity?l.GetDensity():1),o.x+=u*c.x*_,o.y+=u*c.y*_}if(i.x/=n,i.y/=n,o.x/=r,o.y/=r,!(n<a.b2_epsilon)){var p=this.gravity.Clone().SelfNeg();p.SelfMul(this.density*n),e.ApplyForce(p,o);var m=e.GetLinearVelocityFromWorldPoint(i,new s.b2Vec2);m.SelfSub(this.velocity),m.SelfMul(-this.linearDrag*n),e.ApplyForce(m,i),e.ApplyTorque(-e.GetInertia()/e.GetMass()*n*e.GetAngularVelocity()*this.angularDrag)}}}}},e.prototype.Draw=function(t){var e=100,i=new s.b2Vec2,o=new s.b2Vec2;i.x=this.normal.x*this.offset+this.normal.y*e,i.y=this.normal.y*this.offset-this.normal.x*e,o.x=this.normal.x*this.offset-this.normal.y*e,o.y=this.normal.y*this.offset+this.normal.x*e;var n=new l.b2Color(0,0,.8);t.DrawSegment(i,o,n)},e}(r.b2Controller);i.b2BuoyancyController=c,cc._RF.pop()},{"../Common/b2Draw":"b2Draw","../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","./b2Controller":"b2Controller"}],b2ChainAndCircleContact:[function(t,e,i){"use strict";cc._RF.push(e,"238b3tcGa1KPL4hrr6oakCH","b2ChainAndCircleContact");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2ChainAndCircleContact=void 0;var r=t("../../Collision/b2CollideEdge"),s=t("../../Collision/Shapes/b2EdgeShape"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(){return new e},e.Destroy=function(){},e.prototype.Evaluate=function(t,i,o){var n=e.Evaluate_s_edge;this.GetShapeA().GetChildEdge(n,this.m_indexA),r.b2CollideEdgeAndCircle(t,n,i,this.GetShapeB(),o)},e.Evaluate_s_edge=new s.b2EdgeShape,e}(t("./b2Contact").b2Contact);i.b2ChainAndCircleContact=a,cc._RF.pop()},{"../../Collision/Shapes/b2EdgeShape":"b2EdgeShape","../../Collision/b2CollideEdge":"b2CollideEdge","./b2Contact":"b2Contact"}],b2ChainAndPolygonContact:[function(t,e,i){"use strict";cc._RF.push(e,"68976cDHh5KoYKgp2KqDNKC","b2ChainAndPolygonContact");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2ChainAndPolygonContact=void 0;var r=t("../../Collision/b2CollideEdge"),s=t("../../Collision/Shapes/b2EdgeShape"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(){return new e},e.Destroy=function(){},e.prototype.Evaluate=function(t,i,o){var n=e.Evaluate_s_edge;this.GetShapeA().GetChildEdge(n,this.m_indexA),r.b2CollideEdgeAndPolygon(t,n,i,this.GetShapeB(),o)},e.Evaluate_s_edge=new s.b2EdgeShape,e}(t("./b2Contact").b2Contact);i.b2ChainAndPolygonContact=a,cc._RF.pop()},{"../../Collision/Shapes/b2EdgeShape":"b2EdgeShape","../../Collision/b2CollideEdge":"b2CollideEdge","./b2Contact":"b2Contact"}],b2ChainShape:[function(t,e,i){"use strict";cc._RF.push(e,"38093k1zn1PILvq7atwfLIc","b2ChainShape");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2ChainShape=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Shape"),l=t("./b2EdgeShape"),c=function(t){function e(){var e=t.call(this,a.b2ShapeType.e_chainShape,r.b2_polygonRadius)||this;return e.m_vertices=[],e.m_count=0,e.m_prevVertex=new s.b2Vec2,e.m_nextVertex=new s.b2Vec2,e.m_hasPrevVertex=!1,e.m_hasNextVertex=!1,e}return n(e,t),e.prototype.CreateLoop=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("number"==typeof t[0][0]){var i=t[0];if(i.length%2!=0)throw new Error;return this._CreateLoop(function(t){return{x:i[2*t],y:i[2*t+1]}},i.length/2)}var o=t[0],n=t[1]||o.length;return this._CreateLoop(function(t){return o[t]},n)},e.prototype._CreateLoop=function(t,e){if(e<3)return this;this.m_count=e+1,this.m_vertices=s.b2Vec2.MakeArray(this.m_count);for(var i=0;i<e;++i)this.m_vertices[i].Copy(t(i));return this.m_vertices[e].Copy(this.m_vertices[0]),this.m_prevVertex.Copy(this.m_vertices[this.m_count-2]),this.m_nextVertex.Copy(this.m_vertices[1]),this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this},e.prototype.CreateChain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("number"==typeof t[0][0]){var i=t[0];if(i.length%2!=0)throw new Error;return this._CreateChain(function(t){return{x:i[2*t],y:i[2*t+1]}},i.length/2)}var o=t[0],n=t[1]||o.length;return this._CreateChain(function(t){return o[t]},n)},e.prototype._CreateChain=function(t,e){this.m_count=e,this.m_vertices=s.b2Vec2.MakeArray(e);for(var i=0;i<e;++i)this.m_vertices[i].Copy(t(i));return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex.SetZero(),this.m_nextVertex.SetZero(),this},e.prototype.SetPrevVertex=function(t){return this.m_prevVertex.Copy(t),this.m_hasPrevVertex=!0,this},e.prototype.SetNextVertex=function(t){return this.m_nextVertex.Copy(t),this.m_hasNextVertex=!0,this},e.prototype.Clone=function(){return(new e).Copy(this)},e.prototype.Copy=function(e){return t.prototype.Copy.call(this,e),this._CreateChain(function(t){return e.m_vertices[t]},e.m_count),this.m_prevVertex.Copy(e.m_prevVertex),this.m_nextVertex.Copy(e.m_nextVertex),this.m_hasPrevVertex=e.m_hasPrevVertex,this.m_hasNextVertex=e.m_hasNextVertex,this},e.prototype.GetChildCount=function(){return this.m_count-1},e.prototype.GetChildEdge=function(t,e){t.m_radius=this.m_radius,t.m_vertex1.Copy(this.m_vertices[e]),t.m_vertex2.Copy(this.m_vertices[e+1]),e>0?(t.m_vertex0.Copy(this.m_vertices[e-1]),t.m_hasVertex0=!0):(t.m_vertex0.Copy(this.m_prevVertex),t.m_hasVertex0=this.m_hasPrevVertex),e<this.m_count-2?(t.m_vertex3.Copy(this.m_vertices[e+2]),t.m_hasVertex3=!0):(t.m_vertex3.Copy(this.m_nextVertex),t.m_hasVertex3=this.m_hasNextVertex)},e.prototype.TestPoint=function(){return!1},e.prototype.ComputeDistance=function(t,i,o,n){var r=e.ComputeDistance_s_edgeShape;return this.GetChildEdge(r,n),r.ComputeDistance(t,i,o,0)},e.prototype.RayCast=function(t,i,o,n){var r=e.RayCast_s_edgeShape;return r.m_vertex1.Copy(this.m_vertices[n]),r.m_vertex2.Copy(this.m_vertices[(n+1)%this.m_count]),r.RayCast(t,i,o,0)},e.prototype.ComputeAABB=function(t,i,o){var n=this.m_vertices[o],r=this.m_vertices[(o+1)%this.m_count],a=s.b2Transform.MulXV(i,n,e.ComputeAABB_s_v1),l=s.b2Transform.MulXV(i,r,e.ComputeAABB_s_v2);s.b2Vec2.MinV(a,l,t.lowerBound),s.b2Vec2.MaxV(a,l,t.upperBound)},e.prototype.ComputeMass=function(t){t.mass=0,t.center.SetZero(),t.I=0},e.prototype.SetupDistanceProxy=function(t,e){t.m_vertices=t.m_buffer,t.m_vertices[0].Copy(this.m_vertices[e]),e+1<this.m_count?t.m_vertices[1].Copy(this.m_vertices[e+1]):t.m_vertices[1].Copy(this.m_vertices[0]),t.m_count=2,t.m_radius=this.m_radius},e.prototype.ComputeSubmergedArea=function(t,e,i,o){return o.SetZero(),0},e.prototype.Dump=function(t){t("    const shape: b2ChainShape = new b2ChainShape();\n"),t("    const vs: b2Vec2[] = [];\n");for(var e=0;e<this.m_count;++e)t("    vs[%d] = new bVec2(%.15f, %.15f);\n",e,this.m_vertices[e].x,this.m_vertices[e].y);t("    shape.CreateChain(vs, %d);\n",this.m_count),t("    shape.m_prevVertex.Set(%.15f, %.15f);\n",this.m_prevVertex.x,this.m_prevVertex.y),t("    shape.m_nextVertex.Set(%.15f, %.15f);\n",this.m_nextVertex.x,this.m_nextVertex.y),t("    shape.m_hasPrevVertex = %s;\n",this.m_hasPrevVertex?"true":"false"),t("    shape.m_hasNextVertex = %s;\n",this.m_hasNextVertex?"true":"false")},e.ComputeDistance_s_edgeShape=new l.b2EdgeShape,e.RayCast_s_edgeShape=new l.b2EdgeShape,e.ComputeAABB_s_v1=new s.b2Vec2,e.ComputeAABB_s_v2=new s.b2Vec2,e}(a.b2Shape);i.b2ChainShape=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2EdgeShape":"b2EdgeShape","./b2Shape":"b2Shape"}],b2CircleContact:[function(t,e,i){"use strict";cc._RF.push(e,"730465lbJhOKKuegufDH+K1","b2CircleContact");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2CircleContact=void 0;var r=t("../../Collision/b2CollideCircle"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(){return new e},e.Destroy=function(){},e.prototype.Evaluate=function(t,e,i){r.b2CollideCircles(t,this.GetShapeA(),e,this.GetShapeB(),i)},e}(t("./b2Contact").b2Contact);i.b2CircleContact=s,cc._RF.pop()},{"../../Collision/b2CollideCircle":"b2CollideCircle","./b2Contact":"b2Contact"}],b2CircleShape:[function(t,e,i){"use strict";cc._RF.push(e,"60e00+1xxhHtq9Oug5eio2b","b2CircleShape");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2CircleShape=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Shape"),l=function(t){function e(e){void 0===e&&(e=0);var i=t.call(this,a.b2ShapeType.e_circleShape,e)||this;return i.m_p=new s.b2Vec2,i}return n(e,t),e.prototype.Set=function(t,e){return void 0===e&&(e=this.m_radius),this.m_p.Copy(t),this.m_radius=e,this},e.prototype.Clone=function(){return(new e).Copy(this)},e.prototype.Copy=function(e){return t.prototype.Copy.call(this,e),this.m_p.Copy(e.m_p),this},e.prototype.GetChildCount=function(){return 1},e.prototype.TestPoint=function(t,i){var o=s.b2Transform.MulXV(t,this.m_p,e.TestPoint_s_center),n=s.b2Vec2.SubVV(i,o,e.TestPoint_s_d);return s.b2Vec2.DotVV(n,n)<=s.b2Sq(this.m_radius)},e.prototype.ComputeDistance=function(t,i,o){var n=s.b2Transform.MulXV(t,this.m_p,e.ComputeDistance_s_center);return s.b2Vec2.SubVV(i,n,o),o.Normalize()-this.m_radius},e.prototype.RayCast=function(t,i,o){var n=s.b2Transform.MulXV(o,this.m_p,e.RayCast_s_position),a=s.b2Vec2.SubVV(i.p1,n,e.RayCast_s_s),l=s.b2Vec2.DotVV(a,a)-s.b2Sq(this.m_radius),c=s.b2Vec2.SubVV(i.p2,i.p1,e.RayCast_s_r),u=s.b2Vec2.DotVV(a,c),_=s.b2Vec2.DotVV(c,c),p=u*u-_*l;if(p<0||_<r.b2_epsilon)return!1;var m=-(u+s.b2Sqrt(p));return 0<=m&&m<=i.maxFraction*_&&(m/=_,t.fraction=m,s.b2Vec2.AddVMulSV(a,m,c,t.normal).SelfNormalize(),!0)},e.prototype.ComputeAABB=function(t,i){var o=s.b2Transform.MulXV(i,this.m_p,e.ComputeAABB_s_p);t.lowerBound.Set(o.x-this.m_radius,o.y-this.m_radius),t.upperBound.Set(o.x+this.m_radius,o.y+this.m_radius)},e.prototype.ComputeMass=function(t,e){var i=s.b2Sq(this.m_radius);t.mass=e*r.b2_pi*i,t.center.Copy(this.m_p),t.I=t.mass*(.5*i+s.b2Vec2.DotVV(this.m_p,this.m_p))},e.prototype.SetupDistanceProxy=function(t){t.m_vertices=t.m_buffer,t.m_vertices[0].Copy(this.m_p),t.m_count=1,t.m_radius=this.m_radius},e.prototype.ComputeSubmergedArea=function(t,e,i,o){var n=s.b2Transform.MulXV(i,this.m_p,new s.b2Vec2),a=-(s.b2Vec2.DotVV(t,n)-e);if(a<-this.m_radius+r.b2_epsilon)return 0;if(a>this.m_radius)return o.Copy(n),r.b2_pi*this.m_radius*this.m_radius;var l=this.m_radius*this.m_radius,c=a*a,u=l*(s.b2Asin(a/this.m_radius)+r.b2_pi/2)+a*s.b2Sqrt(l-c),_=-2/3*s.b2Pow(l-c,1.5)/u;return o.x=n.x+t.x*_,o.y=n.y+t.y*_,u},e.prototype.Dump=function(t){t("    const shape: b2CircleShape = new b2CircleShape();\n"),t("    shape.m_radius = %.15f;\n",this.m_radius),t("    shape.m_p.Set(%.15f, %.15f);\n",this.m_p.x,this.m_p.y)},e.TestPoint_s_center=new s.b2Vec2,e.TestPoint_s_d=new s.b2Vec2,e.ComputeDistance_s_center=new s.b2Vec2,e.RayCast_s_position=new s.b2Vec2,e.RayCast_s_s=new s.b2Vec2,e.RayCast_s_r=new s.b2Vec2,e.ComputeAABB_s_p=new s.b2Vec2,e}(a.b2Shape);i.b2CircleShape=l,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Shape":"b2Shape"}],b2CollideCircle:[function(t,e,i){"use strict";cc._RF.push(e,"7b909u3nv1Kk4ddPEGw4j0n","b2CollideCircle"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2CollidePolygonAndCircle=i.b2CollideCircles=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Math"),r=t("./b2Collision"),s=new n.b2Vec2,a=new n.b2Vec2;i.b2CollideCircles=function(t,e,i,o,l){t.pointCount=0;var c=n.b2Transform.MulXV(i,e.m_p,s),u=n.b2Transform.MulXV(l,o.m_p,a),_=n.b2Vec2.DistanceSquaredVV(c,u),p=e.m_radius+o.m_radius;_>p*p||(t.type=r.b2ManifoldType.e_circles,t.localPoint.Copy(e.m_p),t.localNormal.SetZero(),t.pointCount=1,t.points[0].localPoint.Copy(o.m_p),t.points[0].id.key=0)};var l=new n.b2Vec2,c=new n.b2Vec2,u=new n.b2Vec2;i.b2CollidePolygonAndCircle=function(t,e,i,s,a){t.pointCount=0;for(var _=n.b2Transform.MulXV(a,s.m_p,l),p=n.b2Transform.MulTXV(i,_,c),m=0,h=-o.b2_maxFloat,f=e.m_radius+s.m_radius,d=e.m_count,b=e.m_vertices,y=e.m_normals,v=0;v<d;++v){var V=n.b2Vec2.DotVV(y[v],n.b2Vec2.SubVV(p,b[v],n.b2Vec2.s_t0));if(V>f)return;V>h&&(h=V,m=v)}var C=m,g=(C+1)%d,x=b[C],S=b[g];if(h<o.b2_epsilon)return t.pointCount=1,t.type=r.b2ManifoldType.e_faceA,t.localNormal.Copy(y[m]),n.b2Vec2.MidVV(x,S,t.localPoint),t.points[0].localPoint.Copy(s.m_p),void(t.points[0].id.key=0);var B=n.b2Vec2.DotVV(n.b2Vec2.SubVV(p,x,n.b2Vec2.s_t0),n.b2Vec2.SubVV(S,x,n.b2Vec2.s_t1)),A=n.b2Vec2.DotVV(n.b2Vec2.SubVV(p,S,n.b2Vec2.s_t0),n.b2Vec2.SubVV(x,S,n.b2Vec2.s_t1));if(B<=0){if(n.b2Vec2.DistanceSquaredVV(p,x)>f*f)return;t.pointCount=1,t.type=r.b2ManifoldType.e_faceA,n.b2Vec2.SubVV(p,x,t.localNormal).SelfNormalize(),t.localPoint.Copy(x),t.points[0].localPoint.Copy(s.m_p),t.points[0].id.key=0}else if(A<=0){if(n.b2Vec2.DistanceSquaredVV(p,S)>f*f)return;t.pointCount=1,t.type=r.b2ManifoldType.e_faceA,n.b2Vec2.SubVV(p,S,t.localNormal).SelfNormalize(),t.localPoint.Copy(S),t.points[0].localPoint.Copy(s.m_p),t.points[0].id.key=0}else{var P=n.b2Vec2.MidVV(x,S,u);if(n.b2Vec2.DotVV(n.b2Vec2.SubVV(p,P,n.b2Vec2.s_t1),y[C])>f)return;t.pointCount=1,t.type=r.b2ManifoldType.e_faceA,t.localNormal.Copy(y[C]).SelfNormalize(),t.localPoint.Copy(P),t.points[0].localPoint.Copy(s.m_p),t.points[0].id.key=0}},cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","./b2Collision":"b2Collision"}],b2CollideEdge:[function(t,e,i){"use strict";cc._RF.push(e,"bc422C7xANHcbrGkAcj61fd","b2CollideEdge"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2CollideEdgeAndPolygon=i.b2CollideEdgeAndCircle=void 0;var o,n=t("../Common/b2Settings"),r=t("../Common/b2Math"),s=t("./b2Collision"),a=t("./b2Collision"),l=new r.b2Vec2,c=new r.b2Vec2,u=new r.b2Vec2,_=new r.b2Vec2,p=new r.b2Vec2,m=new r.b2Vec2,h=new r.b2Vec2,f=new s.b2ContactID;i.b2CollideEdgeAndCircle=function(t,e,i,o,n){t.pointCount=0;var d=r.b2Transform.MulTXV(i,r.b2Transform.MulXV(n,o.m_p,r.b2Vec2.s_t0),l),b=e.m_vertex1,y=e.m_vertex2,v=r.b2Vec2.SubVV(y,b,c),V=r.b2Vec2.DotVV(v,r.b2Vec2.SubVV(y,d,r.b2Vec2.s_t0)),C=r.b2Vec2.DotVV(v,r.b2Vec2.SubVV(d,b,r.b2Vec2.s_t0)),g=e.m_radius+o.m_radius,x=f;if(x.cf.indexB=0,x.cf.typeB=s.b2ContactFeatureType.e_vertex,C<=0){var S=b,B=r.b2Vec2.SubVV(d,S,u);if(r.b2Vec2.DotVV(B,B)>g*g)return;if(e.m_hasVertex0){var A=e.m_vertex0,P=b,w=r.b2Vec2.SubVV(P,A,_);if(r.b2Vec2.DotVV(w,r.b2Vec2.SubVV(P,d,r.b2Vec2.s_t0))>0)return}return x.cf.indexA=0,x.cf.typeA=s.b2ContactFeatureType.e_vertex,t.pointCount=1,t.type=a.b2ManifoldType.e_circles,t.localNormal.SetZero(),t.localPoint.Copy(S),t.points[0].id.Copy(x),void t.points[0].localPoint.Copy(o.m_p)}if(V<=0){var M=y,D=r.b2Vec2.SubVV(d,M,u);if(r.b2Vec2.DotVV(D,D)>g*g)return;if(e.m_hasVertex3){var I=e.m_vertex3,G=y,T=r.b2Vec2.SubVV(I,G,p);if(r.b2Vec2.DotVV(T,r.b2Vec2.SubVV(d,G,r.b2Vec2.s_t0))>0)return}return x.cf.indexA=1,x.cf.typeA=s.b2ContactFeatureType.e_vertex,t.pointCount=1,t.type=a.b2ManifoldType.e_circles,t.localNormal.SetZero(),t.localPoint.Copy(M),t.points[0].id.Copy(x),void t.points[0].localPoint.Copy(o.m_p)}var R=r.b2Vec2.DotVV(v,v),F=m;F.x=1/R*(V*b.x+C*y.x),F.y=1/R*(V*b.y+C*y.y);var O=r.b2Vec2.SubVV(d,F,u);if(!(r.b2Vec2.DotVV(O,O)>g*g)){var L=h.Set(-v.y,v.x);r.b2Vec2.DotVV(L,r.b2Vec2.SubVV(d,b,r.b2Vec2.s_t0))<0&&L.Set(-L.x,-L.y),L.Normalize(),x.cf.indexA=0,x.cf.typeA=s.b2ContactFeatureType.e_face,t.pointCount=1,t.type=a.b2ManifoldType.e_faceA,t.localNormal.Copy(L),t.localPoint.Copy(b),t.points[0].id.Copy(x),t.points[0].localPoint.Copy(o.m_p)}},function(t){t[t.e_unknown=0]="e_unknown",t[t.e_edgeA=1]="e_edgeA",t[t.e_edgeB=2]="e_edgeB"}(o||(o={}));var d,b=function(){this.type=o.e_unknown,this.index=0,this.separation=0},y=function(){this.vertices=[],this.normals=[],this.count=0},v=function(){this.i1=0,this.i2=0,this.v1=new r.b2Vec2,this.v2=new r.b2Vec2,this.normal=new r.b2Vec2,this.sideNormal1=new r.b2Vec2,this.sideOffset1=0,this.sideNormal2=new r.b2Vec2,this.sideOffset2=0};(function(t){t[t.e_isolated=0]="e_isolated",t[t.e_concave=1]="e_concave",t[t.e_convex=2]="e_convex"})(d||(d={}));var V=new(function(){function t(){this.m_polygonB=new y,this.m_xf=new r.b2Transform,this.m_centroidB=new r.b2Vec2,this.m_v0=new r.b2Vec2,this.m_v1=new r.b2Vec2,this.m_v2=new r.b2Vec2,this.m_v3=new r.b2Vec2,this.m_normal0=new r.b2Vec2,this.m_normal1=new r.b2Vec2,this.m_normal2=new r.b2Vec2,this.m_normal=new r.b2Vec2,this.m_type1=d.e_isolated,this.m_type2=d.e_isolated,this.m_lowerLimit=new r.b2Vec2,this.m_upperLimit=new r.b2Vec2,this.m_radius=0,this.m_front=!1}return t.prototype.Collide=function(e,i,l,c,u){r.b2Transform.MulTXX(l,u,this.m_xf),r.b2Transform.MulXV(this.m_xf,c.m_centroid,this.m_centroidB),this.m_v0.Copy(i.m_vertex0),this.m_v1.Copy(i.m_vertex1),this.m_v2.Copy(i.m_vertex2),this.m_v3.Copy(i.m_vertex3);var _=i.m_hasVertex0,p=i.m_hasVertex3,m=r.b2Vec2.SubVV(this.m_v2,this.m_v1,t.s_edge1);m.Normalize(),this.m_normal1.Set(m.y,-m.x);var h=r.b2Vec2.DotVV(this.m_normal1,r.b2Vec2.SubVV(this.m_centroidB,this.m_v1,r.b2Vec2.s_t0)),f=0,d=0,b=!1,y=!1;if(_){var v=r.b2Vec2.SubVV(this.m_v1,this.m_v0,t.s_edge0);v.Normalize(),this.m_normal0.Set(v.y,-v.x),b=r.b2Vec2.CrossVV(v,m)>=0,f=r.b2Vec2.DotVV(this.m_normal0,r.b2Vec2.SubVV(this.m_centroidB,this.m_v0,r.b2Vec2.s_t0))}if(p){var V=r.b2Vec2.SubVV(this.m_v3,this.m_v2,t.s_edge2);V.Normalize(),this.m_normal2.Set(V.y,-V.x),y=r.b2Vec2.CrossVV(m,V)>0,d=r.b2Vec2.DotVV(this.m_normal2,r.b2Vec2.SubVV(this.m_centroidB,this.m_v2,r.b2Vec2.s_t0))}_&&p?b&&y?(this.m_front=f>=0||h>=0||d>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):b?(this.m_front=f>=0||h>=0&&d>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):y?(this.m_front=d>=0||f>=0&&h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):(this.m_front=f>=0&&h>=0&&d>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):_?b?(this.m_front=f>=0||h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):(this.m_front=f>=0&&h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):p?y?(this.m_front=h>=0||d>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1))):(this.m_front=h>=0&&d>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1))):(this.m_front=h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1))),this.m_polygonB.count=c.m_count;for(var C=0;C<c.m_count;++C)this.m_polygonB.vertices.length<=C&&this.m_polygonB.vertices.push(new r.b2Vec2),this.m_polygonB.normals.length<=C&&this.m_polygonB.normals.push(new r.b2Vec2),r.b2Transform.MulXV(this.m_xf,c.m_vertices[C],this.m_polygonB.vertices[C]),r.b2Rot.MulRV(this.m_xf.q,c.m_normals[C],this.m_polygonB.normals[C]);this.m_radius=c.m_radius+i.m_radius,e.pointCount=0;var g=this.ComputeEdgeSeparation(t.s_edgeAxis);if(g.type!==o.e_unknown&&!(g.separation>this.m_radius)){var x=this.ComputePolygonSeparation(t.s_polygonAxis);if(!(x.type!==o.e_unknown&&x.separation>this.m_radius)){var S;S=x.type===o.e_unknown?g:x.separation>.98*g.separation+.001?x:g;var B=t.s_ie,A=t.s_rf;if(S.type===o.e_edgeA){e.type=a.b2ManifoldType.e_faceA;var P=0,w=r.b2Vec2.DotVV(this.m_normal,this.m_polygonB.normals[0]);for(C=1;C<this.m_polygonB.count;++C){var M=r.b2Vec2.DotVV(this.m_normal,this.m_polygonB.normals[C]);M<w&&(w=M,P=C)}var D=P,I=(D+1)%this.m_polygonB.count;(G=B[0]).v.Copy(this.m_polygonB.vertices[D]),G.id.cf.indexA=0,G.id.cf.indexB=D,G.id.cf.typeA=s.b2ContactFeatureType.e_face,G.id.cf.typeB=s.b2ContactFeatureType.e_vertex,(T=B[1]).v.Copy(this.m_polygonB.vertices[I]),T.id.cf.indexA=0,T.id.cf.indexB=I,T.id.cf.typeA=s.b2ContactFeatureType.e_face,T.id.cf.typeB=s.b2ContactFeatureType.e_vertex,this.m_front?(A.i1=0,A.i2=1,A.v1.Copy(this.m_v1),A.v2.Copy(this.m_v2),A.normal.Copy(this.m_normal1)):(A.i1=1,A.i2=0,A.v1.Copy(this.m_v2),A.v2.Copy(this.m_v1),A.normal.Copy(this.m_normal1).SelfNeg())}else{var G,T;e.type=a.b2ManifoldType.e_faceB,(G=B[0]).v.Copy(this.m_v1),G.id.cf.indexA=0,G.id.cf.indexB=S.index,G.id.cf.typeA=s.b2ContactFeatureType.e_vertex,G.id.cf.typeB=s.b2ContactFeatureType.e_face,(T=B[1]).v.Copy(this.m_v2),T.id.cf.indexA=0,T.id.cf.indexB=S.index,T.id.cf.typeA=s.b2ContactFeatureType.e_vertex,T.id.cf.typeB=s.b2ContactFeatureType.e_face,A.i1=S.index,A.i2=(A.i1+1)%this.m_polygonB.count,A.v1.Copy(this.m_polygonB.vertices[A.i1]),A.v2.Copy(this.m_polygonB.vertices[A.i2]),A.normal.Copy(this.m_polygonB.normals[A.i1])}A.sideNormal1.Set(A.normal.y,-A.normal.x),A.sideNormal2.Copy(A.sideNormal1).SelfNeg(),A.sideOffset1=r.b2Vec2.DotVV(A.sideNormal1,A.v1),A.sideOffset2=r.b2Vec2.DotVV(A.sideNormal2,A.v2);var R=t.s_clipPoints1,F=t.s_clipPoints2;if(!(a.b2ClipSegmentToLine(R,B,A.sideNormal1,A.sideOffset1,A.i1)<n.b2_maxManifoldPoints||a.b2ClipSegmentToLine(F,R,A.sideNormal2,A.sideOffset2,A.i2)<n.b2_maxManifoldPoints)){S.type===o.e_edgeA?(e.localNormal.Copy(A.normal),e.localPoint.Copy(A.v1)):(e.localNormal.Copy(c.m_normals[A.i1]),e.localPoint.Copy(c.m_vertices[A.i1]));var O=0;for(C=0;C<n.b2_maxManifoldPoints;++C)if(r.b2Vec2.DotVV(A.normal,r.b2Vec2.SubVV(F[C].v,A.v1,r.b2Vec2.s_t0))<=this.m_radius){var L=e.points[O];S.type===o.e_edgeA?(r.b2Transform.MulTXV(this.m_xf,F[C].v,L.localPoint),L.id.Copy(F[C].id)):(L.localPoint.Copy(F[C].v),L.id.cf.typeA=F[C].id.cf.typeB,L.id.cf.typeB=F[C].id.cf.typeA,L.id.cf.indexA=F[C].id.cf.indexB,L.id.cf.indexB=F[C].id.cf.indexA),++O}e.pointCount=O}}}},t.prototype.ComputeEdgeSeparation=function(t){var e=t;e.type=o.e_edgeA,e.index=this.m_front?0:1,e.separation=n.b2_maxFloat;for(var i=0;i<this.m_polygonB.count;++i){var s=r.b2Vec2.DotVV(this.m_normal,r.b2Vec2.SubVV(this.m_polygonB.vertices[i],this.m_v1,r.b2Vec2.s_t0));s<e.separation&&(e.separation=s)}return e},t.prototype.ComputePolygonSeparation=function(e){var i=e;i.type=o.e_unknown,i.index=-1,i.separation=-n.b2_maxFloat;for(var s=t.s_perp.Set(-this.m_normal.y,this.m_normal.x),a=0;a<this.m_polygonB.count;++a){var l=r.b2Vec2.NegV(this.m_polygonB.normals[a],t.s_n),c=r.b2Vec2.DotVV(l,r.b2Vec2.SubVV(this.m_polygonB.vertices[a],this.m_v1,r.b2Vec2.s_t0)),u=r.b2Vec2.DotVV(l,r.b2Vec2.SubVV(this.m_polygonB.vertices[a],this.m_v2,r.b2Vec2.s_t0)),_=r.b2Min(c,u);if(_>this.m_radius)return i.type=o.e_edgeB,i.index=a,i.separation=_,i;if(r.b2Vec2.DotVV(l,s)>=0){if(r.b2Vec2.DotVV(r.b2Vec2.SubVV(l,this.m_upperLimit,r.b2Vec2.s_t0),this.m_normal)<-n.b2_angularSlop)continue}else if(r.b2Vec2.DotVV(r.b2Vec2.SubVV(l,this.m_lowerLimit,r.b2Vec2.s_t0),this.m_normal)<-n.b2_angularSlop)continue;_>i.separation&&(i.type=o.e_edgeB,i.index=a,i.separation=_)}return i},t.s_edge1=new r.b2Vec2,t.s_edge0=new r.b2Vec2,t.s_edge2=new r.b2Vec2,t.s_ie=a.b2ClipVertex.MakeArray(2),t.s_rf=new v,t.s_clipPoints1=a.b2ClipVertex.MakeArray(2),t.s_clipPoints2=a.b2ClipVertex.MakeArray(2),t.s_edgeAxis=new b,t.s_polygonAxis=new b,t.s_n=new r.b2Vec2,t.s_perp=new r.b2Vec2,t}());i.b2CollideEdgeAndPolygon=function(t,e,i,o,n){V.Collide(t,e,i,o,n)},cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","./b2Collision":"b2Collision"}],b2CollidePolygon:[function(t,e,i){"use strict";cc._RF.push(e,"6787anfQf1ADZ8Z0EyuYw0q","b2CollidePolygon"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2CollidePolygons=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Math"),r=t("./b2Collision"),s=t("./b2Collision"),a=new n.b2Vec2,l=new n.b2Vec2,c=new n.b2Vec2,u=new n.b2Vec2;function _(t,e,i,r,s){for(var _=t.m_vertices,p=t.m_normals,m=r.m_count,h=r.m_vertices,f=n.b2Rot.MulRV(e.q,p[i],a),d=n.b2Rot.MulTRV(s.q,f,l),b=0,y=o.b2_maxFloat,v=0;v<m;++v){var V=n.b2Vec2.DotVV(h[v],d);V<y&&(y=V,b=v)}var C=n.b2Transform.MulXV(e,_[i],c),g=n.b2Transform.MulXV(s,h[b],u);return n.b2Vec2.DotVV(n.b2Vec2.SubVV(g,C,n.b2Vec2.s_t0),f)}var p=new n.b2Vec2,m=new n.b2Vec2;function h(t,e,i,r,s){for(var a=e.m_count,l=e.m_normals,c=n.b2Vec2.SubVV(n.b2Transform.MulXV(s,r.m_centroid,n.b2Vec2.s_t0),n.b2Transform.MulXV(i,e.m_centroid,n.b2Vec2.s_t1),p),u=n.b2Rot.MulTRV(i.q,c,m),h=0,f=-o.b2_maxFloat,d=0;d<a;++d){var b=n.b2Vec2.DotVV(l[d],u);b>f&&(f=b,h=d)}var y=_(e,i,h,r,s),v=(h+a-1)%a,V=_(e,i,v,r,s),C=(h+1)%a,g=_(e,i,C,r,s),x=0,S=0,B=0;if(V>y&&V>g)B=-1,x=v,S=V;else{if(!(g>y))return t[0]=h,y;B=1,x=C,S=g}for(;(y=_(e,i,h=-1===B?(x+a-1)%a:(x+1)%a,r,s))>S;)x=h,S=y;return t[0]=x,S}var f=new n.b2Vec2;function d(t,e,i,s,a,l){for(var c=e.m_normals,u=a.m_count,_=a.m_vertices,p=a.m_normals,m=n.b2Rot.MulTRV(l.q,n.b2Rot.MulRV(i.q,c[s],n.b2Vec2.s_t0),f),h=0,d=o.b2_maxFloat,b=0;b<u;++b){var y=n.b2Vec2.DotVV(m,p[b]);y<d&&(d=y,h=b)}var v=h,V=(v+1)%u,C=t[0];n.b2Transform.MulXV(l,_[v],C.v);var g=C.id.cf;g.indexA=s,g.indexB=v,g.typeA=r.b2ContactFeatureType.e_face,g.typeB=r.b2ContactFeatureType.e_vertex;var x=t[1];n.b2Transform.MulXV(l,_[V],x.v);var S=x.id.cf;S.indexA=s,S.indexB=V,S.typeA=r.b2ContactFeatureType.e_face,S.typeB=r.b2ContactFeatureType.e_vertex}var b=s.b2ClipVertex.MakeArray(2),y=s.b2ClipVertex.MakeArray(2),v=s.b2ClipVertex.MakeArray(2),V=[0],C=[0],g=new n.b2Vec2,x=new n.b2Vec2,S=new n.b2Vec2,B=new n.b2Vec2,A=new n.b2Vec2,P=new n.b2Vec2,w=new n.b2Vec2,M=new n.b2Vec2;i.b2CollidePolygons=function(t,e,i,r,a){t.pointCount=0;var l=e.m_radius+r.m_radius,c=V;c[0]=0;var u=h(c,e,i,r,a);if(!(u>l)){var _=C;_[0]=0;var p=h(_,r,a,e,i);if(!(p>l)){var m,f,D,I,G=0,T=0;p>.98*u+.001?(m=r,f=e,D=a,I=i,G=_[0],t.type=s.b2ManifoldType.e_faceB,T=1):(m=e,f=r,D=i,I=a,G=c[0],t.type=s.b2ManifoldType.e_faceA,T=0);var R=b;d(R,m,D,G,f,I);var F=m.m_count,O=m.m_vertices,L=G,j=(G+1)%F,J=O[L],E=O[j],k=n.b2Vec2.SubVV(E,J,g);k.Normalize();var U=n.b2Vec2.CrossVOne(k,x),N=n.b2Vec2.MidVV(J,E,S),q=n.b2Rot.MulRV(D.q,k,A),z=n.b2Vec2.CrossVOne(q,B),W=n.b2Transform.MulXV(D,J,w),X=n.b2Transform.MulXV(D,E,M),Z=n.b2Vec2.DotVV(z,W),H=-n.b2Vec2.DotVV(q,W)+l,Q=n.b2Vec2.DotVV(q,X)+l,Y=y,K=v,$=n.b2Vec2.NegV(q,P);if(!(s.b2ClipSegmentToLine(Y,R,$,H,L)<2||s.b2ClipSegmentToLine(K,Y,q,Q,j)<2)){t.localNormal.Copy(U),t.localPoint.Copy(N);for(var tt=0,et=0;et<o.b2_maxManifoldPoints;++et){var it=K[et];if(n.b2Vec2.DotVV(z,it.v)-Z<=l){var ot=t.points[tt];if(n.b2Transform.MulTXV(I,it.v,ot.localPoint),ot.id.Copy(it.id),T){var nt=ot.id.cf;ot.id.cf.indexA=nt.indexB,ot.id.cf.indexB=nt.indexA,ot.id.cf.typeA=nt.typeB,ot.id.cf.typeB=nt.typeA}++tt}}t.pointCount=tt}}}},cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","./b2Collision":"b2Collision"}],b2Collision:[function(t,e,i){"use strict";cc._RF.push(e,"ebdfcamJyFD9pGPtPVXrh+5","b2Collision"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2TestOverlapShape=i.b2ClipSegmentToLine=i.b2TestOverlapAABB=i.b2AABB=i.b2RayCastOutput=i.b2RayCastInput=i.b2ClipVertex=i.b2GetPointStates=i.b2PointState=i.b2WorldManifold=i.b2Manifold=i.b2ManifoldType=i.b2ManifoldPoint=i.b2ContactID=i.b2ContactFeature=i.b2ContactFeatureType=void 0;var o,n=t("../Common/b2Settings"),r=t("../Common/b2Math"),s=t("./b2Distance");(function(t){t[t.e_vertex=0]="e_vertex",t[t.e_face=1]="e_face"})(o=i.b2ContactFeatureType||(i.b2ContactFeatureType={}));var a=function(){function t(){this._key=0,this._key_invalid=!1,this._indexA=0,this._indexB=0,this._typeA=0,this._typeB=0}return Object.defineProperty(t.prototype,"key",{get:function(){return this._key_invalid&&(this._key_invalid=!1,this._key=this._indexA|this._indexB<<8|this._typeA<<16|this._typeB<<24),this._key},set:function(t){this._key=t,this._key_invalid=!1,this._indexA=255&this._key,this._indexB=this._key>>8&255,this._typeA=this._key>>16&255,this._typeB=this._key>>24&255},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"indexA",{get:function(){return this._indexA},set:function(t){this._indexA=t,this._key_invalid=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"indexB",{get:function(){return this._indexB},set:function(t){this._indexB=t,this._key_invalid=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"typeA",{get:function(){return this._typeA},set:function(t){this._typeA=t,this._key_invalid=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"typeB",{get:function(){return this._typeB},set:function(t){this._typeB=t,this._key_invalid=!0},enumerable:!1,configurable:!0}),t}();i.b2ContactFeature=a;var l=function(){function t(){this.cf=new a}return t.prototype.Copy=function(t){return this.key=t.key,this},t.prototype.Clone=function(){return(new t).Copy(this)},Object.defineProperty(t.prototype,"key",{get:function(){return this.cf.key},set:function(t){this.cf.key=t},enumerable:!1,configurable:!0}),t}();i.b2ContactID=l;var c,u=function(){function t(){this.localPoint=new r.b2Vec2,this.normalImpulse=0,this.tangentImpulse=0,this.id=new l}return t.MakeArray=function(e){return n.b2MakeArray(e,function(){return new t})},t.prototype.Reset=function(){this.localPoint.SetZero(),this.normalImpulse=0,this.tangentImpulse=0,this.id.key=0},t.prototype.Copy=function(t){return this.localPoint.Copy(t.localPoint),this.normalImpulse=t.normalImpulse,this.tangentImpulse=t.tangentImpulse,this.id.Copy(t.id),this},t}();i.b2ManifoldPoint=u,function(t){t[t.e_unknown=-1]="e_unknown",t[t.e_circles=0]="e_circles",t[t.e_faceA=1]="e_faceA",t[t.e_faceB=2]="e_faceB"}(c=i.b2ManifoldType||(i.b2ManifoldType={}));var _=function(){function t(){this.points=u.MakeArray(n.b2_maxManifoldPoints),this.localNormal=new r.b2Vec2,this.localPoint=new r.b2Vec2,this.type=c.e_unknown,this.pointCount=0}return t.prototype.Reset=function(){for(var t=0;t<n.b2_maxManifoldPoints;++t)this.points[t].Reset();this.localNormal.SetZero(),this.localPoint.SetZero(),this.type=c.e_unknown,this.pointCount=0},t.prototype.Copy=function(t){this.pointCount=t.pointCount;for(var e=0;e<n.b2_maxManifoldPoints;++e)this.points[e].Copy(t.points[e]);return this.localNormal.Copy(t.localNormal),this.localPoint.Copy(t.localPoint),this.type=t.type,this},t.prototype.Clone=function(){return(new t).Copy(this)},t}();i.b2Manifold=_;var p,m=function(){function t(){this.normal=new r.b2Vec2,this.points=r.b2Vec2.MakeArray(n.b2_maxManifoldPoints),this.separations=n.b2MakeNumberArray(n.b2_maxManifoldPoints)}return t.prototype.Initialize=function(e,i,o,s,a){if(0!==e.pointCount)switch(e.type){case c.e_circles:this.normal.Set(1,0);var l=r.b2Transform.MulXV(i,e.localPoint,t.Initialize_s_pointA),u=r.b2Transform.MulXV(s,e.points[0].localPoint,t.Initialize_s_pointB);r.b2Vec2.DistanceSquaredVV(l,u)>n.b2_epsilon_sq&&r.b2Vec2.SubVV(u,l,this.normal).SelfNormalize();var _=r.b2Vec2.AddVMulSV(l,o,this.normal,t.Initialize_s_cA),p=r.b2Vec2.SubVMulSV(u,a,this.normal,t.Initialize_s_cB);r.b2Vec2.MidVV(_,p,this.points[0]),this.separations[0]=r.b2Vec2.DotVV(r.b2Vec2.SubVV(p,_,r.b2Vec2.s_t0),this.normal);break;case c.e_faceA:r.b2Rot.MulRV(i.q,e.localNormal,this.normal);for(var m=r.b2Transform.MulXV(i,e.localPoint,t.Initialize_s_planePoint),h=0;h<e.pointCount;++h){var f=r.b2Transform.MulXV(s,e.points[h].localPoint,t.Initialize_s_clipPoint),d=o-r.b2Vec2.DotVV(r.b2Vec2.SubVV(f,m,r.b2Vec2.s_t0),this.normal);_=r.b2Vec2.AddVMulSV(f,d,this.normal,t.Initialize_s_cA),p=r.b2Vec2.SubVMulSV(f,a,this.normal,t.Initialize_s_cB),r.b2Vec2.MidVV(_,p,this.points[h]),this.separations[h]=r.b2Vec2.DotVV(r.b2Vec2.SubVV(p,_,r.b2Vec2.s_t0),this.normal)}break;case c.e_faceB:for(r.b2Rot.MulRV(s.q,e.localNormal,this.normal),m=r.b2Transform.MulXV(s,e.localPoint,t.Initialize_s_planePoint),h=0;h<e.pointCount;++h)f=r.b2Transform.MulXV(i,e.points[h].localPoint,t.Initialize_s_clipPoint),d=a-r.b2Vec2.DotVV(r.b2Vec2.SubVV(f,m,r.b2Vec2.s_t0),this.normal),p=r.b2Vec2.AddVMulSV(f,d,this.normal,t.Initialize_s_cB),_=r.b2Vec2.SubVMulSV(f,o,this.normal,t.Initialize_s_cA),r.b2Vec2.MidVV(_,p,this.points[h]),this.separations[h]=r.b2Vec2.DotVV(r.b2Vec2.SubVV(_,p,r.b2Vec2.s_t0),this.normal);this.normal.SelfNeg()}},t.Initialize_s_pointA=new r.b2Vec2,t.Initialize_s_pointB=new r.b2Vec2,t.Initialize_s_cA=new r.b2Vec2,t.Initialize_s_cB=new r.b2Vec2,t.Initialize_s_planePoint=new r.b2Vec2,t.Initialize_s_clipPoint=new r.b2Vec2,t}();i.b2WorldManifold=m,function(t){t[t.b2_nullState=0]="b2_nullState",t[t.b2_addState=1]="b2_addState",t[t.b2_persistState=2]="b2_persistState",t[t.b2_removeState=3]="b2_removeState"}(p=i.b2PointState||(i.b2PointState={})),i.b2GetPointStates=function(t,e,i,o){var r;for(r=0;r<i.pointCount;++r){var s=i.points[r].id.key;t[r]=p.b2_removeState;for(var a=0,l=o.pointCount;a<l;++a)if(o.points[a].id.key===s){t[r]=p.b2_persistState;break}}for(;r<n.b2_maxManifoldPoints;++r)t[r]=p.b2_nullState;for(r=0;r<o.pointCount;++r)for(s=o.points[r].id.key,e[r]=p.b2_addState,a=0,l=i.pointCount;a<l;++a)if(i.points[a].id.key===s){e[r]=p.b2_persistState;break}for(;r<n.b2_maxManifoldPoints;++r)e[r]=p.b2_nullState};var h=function(){function t(){this.v=new r.b2Vec2,this.id=new l}return t.MakeArray=function(e){return n.b2MakeArray(e,function(){return new t})},t.prototype.Copy=function(t){return this.v.Copy(t.v),this.id.Copy(t.id),this},t}();i.b2ClipVertex=h;var f=function(){function t(){this.p1=new r.b2Vec2,this.p2=new r.b2Vec2,this.maxFraction=1}return t.prototype.Copy=function(t){return this.p1.Copy(t.p1),this.p2.Copy(t.p2),this.maxFraction=t.maxFraction,this},t}();i.b2RayCastInput=f;var d=function(){function t(){this.normal=new r.b2Vec2,this.fraction=0}return t.prototype.Copy=function(t){return this.normal.Copy(t.normal),this.fraction=t.fraction,this},t}();i.b2RayCastOutput=d;var b=function(){function t(){this.lowerBound=new r.b2Vec2,this.upperBound=new r.b2Vec2,this.m_cache_center=new r.b2Vec2,this.m_cache_extent=new r.b2Vec2}return t.prototype.Copy=function(t){return this.lowerBound.Copy(t.lowerBound),this.upperBound.Copy(t.upperBound),this},t.prototype.IsValid=function(){return!(!this.lowerBound.IsValid()||!this.upperBound.IsValid()||this.upperBound.x<this.lowerBound.x||this.upperBound.y<this.lowerBound.y)},t.prototype.GetCenter=function(){return r.b2Vec2.MidVV(this.lowerBound,this.upperBound,this.m_cache_center)},t.prototype.GetExtents=function(){return r.b2Vec2.ExtVV(this.lowerBound,this.upperBound,this.m_cache_extent)},t.prototype.GetPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))},t.prototype.Combine1=function(t){return this.lowerBound.x=r.b2Min(this.lowerBound.x,t.lowerBound.x),this.lowerBound.y=r.b2Min(this.lowerBound.y,t.lowerBound.y),this.upperBound.x=r.b2Max(this.upperBound.x,t.upperBound.x),this.upperBound.y=r.b2Max(this.upperBound.y,t.upperBound.y),this},t.prototype.Combine2=function(t,e){return this.lowerBound.x=r.b2Min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=r.b2Min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=r.b2Max(t.upperBound.x,e.upperBound.x),this.upperBound.y=r.b2Max(t.upperBound.y,e.upperBound.y),this},t.Combine=function(t,e,i){return i.Combine2(t,e),i},t.prototype.Contains=function(t){return!(this.lowerBound.x<=t.lowerBound.x||this.lowerBound.y<=t.lowerBound.y||t.upperBound.x<=this.upperBound.x||t.upperBound.y<=this.upperBound.y)},t.prototype.RayCast=function(t,e){var i,o,s=-n.b2_maxFloat,a=n.b2_maxFloat,l=e.p1.x,c=e.p1.y,u=e.p2.x-e.p1.x,_=e.p2.y-e.p1.y,p=r.b2Abs(u),m=r.b2Abs(_),h=t.normal;if(p<n.b2_epsilon){if(l<this.lowerBound.x||this.upperBound.x<l)return!1}else{var f=1/u,d=-1;if((i=(this.lowerBound.x-l)*f)>(o=(this.upperBound.x-l)*f)){var b=i;i=o,o=b,d=1}if(i>s&&(h.x=d,h.y=0,s=i),s>(a=r.b2Min(a,o)))return!1}if(m<n.b2_epsilon){if(c<this.lowerBound.y||this.upperBound.y<c)return!1}else if(f=1/_,d=-1,(i=(this.lowerBound.y-c)*f)>(o=(this.upperBound.y-c)*f)&&(b=i,i=o,o=b,d=1),i>s&&(h.x=0,h.y=d,s=i),s>(a=r.b2Min(a,o)))return!1;return!(s<0||e.maxFraction<s||(t.fraction=s,0))},t.prototype.TestContain=function(t){return!(t.x<this.lowerBound.x||this.upperBound.x<t.x||t.y<this.lowerBound.y||this.upperBound.y<t.y)},t.prototype.TestOverlap=function(t){return!(this.upperBound.x<t.lowerBound.x||this.upperBound.y<t.lowerBound.y||t.upperBound.x<this.lowerBound.x||t.upperBound.y<this.lowerBound.y)},t}();i.b2AABB=b,i.b2TestOverlapAABB=function(t,e){return!(t.upperBound.x<e.lowerBound.x||t.upperBound.y<e.lowerBound.y||e.upperBound.x<t.lowerBound.x||e.upperBound.y<t.lowerBound.y)},i.b2ClipSegmentToLine=function(t,e,i,n,s){var a=0,l=e[0],c=e[1],u=r.b2Vec2.DotVV(i,l.v)-n,_=r.b2Vec2.DotVV(i,c.v)-n;if(u<=0&&t[a++].Copy(l),_<=0&&t[a++].Copy(c),u*_<0){var p=u/(u-_),m=t[a].v;m.x=l.v.x+p*(c.v.x-l.v.x),m.y=l.v.y+p*(c.v.y-l.v.y);var h=t[a].id;h.cf.indexA=s,h.cf.indexB=l.id.cf.indexB,h.cf.typeA=o.e_vertex,h.cf.typeB=o.e_face,++a}return a};var y=new s.b2DistanceInput,v=new s.b2SimplexCache,V=new s.b2DistanceOutput;i.b2TestOverlapShape=function(t,e,i,o,r,a){var l=y.Reset();l.proxyA.SetShape(t,e),l.proxyB.SetShape(i,o),l.transformA.Copy(r),l.transformB.Copy(a),l.useRadii=!0;var c=v.Reset();c.count=0;var u=V.Reset();return s.b2Distance(u,c,l),u.distance<10*n.b2_epsilon},cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","./b2Distance":"b2Distance"}],b2ConstantAccelController:[function(t,e,i){"use strict";cc._RF.push(e,"2d21bxSTbFDPYQ1z5AkNul8","b2ConstantAccelController");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2ConstantAccelController=void 0;var r=t("./b2Controller"),s=t("../Common/b2Math"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.A=new s.b2Vec2(0,0),e}return n(e,t),e.prototype.Step=function(t){for(var i=s.b2Vec2.MulSV(t.dt,this.A,e.Step_s_dtA),o=this.m_bodyList;o;o=o.nextBody){var n=o.body;n.IsAwake()&&n.SetLinearVelocity(s.b2Vec2.AddVV(n.GetLinearVelocity(),i,s.b2Vec2.s_t0))}},e.prototype.Draw=function(){},e.Step_s_dtA=new s.b2Vec2,e}(r.b2Controller);i.b2ConstantAccelController=a,cc._RF.pop()},{"../Common/b2Math":"b2Math","./b2Controller":"b2Controller"}],b2ConstantForceController:[function(t,e,i){"use strict";cc._RF.push(e,"c9e22/97Z1C1agzPs8H+AKn","b2ConstantForceController");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2ConstantForceController=void 0;var r=t("./b2Controller"),s=t("../Common/b2Math"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.F=new s.b2Vec2(0,0),e}return n(e,t),e.prototype.Step=function(){for(var t=this.m_bodyList;t;t=t.nextBody){var e=t.body;e.IsAwake()&&e.ApplyForce(this.F,e.GetWorldCenter())}},e.prototype.Draw=function(){},e}(r.b2Controller);i.b2ConstantForceController=a,cc._RF.pop()},{"../Common/b2Math":"b2Math","./b2Controller":"b2Controller"}],b2ContactFactory:[function(t,e,i){"use strict";cc._RF.push(e,"e1bc6n6LPJBybUHGynpM85G","b2ContactFactory"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2ContactFactory=i.b2ContactRegister=void 0;var o=t("../../Collision/Shapes/b2Shape"),n=t("./b2CircleContact"),r=t("./b2PolygonContact"),s=t("./b2PolygonAndCircleContact"),a=t("./b2EdgeAndCircleContact"),l=t("./b2EdgeAndPolygonContact"),c=t("./b2ChainAndCircleContact"),u=t("./b2ChainAndPolygonContact"),_=function(){this.pool=[],this.createFcn=null,this.destroyFcn=null,this.primary=!1};i.b2ContactRegister=_;var p=function(){function t(){this.m_registers=[],this.InitializeRegisters()}return t.prototype.AddType=function(t,e,i,o){var n=[];function r(){return n.pop()||t()}function s(t){n.push(t)}this.m_registers[i][o].pool=n,this.m_registers[i][o].createFcn=r,this.m_registers[i][o].destroyFcn=s,this.m_registers[i][o].primary=!0,i!==o&&(this.m_registers[o][i].pool=n,this.m_registers[o][i].createFcn=r,this.m_registers[o][i].destroyFcn=s,this.m_registers[o][i].primary=!1)},t.prototype.InitializeRegisters=function(){for(var t=0;t<o.b2ShapeType.e_shapeTypeCount;t++){this.m_registers[t]=[];for(var e=0;e<o.b2ShapeType.e_shapeTypeCount;e++)this.m_registers[t][e]=new _}this.AddType(n.b2CircleContact.Create,n.b2CircleContact.Destroy,o.b2ShapeType.e_circleShape,o.b2ShapeType.e_circleShape),this.AddType(s.b2PolygonAndCircleContact.Create,s.b2PolygonAndCircleContact.Destroy,o.b2ShapeType.e_polygonShape,o.b2ShapeType.e_circleShape),this.AddType(r.b2PolygonContact.Create,r.b2PolygonContact.Destroy,o.b2ShapeType.e_polygonShape,o.b2ShapeType.e_polygonShape),this.AddType(a.b2EdgeAndCircleContact.Create,a.b2EdgeAndCircleContact.Destroy,o.b2ShapeType.e_edgeShape,o.b2ShapeType.e_circleShape),this.AddType(l.b2EdgeAndPolygonContact.Create,l.b2EdgeAndPolygonContact.Destroy,o.b2ShapeType.e_edgeShape,o.b2ShapeType.e_polygonShape),this.AddType(c.b2ChainAndCircleContact.Create,c.b2ChainAndCircleContact.Destroy,o.b2ShapeType.e_chainShape,o.b2ShapeType.e_circleShape),this.AddType(u.b2ChainAndPolygonContact.Create,u.b2ChainAndPolygonContact.Destroy,o.b2ShapeType.e_chainShape,o.b2ShapeType.e_polygonShape)},t.prototype.Create=function(t,e,i,o){var n=t.GetType(),r=i.GetType(),s=this.m_registers[n][r];if(s.createFcn){var a=s.createFcn();return s.primary?a.Reset(t,e,i,o):a.Reset(i,o,t,e),a}return null},t.prototype.Destroy=function(t){var e=t.m_fixtureA.GetType(),i=t.m_fixtureB.GetType(),o=this.m_registers[e][i];o.destroyFcn&&o.destroyFcn(t)},t}();i.b2ContactFactory=p,cc._RF.pop()},{"../../Collision/Shapes/b2Shape":"b2Shape","./b2ChainAndCircleContact":"b2ChainAndCircleContact","./b2ChainAndPolygonContact":"b2ChainAndPolygonContact","./b2CircleContact":"b2CircleContact","./b2EdgeAndCircleContact":"b2EdgeAndCircleContact","./b2EdgeAndPolygonContact":"b2EdgeAndPolygonContact","./b2PolygonAndCircleContact":"b2PolygonAndCircleContact","./b2PolygonContact":"b2PolygonContact"}],b2ContactManager:[function(t,e,i){"use strict";cc._RF.push(e,"fb036w03StLPJHX+hemZmrr","b2ContactManager"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2ContactManager=void 0;var o=t("../Collision/b2BroadPhase"),n=t("../Collision/b2Collision"),r=t("./Contacts/b2ContactFactory"),s=t("./b2Body"),a=t("./b2WorldCallbacks"),l=function(){function t(){this.m_broadPhase=new o.b2BroadPhase,this.m_contactList=null,this.m_contactCount=0,this.m_contactFilter=a.b2ContactFilter.b2_defaultFilter,this.m_contactListener=a.b2ContactListener.b2_defaultListener,this.m_contactFactory=new r.b2ContactFactory}return t.prototype.AddPair=function(t,e){var i=t.fixture,o=e.fixture,n=t.childIndex,r=e.childIndex,s=i.GetBody(),a=o.GetBody();if(s!==a){for(var l=a.GetContactList();l;){if(l.other===s){var c=l.contact.GetFixtureA(),u=l.contact.GetFixtureB(),_=l.contact.GetChildIndexA(),p=l.contact.GetChildIndexB();if(c===i&&u===o&&_===n&&p===r)return;if(c===o&&u===i&&_===r&&p===n)return}l=l.next}if(!this.m_contactFilter||this.m_contactFilter.ShouldCollide(i,o)){var m=this.m_contactFactory.Create(i,n,o,r);null!==m&&(i=m.GetFixtureA(),o=m.GetFixtureB(),n=m.GetChildIndexA(),r=m.GetChildIndexB(),s=i.m_body,a=o.m_body,m.m_prev=null,m.m_next=this.m_contactList,null!==this.m_contactList&&(this.m_contactList.m_prev=m),this.m_contactList=m,m.m_nodeA.other=a,m.m_nodeA.prev=null,m.m_nodeA.next=s.m_contactList,null!==s.m_contactList&&(s.m_contactList.prev=m.m_nodeA),s.m_contactList=m.m_nodeA,m.m_nodeB.other=s,m.m_nodeB.prev=null,m.m_nodeB.next=a.m_contactList,null!==a.m_contactList&&(a.m_contactList.prev=m.m_nodeB),a.m_contactList=m.m_nodeB,i.IsSensor()||o.IsSensor()||(s.SetAwake(!0),a.SetAwake(!0)),++this.m_contactCount)}}},t.prototype.FindNewContacts=function(){var t=this;this.m_broadPhase.UpdatePairs(function(e,i){t.AddPair(e,i)})},t.prototype.Destroy=function(t){var e=t.GetFixtureA(),i=t.GetFixtureB(),o=e.GetBody(),n=i.GetBody();this.m_contactListener&&t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_contactList&&(this.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA===o.m_contactList&&(o.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB===n.m_contactList&&(n.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&!e.IsSensor()&&!i.IsSensor()&&(e.GetBody().SetAwake(!0),i.GetBody().SetAwake(!0)),this.m_contactFactory.Destroy(t),--this.m_contactCount},t.prototype.Collide=function(){for(var t=this.m_contactList;t;){var e=t.GetFixtureA(),i=t.GetFixtureB(),o=t.GetChildIndexA(),r=t.GetChildIndexB(),a=e.GetBody(),l=i.GetBody();if(t.m_filterFlag){if(this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(e,i)){t=(_=t).m_next,this.Destroy(_);continue}t.m_filterFlag=!1}var c=a.IsAwake()&&a.m_type!==s.b2BodyType.b2_staticBody,u=l.IsAwake()&&l.m_type!==s.b2BodyType.b2_staticBody;if(c||u){var _,p=e.m_proxies[o].treeNode,m=i.m_proxies[r].treeNode;n.b2TestOverlapAABB(p.aabb,m.aabb)?(t.Update(this.m_contactListener),t=t.m_next):(t=(_=t).m_next,this.Destroy(_))}else t=t.m_next}},t}();i.b2ContactManager=l,cc._RF.pop()},{"../Collision/b2BroadPhase":"b2BroadPhase","../Collision/b2Collision":"b2Collision","./Contacts/b2ContactFactory":"b2ContactFactory","./b2Body":"b2Body","./b2WorldCallbacks":"b2WorldCallbacks"}],b2ContactSolver:[function(t,e,i){"use strict";cc._RF.push(e,"518e9kIscZK56VN0Vi58GtR","b2ContactSolver"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2ContactSolver=i.b2PositionSolverManifold=i.b2ContactSolverDef=i.b2ContactPositionConstraint=i.b2ContactVelocityConstraint=i.b2VelocityConstraintPoint=i.g_blockSolve=void 0;var o=t("../../Common/b2Settings"),n=t("../../Common/b2Math"),r=t("../../Collision/b2Collision"),s=t("../../Collision/b2Collision"),a=t("../b2TimeStep");i.g_blockSolve=!1;var l=function(){function t(){this.rA=new n.b2Vec2,this.rB=new n.b2Vec2,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}return t.MakeArray=function(e){return o.b2MakeArray(e,function(){return new t})},t}();i.b2VelocityConstraintPoint=l;var c=function(){function t(){this.points=l.MakeArray(o.b2_maxManifoldPoints),this.normal=new n.b2Vec2,this.tangent=new n.b2Vec2,this.normalMass=new n.b2Mat22,this.K=new n.b2Mat22,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.invIA=0,this.invIB=0,this.friction=0,this.restitution=0,this.tangentSpeed=0,this.pointCount=0,this.contactIndex=0}return t.MakeArray=function(e){return o.b2MakeArray(e,function(){return new t})},t}();i.b2ContactVelocityConstraint=c;var u=function(){function t(){this.localPoints=n.b2Vec2.MakeArray(o.b2_maxManifoldPoints),this.localNormal=new n.b2Vec2,this.localPoint=new n.b2Vec2,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.localCenterA=new n.b2Vec2,this.localCenterB=new n.b2Vec2,this.invIA=0,this.invIB=0,this.type=s.b2ManifoldType.e_unknown,this.radiusA=0,this.radiusB=0,this.pointCount=0}return t.MakeArray=function(e){return o.b2MakeArray(e,function(){return new t})},t}();i.b2ContactPositionConstraint=u;i.b2ContactSolverDef=function(){this.step=new a.b2TimeStep,this.count=0};var _=function(){function t(){this.normal=new n.b2Vec2,this.point=new n.b2Vec2,this.separation=0}return t.prototype.Initialize=function(e,i,o,r){var a=t.Initialize_s_pointA,l=t.Initialize_s_pointB,c=t.Initialize_s_planePoint,u=t.Initialize_s_clipPoint;switch(e.type){case s.b2ManifoldType.e_circles:n.b2Transform.MulXV(i,e.localPoint,a),n.b2Transform.MulXV(o,e.localPoints[0],l),n.b2Vec2.SubVV(l,a,this.normal).SelfNormalize(),n.b2Vec2.MidVV(a,l,this.point),this.separation=n.b2Vec2.DotVV(n.b2Vec2.SubVV(l,a,n.b2Vec2.s_t0),this.normal)-e.radiusA-e.radiusB;break;case s.b2ManifoldType.e_faceA:n.b2Rot.MulRV(i.q,e.localNormal,this.normal),n.b2Transform.MulXV(i,e.localPoint,c),n.b2Transform.MulXV(o,e.localPoints[r],u),this.separation=n.b2Vec2.DotVV(n.b2Vec2.SubVV(u,c,n.b2Vec2.s_t0),this.normal)-e.radiusA-e.radiusB,this.point.Copy(u);break;case s.b2ManifoldType.e_faceB:n.b2Rot.MulRV(o.q,e.localNormal,this.normal),n.b2Transform.MulXV(o,e.localPoint,c),n.b2Transform.MulXV(i,e.localPoints[r],u),this.separation=n.b2Vec2.DotVV(n.b2Vec2.SubVV(u,c,n.b2Vec2.s_t0),this.normal)-e.radiusA-e.radiusB,this.point.Copy(u),this.normal.SelfNeg()}},t.Initialize_s_pointA=new n.b2Vec2,t.Initialize_s_pointB=new n.b2Vec2,t.Initialize_s_planePoint=new n.b2Vec2,t.Initialize_s_clipPoint=new n.b2Vec2,t}();i.b2PositionSolverManifold=_;var p=function(){function t(){this.m_step=new a.b2TimeStep,this.m_positionConstraints=u.MakeArray(1024),this.m_velocityConstraints=c.MakeArray(1024),this.m_count=0}return t.prototype.Initialize=function(t){if(this.m_step.Copy(t.step),this.m_count=t.count,this.m_positionConstraints.length<this.m_count)for(var e=n.b2Max(2*this.m_positionConstraints.length,this.m_count);this.m_positionConstraints.length<e;)this.m_positionConstraints[this.m_positionConstraints.length]=new u;if(this.m_velocityConstraints.length<this.m_count)for(e=n.b2Max(2*this.m_velocityConstraints.length,this.m_count);this.m_velocityConstraints.length<e;)this.m_velocityConstraints[this.m_velocityConstraints.length]=new c;this.m_positions=t.positions,this.m_velocities=t.velocities,this.m_contacts=t.contacts;for(var i=0;i<this.m_count;++i){var o=this.m_contacts[i],r=o.m_fixtureA,s=o.m_fixtureB,a=r.GetShape(),l=s.GetShape(),_=a.m_radius,p=l.m_radius,m=r.GetBody(),h=s.GetBody(),f=o.GetManifold(),d=f.pointCount,b=this.m_velocityConstraints[i];b.friction=o.m_friction,b.restitution=o.m_restitution,b.tangentSpeed=o.m_tangentSpeed,b.indexA=m.m_islandIndex,b.indexB=h.m_islandIndex,b.invMassA=m.m_invMass,b.invMassB=h.m_invMass,b.invIA=m.m_invI,b.invIB=h.m_invI,b.contactIndex=i,b.pointCount=d,b.K.SetZero(),b.normalMass.SetZero();var y=this.m_positionConstraints[i];y.indexA=m.m_islandIndex,y.indexB=h.m_islandIndex,y.invMassA=m.m_invMass,y.invMassB=h.m_invMass,y.localCenterA.Copy(m.m_sweep.localCenter),y.localCenterB.Copy(h.m_sweep.localCenter),y.invIA=m.m_invI,y.invIB=h.m_invI,y.localNormal.Copy(f.localNormal),y.localPoint.Copy(f.localPoint),y.pointCount=d,y.radiusA=_,y.radiusB=p,y.type=f.type;for(var v=0;v<d;++v){var V=f.points[v],C=b.points[v];this.m_step.warmStarting?(C.normalImpulse=this.m_step.dtRatio*V.normalImpulse,C.tangentImpulse=this.m_step.dtRatio*V.tangentImpulse):(C.normalImpulse=0,C.tangentImpulse=0),C.rA.SetZero(),C.rB.SetZero(),C.normalMass=0,C.tangentMass=0,C.velocityBias=0,y.localPoints[v].Copy(V.localPoint)}}return this},t.prototype.InitializeVelocityConstraints=function(){for(var e=t.InitializeVelocityConstraints_s_xfA,r=t.InitializeVelocityConstraints_s_xfB,s=t.InitializeVelocityConstraints_s_worldManifold,a=0;a<this.m_count;++a){var l=this.m_velocityConstraints[a],c=this.m_positionConstraints[a],u=c.radiusA,_=c.radiusB,p=this.m_contacts[l.contactIndex].GetManifold(),m=l.indexA,h=l.indexB,f=l.invMassA,d=l.invMassB,b=l.invIA,y=l.invIB,v=c.localCenterA,V=c.localCenterB,C=this.m_positions[m].c,g=this.m_positions[m].a,x=this.m_velocities[m].v,S=this.m_velocities[m].w,B=this.m_positions[h].c,A=this.m_positions[h].a,P=this.m_velocities[h].v,w=this.m_velocities[h].w;e.q.SetAngle(g),r.q.SetAngle(A),n.b2Vec2.SubVV(C,n.b2Rot.MulRV(e.q,v,n.b2Vec2.s_t0),e.p),n.b2Vec2.SubVV(B,n.b2Rot.MulRV(r.q,V,n.b2Vec2.s_t0),r.p),s.Initialize(p,e,u,r,_),l.normal.Copy(s.normal),n.b2Vec2.CrossVOne(l.normal,l.tangent);for(var M=l.pointCount,D=0;D<M;++D){var I=l.points[D];n.b2Vec2.SubVV(s.points[D],C,I.rA),n.b2Vec2.SubVV(s.points[D],B,I.rB);var G=n.b2Vec2.CrossVV(I.rA,l.normal),T=n.b2Vec2.CrossVV(I.rB,l.normal),R=f+d+b*G*G+y*T*T;I.normalMass=R>0?1/R:0;var F=l.tangent,O=n.b2Vec2.CrossVV(I.rA,F),L=n.b2Vec2.CrossVV(I.rB,F),j=f+d+b*O*O+y*L*L;I.tangentMass=j>0?1/j:0,I.velocityBias=0;var J=n.b2Vec2.DotVV(l.normal,n.b2Vec2.SubVV(n.b2Vec2.AddVCrossSV(P,w,I.rB,n.b2Vec2.s_t0),n.b2Vec2.AddVCrossSV(x,S,I.rA,n.b2Vec2.s_t1),n.b2Vec2.s_t0));J<-o.b2_velocityThreshold&&(I.velocityBias+=-l.restitution*J)}if(2===l.pointCount&&i.g_blockSolve){var E=l.points[0],k=l.points[1],U=n.b2Vec2.CrossVV(E.rA,l.normal),N=n.b2Vec2.CrossVV(E.rB,l.normal),q=n.b2Vec2.CrossVV(k.rA,l.normal),z=n.b2Vec2.CrossVV(k.rB,l.normal),W=f+d+b*U*U+y*N*N,X=f+d+b*q*q+y*z*z,Z=f+d+b*U*q+y*N*z;W*W<1e3*(W*X-Z*Z)?(l.K.ex.Set(W,Z),l.K.ey.Set(Z,X),l.K.GetInverse(l.normalMass)):l.pointCount=1}}},t.prototype.WarmStart=function(){for(var e=t.WarmStart_s_P,i=0;i<this.m_count;++i){for(var o=this.m_velocityConstraints[i],r=o.indexA,s=o.indexB,a=o.invMassA,l=o.invIA,c=o.invMassB,u=o.invIB,_=o.pointCount,p=this.m_velocities[r].v,m=this.m_velocities[r].w,h=this.m_velocities[s].v,f=this.m_velocities[s].w,d=o.normal,b=o.tangent,y=0;y<_;++y){var v=o.points[y];n.b2Vec2.AddVV(n.b2Vec2.MulSV(v.normalImpulse,d,n.b2Vec2.s_t0),n.b2Vec2.MulSV(v.tangentImpulse,b,n.b2Vec2.s_t1),e),m-=l*n.b2Vec2.CrossVV(v.rA,e),p.SelfMulSub(a,e),f+=u*n.b2Vec2.CrossVV(v.rB,e),h.SelfMulAdd(c,e)}this.m_velocities[r].w=m,this.m_velocities[s].w=f}},t.prototype.SolveVelocityConstraints=function(){for(var e=t.SolveVelocityConstraints_s_dv,o=t.SolveVelocityConstraints_s_dv1,r=t.SolveVelocityConstraints_s_dv2,s=t.SolveVelocityConstraints_s_P,a=t.SolveVelocityConstraints_s_a,l=t.SolveVelocityConstraints_s_b,c=t.SolveVelocityConstraints_s_x,u=t.SolveVelocityConstraints_s_d,_=t.SolveVelocityConstraints_s_P1,p=t.SolveVelocityConstraints_s_P2,m=t.SolveVelocityConstraints_s_P1P2,h=0;h<this.m_count;++h){for(var f=this.m_velocityConstraints[h],d=f.indexA,b=f.indexB,y=f.invMassA,v=f.invIA,V=f.invMassB,C=f.invIB,g=f.pointCount,x=this.m_velocities[d].v,S=this.m_velocities[d].w,B=this.m_velocities[b].v,A=this.m_velocities[b].w,P=f.normal,w=f.tangent,M=f.friction,D=0;D<g;++D){var I=f.points[D];n.b2Vec2.SubVV(n.b2Vec2.AddVCrossSV(B,A,I.rB,n.b2Vec2.s_t0),n.b2Vec2.AddVCrossSV(x,S,I.rA,n.b2Vec2.s_t1),e);var G=n.b2Vec2.DotVV(e,w)-f.tangentSpeed,T=I.tangentMass*-G,R=M*I.normalImpulse;T=(F=n.b2Clamp(I.tangentImpulse+T,-R,R))-I.tangentImpulse,I.tangentImpulse=F,n.b2Vec2.MulSV(T,w,s),x.SelfMulSub(y,s),S-=v*n.b2Vec2.CrossVV(I.rA,s),B.SelfMulAdd(V,s),A+=C*n.b2Vec2.CrossVV(I.rB,s)}if(1===f.pointCount||!1===i.g_blockSolve)for(D=0;D<g;++D){I=f.points[D],n.b2Vec2.SubVV(n.b2Vec2.AddVCrossSV(B,A,I.rB,n.b2Vec2.s_t0),n.b2Vec2.AddVCrossSV(x,S,I.rA,n.b2Vec2.s_t1),e);var F,O=n.b2Vec2.DotVV(e,P);T=-I.normalMass*(O-I.velocityBias),T=(F=n.b2Max(I.normalImpulse+T,0))-I.normalImpulse,I.normalImpulse=F,n.b2Vec2.MulSV(T,P,s),x.SelfMulSub(y,s),S-=v*n.b2Vec2.CrossVV(I.rA,s),B.SelfMulAdd(V,s),A+=C*n.b2Vec2.CrossVV(I.rB,s)}else{var L=f.points[0],j=f.points[1];a.Set(L.normalImpulse,j.normalImpulse),n.b2Vec2.SubVV(n.b2Vec2.AddVCrossSV(B,A,L.rB,n.b2Vec2.s_t0),n.b2Vec2.AddVCrossSV(x,S,L.rA,n.b2Vec2.s_t1),o),n.b2Vec2.SubVV(n.b2Vec2.AddVCrossSV(B,A,j.rB,n.b2Vec2.s_t0),n.b2Vec2.AddVCrossSV(x,S,j.rA,n.b2Vec2.s_t1),r);var J=n.b2Vec2.DotVV(o,P),E=n.b2Vec2.DotVV(r,P);for(l.x=J-L.velocityBias,l.y=E-j.velocityBias,l.SelfSub(n.b2Mat22.MulMV(f.K,a,n.b2Vec2.s_t0));;){if(n.b2Mat22.MulMV(f.normalMass,l,c).SelfNeg(),c.x>=0&&c.y>=0){n.b2Vec2.SubVV(c,a,u),n.b2Vec2.MulSV(u.x,P,_),n.b2Vec2.MulSV(u.y,P,p),n.b2Vec2.AddVV(_,p,m),x.SelfMulSub(y,m),S-=v*(n.b2Vec2.CrossVV(L.rA,_)+n.b2Vec2.CrossVV(j.rA,p)),B.SelfMulAdd(V,m),A+=C*(n.b2Vec2.CrossVV(L.rB,_)+n.b2Vec2.CrossVV(j.rB,p)),L.normalImpulse=c.x,j.normalImpulse=c.y;break}if(c.x=-L.normalMass*l.x,c.y=0,J=0,E=f.K.ex.y*c.x+l.y,c.x>=0&&E>=0){n.b2Vec2.SubVV(c,a,u),n.b2Vec2.MulSV(u.x,P,_),n.b2Vec2.MulSV(u.y,P,p),n.b2Vec2.AddVV(_,p,m),x.SelfMulSub(y,m),S-=v*(n.b2Vec2.CrossVV(L.rA,_)+n.b2Vec2.CrossVV(j.rA,p)),B.SelfMulAdd(V,m),A+=C*(n.b2Vec2.CrossVV(L.rB,_)+n.b2Vec2.CrossVV(j.rB,p)),L.normalImpulse=c.x,j.normalImpulse=c.y;break}if(c.x=0,c.y=-j.normalMass*l.y,J=f.K.ey.x*c.y+l.x,E=0,c.y>=0&&J>=0){n.b2Vec2.SubVV(c,a,u),n.b2Vec2.MulSV(u.x,P,_),n.b2Vec2.MulSV(u.y,P,p),n.b2Vec2.AddVV(_,p,m),x.SelfMulSub(y,m),S-=v*(n.b2Vec2.CrossVV(L.rA,_)+n.b2Vec2.CrossVV(j.rA,p)),B.SelfMulAdd(V,m),A+=C*(n.b2Vec2.CrossVV(L.rB,_)+n.b2Vec2.CrossVV(j.rB,p)),L.normalImpulse=c.x,j.normalImpulse=c.y;break}if(c.x=0,c.y=0,J=l.x,E=l.y,J>=0&&E>=0){n.b2Vec2.SubVV(c,a,u),n.b2Vec2.MulSV(u.x,P,_),n.b2Vec2.MulSV(u.y,P,p),n.b2Vec2.AddVV(_,p,m),x.SelfMulSub(y,m),S-=v*(n.b2Vec2.CrossVV(L.rA,_)+n.b2Vec2.CrossVV(j.rA,p)),B.SelfMulAdd(V,m),A+=C*(n.b2Vec2.CrossVV(L.rB,_)+n.b2Vec2.CrossVV(j.rB,p)),L.normalImpulse=c.x,j.normalImpulse=c.y;break}break}}this.m_velocities[d].w=S,this.m_velocities[b].w=A}},t.prototype.StoreImpulses=function(){for(var t=0;t<this.m_count;++t)for(var e=this.m_velocityConstraints[t],i=this.m_contacts[e.contactIndex].GetManifold(),o=0;o<e.pointCount;++o)i.points[o].normalImpulse=e.points[o].normalImpulse,i.points[o].tangentImpulse=e.points[o].tangentImpulse},t.prototype.SolvePositionConstraints=function(){for(var e=t.SolvePositionConstraints_s_xfA,i=t.SolvePositionConstraints_s_xfB,r=t.SolvePositionConstraints_s_psm,s=t.SolvePositionConstraints_s_rA,a=t.SolvePositionConstraints_s_rB,l=t.SolvePositionConstraints_s_P,c=0,u=0;u<this.m_count;++u){for(var _=this.m_positionConstraints[u],p=_.indexA,m=_.indexB,h=_.localCenterA,f=_.invMassA,d=_.invIA,b=_.localCenterB,y=_.invMassB,v=_.invIB,V=_.pointCount,C=this.m_positions[p].c,g=this.m_positions[p].a,x=this.m_positions[m].c,S=this.m_positions[m].a,B=0;B<V;++B){e.q.SetAngle(g),i.q.SetAngle(S),n.b2Vec2.SubVV(C,n.b2Rot.MulRV(e.q,h,n.b2Vec2.s_t0),e.p),n.b2Vec2.SubVV(x,n.b2Rot.MulRV(i.q,b,n.b2Vec2.s_t0),i.p),r.Initialize(_,e,i,B);var A=r.normal,P=r.point,w=r.separation;n.b2Vec2.SubVV(P,C,s),n.b2Vec2.SubVV(P,x,a),c=n.b2Min(c,w);var M=n.b2Clamp(o.b2_baumgarte*(w+o.b2_linearSlop),-o.b2_maxLinearCorrection,0),D=n.b2Vec2.CrossVV(s,A),I=n.b2Vec2.CrossVV(a,A),G=f+y+d*D*D+v*I*I,T=G>0?-M/G:0;n.b2Vec2.MulSV(T,A,l),C.SelfMulSub(f,l),g-=d*n.b2Vec2.CrossVV(s,l),x.SelfMulAdd(y,l),S+=v*n.b2Vec2.CrossVV(a,l)}this.m_positions[p].a=g,this.m_positions[m].a=S}return c>-3*o.b2_linearSlop},t.prototype.SolveTOIPositionConstraints=function(e,i){for(var r=t.SolveTOIPositionConstraints_s_xfA,s=t.SolveTOIPositionConstraints_s_xfB,a=t.SolveTOIPositionConstraints_s_psm,l=t.SolveTOIPositionConstraints_s_rA,c=t.SolveTOIPositionConstraints_s_rB,u=t.SolveTOIPositionConstraints_s_P,_=0,p=0;p<this.m_count;++p){var m=this.m_positionConstraints[p],h=m.indexA,f=m.indexB,d=m.localCenterA,b=m.localCenterB,y=m.pointCount,v=0,V=0;h!==e&&h!==i||(v=m.invMassA,V=m.invIA);var C=0,g=0;f!==e&&f!==i||(C=m.invMassB,g=m.invIB);for(var x=this.m_positions[h].c,S=this.m_positions[h].a,B=this.m_positions[f].c,A=this.m_positions[f].a,P=0;P<y;++P){r.q.SetAngle(S),s.q.SetAngle(A),n.b2Vec2.SubVV(x,n.b2Rot.MulRV(r.q,d,n.b2Vec2.s_t0),r.p),n.b2Vec2.SubVV(B,n.b2Rot.MulRV(s.q,b,n.b2Vec2.s_t0),s.p),a.Initialize(m,r,s,P);var w=a.normal,M=a.point,D=a.separation;n.b2Vec2.SubVV(M,x,l),n.b2Vec2.SubVV(M,B,c),_=n.b2Min(_,D);var I=n.b2Clamp(o.b2_toiBaumgarte*(D+o.b2_linearSlop),-o.b2_maxLinearCorrection,0),G=n.b2Vec2.CrossVV(l,w),T=n.b2Vec2.CrossVV(c,w),R=v+C+V*G*G+g*T*T,F=R>0?-I/R:0;n.b2Vec2.MulSV(F,w,u),x.SelfMulSub(v,u),S-=V*n.b2Vec2.CrossVV(l,u),B.SelfMulAdd(C,u),A+=g*n.b2Vec2.CrossVV(c,u)}this.m_positions[h].a=S,this.m_positions[f].a=A}return _>=-1.5*o.b2_linearSlop},t.InitializeVelocityConstraints_s_xfA=new n.b2Transform,t.InitializeVelocityConstraints_s_xfB=new n.b2Transform,t.InitializeVelocityConstraints_s_worldManifold=new r.b2WorldManifold,t.WarmStart_s_P=new n.b2Vec2,t.SolveVelocityConstraints_s_dv=new n.b2Vec2,t.SolveVelocityConstraints_s_dv1=new n.b2Vec2,t.SolveVelocityConstraints_s_dv2=new n.b2Vec2,t.SolveVelocityConstraints_s_P=new n.b2Vec2,t.SolveVelocityConstraints_s_a=new n.b2Vec2,t.SolveVelocityConstraints_s_b=new n.b2Vec2,t.SolveVelocityConstraints_s_x=new n.b2Vec2,t.SolveVelocityConstraints_s_d=new n.b2Vec2,t.SolveVelocityConstraints_s_P1=new n.b2Vec2,t.SolveVelocityConstraints_s_P2=new n.b2Vec2,t.SolveVelocityConstraints_s_P1P2=new n.b2Vec2,t.SolvePositionConstraints_s_xfA=new n.b2Transform,t.SolvePositionConstraints_s_xfB=new n.b2Transform,t.SolvePositionConstraints_s_psm=new _,t.SolvePositionConstraints_s_rA=new n.b2Vec2,t.SolvePositionConstraints_s_rB=new n.b2Vec2,t.SolvePositionConstraints_s_P=new n.b2Vec2,t.SolveTOIPositionConstraints_s_xfA=new n.b2Transform,t.SolveTOIPositionConstraints_s_xfB=new n.b2Transform,t.SolveTOIPositionConstraints_s_psm=new _,t.SolveTOIPositionConstraints_s_rA=new n.b2Vec2,t.SolveTOIPositionConstraints_s_rB=new n.b2Vec2,t.SolveTOIPositionConstraints_s_P=new n.b2Vec2,t}();i.b2ContactSolver=p,cc._RF.pop()},{"../../Collision/b2Collision":"b2Collision","../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","../b2TimeStep":"b2TimeStep"}],b2Contact:[function(t,e,i){"use strict";cc._RF.push(e,"12a0aoWyslEUZlCwxqiVQYe","b2Contact"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Contact=i.b2ContactEdge=i.b2MixRestitution=i.b2MixFriction=void 0;var o=t("../../Common/b2Settings"),n=t("../../Common/b2Math"),r=t("../../Collision/b2Collision"),s=t("../../Collision/b2Collision"),a=t("../../Collision/b2TimeOfImpact");function l(t,e){return n.b2Sqrt(t*e)}function c(t,e){return t>e?t:e}i.b2MixFriction=l,i.b2MixRestitution=c;var u=function(){function t(t){this._other=null,this.prev=null,this.next=null,this.contact=t}return Object.defineProperty(t.prototype,"other",{get:function(){if(null===this._other)throw new Error;return this._other},set:function(t){if(null!==this._other)throw new Error;this._other=t},enumerable:!1,configurable:!0}),t.prototype.Reset=function(){this._other=null,this.prev=null,this.next=null},t}();i.b2ContactEdge=u;var _=function(){function t(){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_prev=null,this.m_next=null,this.m_nodeA=new u(this),this.m_nodeB=new u(this),this.m_indexA=0,this.m_indexB=0,this.m_manifold=new r.b2Manifold,this.m_toiCount=0,this.m_toi=0,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_oldManifold=new r.b2Manifold}return t.prototype.GetManifold=function(){return this.m_manifold},t.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),o=this.GetShapeA(),n=this.GetShapeB();t.Initialize(this.m_manifold,e.GetTransform(),o.m_radius,i.GetTransform(),n.m_radius)},t.prototype.IsTouching=function(){return this.m_touchingFlag},t.prototype.SetEnabled=function(t){this.m_enabledFlag=t},t.prototype.IsEnabled=function(){return this.m_enabledFlag},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetFixtureA=function(){return this.m_fixtureA},t.prototype.GetChildIndexA=function(){return this.m_indexA},t.prototype.GetShapeA=function(){return this.m_fixtureA.GetShape()},t.prototype.GetFixtureB=function(){return this.m_fixtureB},t.prototype.GetChildIndexB=function(){return this.m_indexB},t.prototype.GetShapeB=function(){return this.m_fixtureB.GetShape()},t.prototype.FlagForFiltering=function(){this.m_filterFlag=!0},t.prototype.SetFriction=function(t){this.m_friction=t},t.prototype.GetFriction=function(){return this.m_friction},t.prototype.ResetFriction=function(){this.m_friction=l(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)},t.prototype.SetRestitution=function(t){this.m_restitution=t},t.prototype.GetRestitution=function(){return this.m_restitution},t.prototype.ResetRestitution=function(){this.m_restitution=c(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},t.prototype.SetTangentSpeed=function(t){this.m_tangentSpeed=t},t.prototype.GetTangentSpeed=function(){return this.m_tangentSpeed},t.prototype.Reset=function(t,e,i,o){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!0,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_fixtureA=t,this.m_fixtureB=i,this.m_indexA=e,this.m_indexB=o,this.m_manifold.pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.Reset(),this.m_nodeB.Reset(),this.m_toiCount=0,this.m_friction=l(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=c(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},t.prototype.Update=function(t){var e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_enabledFlag=!0;var i=!1,o=this.m_touchingFlag,n=this.m_fixtureA.IsSensor(),r=this.m_fixtureB.IsSensor(),a=n||r,l=this.m_fixtureA.GetBody(),c=this.m_fixtureB.GetBody(),u=l.GetTransform(),_=c.GetTransform();if(a){var p=this.GetShapeA(),m=this.GetShapeB();i=s.b2TestOverlapShape(p,this.m_indexA,m,this.m_indexB,u,_),this.m_manifold.pointCount=0}else{this.Evaluate(this.m_manifold,u,_),i=this.m_manifold.pointCount>0;for(var h=0;h<this.m_manifold.pointCount;++h){var f=this.m_manifold.points[h];f.normalImpulse=0,f.tangentImpulse=0;for(var d=f.id,b=0;b<this.m_oldManifold.pointCount;++b){var y=this.m_oldManifold.points[b];if(y.id.key===d.key){f.normalImpulse=y.normalImpulse,f.tangentImpulse=y.tangentImpulse;break}}}i!==o&&(l.SetAwake(!0),c.SetAwake(!0))}this.m_touchingFlag=i,!o&&i&&t&&t.BeginContact(this),o&&!i&&t&&t.EndContact(this),!a&&i&&t&&t.PreSolve(this,this.m_oldManifold)},t.prototype.ComputeTOI=function(e,i){var n=t.ComputeTOI_s_input;n.proxyA.SetShape(this.GetShapeA(),this.m_indexA),n.proxyB.SetShape(this.GetShapeB(),this.m_indexB),n.sweepA.Copy(e),n.sweepB.Copy(i),n.tMax=o.b2_linearSlop;var r=t.ComputeTOI_s_output;return a.b2TimeOfImpact(r,n),r.t},t.ComputeTOI_s_input=new a.b2TOIInput,t.ComputeTOI_s_output=new a.b2TOIOutput,t}();i.b2Contact=_,cc._RF.pop()},{"../../Collision/b2Collision":"b2Collision","../../Collision/b2TimeOfImpact":"b2TimeOfImpact","../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings"}],b2Controller:[function(t,e,i){"use strict";cc._RF.push(e,"86e07gLsYJIpKUVqL94w9Ur","b2Controller"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Controller=i.b2ControllerEdge=void 0;var o=function(t,e){this.prevBody=null,this.nextBody=null,this.prevController=null,this.nextController=null,this.controller=t,this.body=e};i.b2ControllerEdge=o;var n=function(){function t(){this.m_bodyList=null,this.m_bodyCount=0,this.m_prev=null,this.m_next=null}return t.prototype.GetNext=function(){return this.m_next},t.prototype.GetPrev=function(){return this.m_prev},t.prototype.GetBodyList=function(){return this.m_bodyList},t.prototype.AddBody=function(t){var e=new o(this,t);e.nextBody=this.m_bodyList,e.prevBody=null,this.m_bodyList&&(this.m_bodyList.prevBody=e),this.m_bodyList=e,++this.m_bodyCount,e.nextController=t.m_controllerList,e.prevController=null,t.m_controllerList&&(t.m_controllerList.prevController=e),t.m_controllerList=e,++t.m_controllerCount},t.prototype.RemoveBody=function(t){if(this.m_bodyCount<=0)throw new Error;for(var e=this.m_bodyList;e&&e.body!==t;)e=e.nextBody;if(null===e)throw new Error;e.prevBody&&(e.prevBody.nextBody=e.nextBody),e.nextBody&&(e.nextBody.prevBody=e.prevBody),this.m_bodyList===e&&(this.m_bodyList=e.nextBody),--this.m_bodyCount,e.nextController&&(e.nextController.prevController=e.prevController),e.prevController&&(e.prevController.nextController=e.nextController),t.m_controllerList===e&&(t.m_controllerList=e.nextController),--t.m_controllerCount},t.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body);this.m_bodyCount=0},t}();i.b2Controller=n,cc._RF.pop()},{}],b2DistanceJoint:[function(t,e,i){"use strict";cc._RF.push(e,"22ea9Nve1FHAL6D7XbI2FcX","b2DistanceJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2DistanceJoint=i.b2DistanceJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=function(t){function e(){var e=t.call(this,a.b2JointType.e_distanceJoint)||this;return e.localAnchorA=new s.b2Vec2,e.localAnchorB=new s.b2Vec2,e.length=1,e.frequencyHz=0,e.dampingRatio=0,e}return n(e,t),e.prototype.Initialize=function(t,e,i,o){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(o,this.localAnchorB),this.length=s.b2Vec2.DistanceVV(i,o),this.frequencyHz=0,this.dampingRatio=0},e}(a.b2JointDef);i.b2DistanceJointDef=l;var c=function(t){function e(e){var i=t.call(this,e)||this;return i.m_frequencyHz=0,i.m_dampingRatio=0,i.m_bias=0,i.m_localAnchorA=new s.b2Vec2,i.m_localAnchorB=new s.b2Vec2,i.m_gamma=0,i.m_impulse=0,i.m_length=0,i.m_indexA=0,i.m_indexB=0,i.m_u=new s.b2Vec2,i.m_rA=new s.b2Vec2,i.m_rB=new s.b2Vec2,i.m_localCenterA=new s.b2Vec2,i.m_localCenterB=new s.b2Vec2,i.m_invMassA=0,i.m_invMassB=0,i.m_invIA=0,i.m_invIB=0,i.m_mass=0,i.m_qA=new s.b2Rot,i.m_qB=new s.b2Rot,i.m_lalcA=new s.b2Vec2,i.m_lalcB=new s.b2Vec2,i.m_frequencyHz=r.b2Maybe(e.frequencyHz,0),i.m_dampingRatio=r.b2Maybe(e.dampingRatio,0),i.m_localAnchorA.Copy(e.localAnchorA),i.m_localAnchorB.Copy(e.localAnchorB),i.m_length=e.length,i}return n(e,t),e.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)},e.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)},e.prototype.GetReactionForce=function(t,e){return e.x=t*this.m_impulse*this.m_u.x,e.y=t*this.m_impulse*this.m_u.y,e},e.prototype.GetReactionTorque=function(){return 0},e.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.SetLength=function(t){this.m_length=t},e.prototype.Length=function(){return this.m_length},e.prototype.SetFrequency=function(t){this.m_frequencyHz=t},e.prototype.GetFrequency=function(){return this.m_frequencyHz},e.prototype.SetDampingRatio=function(t){this.m_dampingRatio=t},e.prototype.GetDampingRatio=function(){return this.m_dampingRatio},e.prototype.Dump=function(t){var e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2DistanceJointDef = new b2DistanceJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.length = %.15f;\n",this.m_length),t("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),t("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},e.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v,a=t.velocities[this.m_indexA].w,l=t.positions[this.m_indexB].c,c=t.positions[this.m_indexB].a,u=t.velocities[this.m_indexB].v,_=t.velocities[this.m_indexB].w,p=this.m_qA.SetAngle(o),m=this.m_qB.SetAngle(c);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),s.b2Rot.MulRV(p,this.m_lalcA,this.m_rA),s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),s.b2Rot.MulRV(m,this.m_lalcB,this.m_rB),this.m_u.x=l.x+this.m_rB.x-i.x-this.m_rA.x,this.m_u.y=l.y+this.m_rB.y-i.y-this.m_rA.y;var h=this.m_u.Length();h>r.b2_linearSlop?this.m_u.SelfMul(1/h):this.m_u.SetZero();var f=s.b2Vec2.CrossVV(this.m_rA,this.m_u),d=s.b2Vec2.CrossVV(this.m_rB,this.m_u),b=this.m_invMassA+this.m_invIA*f*f+this.m_invMassB+this.m_invIB*d*d;if(this.m_mass=0!==b?1/b:0,this.m_frequencyHz>0){var y=h-this.m_length,v=2*r.b2_pi*this.m_frequencyHz,V=2*this.m_mass*this.m_dampingRatio*v,C=this.m_mass*v*v,g=t.step.dt;this.m_gamma=g*(V+g*C),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=y*g*C*this.m_gamma,b+=this.m_gamma,this.m_mass=0!==b?1/b:0}else this.m_gamma=0,this.m_bias=0;if(t.step.warmStarting){this.m_impulse*=t.step.dtRatio;var x=s.b2Vec2.MulSV(this.m_impulse,this.m_u,e.InitVelocityConstraints_s_P);n.SelfMulSub(this.m_invMassA,x),a-=this.m_invIA*s.b2Vec2.CrossVV(this.m_rA,x),u.SelfMulAdd(this.m_invMassB,x),_+=this.m_invIB*s.b2Vec2.CrossVV(this.m_rB,x)}else this.m_impulse=0;t.velocities[this.m_indexA].w=a,t.velocities[this.m_indexB].w=_},e.prototype.SolveVelocityConstraints=function(t){var i=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v,r=t.velocities[this.m_indexB].w,a=s.b2Vec2.AddVCrossSV(i,o,this.m_rA,e.SolveVelocityConstraints_s_vpA),l=s.b2Vec2.AddVCrossSV(n,r,this.m_rB,e.SolveVelocityConstraints_s_vpB),c=s.b2Vec2.DotVV(this.m_u,s.b2Vec2.SubVV(l,a,s.b2Vec2.s_t0)),u=-this.m_mass*(c+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=u;var _=s.b2Vec2.MulSV(u,this.m_u,e.SolveVelocityConstraints_s_P);i.SelfMulSub(this.m_invMassA,_),o-=this.m_invIA*s.b2Vec2.CrossVV(this.m_rA,_),n.SelfMulAdd(this.m_invMassB,_),r+=this.m_invIB*s.b2Vec2.CrossVV(this.m_rB,_),t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=r},e.prototype.SolvePositionConstraints=function(t){if(this.m_frequencyHz>0)return!0;var i=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,l=this.m_qA.SetAngle(o),c=this.m_qB.SetAngle(a),u=s.b2Rot.MulRV(l,this.m_lalcA,this.m_rA),_=s.b2Rot.MulRV(c,this.m_lalcB,this.m_rB),p=this.m_u;p.x=n.x+_.x-i.x-u.x,p.y=n.y+_.y-i.y-u.y;var m=this.m_u.Normalize()-this.m_length;m=s.b2Clamp(m,-r.b2_maxLinearCorrection,r.b2_maxLinearCorrection);var h=-this.m_mass*m,f=s.b2Vec2.MulSV(h,p,e.SolvePositionConstraints_s_P);return i.SelfMulSub(this.m_invMassA,f),o-=this.m_invIA*s.b2Vec2.CrossVV(u,f),n.SelfMulAdd(this.m_invMassB,f),a+=this.m_invIB*s.b2Vec2.CrossVV(_,f),t.positions[this.m_indexA].a=o,t.positions[this.m_indexB].a=a,s.b2Abs(m)<r.b2_linearSlop},e.InitVelocityConstraints_s_P=new s.b2Vec2,e.SolveVelocityConstraints_s_vpA=new s.b2Vec2,e.SolveVelocityConstraints_s_vpB=new s.b2Vec2,e.SolveVelocityConstraints_s_P=new s.b2Vec2,e.SolvePositionConstraints_s_P=new s.b2Vec2,e}(a.b2Joint);i.b2DistanceJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2Distance:[function(t,e,i){"use strict";cc._RF.push(e,"fcf85kg9ypNPZe5Vt7uTQrv","b2Distance"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2ShapeCast=i.b2Distance=i.b2Simplex=i.b2SimplexVertex=i.b2_gjk_reset=i.b2_gjkMaxIters=i.b2_gjkIters=i.b2_gjkCalls=i.b2ShapeCastOutput=i.b2ShapeCastInput=i.b2DistanceOutput=i.b2DistanceInput=i.b2SimplexCache=i.b2DistanceProxy=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Math"),r=function(){function t(){this.m_buffer=n.b2Vec2.MakeArray(2),this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0}return t.prototype.Copy=function(t){return t.m_vertices===t.m_buffer?(this.m_vertices=this.m_buffer,this.m_buffer[0].Copy(t.m_buffer[0]),this.m_buffer[1].Copy(t.m_buffer[1])):this.m_vertices=t.m_vertices,this.m_count=t.m_count,this.m_radius=t.m_radius,this},t.prototype.Reset=function(){return this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0,this},t.prototype.SetShape=function(t,e){t.SetupDistanceProxy(this,e)},t.prototype.SetVerticesRadius=function(t,e,i){this.m_vertices=t,this.m_count=e,this.m_radius=i},t.prototype.GetSupport=function(t){for(var e=0,i=n.b2Vec2.DotVV(this.m_vertices[0],t),o=1;o<this.m_count;++o){var r=n.b2Vec2.DotVV(this.m_vertices[o],t);r>i&&(e=o,i=r)}return e},t.prototype.GetSupportVertex=function(t){for(var e=0,i=n.b2Vec2.DotVV(this.m_vertices[0],t),o=1;o<this.m_count;++o){var r=n.b2Vec2.DotVV(this.m_vertices[o],t);r>i&&(e=o,i=r)}return this.m_vertices[e]},t.prototype.GetVertexCount=function(){return this.m_count},t.prototype.GetVertex=function(t){return this.m_vertices[t]},t}();i.b2DistanceProxy=r;var s=function(){function t(){this.metric=0,this.count=0,this.indexA=[0,0,0],this.indexB=[0,0,0]}return t.prototype.Reset=function(){return this.metric=0,this.count=0,this},t}();i.b2SimplexCache=s;var a=function(){function t(){this.proxyA=new r,this.proxyB=new r,this.transformA=new n.b2Transform,this.transformB=new n.b2Transform,this.useRadii=!1}return t.prototype.Reset=function(){return this.proxyA.Reset(),this.proxyB.Reset(),this.transformA.SetIdentity(),this.transformB.SetIdentity(),this.useRadii=!1,this},t}();i.b2DistanceInput=a;var l=function(){function t(){this.pointA=new n.b2Vec2,this.pointB=new n.b2Vec2,this.distance=0,this.iterations=0}return t.prototype.Reset=function(){return this.pointA.SetZero(),this.pointB.SetZero(),this.distance=0,this.iterations=0,this},t}();i.b2DistanceOutput=l;i.b2ShapeCastInput=function(){this.proxyA=new r,this.proxyB=new r,this.transformA=new n.b2Transform,this.transformB=new n.b2Transform,this.translationB=new n.b2Vec2};i.b2ShapeCastOutput=function(){this.point=new n.b2Vec2,this.normal=new n.b2Vec2,this.lambda=0,this.iterations=0},i.b2_gjkCalls=0,i.b2_gjkIters=0,i.b2_gjkMaxIters=0,i.b2_gjk_reset=function(){i.b2_gjkCalls=0,i.b2_gjkIters=0,i.b2_gjkMaxIters=0};var c=function(){function t(){this.wA=new n.b2Vec2,this.wB=new n.b2Vec2,this.w=new n.b2Vec2,this.a=0,this.indexA=0,this.indexB=0}return t.prototype.Copy=function(t){return this.wA.Copy(t.wA),this.wB.Copy(t.wB),this.w.Copy(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB,this},t}();i.b2SimplexVertex=c;var u=function(){function t(){this.m_v1=new c,this.m_v2=new c,this.m_v3=new c,this.m_vertices=[],this.m_count=0,this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3}return t.prototype.ReadCache=function(t,e,i,r,s){this.m_count=t.count;for(var a=this.m_vertices,l=0;l<this.m_count;++l){(m=a[l]).indexA=t.indexA[l],m.indexB=t.indexB[l];var c=e.GetVertex(m.indexA),u=r.GetVertex(m.indexB);n.b2Transform.MulXV(i,c,m.wA),n.b2Transform.MulXV(s,u,m.wB),n.b2Vec2.SubVV(m.wB,m.wA,m.w),m.a=0}if(this.m_count>1){var _=t.metric,p=this.GetMetric();(p<.5*_||2*_<p||p<o.b2_epsilon)&&(this.m_count=0)}var m;0===this.m_count&&((m=a[0]).indexA=0,m.indexB=0,c=e.GetVertex(0),u=r.GetVertex(0),n.b2Transform.MulXV(i,c,m.wA),n.b2Transform.MulXV(s,u,m.wB),n.b2Vec2.SubVV(m.wB,m.wA,m.w),m.a=1,this.m_count=1)},t.prototype.WriteCache=function(t){t.metric=this.GetMetric(),t.count=this.m_count;for(var e=this.m_vertices,i=0;i<this.m_count;++i)t.indexA[i]=e[i].indexA,t.indexB[i]=e[i].indexB},t.prototype.GetSearchDirection=function(t){switch(this.m_count){case 1:return n.b2Vec2.NegV(this.m_v1.w,t);case 2:var e=n.b2Vec2.SubVV(this.m_v2.w,this.m_v1.w,t);return n.b2Vec2.CrossVV(e,n.b2Vec2.NegV(this.m_v1.w,n.b2Vec2.s_t0))>0?n.b2Vec2.CrossOneV(e,t):n.b2Vec2.CrossVOne(e,t);default:return t.SetZero()}},t.prototype.GetClosestPoint=function(t){switch(this.m_count){case 0:return t.SetZero();case 1:return t.Copy(this.m_v1.w);case 2:return t.Set(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);case 3:default:return t.SetZero()}},t.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:break;case 1:t.Copy(this.m_v1.wA),e.Copy(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y}},t.prototype.GetMetric=function(){switch(this.m_count){case 0:case 1:return 0;case 2:return n.b2Vec2.DistanceVV(this.m_v1.w,this.m_v2.w);case 3:return n.b2Vec2.CrossVV(n.b2Vec2.SubVV(this.m_v2.w,this.m_v1.w,n.b2Vec2.s_t0),n.b2Vec2.SubVV(this.m_v3.w,this.m_v1.w,n.b2Vec2.s_t1));default:return 0}},t.prototype.Solve2=function(){var e=this.m_v1.w,i=this.m_v2.w,o=n.b2Vec2.SubVV(i,e,t.s_e12),r=-n.b2Vec2.DotVV(e,o);if(r<=0)return this.m_v1.a=1,void(this.m_count=1);var s=n.b2Vec2.DotVV(i,o);if(s<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);var a=1/(s+r);this.m_v1.a=s*a,this.m_v2.a=r*a,this.m_count=2},t.prototype.Solve3=function(){var e=this.m_v1.w,i=this.m_v2.w,o=this.m_v3.w,r=n.b2Vec2.SubVV(i,e,t.s_e12),s=n.b2Vec2.DotVV(e,r),a=n.b2Vec2.DotVV(i,r),l=-s,c=n.b2Vec2.SubVV(o,e,t.s_e13),u=n.b2Vec2.DotVV(e,c),_=n.b2Vec2.DotVV(o,c),p=-u,m=n.b2Vec2.SubVV(o,i,t.s_e23),h=n.b2Vec2.DotVV(i,m),f=n.b2Vec2.DotVV(o,m),d=-h,b=n.b2Vec2.CrossVV(r,c),y=b*n.b2Vec2.CrossVV(i,o),v=b*n.b2Vec2.CrossVV(o,e),V=b*n.b2Vec2.CrossVV(e,i);if(l<=0&&p<=0)return this.m_v1.a=1,void(this.m_count=1);if(a>0&&l>0&&V<=0){var C=1/(a+l);return this.m_v1.a=a*C,this.m_v2.a=l*C,void(this.m_count=2)}if(_>0&&p>0&&v<=0){var g=1/(_+p);return this.m_v1.a=_*g,this.m_v3.a=p*g,this.m_count=2,void this.m_v2.Copy(this.m_v3)}if(a<=0&&d<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);if(_<=0&&f<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v3);if(f>0&&d>0&&y<=0){var x=1/(f+d);return this.m_v2.a=f*x,this.m_v3.a=d*x,this.m_count=2,void this.m_v1.Copy(this.m_v3)}var S=1/(y+v+V);this.m_v1.a=y*S,this.m_v2.a=v*S,this.m_v3.a=V*S,this.m_count=3},t.s_e12=new n.b2Vec2,t.s_e13=new n.b2Vec2,t.s_e23=new n.b2Vec2,t}();i.b2Simplex=u;var _=new u,p=[0,0,0],m=[0,0,0],h=new n.b2Vec2,f=new n.b2Vec2,d=new n.b2Vec2,b=new n.b2Vec2,y=new n.b2Vec2;i.b2Distance=function(t,e,r){++i.b2_gjkCalls;var s=r.proxyA,a=r.proxyB,l=r.transformA,c=r.transformB,u=_;u.ReadCache(e,s,l,a,c);for(var v=u.m_vertices,V=p,C=m,g=0,x=0;x<20;){g=u.m_count;for(var S=0;S<g;++S)V[S]=v[S].indexA,C[S]=v[S].indexB;switch(u.m_count){case 1:break;case 2:u.Solve2();break;case 3:u.Solve3()}if(3===u.m_count)break;var B=u.GetSearchDirection(f);if(B.LengthSquared()<o.b2_epsilon_sq)break;var A=v[u.m_count];A.indexA=s.GetSupport(n.b2Rot.MulTRV(l.q,n.b2Vec2.NegV(B,n.b2Vec2.s_t0),b)),n.b2Transform.MulXV(l,s.GetVertex(A.indexA),A.wA),A.indexB=a.GetSupport(n.b2Rot.MulTRV(c.q,B,y)),n.b2Transform.MulXV(c,a.GetVertex(A.indexB),A.wB),n.b2Vec2.SubVV(A.wB,A.wA,A.w),++x,++i.b2_gjkIters;var P=!1;for(S=0;S<g;++S)if(A.indexA===V[S]&&A.indexB===C[S]){P=!0;break}if(P)break;++u.m_count}if(i.b2_gjkMaxIters=n.b2Max(i.b2_gjkMaxIters,x),u.GetWitnessPoints(t.pointA,t.pointB),t.distance=n.b2Vec2.DistanceVV(t.pointA,t.pointB),t.iterations=x,u.WriteCache(e),r.useRadii){var w=s.m_radius,M=a.m_radius;if(t.distance>w+M&&t.distance>o.b2_epsilon){t.distance-=w+M;var D=n.b2Vec2.SubVV(t.pointB,t.pointA,d);D.Normalize(),t.pointA.SelfMulAdd(w,D),t.pointB.SelfMulSub(M,D)}else{var I=n.b2Vec2.MidVV(t.pointA,t.pointB,h);t.pointA.Copy(I),t.pointB.Copy(I),t.distance=0}}};var v=new n.b2Vec2,V=new u,C=new n.b2Vec2,g=new n.b2Vec2,x=new n.b2Vec2,S=new n.b2Vec2,B=new n.b2Vec2,A=new n.b2Vec2;i.b2ShapeCast=function(t,e){t.iterations=0,t.lambda=1,t.normal.SetZero(),t.point.SetZero();var i=e.proxyA,r=e.proxyB,s=n.b2Max(i.m_radius,o.b2_polygonRadius)+n.b2Max(r.m_radius,o.b2_polygonRadius),a=e.transformA,l=e.transformB,c=e.translationB,u=v.Set(0,0),_=0,p=V;p.m_count=0;for(var m=p.m_vertices,h=i.GetSupport(n.b2Rot.MulTRV(a.q,n.b2Vec2.NegV(c,n.b2Vec2.s_t1),n.b2Vec2.s_t0)),f=n.b2Transform.MulXV(a,i.GetVertex(h),C),d=r.GetSupport(n.b2Rot.MulTRV(l.q,c,n.b2Vec2.s_t0)),b=n.b2Transform.MulXV(l,r.GetVertex(d),g),y=n.b2Vec2.SubVV(f,b,x),P=n.b2Max(o.b2_polygonRadius,s-o.b2_polygonRadius),w=.5*o.b2_linearSlop,M=0;M<20&&n.b2Abs(y.Length()-P)>w;){t.iterations+=1,h=i.GetSupport(n.b2Rot.MulTRV(a.q,n.b2Vec2.NegV(y,n.b2Vec2.s_t1),n.b2Vec2.s_t0)),f=n.b2Transform.MulXV(a,i.GetVertex(h),C),d=r.GetSupport(n.b2Rot.MulTRV(l.q,y,n.b2Vec2.s_t0)),b=n.b2Transform.MulXV(l,r.GetVertex(d),g);var D=n.b2Vec2.SubVV(f,b,S);y.Normalize();var I=n.b2Vec2.DotVV(y,D),G=n.b2Vec2.DotVV(y,c);if(I-P>_*G){if(G<=0)return!1;if((_=(I-P)/G)>1)return!1;u.Copy(y).SelfNeg(),p.m_count=0}var T=m[p.m_count];switch(T.indexA=d,T.wA.Copy(b).SelfMulAdd(_,c),T.indexB=h,T.wB.Copy(f),T.w.Copy(T.wB).SelfSub(T.wA),T.a=1,p.m_count+=1,p.m_count){case 1:break;case 2:p.Solve2();break;case 3:p.Solve3()}if(3===p.m_count)return!1;p.GetClosestPoint(y),++M}var R=B,F=A;return p.GetWitnessPoints(R,F),y.LengthSquared()>0&&(u.Copy(y).SelfNeg(),u.Normalize()),t.normal.Copy(u),t.lambda=_,t.iterations=M,!0},cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings"}],b2Draw:[function(t,e,i){"use strict";cc._RF.push(e,"4b649S24atMHIojI/iMMyVC","b2Draw"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Draw=i.b2DrawFlags=i.b2Color=void 0;var o=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t[0]instanceof Float32Array){if(4!==t[0].length)throw new Error;this.data=t[0]}else{var i="number"==typeof t[0]?t[0]:.5,o="number"==typeof t[1]?t[1]:.5,n="number"==typeof t[2]?t[2]:.5,r="number"==typeof t[3]?t[3]:1;this.data=new Float32Array([i,o,n,r])}}return Object.defineProperty(t.prototype,"r",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"g",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!1,configurable:!0}),t.prototype.Clone=function(){return(new t).Copy(this)},t.prototype.Copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},t.prototype.IsEqual=function(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},t.prototype.IsZero=function(){return 0===this.r&&0===this.g&&0===this.b&&0===this.a},t.prototype.Set=function(t,e,i,o){void 0===o&&(o=this.a),this.SetRGBA(t,e,i,o)},t.prototype.SetByteRGB=function(t,e,i){return this.r=t/255,this.g=e/255,this.b=i/255,this},t.prototype.SetByteRGBA=function(t,e,i,o){return this.r=t/255,this.g=e/255,this.b=i/255,this.a=o/255,this},t.prototype.SetRGB=function(t,e,i){return this.r=t,this.g=e,this.b=i,this},t.prototype.SetRGBA=function(t,e,i,o){return this.r=t,this.g=e,this.b=i,this.a=o,this},t.prototype.SelfAdd=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this},t.prototype.Add=function(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,e.a=this.a+t.a,e},t.prototype.SelfSub=function(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this.a-=t.a,this},t.prototype.Sub=function(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,e},t.prototype.SelfMul=function(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this},t.prototype.Mul=function(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,e},t.prototype.Mix=function(e,i){t.MixColors(this,e,i)},t.MixColors=function(t,e,i){var o=i*(e.r-t.r),n=i*(e.g-t.g),r=i*(e.b-t.b),s=i*(e.a-t.a);t.r+=o,t.g+=n,t.b+=r,t.a+=s,e.r-=o,e.g-=n,e.b-=r,e.a-=s},t.prototype.MakeStyleString=function(e){return void 0===e&&(e=this.a),t.MakeStyleString(this.r,this.g,this.b,e)},t.MakeStyleString=function(t,e,i,o){return void 0===o&&(o=1),t*=255,e*=255,i*=255,o<1?"rgba("+t+","+e+","+i+","+o+")":"rgb("+t+","+e+","+i+")"},t.ZERO=new t(0,0,0,0),t.RED=new t(1,0,0),t.GREEN=new t(0,1,0),t.BLUE=new t(0,0,1),t}();i.b2Color=o,function(t){t[t.e_none=0]="e_none",t[t.e_shapeBit=1]="e_shapeBit",t[t.e_jointBit=2]="e_jointBit",t[t.e_aabbBit=4]="e_aabbBit",t[t.e_pairBit=8]="e_pairBit",t[t.e_centerOfMassBit=16]="e_centerOfMassBit",t[t.e_particleBit=32]="e_particleBit",t[t.e_controllerBit=64]="e_controllerBit",t[t.e_all=63]="e_all"}(i.b2DrawFlags||(i.b2DrawFlags={}));var n=function(){function t(){this.m_drawFlags=0}return t.prototype.SetFlags=function(t){this.m_drawFlags=t},t.prototype.GetFlags=function(){return this.m_drawFlags},t.prototype.AppendFlags=function(t){this.m_drawFlags|=t},t.prototype.ClearFlags=function(t){this.m_drawFlags&=~t},t}();i.b2Draw=n,cc._RF.pop()},{}],b2DynamicTree:[function(t,e,i){"use strict";cc._RF.push(e,"795adJT5D1PmpT7m4ce0q7Y","b2DynamicTree"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2DynamicTree=i.b2TreeNode=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Math"),r=t("../Common/b2GrowableStack"),s=t("./b2Collision");function a(t){if(null===t)throw new Error;return t}var l=function(){function t(t){void 0===t&&(t=0),this.m_id=0,this.aabb=new s.b2AABB,this._userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=0,this.m_id=t}return Object.defineProperty(t.prototype,"userData",{get:function(){if(null===this._userData)throw new Error;return this._userData},set:function(t){if(null!==this._userData)throw new Error;this._userData=t},enumerable:!1,configurable:!0}),t.prototype.Reset=function(){this._userData=null},t.prototype.IsLeaf=function(){return null===this.child1},t}();i.b2TreeNode=l;var c=function(){function t(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0,this.m_stack=new r.b2GrowableStack(256)}return t.prototype.Query=function(t,e){var i=this.m_stack.Reset();for(i.Push(this.m_root);i.GetCount()>0;){var o=i.Pop();if(null!==o&&o.aabb.TestOverlap(t))if(o.IsLeaf()){if(!e(o))return}else i.Push(o.child1),i.Push(o.child2)}},t.prototype.QueryPoint=function(t,e){var i=this.m_stack.Reset();for(i.Push(this.m_root);i.GetCount()>0;){var o=i.Pop();if(null!==o&&o.aabb.TestContain(t))if(o.IsLeaf()){if(!e(o))return}else i.Push(o.child1),i.Push(o.child2)}},t.prototype.RayCast=function(e,i){var o=e.p1,r=e.p2,a=n.b2Vec2.SubVV(r,o,t.s_r);a.Normalize();var l=n.b2Vec2.CrossOneV(a,t.s_v),c=n.b2Vec2.AbsV(l,t.s_abs_v),u=e.maxFraction,_=t.s_segmentAABB,p=o.x+u*(r.x-o.x),m=o.y+u*(r.y-o.y);_.lowerBound.x=n.b2Min(o.x,p),_.lowerBound.y=n.b2Min(o.y,m),_.upperBound.x=n.b2Max(o.x,p),_.upperBound.y=n.b2Max(o.y,m);var h=this.m_stack.Reset();for(h.Push(this.m_root);h.GetCount()>0;){var f=h.Pop();if(null!==f&&s.b2TestOverlapAABB(f.aabb,_)){var d=f.aabb.GetCenter(),b=f.aabb.GetExtents();if(!(n.b2Abs(n.b2Vec2.DotVV(l,n.b2Vec2.SubVV(o,d,n.b2Vec2.s_t0)))-n.b2Vec2.DotVV(c,b)>0))if(f.IsLeaf()){var y=t.s_subInput;y.p1.Copy(e.p1),y.p2.Copy(e.p2),y.maxFraction=u;var v=i(y,f);if(0===v)return;v>0&&(u=v,p=o.x+u*(r.x-o.x),m=o.y+u*(r.y-o.y),_.lowerBound.x=n.b2Min(o.x,p),_.lowerBound.y=n.b2Min(o.y,m),_.upperBound.x=n.b2Max(o.x,p),_.upperBound.y=n.b2Max(o.y,m))}else h.Push(f.child1),h.Push(f.child2)}}},t.prototype.AllocateNode=function(){if(null!==this.m_freeList){var e=this.m_freeList;return this.m_freeList=e.parent,e.parent=null,e.child1=null,e.child2=null,e.height=0,e}return new l(t.s_node_id++)},t.prototype.FreeNode=function(t){t.parent=this.m_freeList,t.child1=null,t.child2=null,t.height=-1,t.Reset(),this.m_freeList=t},t.prototype.CreateProxy=function(t,e){var i=this.AllocateNode(),n=o.b2_aabbExtension,r=o.b2_aabbExtension;return i.aabb.lowerBound.x=t.lowerBound.x-n,i.aabb.lowerBound.y=t.lowerBound.y-r,i.aabb.upperBound.x=t.upperBound.x+n,i.aabb.upperBound.y=t.upperBound.y+r,i.userData=e,i.height=0,this.InsertLeaf(i),i},t.prototype.DestroyProxy=function(t){this.RemoveLeaf(t),this.FreeNode(t)},t.prototype.MoveProxy=function(t,e,i){if(t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var n=o.b2_aabbExtension,r=o.b2_aabbExtension;t.aabb.lowerBound.x=e.lowerBound.x-n,t.aabb.lowerBound.y=e.lowerBound.y-r,t.aabb.upperBound.x=e.upperBound.x+n,t.aabb.upperBound.y=e.upperBound.y+r;var s=o.b2_aabbMultiplier*i.x,a=o.b2_aabbMultiplier*i.y;return s<0?t.aabb.lowerBound.x+=s:t.aabb.upperBound.x+=s,a<0?t.aabb.lowerBound.y+=a:t.aabb.upperBound.y+=a,this.InsertLeaf(t),!0},t.prototype.InsertLeaf=function(e){if(++this.m_insertionCount,null===this.m_root)return this.m_root=e,void(this.m_root.parent=null);for(var i=e.aabb,o=this.m_root;!o.IsLeaf();){var r=a(o.child1),s=a(o.child2),l=o.aabb.GetPerimeter(),c=t.s_combinedAABB;c.Combine2(o.aabb,i);var u=c.GetPerimeter(),_=2*u,p=2*(u-l),m=void 0,h=t.s_aabb,f=void 0;r.IsLeaf()?(h.Combine2(i,r.aabb),m=h.GetPerimeter()+p):(h.Combine2(i,r.aabb),f=r.aabb.GetPerimeter(),m=h.GetPerimeter()-f+p);var d=void 0;if(s.IsLeaf()?(h.Combine2(i,s.aabb),d=h.GetPerimeter()+p):(h.Combine2(i,s.aabb),f=s.aabb.GetPerimeter(),d=h.GetPerimeter()-f+p),_<m&&_<d)break;o=m<d?r:s}var b=o.parent,y=this.AllocateNode();y.parent=b,y.aabb.Combine2(i,o.aabb),y.height=o.height+1,null!==b?(b.child1===o?b.child1=y:b.child2=y,y.child1=o,y.child2=e,o.parent=y,e.parent=y):(y.child1=o,y.child2=e,o.parent=y,e.parent=y,this.m_root=y);for(var v=e.parent;null!==v;)r=a((v=this.Balance(v)).child1),s=a(v.child2),v.height=1+n.b2Max(r.height,s.height),v.aabb.Combine2(r.aabb,s.aabb),v=v.parent},t.prototype.RemoveLeaf=function(t){if(t!==this.m_root){var e=a(t.parent),i=e&&e.parent,o=a(e.child1===t?e.child2:e.child1);if(null!==i){i.child1===e?i.child1=o:i.child2=o,o.parent=i,this.FreeNode(e);for(var r=i;null!==r;){var s=a((r=this.Balance(r)).child1),l=a(r.child2);r.aabb.Combine2(s.aabb,l.aabb),r.height=1+n.b2Max(s.height,l.height),r=r.parent}}else this.m_root=o,o.parent=null,this.FreeNode(e)}else this.m_root=null},t.prototype.Balance=function(t){if(t.IsLeaf()||t.height<2)return t;var e=a(t.child1),i=a(t.child2),o=i.height-e.height;if(o>1){var r=a(i.child1),s=a(i.child2);return i.child1=t,i.parent=t.parent,t.parent=i,null!==i.parent?i.parent.child1===t?i.parent.child1=i:i.parent.child2=i:this.m_root=i,r.height>s.height?(i.child2=r,t.child2=s,s.parent=t,t.aabb.Combine2(e.aabb,s.aabb),i.aabb.Combine2(t.aabb,r.aabb),t.height=1+n.b2Max(e.height,s.height),i.height=1+n.b2Max(t.height,r.height)):(i.child2=s,t.child2=r,r.parent=t,t.aabb.Combine2(e.aabb,r.aabb),i.aabb.Combine2(t.aabb,s.aabb),t.height=1+n.b2Max(e.height,r.height),i.height=1+n.b2Max(t.height,s.height)),i}if(o<-1){var l=a(e.child1),c=a(e.child2);return e.child1=t,e.parent=t.parent,t.parent=e,null!==e.parent?e.parent.child1===t?e.parent.child1=e:e.parent.child2=e:this.m_root=e,l.height>c.height?(e.child2=l,t.child1=c,c.parent=t,t.aabb.Combine2(i.aabb,c.aabb),e.aabb.Combine2(t.aabb,l.aabb),t.height=1+n.b2Max(i.height,c.height),e.height=1+n.b2Max(t.height,l.height)):(e.child2=c,t.child1=l,l.parent=t,t.aabb.Combine2(i.aabb,l.aabb),e.aabb.Combine2(t.aabb,c.aabb),t.height=1+n.b2Max(i.height,l.height),e.height=1+n.b2Max(t.height,c.height)),e}return t},t.prototype.GetHeight=function(){return null===this.m_root?0:this.m_root.height},t.GetAreaNode=function(e){if(null===e)return 0;if(e.IsLeaf())return 0;var i=e.aabb.GetPerimeter();return(i+=t.GetAreaNode(e.child1))+t.GetAreaNode(e.child2)},t.prototype.GetAreaRatio=function(){if(null===this.m_root)return 0;var e=this.m_root.aabb.GetPerimeter();return t.GetAreaNode(this.m_root)/e},t.ComputeHeightNode=function(e){if(null===e)return 0;if(e.IsLeaf())return 0;var i=t.ComputeHeightNode(e.child1),o=t.ComputeHeightNode(e.child2);return 1+n.b2Max(i,o)},t.prototype.ComputeHeight=function(){return t.ComputeHeightNode(this.m_root)},t.prototype.ValidateStructure=function(t){if(null!==t&&(this.m_root,!t.IsLeaf())){var e=a(t.child1),i=a(t.child2);this.ValidateStructure(e),this.ValidateStructure(i)}},t.prototype.ValidateMetrics=function(e){if(null!==e&&!e.IsLeaf()){var i=a(e.child1),o=a(e.child2);t.s_aabb.Combine2(i.aabb,o.aabb),this.ValidateMetrics(i),this.ValidateMetrics(o)}},t.prototype.Validate=function(){},t.GetMaxBalanceNode=function(t,e){if(null===t)return e;if(t.height<=1)return e;var i=a(t.child1),o=a(t.child2),r=n.b2Abs(o.height-i.height);return n.b2Max(e,r)},t.prototype.GetMaxBalance=function(){return t.GetMaxBalanceNode(this.m_root,0)},t.prototype.RebuildBottomUp=function(){this.Validate()},t.ShiftOriginNode=function(e,i){if(null!==e&&!(e.height<=1)){var o=e.child1,n=e.child2;t.ShiftOriginNode(o,i),t.ShiftOriginNode(n,i),e.aabb.lowerBound.SelfSub(i),e.aabb.upperBound.SelfSub(i)}},t.prototype.ShiftOrigin=function(e){t.ShiftOriginNode(this.m_root,e)},t.s_r=new n.b2Vec2,t.s_v=new n.b2Vec2,t.s_abs_v=new n.b2Vec2,t.s_segmentAABB=new s.b2AABB,t.s_subInput=new s.b2RayCastInput,t.s_combinedAABB=new s.b2AABB,t.s_aabb=new s.b2AABB,t.s_node_id=0,t}();i.b2DynamicTree=c,cc._RF.pop()},{"../Common/b2GrowableStack":"b2GrowableStack","../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","./b2Collision":"b2Collision"}],b2EdgeAndCircleContact:[function(t,e,i){"use strict";cc._RF.push(e,"ad23fJqMxFLYZXGrs9Cl/2Q","b2EdgeAndCircleContact");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2EdgeAndCircleContact=void 0;var r=t("../../Collision/b2CollideEdge"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(){return new e},e.Destroy=function(){},e.prototype.Evaluate=function(t,e,i){r.b2CollideEdgeAndCircle(t,this.GetShapeA(),e,this.GetShapeB(),i)},e}(t("./b2Contact").b2Contact);i.b2EdgeAndCircleContact=s,cc._RF.pop()},{"../../Collision/b2CollideEdge":"b2CollideEdge","./b2Contact":"b2Contact"}],b2EdgeAndPolygonContact:[function(t,e,i){"use strict";cc._RF.push(e,"908d2xvsCtC6qJ2FEmGX+wU","b2EdgeAndPolygonContact");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2EdgeAndPolygonContact=void 0;var r=t("../../Collision/b2CollideEdge"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(){return new e},e.Destroy=function(){},e.prototype.Evaluate=function(t,e,i){r.b2CollideEdgeAndPolygon(t,this.GetShapeA(),e,this.GetShapeB(),i)},e}(t("./b2Contact").b2Contact);i.b2EdgeAndPolygonContact=s,cc._RF.pop()},{"../../Collision/b2CollideEdge":"b2CollideEdge","./b2Contact":"b2Contact"}],b2EdgeShape:[function(t,e,i){"use strict";cc._RF.push(e,"bab28JwkihL05eo4nvQn5vi","b2EdgeShape");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2EdgeShape=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Shape"),l=function(t){function e(){var e=t.call(this,a.b2ShapeType.e_edgeShape,r.b2_polygonRadius)||this;return e.m_vertex1=new s.b2Vec2,e.m_vertex2=new s.b2Vec2,e.m_vertex0=new s.b2Vec2,e.m_vertex3=new s.b2Vec2,e.m_hasVertex0=!1,e.m_hasVertex3=!1,e}return n(e,t),e.prototype.Set=function(t,e){return this.m_vertex1.Copy(t),this.m_vertex2.Copy(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this},e.prototype.Clone=function(){return(new e).Copy(this)},e.prototype.Copy=function(e){return t.prototype.Copy.call(this,e),this.m_vertex1.Copy(e.m_vertex1),this.m_vertex2.Copy(e.m_vertex2),this.m_vertex0.Copy(e.m_vertex0),this.m_vertex3.Copy(e.m_vertex3),this.m_hasVertex0=e.m_hasVertex0,this.m_hasVertex3=e.m_hasVertex3,this},e.prototype.GetChildCount=function(){return 1},e.prototype.TestPoint=function(){return!1},e.prototype.ComputeDistance=function(t,i,o){var n=s.b2Transform.MulXV(t,this.m_vertex1,e.ComputeDistance_s_v1),r=s.b2Transform.MulXV(t,this.m_vertex2,e.ComputeDistance_s_v2),a=s.b2Vec2.SubVV(i,n,e.ComputeDistance_s_d),l=s.b2Vec2.SubVV(r,n,e.ComputeDistance_s_s),c=s.b2Vec2.DotVV(a,l);if(c>0){var u=s.b2Vec2.DotVV(l,l);c>u?s.b2Vec2.SubVV(i,r,a):a.SelfMulSub(c/u,l)}return o.Copy(a),o.Normalize()},e.prototype.RayCast=function(t,i,o){var n=s.b2Transform.MulTXV(o,i.p1,e.RayCast_s_p1),r=s.b2Transform.MulTXV(o,i.p2,e.RayCast_s_p2),a=s.b2Vec2.SubVV(r,n,e.RayCast_s_d),l=this.m_vertex1,c=this.m_vertex2,u=s.b2Vec2.SubVV(c,l,e.RayCast_s_e),_=t.normal.Set(u.y,-u.x).SelfNormalize(),p=s.b2Vec2.DotVV(_,s.b2Vec2.SubVV(l,n,s.b2Vec2.s_t0)),m=s.b2Vec2.DotVV(_,a);if(0===m)return!1;var h=p/m;if(h<0||i.maxFraction<h)return!1;var f=s.b2Vec2.AddVMulSV(n,h,a,e.RayCast_s_q),d=s.b2Vec2.SubVV(c,l,e.RayCast_s_r),b=s.b2Vec2.DotVV(d,d);if(0===b)return!1;var y=s.b2Vec2.DotVV(s.b2Vec2.SubVV(f,l,s.b2Vec2.s_t0),d)/b;return!(y<0||1<y||(t.fraction=h,s.b2Rot.MulRV(o.q,t.normal,t.normal),p>0&&t.normal.SelfNeg(),0))},e.prototype.ComputeAABB=function(t,i){var o=s.b2Transform.MulXV(i,this.m_vertex1,e.ComputeAABB_s_v1),n=s.b2Transform.MulXV(i,this.m_vertex2,e.ComputeAABB_s_v2);s.b2Vec2.MinV(o,n,t.lowerBound),s.b2Vec2.MaxV(o,n,t.upperBound);var r=this.m_radius;t.lowerBound.SelfSubXY(r,r),t.upperBound.SelfAddXY(r,r)},e.prototype.ComputeMass=function(t){t.mass=0,s.b2Vec2.MidVV(this.m_vertex1,this.m_vertex2,t.center),t.I=0},e.prototype.SetupDistanceProxy=function(t){t.m_vertices=t.m_buffer,t.m_vertices[0].Copy(this.m_vertex1),t.m_vertices[1].Copy(this.m_vertex2),t.m_count=2,t.m_radius=this.m_radius},e.prototype.ComputeSubmergedArea=function(t,e,i,o){return o.SetZero(),0},e.prototype.Dump=function(t){t("    const shape: b2EdgeShape = new b2EdgeShape();\n"),t("    shape.m_radius = %.15f;\n",this.m_radius),t("    shape.m_vertex0.Set(%.15f, %.15f);\n",this.m_vertex0.x,this.m_vertex0.y),t("    shape.m_vertex1.Set(%.15f, %.15f);\n",this.m_vertex1.x,this.m_vertex1.y),t("    shape.m_vertex2.Set(%.15f, %.15f);\n",this.m_vertex2.x,this.m_vertex2.y),t("    shape.m_vertex3.Set(%.15f, %.15f);\n",this.m_vertex3.x,this.m_vertex3.y),t("    shape.m_hasVertex0 = %s;\n",this.m_hasVertex0),t("    shape.m_hasVertex3 = %s;\n",this.m_hasVertex3)},e.ComputeDistance_s_v1=new s.b2Vec2,e.ComputeDistance_s_v2=new s.b2Vec2,e.ComputeDistance_s_d=new s.b2Vec2,e.ComputeDistance_s_s=new s.b2Vec2,e.RayCast_s_p1=new s.b2Vec2,e.RayCast_s_p2=new s.b2Vec2,e.RayCast_s_d=new s.b2Vec2,e.RayCast_s_e=new s.b2Vec2,e.RayCast_s_q=new s.b2Vec2,e.RayCast_s_r=new s.b2Vec2,e.ComputeAABB_s_v1=new s.b2Vec2,e.ComputeAABB_s_v2=new s.b2Vec2,e}(a.b2Shape);i.b2EdgeShape=l,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Shape":"b2Shape"}],b2Fixture:[function(t,e,i){"use strict";cc._RF.push(e,"a7f9awyqm5GjoDH9ZQcBqVM","b2Fixture"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Fixture=i.b2FixtureProxy=i.b2FixtureDef=i.b2Filter=void 0;var o=t("../Common/b2Settings"),n=t("../Collision/b2Collision"),r=t("../Collision/Shapes/b2Shape"),s=function(){function t(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}return t.prototype.Clone=function(){return(new t).Copy(this)},t.prototype.Copy=function(t){return this.categoryBits=t.categoryBits,this.maskBits=t.maskBits,this.groupIndex=t.groupIndex||0,this},t.DEFAULT=new t,t}();i.b2Filter=s;i.b2FixtureDef=function(){this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter=new s};var a=function(){function t(t,e){this.aabb=new n.b2AABB,this.childIndex=0,this.fixture=t,this.childIndex=e,this.fixture.m_shape.ComputeAABB(this.aabb,this.fixture.m_body.GetTransform(),e),this.treeNode=this.fixture.m_body.m_world.m_contactManager.m_broadPhase.CreateProxy(this.aabb,this)}return t.prototype.Reset=function(){this.fixture.m_body.m_world.m_contactManager.m_broadPhase.DestroyProxy(this.treeNode)},t.prototype.Touch=function(){this.fixture.m_body.m_world.m_contactManager.m_broadPhase.TouchProxy(this.treeNode)},t.prototype.Synchronize=function(e,i,o){if(e===i)this.fixture.m_shape.ComputeAABB(this.aabb,e,this.childIndex),this.fixture.m_body.m_world.m_contactManager.m_broadPhase.MoveProxy(this.treeNode,this.aabb,o);else{var n=t.Synchronize_s_aabb1,r=t.Synchronize_s_aabb2;this.fixture.m_shape.ComputeAABB(n,e,this.childIndex),this.fixture.m_shape.ComputeAABB(r,i,this.childIndex),this.aabb.Combine2(n,r),this.fixture.m_body.m_world.m_contactManager.m_broadPhase.MoveProxy(this.treeNode,this.aabb,o)}},t.Synchronize_s_aabb1=new n.b2AABB,t.Synchronize_s_aabb2=new n.b2AABB,t}();i.b2FixtureProxy=a;var l=function(){function t(t,e){this.m_density=0,this.m_next=null,this.m_friction=0,this.m_restitution=0,this.m_proxies=[],this.m_filter=new s,this.m_isSensor=!1,this.m_userData=null,this.m_body=t,this.m_shape=e.shape.Clone(),this.m_userData=o.b2Maybe(e.userData,null),this.m_friction=o.b2Maybe(e.friction,.2),this.m_restitution=o.b2Maybe(e.restitution,0),this.m_filter.Copy(o.b2Maybe(e.filter,s.DEFAULT)),this.m_isSensor=o.b2Maybe(e.isSensor,!1),this.m_density=o.b2Maybe(e.density,0)}return Object.defineProperty(t.prototype,"m_proxyCount",{get:function(){return this.m_proxies.length},enumerable:!1,configurable:!0}),t.prototype.Reset=function(){},t.prototype.GetType=function(){return this.m_shape.GetType()},t.prototype.GetShape=function(){return this.m_shape},t.prototype.SetSensor=function(t){t!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=t)},t.prototype.IsSensor=function(){return this.m_isSensor},t.prototype.SetFilterData=function(t){this.m_filter.Copy(t),this.Refilter()},t.prototype.GetFilterData=function(){return this.m_filter},t.prototype.Refilter=function(){for(var t=this.m_body.GetContactList();t;){var e=t.contact,i=e.GetFixtureA(),o=e.GetFixtureB();i!==this&&o!==this||e.FlagForFiltering(),t=t.next}this.TouchProxies()},t.prototype.GetBody=function(){return this.m_body},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetUserData=function(){return this.m_userData},t.prototype.SetUserData=function(t){this.m_userData=t},t.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)},t.prototype.ComputeDistance=function(t,e,i){return this.m_shape.ComputeDistance(this.m_body.GetTransform(),t,e,i)},t.prototype.RayCast=function(t,e,i){return this.m_shape.RayCast(t,e,this.m_body.GetTransform(),i)},t.prototype.GetMassData=function(t){return void 0===t&&(t=new r.b2MassData),this.m_shape.ComputeMass(t,this.m_density),t},t.prototype.SetDensity=function(t){this.m_density=t},t.prototype.GetDensity=function(){return this.m_density},t.prototype.GetFriction=function(){return this.m_friction},t.prototype.SetFriction=function(t){this.m_friction=t},t.prototype.GetRestitution=function(){return this.m_restitution},t.prototype.SetRestitution=function(t){this.m_restitution=t},t.prototype.GetAABB=function(t){return this.m_proxies[t].aabb},t.prototype.Dump=function(t,e){t("    const fd: b2FixtureDef = new b2FixtureDef();\n"),t("    fd.friction = %.15f;\n",this.m_friction),t("    fd.restitution = %.15f;\n",this.m_restitution),t("    fd.density = %.15f;\n",this.m_density),t("    fd.isSensor = %s;\n",this.m_isSensor?"true":"false"),t("    fd.filter.categoryBits = %d;\n",this.m_filter.categoryBits),t("    fd.filter.maskBits = %d;\n",this.m_filter.maskBits),t("    fd.filter.groupIndex = %d;\n",this.m_filter.groupIndex),this.m_shape.Dump(t),t("\n"),t("    fd.shape = shape;\n"),t("\n"),t("    bodies[%d].CreateFixture(fd);\n",e)},t.prototype.CreateProxies=function(){if(0!==this.m_proxies.length)throw new Error;for(var t=0;t<this.m_shape.GetChildCount();++t)this.m_proxies[t]=new a(this,t)},t.prototype.DestroyProxies=function(){for(var t=0,e=this.m_proxies;t<e.length;t++)e[t].Reset();this.m_proxies.length=0},t.prototype.TouchProxies=function(){for(var t=0,e=this.m_proxies;t<e.length;t++)e[t].Touch()},t.prototype.SynchronizeProxies=function(t,e,i){for(var o=0,n=this.m_proxies;o<n.length;o++)n[o].Synchronize(t,e,i)},t}();i.b2Fixture=l,cc._RF.pop()},{"../Collision/Shapes/b2Shape":"b2Shape","../Collision/b2Collision":"b2Collision","../Common/b2Settings":"b2Settings"}],b2FrictionJoint:[function(t,e,i){"use strict";cc._RF.push(e,"5e20cdyhPtFQo+83sZvYdBu","b2FrictionJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2FrictionJoint=i.b2FrictionJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=function(t){function e(){var e=t.call(this,a.b2JointType.e_frictionJoint)||this;return e.localAnchorA=new s.b2Vec2,e.localAnchorB=new s.b2Vec2,e.maxForce=0,e.maxTorque=0,e}return n(e,t),e.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB)},e}(a.b2JointDef);i.b2FrictionJointDef=l;var c=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchorA=new s.b2Vec2,i.m_localAnchorB=new s.b2Vec2,i.m_linearImpulse=new s.b2Vec2,i.m_angularImpulse=0,i.m_maxForce=0,i.m_maxTorque=0,i.m_indexA=0,i.m_indexB=0,i.m_rA=new s.b2Vec2,i.m_rB=new s.b2Vec2,i.m_localCenterA=new s.b2Vec2,i.m_localCenterB=new s.b2Vec2,i.m_invMassA=0,i.m_invMassB=0,i.m_invIA=0,i.m_invIB=0,i.m_linearMass=new s.b2Mat22,i.m_angularMass=0,i.m_qA=new s.b2Rot,i.m_qB=new s.b2Rot,i.m_lalcA=new s.b2Vec2,i.m_lalcB=new s.b2Vec2,i.m_K=new s.b2Mat22,i.m_localAnchorA.Copy(e.localAnchorA),i.m_localAnchorB.Copy(e.localAnchorB),i.m_linearImpulse.SetZero(),i.m_maxForce=r.b2Maybe(e.maxForce,0),i.m_maxTorque=r.b2Maybe(e.maxTorque,0),i.m_linearMass.SetZero(),i}return n(e,t),e.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].a,i=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,n=t.positions[this.m_indexB].a,r=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,l=this.m_qA.SetAngle(e),c=this.m_qB.SetAngle(n);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var u=s.b2Rot.MulRV(l,this.m_lalcA,this.m_rA);s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var _=s.b2Rot.MulRV(c,this.m_lalcB,this.m_rB),p=this.m_invMassA,m=this.m_invMassB,h=this.m_invIA,f=this.m_invIB,d=this.m_K;if(d.ex.x=p+m+h*u.y*u.y+f*_.y*_.y,d.ex.y=-h*u.x*u.y-f*_.x*_.y,d.ey.x=d.ex.y,d.ey.y=p+m+h*u.x*u.x+f*_.x*_.x,d.GetInverse(this.m_linearMass),this.m_angularMass=h+f,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.step.warmStarting){this.m_linearImpulse.SelfMul(t.step.dtRatio),this.m_angularImpulse*=t.step.dtRatio;var b=this.m_linearImpulse;i.SelfMulSub(p,b),o-=h*(s.b2Vec2.CrossVV(this.m_rA,b)+this.m_angularImpulse),r.SelfMulAdd(m,b),a+=f*(s.b2Vec2.CrossVV(this.m_rB,b)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=a},e.prototype.SolveVelocityConstraints=function(t){var i=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v,r=t.velocities[this.m_indexB].w,a=this.m_invMassA,l=this.m_invMassB,c=this.m_invIA,u=this.m_invIB,_=t.step.dt,p=r-o,m=-this.m_angularMass*p,h=this.m_angularImpulse,f=_*this.m_maxTorque;this.m_angularImpulse=s.b2Clamp(this.m_angularImpulse+m,-f,f),o-=c*(m=this.m_angularImpulse-h),r+=u*m;var d=s.b2Vec2.SubVV(s.b2Vec2.AddVCrossSV(n,r,this.m_rB,s.b2Vec2.s_t0),s.b2Vec2.AddVCrossSV(i,o,this.m_rA,s.b2Vec2.s_t1),e.SolveVelocityConstraints_s_Cdot_v2),b=s.b2Mat22.MulMV(this.m_linearMass,d,e.SolveVelocityConstraints_s_impulseV).SelfNeg(),y=e.SolveVelocityConstraints_s_oldImpulseV.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(b),f=_*this.m_maxForce,this.m_linearImpulse.LengthSquared()>f*f&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(f)),s.b2Vec2.SubVV(this.m_linearImpulse,y,b),i.SelfMulSub(a,b),o-=c*s.b2Vec2.CrossVV(this.m_rA,b),n.SelfMulAdd(l,b),r+=u*s.b2Vec2.CrossVV(this.m_rB,b),t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=r},e.prototype.SolvePositionConstraints=function(){return!0},e.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)},e.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)},e.prototype.GetReactionForce=function(t,e){return e.x=t*this.m_linearImpulse.x,e.y=t*this.m_linearImpulse.y,e},e.prototype.GetReactionTorque=function(t){return t*this.m_angularImpulse},e.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.SetMaxForce=function(t){this.m_maxForce=t},e.prototype.GetMaxForce=function(){return this.m_maxForce},e.prototype.SetMaxTorque=function(t){this.m_maxTorque=t},e.prototype.GetMaxTorque=function(){return this.m_maxTorque},e.prototype.Dump=function(t){var e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2FrictionJointDef = new b2FrictionJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.maxForce = %.15f;\n",this.m_maxForce),t("  jd.maxTorque = %.15f;\n",this.m_maxTorque),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},e.SolveVelocityConstraints_s_Cdot_v2=new s.b2Vec2,e.SolveVelocityConstraints_s_impulseV=new s.b2Vec2,e.SolveVelocityConstraints_s_oldImpulseV=new s.b2Vec2,e}(a.b2Joint);i.b2FrictionJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2GearJoint:[function(t,e,i){"use strict";cc._RF.push(e,"5079537Nq1GubFXgS9ZdtB3","b2GearJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2GearJoint=i.b2GearJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=function(t){function e(){var e=t.call(this,a.b2JointType.e_gearJoint)||this;return e.ratio=1,e}return n(e,t),e}(a.b2JointDef);i.b2GearJointDef=l;var c=function(t){function e(e){var i,o,n=t.call(this,e)||this;n.m_typeA=a.b2JointType.e_unknownJoint,n.m_typeB=a.b2JointType.e_unknownJoint,n.m_localAnchorA=new s.b2Vec2,n.m_localAnchorB=new s.b2Vec2,n.m_localAnchorC=new s.b2Vec2,n.m_localAnchorD=new s.b2Vec2,n.m_localAxisC=new s.b2Vec2,n.m_localAxisD=new s.b2Vec2,n.m_referenceAngleA=0,n.m_referenceAngleB=0,n.m_constant=0,n.m_ratio=0,n.m_impulse=0,n.m_indexA=0,n.m_indexB=0,n.m_indexC=0,n.m_indexD=0,n.m_lcA=new s.b2Vec2,n.m_lcB=new s.b2Vec2,n.m_lcC=new s.b2Vec2,n.m_lcD=new s.b2Vec2,n.m_mA=0,n.m_mB=0,n.m_mC=0,n.m_mD=0,n.m_iA=0,n.m_iB=0,n.m_iC=0,n.m_iD=0,n.m_JvAC=new s.b2Vec2,n.m_JvBD=new s.b2Vec2,n.m_JwA=0,n.m_JwB=0,n.m_JwC=0,n.m_JwD=0,n.m_mass=0,n.m_qA=new s.b2Rot,n.m_qB=new s.b2Rot,n.m_qC=new s.b2Rot,n.m_qD=new s.b2Rot,n.m_lalcA=new s.b2Vec2,n.m_lalcB=new s.b2Vec2,n.m_lalcC=new s.b2Vec2,n.m_lalcD=new s.b2Vec2,n.m_joint1=e.joint1,n.m_joint2=e.joint2,n.m_typeA=n.m_joint1.GetType(),n.m_typeB=n.m_joint2.GetType(),n.m_bodyC=n.m_joint1.GetBodyA(),n.m_bodyA=n.m_joint1.GetBodyB();var l=n.m_bodyA.m_xf,c=n.m_bodyA.m_sweep.a,u=n.m_bodyC.m_xf,_=n.m_bodyC.m_sweep.a;if(n.m_typeA===a.b2JointType.e_revoluteJoint){var p=e.joint1;n.m_localAnchorC.Copy(p.m_localAnchorA),n.m_localAnchorA.Copy(p.m_localAnchorB),n.m_referenceAngleA=p.m_referenceAngle,n.m_localAxisC.SetZero(),i=c-_-n.m_referenceAngleA}else{var m=e.joint1;n.m_localAnchorC.Copy(m.m_localAnchorA),n.m_localAnchorA.Copy(m.m_localAnchorB),n.m_referenceAngleA=m.m_referenceAngle,n.m_localAxisC.Copy(m.m_localXAxisA);var h=n.m_localAnchorC,f=s.b2Rot.MulTRV(u.q,s.b2Vec2.AddVV(s.b2Rot.MulRV(l.q,n.m_localAnchorA,s.b2Vec2.s_t0),s.b2Vec2.SubVV(l.p,u.p,s.b2Vec2.s_t1),s.b2Vec2.s_t0),s.b2Vec2.s_t0);i=s.b2Vec2.DotVV(s.b2Vec2.SubVV(f,h,s.b2Vec2.s_t0),n.m_localAxisC)}n.m_bodyD=n.m_joint2.GetBodyA(),n.m_bodyB=n.m_joint2.GetBodyB();var d=n.m_bodyB.m_xf,b=n.m_bodyB.m_sweep.a,y=n.m_bodyD.m_xf,v=n.m_bodyD.m_sweep.a;if(n.m_typeB===a.b2JointType.e_revoluteJoint)p=e.joint2,n.m_localAnchorD.Copy(p.m_localAnchorA),n.m_localAnchorB.Copy(p.m_localAnchorB),n.m_referenceAngleB=p.m_referenceAngle,n.m_localAxisD.SetZero(),o=b-v-n.m_referenceAngleB;else{m=e.joint2,n.m_localAnchorD.Copy(m.m_localAnchorA),n.m_localAnchorB.Copy(m.m_localAnchorB),n.m_referenceAngleB=m.m_referenceAngle,n.m_localAxisD.Copy(m.m_localXAxisA);var V=n.m_localAnchorD,C=s.b2Rot.MulTRV(y.q,s.b2Vec2.AddVV(s.b2Rot.MulRV(d.q,n.m_localAnchorB,s.b2Vec2.s_t0),s.b2Vec2.SubVV(d.p,y.p,s.b2Vec2.s_t1),s.b2Vec2.s_t0),s.b2Vec2.s_t0);o=s.b2Vec2.DotVV(s.b2Vec2.SubVV(C,V,s.b2Vec2.s_t0),n.m_localAxisD)}return n.m_ratio=r.b2Maybe(e.ratio,1),n.m_constant=i+n.m_ratio*o,n.m_impulse=0,n}return n(e,t),e.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_indexC=this.m_bodyC.m_islandIndex,this.m_indexD=this.m_bodyD.m_islandIndex,this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter),this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter),this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var i=t.positions[this.m_indexA].a,o=t.velocities[this.m_indexA].v,n=t.velocities[this.m_indexA].w,r=t.positions[this.m_indexB].a,l=t.velocities[this.m_indexB].v,c=t.velocities[this.m_indexB].w,u=t.positions[this.m_indexC].a,_=t.velocities[this.m_indexC].v,p=t.velocities[this.m_indexC].w,m=t.positions[this.m_indexD].a,h=t.velocities[this.m_indexD].v,f=t.velocities[this.m_indexD].w,d=this.m_qA.SetAngle(i),b=this.m_qB.SetAngle(r),y=this.m_qC.SetAngle(u),v=this.m_qD.SetAngle(m);if(this.m_mass=0,this.m_typeA===a.b2JointType.e_revoluteJoint)this.m_JvAC.SetZero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var V=s.b2Rot.MulRV(y,this.m_localAxisC,e.InitVelocityConstraints_s_u);s.b2Vec2.SubVV(this.m_localAnchorC,this.m_lcC,this.m_lalcC);var C=s.b2Rot.MulRV(y,this.m_lalcC,e.InitVelocityConstraints_s_rC);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_lcA,this.m_lalcA);var g=s.b2Rot.MulRV(d,this.m_lalcA,e.InitVelocityConstraints_s_rA);this.m_JvAC.Copy(V),this.m_JwC=s.b2Vec2.CrossVV(C,V),this.m_JwA=s.b2Vec2.CrossVV(g,V),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_typeB===a.b2JointType.e_revoluteJoint)this.m_JvBD.SetZero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{V=s.b2Rot.MulRV(v,this.m_localAxisD,e.InitVelocityConstraints_s_u),s.b2Vec2.SubVV(this.m_localAnchorD,this.m_lcD,this.m_lalcD);var x=s.b2Rot.MulRV(v,this.m_lalcD,e.InitVelocityConstraints_s_rD);s.b2Vec2.SubVV(this.m_localAnchorB,this.m_lcB,this.m_lalcB);var S=s.b2Rot.MulRV(b,this.m_lalcB,e.InitVelocityConstraints_s_rB);s.b2Vec2.MulSV(this.m_ratio,V,this.m_JvBD),this.m_JwD=this.m_ratio*s.b2Vec2.CrossVV(x,V),this.m_JwB=this.m_ratio*s.b2Vec2.CrossVV(S,V),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.step.warmStarting?(o.SelfMulAdd(this.m_mA*this.m_impulse,this.m_JvAC),n+=this.m_iA*this.m_impulse*this.m_JwA,l.SelfMulAdd(this.m_mB*this.m_impulse,this.m_JvBD),c+=this.m_iB*this.m_impulse*this.m_JwB,_.SelfMulSub(this.m_mC*this.m_impulse,this.m_JvAC),p-=this.m_iC*this.m_impulse*this.m_JwC,h.SelfMulSub(this.m_mD*this.m_impulse,this.m_JvBD),f-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].w=c,t.velocities[this.m_indexC].w=p,t.velocities[this.m_indexD].w=f},e.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexA].v,i=t.velocities[this.m_indexA].w,o=t.velocities[this.m_indexB].v,n=t.velocities[this.m_indexB].w,r=t.velocities[this.m_indexC].v,a=t.velocities[this.m_indexC].w,l=t.velocities[this.m_indexD].v,c=t.velocities[this.m_indexD].w,u=s.b2Vec2.DotVV(this.m_JvAC,s.b2Vec2.SubVV(e,r,s.b2Vec2.s_t0))+s.b2Vec2.DotVV(this.m_JvBD,s.b2Vec2.SubVV(o,l,s.b2Vec2.s_t0));u+=this.m_JwA*i-this.m_JwC*a+(this.m_JwB*n-this.m_JwD*c);var _=-this.m_mass*u;this.m_impulse+=_,e.SelfMulAdd(this.m_mA*_,this.m_JvAC),i+=this.m_iA*_*this.m_JwA,o.SelfMulAdd(this.m_mB*_,this.m_JvBD),n+=this.m_iB*_*this.m_JwB,r.SelfMulSub(this.m_mC*_,this.m_JvAC),a-=this.m_iC*_*this.m_JwC,l.SelfMulSub(this.m_mD*_,this.m_JvBD),c-=this.m_iD*_*this.m_JwD,t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=n,t.velocities[this.m_indexC].w=a,t.velocities[this.m_indexD].w=c},e.prototype.SolvePositionConstraints=function(t){var i,o,n,l,c,u,_=t.positions[this.m_indexA].c,p=t.positions[this.m_indexA].a,m=t.positions[this.m_indexB].c,h=t.positions[this.m_indexB].a,f=t.positions[this.m_indexC].c,d=t.positions[this.m_indexC].a,b=t.positions[this.m_indexD].c,y=t.positions[this.m_indexD].a,v=this.m_qA.SetAngle(p),V=this.m_qB.SetAngle(h),C=this.m_qC.SetAngle(d),g=this.m_qD.SetAngle(y),x=this.m_JvAC,S=this.m_JvBD,B=0;if(this.m_typeA===a.b2JointType.e_revoluteJoint)x.SetZero(),n=1,c=1,B+=this.m_iA+this.m_iC,i=p-d-this.m_referenceAngleA;else{var A=s.b2Rot.MulRV(C,this.m_localAxisC,e.SolvePositionConstraints_s_u),P=s.b2Rot.MulRV(C,this.m_lalcC,e.SolvePositionConstraints_s_rC),w=s.b2Rot.MulRV(v,this.m_lalcA,e.SolvePositionConstraints_s_rA);x.Copy(A),c=s.b2Vec2.CrossVV(P,A),n=s.b2Vec2.CrossVV(w,A),B+=this.m_mC+this.m_mA+this.m_iC*c*c+this.m_iA*n*n;var M=this.m_lalcC,D=s.b2Rot.MulTRV(C,s.b2Vec2.AddVV(w,s.b2Vec2.SubVV(_,f,s.b2Vec2.s_t0),s.b2Vec2.s_t0),s.b2Vec2.s_t0);i=s.b2Vec2.DotVV(s.b2Vec2.SubVV(D,M,s.b2Vec2.s_t0),this.m_localAxisC)}if(this.m_typeB===a.b2JointType.e_revoluteJoint)S.SetZero(),l=this.m_ratio,u=this.m_ratio,B+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),o=h-y-this.m_referenceAngleB;else{A=s.b2Rot.MulRV(g,this.m_localAxisD,e.SolvePositionConstraints_s_u);var I=s.b2Rot.MulRV(g,this.m_lalcD,e.SolvePositionConstraints_s_rD),G=s.b2Rot.MulRV(V,this.m_lalcB,e.SolvePositionConstraints_s_rB);s.b2Vec2.MulSV(this.m_ratio,A,S),u=this.m_ratio*s.b2Vec2.CrossVV(I,A),l=this.m_ratio*s.b2Vec2.CrossVV(G,A),B+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*u*u+this.m_iB*l*l;var T=this.m_lalcD,R=s.b2Rot.MulTRV(g,s.b2Vec2.AddVV(G,s.b2Vec2.SubVV(m,b,s.b2Vec2.s_t0),s.b2Vec2.s_t0),s.b2Vec2.s_t0);o=s.b2Vec2.DotVV(s.b2Vec2.SubVV(R,T,s.b2Vec2.s_t0),this.m_localAxisD)}var F=i+this.m_ratio*o-this.m_constant,O=0;return B>0&&(O=-F/B),_.SelfMulAdd(this.m_mA*O,x),p+=this.m_iA*O*n,m.SelfMulAdd(this.m_mB*O,S),h+=this.m_iB*O*l,f.SelfMulSub(this.m_mC*O,x),d-=this.m_iC*O*c,b.SelfMulSub(this.m_mD*O,S),y-=this.m_iD*O*u,t.positions[this.m_indexA].a=p,t.positions[this.m_indexB].a=h,t.positions[this.m_indexC].a=d,t.positions[this.m_indexD].a=y,0<r.b2_linearSlop},e.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)},e.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)},e.prototype.GetReactionForce=function(t,e){return s.b2Vec2.MulSV(t*this.m_impulse,this.m_JvAC,e)},e.prototype.GetReactionTorque=function(t){return t*this.m_impulse*this.m_JwA},e.prototype.GetJoint1=function(){return this.m_joint1},e.prototype.GetJoint2=function(){return this.m_joint2},e.prototype.GetRatio=function(){return this.m_ratio},e.prototype.SetRatio=function(t){this.m_ratio=t},e.prototype.Dump=function(t){var e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex,o=this.m_joint1.m_index,n=this.m_joint2.m_index;t("  const jd: b2GearJointDef = new b2GearJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.joint1 = joints[%d];\n",o),t("  jd.joint2 = joints[%d];\n",n),t("  jd.ratio = %.15f;\n",this.m_ratio),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},e.InitVelocityConstraints_s_u=new s.b2Vec2,e.InitVelocityConstraints_s_rA=new s.b2Vec2,e.InitVelocityConstraints_s_rB=new s.b2Vec2,e.InitVelocityConstraints_s_rC=new s.b2Vec2,e.InitVelocityConstraints_s_rD=new s.b2Vec2,e.SolvePositionConstraints_s_u=new s.b2Vec2,e.SolvePositionConstraints_s_rA=new s.b2Vec2,e.SolvePositionConstraints_s_rB=new s.b2Vec2,e.SolvePositionConstraints_s_rC=new s.b2Vec2,e.SolvePositionConstraints_s_rD=new s.b2Vec2,e}(a.b2Joint);i.b2GearJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2GravityController:[function(t,e,i){"use strict";cc._RF.push(e,"4bbb8qAyINHA4V5m/M/nCar","b2GravityController");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2GravityController=void 0;var r=t("./b2Controller"),s=t("../Common/b2Settings"),a=t("../Common/b2Math"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.G=1,e.invSqr=!0,e}return n(e,t),e.prototype.Step=function(){if(this.invSqr)for(var t=this.m_bodyList;t;t=t.nextBody)for(var i=(c=t.body).GetWorldCenter(),o=c.GetMass(),n=this.m_bodyList;n&&n!==t;n=n.nextBody){var r=(u=n.body).GetWorldCenter(),l=u.GetMass();(m=(_=r.x-i.x)*_+(p=r.y-i.y)*p)<s.b2_epsilon||((h=e.Step_s_f.Set(_,p)).SelfMul(this.G/m/a.b2Sqrt(m)*o*l),c.IsAwake()&&c.ApplyForce(h,i),u.IsAwake()&&u.ApplyForce(h.SelfMul(-1),r))}else for(t=this.m_bodyList;t;t=t.nextBody){var c;for(i=(c=t.body).GetWorldCenter(),o=c.GetMass(),n=this.m_bodyList;n&&n!==t;n=n.nextBody){var u,_,p,m,h;r=(u=n.body).GetWorldCenter(),l=u.GetMass(),(m=(_=r.x-i.x)*_+(p=r.y-i.y)*p)<s.b2_epsilon||((h=e.Step_s_f.Set(_,p)).SelfMul(this.G/m*o*l),c.IsAwake()&&c.ApplyForce(h,i),u.IsAwake()&&u.ApplyForce(h.SelfMul(-1),r))}}},e.prototype.Draw=function(){},e.Step_s_f=new a.b2Vec2,e}(r.b2Controller);i.b2GravityController=l,cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","./b2Controller":"b2Controller"}],b2GrowableStack:[function(t,e,i){"use strict";cc._RF.push(e,"7106fnvJNRIta7QkXDxRwQd","b2GrowableStack"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2GrowableStack=void 0;var o=t("./b2Settings"),n=function(){function t(t){this.m_stack=[],this.m_count=0,this.m_stack=o.b2MakeArray(t,function(){return null}),this.m_count=0}return t.prototype.Reset=function(){return this.m_count=0,this},t.prototype.Push=function(t){this.m_stack[this.m_count]=t,this.m_count++},t.prototype.Pop=function(){this.m_count--;var t=this.m_stack[this.m_count];if(this.m_stack[this.m_count]=null,null===t)throw new Error;return t},t.prototype.GetCount=function(){return this.m_count},t}();i.b2GrowableStack=n,cc._RF.pop()},{"./b2Settings":"b2Settings"}],b2Island:[function(t,e,i){"use strict";cc._RF.push(e,"d50e8dZ2o1O0Y+sq2u6/Pz0","b2Island"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Island=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Settings"),r=t("../Common/b2Settings"),s=t("../Common/b2Settings"),a=t("../Common/b2Math"),l=t("../Common/b2Timer"),c=t("./Contacts/b2ContactSolver"),u=t("./b2Body"),_=t("./b2TimeStep"),p=t("./b2WorldCallbacks"),m=function(){function t(){this.m_bodies=[],this.m_contacts=[],this.m_joints=[],this.m_positions=_.b2Position.MakeArray(1024),this.m_velocities=_.b2Velocity.MakeArray(1024),this.m_bodyCount=0,this.m_jointCount=0,this.m_contactCount=0,this.m_bodyCapacity=0,this.m_contactCapacity=0,this.m_jointCapacity=0}return t.prototype.Initialize=function(t,e,i,o){if(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_listener=o,this.m_positions.length<t)for(var n=a.b2Max(2*this.m_positions.length,t);this.m_positions.length<n;)this.m_positions[this.m_positions.length]=new _.b2Position;if(this.m_velocities.length<t)for(n=a.b2Max(2*this.m_velocities.length,t);this.m_velocities.length<n;)this.m_velocities[this.m_velocities.length]=new _.b2Velocity},t.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},t.prototype.AddBody=function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t},t.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t},t.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t},t.prototype.Solve=function(e,i,l,c){for(var _=t.s_timer.Reset(),p=i.dt,m=0;m<this.m_bodyCount;++m){var h=this.m_bodies[m];this.m_positions[m].c.Copy(h.m_sweep.c);var f=h.m_sweep.a,d=this.m_velocities[m].v.Copy(h.m_linearVelocity),b=h.m_angularVelocity;h.m_sweep.c0.Copy(h.m_sweep.c),h.m_sweep.a0=h.m_sweep.a,h.m_type===u.b2BodyType.b2_dynamicBody&&(d.x+=p*(h.m_gravityScale*l.x+h.m_invMass*h.m_force.x),d.y+=p*(h.m_gravityScale*l.y+h.m_invMass*h.m_force.y),b+=p*h.m_invI*h.m_torque,d.SelfMul(1/(1+p*h.m_linearDamping)),b*=1/(1+p*h.m_angularDamping)),this.m_positions[m].a=f,this.m_velocities[m].w=b}_.Reset();var y=t.s_solverData;y.step.Copy(i),y.positions=this.m_positions,y.velocities=this.m_velocities;var v=t.s_contactSolverDef;v.step.Copy(i),v.contacts=this.m_contacts,v.count=this.m_contactCount,v.positions=this.m_positions,v.velocities=this.m_velocities;var V=t.s_contactSolver.Initialize(v);for(V.InitializeVelocityConstraints(),i.warmStarting&&V.WarmStart(),m=0;m<this.m_jointCount;++m)this.m_joints[m].InitVelocityConstraints(y);for(e.solveInit=_.GetMilliseconds(),_.Reset(),m=0;m<i.velocityIterations;++m){for(var C=0;C<this.m_jointCount;++C)this.m_joints[C].SolveVelocityConstraints(y);V.SolveVelocityConstraints()}for(V.StoreImpulses(),e.solveVelocity=_.GetMilliseconds(),m=0;m<this.m_bodyCount;++m){var g=this.m_positions[m].c,x=(f=this.m_positions[m].a,d=this.m_velocities[m].v,b=this.m_velocities[m].w,a.b2Vec2.MulSV(p,d,t.s_translation));if(a.b2Vec2.DotVV(x,x)>n.b2_maxTranslationSquared){var S=n.b2_maxTranslation/x.Length();d.SelfMul(S)}var B=p*b;B*B>r.b2_maxRotationSquared&&(b*=S=r.b2_maxRotation/a.b2Abs(B)),g.x+=p*d.x,g.y+=p*d.y,f+=p*b,this.m_positions[m].a=f,this.m_velocities[m].w=b}_.Reset();var A=!1;for(m=0;m<i.positionIterations;++m){var P=V.SolvePositionConstraints(),w=!0;for(C=0;C<this.m_jointCount;++C){var M=this.m_joints[C].SolvePositionConstraints(y);w=w&&M}if(P&&w){A=!0;break}}for(m=0;m<this.m_bodyCount;++m){var D=this.m_bodies[m];D.m_sweep.c.Copy(this.m_positions[m].c),D.m_sweep.a=this.m_positions[m].a,D.m_linearVelocity.Copy(this.m_velocities[m].v),D.m_angularVelocity=this.m_velocities[m].w,D.SynchronizeTransform()}if(e.solvePosition=_.GetMilliseconds(),this.Report(V.m_velocityConstraints),c){var I=o.b2_maxFloat,G=s.b2_linearSleepTolerance*s.b2_linearSleepTolerance,T=s.b2_angularSleepTolerance*s.b2_angularSleepTolerance;for(m=0;m<this.m_bodyCount;++m)(h=this.m_bodies[m]).GetType()!==u.b2BodyType.b2_staticBody&&(!h.m_autoSleepFlag||h.m_angularVelocity*h.m_angularVelocity>T||a.b2Vec2.DotVV(h.m_linearVelocity,h.m_linearVelocity)>G?(h.m_sleepTime=0,I=0):(h.m_sleepTime+=p,I=a.b2Min(I,h.m_sleepTime)));if(I>=o.b2_timeToSleep&&A)for(m=0;m<this.m_bodyCount;++m)(h=this.m_bodies[m]).SetAwake(!1)}},t.prototype.SolveTOI=function(e,i,o){for(var s=0;s<this.m_bodyCount;++s){var l=this.m_bodies[s];this.m_positions[s].c.Copy(l.m_sweep.c),this.m_positions[s].a=l.m_sweep.a,this.m_velocities[s].v.Copy(l.m_linearVelocity),this.m_velocities[s].w=l.m_angularVelocity}var c=t.s_contactSolverDef;c.contacts=this.m_contacts,c.count=this.m_contactCount,c.step.Copy(e),c.positions=this.m_positions,c.velocities=this.m_velocities;var u=t.s_contactSolver.Initialize(c);for(s=0;s<e.positionIterations&&!u.SolveTOIPositionConstraints(i,o);++s);for(this.m_bodies[i].m_sweep.c0.Copy(this.m_positions[i].c),this.m_bodies[i].m_sweep.a0=this.m_positions[i].a,this.m_bodies[o].m_sweep.c0.Copy(this.m_positions[o].c),this.m_bodies[o].m_sweep.a0=this.m_positions[o].a,u.InitializeVelocityConstraints(),s=0;s<e.velocityIterations;++s)u.SolveVelocityConstraints();var _=e.dt;for(s=0;s<this.m_bodyCount;++s){var p=this.m_positions[s].c,m=this.m_positions[s].a,h=this.m_velocities[s].v,f=this.m_velocities[s].w,d=a.b2Vec2.MulSV(_,h,t.s_translation);if(a.b2Vec2.DotVV(d,d)>n.b2_maxTranslationSquared){var b=n.b2_maxTranslation/d.Length();h.SelfMul(b)}var y=_*f;y*y>r.b2_maxRotationSquared&&(f*=b=r.b2_maxRotation/a.b2Abs(y)),p.SelfMulAdd(_,h),m+=_*f,this.m_positions[s].a=m,this.m_velocities[s].w=f;var v=this.m_bodies[s];v.m_sweep.c.Copy(p),v.m_sweep.a=m,v.m_linearVelocity.Copy(h),v.m_angularVelocity=f,v.SynchronizeTransform()}this.Report(u.m_velocityConstraints)},t.prototype.Report=function(e){if(null!==this.m_listener)for(var i=0;i<this.m_contactCount;++i){var o=this.m_contacts[i];if(o){var n=e[i],r=t.s_impulse;r.count=n.pointCount;for(var s=0;s<n.pointCount;++s)r.normalImpulses[s]=n.points[s].normalImpulse,r.tangentImpulses[s]=n.points[s].tangentImpulse;this.m_listener.PostSolve(o,r)}}},t.s_timer=new l.b2Timer,t.s_solverData=new _.b2SolverData,t.s_contactSolverDef=new c.b2ContactSolverDef,t.s_contactSolver=new c.b2ContactSolver,t.s_translation=new a.b2Vec2,t.s_impulse=new p.b2ContactImpulse,t}();i.b2Island=m,cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","../Common/b2Timer":"b2Timer","./Contacts/b2ContactSolver":"b2ContactSolver","./b2Body":"b2Body","./b2TimeStep":"b2TimeStep","./b2WorldCallbacks":"b2WorldCallbacks"}],b2Joint:[function(t,e,i){"use strict";cc._RF.push(e,"deb1aAGUa9IMI+jf7ph1dZ0","b2Joint"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Joint=i.b2JointDef=i.b2JointEdge=i.b2Jacobian=i.b2LimitState=i.b2JointType=void 0;var o,n=t("../../Common/b2Settings"),r=t("../../Common/b2Math");(function(t){t[t.e_unknownJoint=0]="e_unknownJoint",t[t.e_revoluteJoint=1]="e_revoluteJoint",t[t.e_prismaticJoint=2]="e_prismaticJoint",t[t.e_distanceJoint=3]="e_distanceJoint",t[t.e_pulleyJoint=4]="e_pulleyJoint",t[t.e_mouseJoint=5]="e_mouseJoint",t[t.e_gearJoint=6]="e_gearJoint",t[t.e_wheelJoint=7]="e_wheelJoint",t[t.e_weldJoint=8]="e_weldJoint",t[t.e_frictionJoint=9]="e_frictionJoint",t[t.e_ropeJoint=10]="e_ropeJoint",t[t.e_motorJoint=11]="e_motorJoint",t[t.e_areaJoint=12]="e_areaJoint"})(o=i.b2JointType||(i.b2JointType={})),function(t){t[t.e_inactiveLimit=0]="e_inactiveLimit",t[t.e_atLowerLimit=1]="e_atLowerLimit",t[t.e_atUpperLimit=2]="e_atUpperLimit",t[t.e_equalLimits=3]="e_equalLimits"}(i.b2LimitState||(i.b2LimitState={}));var s=function(){function t(){this.linear=new r.b2Vec2,this.angularA=0,this.angularB=0}return t.prototype.SetZero=function(){return this.linear.SetZero(),this.angularA=0,this.angularB=0,this},t.prototype.Set=function(t,e,i){return this.linear.Copy(t),this.angularA=e,this.angularB=i,this},t}();i.b2Jacobian=s;var a=function(){function t(t){this._other=null,this.prev=null,this.next=null,this.joint=t}return Object.defineProperty(t.prototype,"other",{get:function(){if(null===this._other)throw new Error;return this._other},set:function(t){if(null!==this._other)throw new Error;this._other=t},enumerable:!1,configurable:!0}),t.prototype.Reset=function(){this._other=null,this.prev=null,this.next=null},t}();i.b2JointEdge=a;i.b2JointDef=function(t){this.type=o.e_unknownJoint,this.userData=null,this.collideConnected=!1,this.type=t};var l=function(){function t(t){this.m_type=o.e_unknownJoint,this.m_prev=null,this.m_next=null,this.m_edgeA=new a(this),this.m_edgeB=new a(this),this.m_index=0,this.m_islandFlag=!1,this.m_collideConnected=!1,this.m_userData=null,this.m_type=t.type,this.m_edgeA.other=t.bodyB,this.m_edgeB.other=t.bodyA,this.m_bodyA=t.bodyA,this.m_bodyB=t.bodyB,this.m_collideConnected=n.b2Maybe(t.collideConnected,!1),this.m_userData=n.b2Maybe(t.userData,null)}return t.prototype.GetType=function(){return this.m_type},t.prototype.GetBodyA=function(){return this.m_bodyA},t.prototype.GetBodyB=function(){return this.m_bodyB},t.prototype.GetNext=function(){return this.m_next},t.prototype.GetUserData=function(){return this.m_userData},t.prototype.SetUserData=function(t){this.m_userData=t},t.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},t.prototype.GetCollideConnected=function(){return this.m_collideConnected},t.prototype.Dump=function(t){t("// Dump is not supported for this joint type.\n")},t.prototype.ShiftOrigin=function(){},t}();i.b2Joint=l,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings"}],b2Math:[function(t,e,i){"use strict";cc._RF.push(e,"4d9da442SdPFbT/AgeQYG48","b2Math"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Sweep=i.b2Transform=i.b2Rot=i.b2Mat33=i.b2Mat22=i.b2Vec3=i.b2Vec2_zero=i.b2Vec2=i.b2RandomRange=i.b2Random=i.b2IsPowerOfTwo=i.b2NextPowerOfTwo=i.b2Atan2=i.b2Asin=i.b2Acos=i.b2Sin=i.b2Cos=i.b2RadToDeg=i.b2DegToRad=i.b2Pow=i.b2Sqrt=i.b2InvSqrt=i.b2Sq=i.b2IsValid=i.b2Swap=i.b2Clamp=i.b2Max=i.b2Min=i.b2Abs=i.b2_two_pi=i.b2_180_over_pi=i.b2_pi_over_180=void 0;var o=t("./b2Settings");function n(t,e){return t<e?t:e}function r(t,e){return t>e?t:e}function s(t,e,i){return t<e?e:t>i?i:t}i.b2_pi_over_180=o.b2_pi/180,i.b2_180_over_pi=180/o.b2_pi,i.b2_two_pi=2*o.b2_pi,i.b2Abs=Math.abs,i.b2Min=n,i.b2Max=r,i.b2Clamp=s,i.b2Swap=function(t,e){var i=t[0];t[0]=e[0],e[0]=i},i.b2IsValid=isFinite,i.b2Sq=function(t){return t*t},i.b2InvSqrt=function(t){return 1/Math.sqrt(t)},i.b2Sqrt=Math.sqrt,i.b2Pow=Math.pow,i.b2DegToRad=function(t){return t*i.b2_pi_over_180},i.b2RadToDeg=function(t){return t*i.b2_180_over_pi},i.b2Cos=Math.cos,i.b2Sin=Math.sin,i.b2Acos=Math.acos,i.b2Asin=Math.asin,i.b2Atan2=Math.atan2,i.b2NextPowerOfTwo=function(t){return t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,1+(t|=t>>16&65535)},i.b2IsPowerOfTwo=function(t){return t>0&&0==(t&t-1)},i.b2Random=function(){return 2*Math.random()-1},i.b2RandomRange=function(t,e){return(e-t)*Math.random()+t};var a=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t[0]instanceof Float32Array){if(2!==t[0].length)throw new Error;this.data=t[0]}else{var i="number"==typeof t[0]?t[0]:0,o="number"==typeof t[1]?t[1]:0;this.data=new Float32Array([i,o])}}return Object.defineProperty(t.prototype,"x",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!1,configurable:!0}),t.prototype.Clone=function(){return new t(this.x,this.y)},t.prototype.SetZero=function(){return this.x=0,this.y=0,this},t.prototype.Set=function(t,e){return this.x=t,this.y=e,this},t.prototype.Copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.SelfAdd=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.SelfAddXY=function(t,e){return this.x+=t,this.y+=e,this},t.prototype.SelfSub=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.SelfSubXY=function(t,e){return this.x-=t,this.y-=e,this},t.prototype.SelfMul=function(t){return this.x*=t,this.y*=t,this},t.prototype.SelfMulAdd=function(t,e){return this.x+=t*e.x,this.y+=t*e.y,this},t.prototype.SelfMulSub=function(t,e){return this.x-=t*e.x,this.y-=t*e.y,this},t.prototype.Dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.Cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.Length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},t.prototype.LengthSquared=function(){var t=this.x,e=this.y;return t*t+e*e},t.prototype.Normalize=function(){var t=this.Length();if(t>=o.b2_epsilon){var e=1/t;this.x*=e,this.y*=e}return t},t.prototype.SelfNormalize=function(){var t=this.Length();if(t>=o.b2_epsilon){var e=1/t;this.x*=e,this.y*=e}return this},t.prototype.SelfRotate=function(t){var e=Math.cos(t),i=Math.sin(t),o=this.x;return this.x=e*o-i*this.y,this.y=i*o+e*this.y,this},t.prototype.SelfRotateCosSin=function(t,e){var i=this.x;return this.x=t*i-e*this.y,this.y=e*i+t*this.y,this},t.prototype.IsValid=function(){return isFinite(this.x)&&isFinite(this.y)},t.prototype.SelfCrossVS=function(t){var e=this.x;return this.x=t*this.y,this.y=-t*e,this},t.prototype.SelfCrossSV=function(t){var e=this.x;return this.x=-t*this.y,this.y=t*e,this},t.prototype.SelfMinV=function(t){return this.x=n(this.x,t.x),this.y=n(this.y,t.y),this},t.prototype.SelfMaxV=function(t){return this.x=r(this.x,t.x),this.y=r(this.y,t.y),this},t.prototype.SelfAbs=function(){return this.x=i.b2Abs(this.x),this.y=i.b2Abs(this.y),this},t.prototype.SelfNeg=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.SelfSkew=function(){var t=this.x;return this.x=-this.y,this.y=t,this},t.MakeArray=function(e){return o.b2MakeArray(e,function(){return new t})},t.AbsV=function(t,e){return e.x=i.b2Abs(t.x),e.y=i.b2Abs(t.y),e},t.MinV=function(t,e,i){return i.x=n(t.x,e.x),i.y=n(t.y,e.y),i},t.MaxV=function(t,e,i){return i.x=r(t.x,e.x),i.y=r(t.y,e.y),i},t.ClampV=function(t,e,i,o){return o.x=s(t.x,e.x,i.x),o.y=s(t.y,e.y,i.y),o},t.RotateV=function(t,e,i){var o=t.x,n=t.y,r=Math.cos(e),s=Math.sin(e);return i.x=r*o-s*n,i.y=s*o+r*n,i},t.DotVV=function(t,e){return t.x*e.x+t.y*e.y},t.CrossVV=function(t,e){return t.x*e.y-t.y*e.x},t.CrossVS=function(t,e,i){var o=t.x;return i.x=e*t.y,i.y=-e*o,i},t.CrossVOne=function(t,e){var i=t.x;return e.x=t.y,e.y=-i,e},t.CrossSV=function(t,e,i){var o=e.x;return i.x=-t*e.y,i.y=t*o,i},t.CrossOneV=function(t,e){var i=t.x;return e.x=-t.y,e.y=i,e},t.AddVV=function(t,e,i){return i.x=t.x+e.x,i.y=t.y+e.y,i},t.SubVV=function(t,e,i){return i.x=t.x-e.x,i.y=t.y-e.y,i},t.MulSV=function(t,e,i){return i.x=e.x*t,i.y=e.y*t,i},t.MulVS=function(t,e,i){return i.x=t.x*e,i.y=t.y*e,i},t.AddVMulSV=function(t,e,i,o){return o.x=t.x+e*i.x,o.y=t.y+e*i.y,o},t.SubVMulSV=function(t,e,i,o){return o.x=t.x-e*i.x,o.y=t.y-e*i.y,o},t.AddVCrossSV=function(t,e,i,o){var n=i.x;return o.x=t.x-e*i.y,o.y=t.y+e*n,o},t.MidVV=function(t,e,i){return i.x=.5*(t.x+e.x),i.y=.5*(t.y+e.y),i},t.ExtVV=function(t,e,i){return i.x=.5*(e.x-t.x),i.y=.5*(e.y-t.y),i},t.IsEqualToV=function(t,e){return t.x===e.x&&t.y===e.y},t.DistanceVV=function(t,e){var i=t.x-e.x,o=t.y-e.y;return Math.sqrt(i*i+o*o)},t.DistanceSquaredVV=function(t,e){var i=t.x-e.x,o=t.y-e.y;return i*i+o*o},t.NegV=function(t,e){return e.x=-t.x,e.y=-t.y,e},t.ZERO=new t(0,0),t.UNITX=new t(1,0),t.UNITY=new t(0,1),t.s_t0=new t,t.s_t1=new t,t.s_t2=new t,t.s_t3=new t,t}();i.b2Vec2=a,i.b2Vec2_zero=new a(0,0);var l=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t[0]instanceof Float32Array){if(3!==t[0].length)throw new Error;this.data=t[0]}else{var i="number"==typeof t[0]?t[0]:0,o="number"==typeof t[1]?t[1]:0,n="number"==typeof t[2]?t[2]:0;this.data=new Float32Array([i,o,n])}}return Object.defineProperty(t.prototype,"x",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!1,configurable:!0}),t.prototype.Clone=function(){return new t(this.x,this.y,this.z)},t.prototype.SetZero=function(){return this.x=0,this.y=0,this.z=0,this},t.prototype.SetXYZ=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},t.prototype.Copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},t.prototype.SelfNeg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},t.prototype.SelfAdd=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},t.prototype.SelfAddXYZ=function(t,e,i){return this.x+=t,this.y+=e,this.z+=i,this},t.prototype.SelfSub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},t.prototype.SelfSubXYZ=function(t,e,i){return this.x-=t,this.y-=e,this.z-=i,this},t.prototype.SelfMul=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t.DotV3V3=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},t.CrossV3V3=function(t,e,i){var o=t.x,n=t.y,r=t.z,s=e.x,a=e.y,l=e.z;return i.x=n*l-r*a,i.y=r*s-o*l,i.z=o*a-n*s,i},t.ZERO=new t(0,0,0),t.s_t0=new t,t}();i.b2Vec3=l;var c=function(){function t(){this.data=new Float32Array([1,0,0,1]),this.ex=new a(this.data.subarray(0,2)),this.ey=new a(this.data.subarray(2,4))}return t.prototype.Clone=function(){return(new t).Copy(this)},t.FromVV=function(e,i){return(new t).SetVV(e,i)},t.FromSSSS=function(e,i,o,n){return(new t).SetSSSS(e,i,o,n)},t.FromAngle=function(e){return(new t).SetAngle(e)},t.prototype.SetSSSS=function(t,e,i,o){return this.ex.Set(t,i),this.ey.Set(e,o),this},t.prototype.SetVV=function(t,e){return this.ex.Copy(t),this.ey.Copy(e),this},t.prototype.SetAngle=function(t){var e=Math.cos(t),i=Math.sin(t);return this.ex.Set(e,i),this.ey.Set(-i,e),this},t.prototype.Copy=function(t){return this.ex.Copy(t.ex),this.ey.Copy(t.ey),this},t.prototype.SetIdentity=function(){return this.ex.Set(1,0),this.ey.Set(0,1),this},t.prototype.SetZero=function(){return this.ex.SetZero(),this.ey.SetZero(),this},t.prototype.GetAngle=function(){return Math.atan2(this.ex.y,this.ex.x)},t.prototype.GetInverse=function(t){var e=this.ex.x,i=this.ey.x,o=this.ex.y,n=this.ey.y,r=e*n-i*o;return 0!==r&&(r=1/r),t.ex.x=r*n,t.ey.x=-r*i,t.ex.y=-r*o,t.ey.y=r*e,t},t.prototype.Solve=function(t,e,i){var o=this.ex.x,n=this.ey.x,r=this.ex.y,s=this.ey.y,a=o*s-n*r;return 0!==a&&(a=1/a),i.x=a*(s*t-n*e),i.y=a*(o*e-r*t),i},t.prototype.SelfAbs=function(){return this.ex.SelfAbs(),this.ey.SelfAbs(),this},t.prototype.SelfInv=function(){return this.GetInverse(this),this},t.prototype.SelfAddM=function(t){return this.ex.SelfAdd(t.ex),this.ey.SelfAdd(t.ey),this},t.prototype.SelfSubM=function(t){return this.ex.SelfSub(t.ex),this.ey.SelfSub(t.ey),this},t.AbsM=function(t,e){var o=t.ex,n=t.ey;return e.ex.x=i.b2Abs(o.x),e.ex.y=i.b2Abs(o.y),e.ey.x=i.b2Abs(n.x),e.ey.y=i.b2Abs(n.y),e},t.MulMV=function(t,e,i){var o=t.ex,n=t.ey,r=e.x,s=e.y;return i.x=o.x*r+n.x*s,i.y=o.y*r+n.y*s,i},t.MulTMV=function(t,e,i){var o=t.ex,n=t.ey,r=e.x,s=e.y;return i.x=o.x*r+o.y*s,i.y=n.x*r+n.y*s,i},t.AddMM=function(t,e,i){var o=t.ex,n=t.ey,r=e.ex,s=e.ey;return i.ex.x=o.x+r.x,i.ex.y=o.y+r.y,i.ey.x=n.x+s.x,i.ey.y=n.y+s.y,i},t.MulMM=function(t,e,i){var o=t.ex.x,n=t.ex.y,r=t.ey.x,s=t.ey.y,a=e.ex.x,l=e.ex.y,c=e.ey.x,u=e.ey.y;return i.ex.x=o*a+r*l,i.ex.y=n*a+s*l,i.ey.x=o*c+r*u,i.ey.y=n*c+s*u,i},t.MulTMM=function(t,e,i){var o=t.ex.x,n=t.ex.y,r=t.ey.x,s=t.ey.y,a=e.ex.x,l=e.ex.y,c=e.ey.x,u=e.ey.y;return i.ex.x=o*a+n*l,i.ex.y=r*a+s*l,i.ey.x=o*c+n*u,i.ey.y=r*c+s*u,i},t.IDENTITY=new t,t}();i.b2Mat22=c;var u=function(){function t(){this.data=new Float32Array([1,0,0,0,1,0,0,0,1]),this.ex=new l(this.data.subarray(0,3)),this.ey=new l(this.data.subarray(3,6)),this.ez=new l(this.data.subarray(6,9))}return t.prototype.Clone=function(){return(new t).Copy(this)},t.prototype.SetVVV=function(t,e,i){return this.ex.Copy(t),this.ey.Copy(e),this.ez.Copy(i),this},t.prototype.Copy=function(t){return this.ex.Copy(t.ex),this.ey.Copy(t.ey),this.ez.Copy(t.ez),this},t.prototype.SetIdentity=function(){return this.ex.SetXYZ(1,0,0),this.ey.SetXYZ(0,1,0),this.ez.SetXYZ(0,0,1),this},t.prototype.SetZero=function(){return this.ex.SetZero(),this.ey.SetZero(),this.ez.SetZero(),this},t.prototype.SelfAddM=function(t){return this.ex.SelfAdd(t.ex),this.ey.SelfAdd(t.ey),this.ez.SelfAdd(t.ez),this},t.prototype.Solve33=function(t,e,i,o){var n=this.ex.x,r=this.ex.y,s=this.ex.z,a=this.ey.x,l=this.ey.y,c=this.ey.z,u=this.ez.x,_=this.ez.y,p=this.ez.z,m=n*(l*p-c*_)+r*(c*u-a*p)+s*(a*_-l*u);return 0!==m&&(m=1/m),o.x=m*(t*(l*p-c*_)+e*(c*u-a*p)+i*(a*_-l*u)),o.y=m*(n*(e*p-i*_)+r*(i*u-t*p)+s*(t*_-e*u)),o.z=m*(n*(l*i-c*e)+r*(c*t-a*i)+s*(a*e-l*t)),o},t.prototype.Solve22=function(t,e,i){var o=this.ex.x,n=this.ey.x,r=this.ex.y,s=this.ey.y,a=o*s-n*r;return 0!==a&&(a=1/a),i.x=a*(s*t-n*e),i.y=a*(o*e-r*t),i},t.prototype.GetInverse22=function(t){var e=this.ex.x,i=this.ey.x,o=this.ex.y,n=this.ey.y,r=e*n-i*o;0!==r&&(r=1/r),t.ex.x=r*n,t.ey.x=-r*i,t.ex.z=0,t.ex.y=-r*o,t.ey.y=r*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0},t.prototype.GetSymInverse33=function(t){var e=l.DotV3V3(this.ex,l.CrossV3V3(this.ey,this.ez,l.s_t0));0!==e&&(e=1/e);var i=this.ex.x,o=this.ey.x,n=this.ez.x,r=this.ey.y,s=this.ez.y,a=this.ez.z;t.ex.x=e*(r*a-s*s),t.ex.y=e*(n*s-o*a),t.ex.z=e*(o*s-n*r),t.ey.x=t.ex.y,t.ey.y=e*(i*a-n*n),t.ey.z=e*(n*o-i*s),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(i*r-o*o)},t.MulM33V3=function(t,e,i){var o=e.x,n=e.y,r=e.z;return i.x=t.ex.x*o+t.ey.x*n+t.ez.x*r,i.y=t.ex.y*o+t.ey.y*n+t.ez.y*r,i.z=t.ex.z*o+t.ey.z*n+t.ez.z*r,i},t.MulM33XYZ=function(t,e,i,o,n){return n.x=t.ex.x*e+t.ey.x*i+t.ez.x*o,n.y=t.ex.y*e+t.ey.y*i+t.ez.y*o,n.z=t.ex.z*e+t.ey.z*i+t.ez.z*o,n},t.MulM33V2=function(t,e,i){var o=e.x,n=e.y;return i.x=t.ex.x*o+t.ey.x*n,i.y=t.ex.y*o+t.ey.y*n,i},t.MulM33XY=function(t,e,i,o){return o.x=t.ex.x*e+t.ey.x*i,o.y=t.ex.y*e+t.ey.y*i,o},t.IDENTITY=new t,t}();i.b2Mat33=u;var _=function(){function t(t){void 0===t&&(t=0),this.s=0,this.c=1,t&&(this.s=Math.sin(t),this.c=Math.cos(t))}return t.prototype.Clone=function(){return(new t).Copy(this)},t.prototype.Copy=function(t){return this.s=t.s,this.c=t.c,this},t.prototype.SetAngle=function(t){return this.s=Math.sin(t),this.c=Math.cos(t),this},t.prototype.SetIdentity=function(){return this.s=0,this.c=1,this},t.prototype.GetAngle=function(){return Math.atan2(this.s,this.c)},t.prototype.GetXAxis=function(t){return t.x=this.c,t.y=this.s,t},t.prototype.GetYAxis=function(t){return t.x=-this.s,t.y=this.c,t},t.MulRR=function(t,e,i){var o=t.c,n=t.s,r=e.c,s=e.s;return i.s=n*r+o*s,i.c=o*r-n*s,i},t.MulTRR=function(t,e,i){var o=t.c,n=t.s,r=e.c,s=e.s;return i.s=o*s-n*r,i.c=o*r+n*s,i},t.MulRV=function(t,e,i){var o=t.c,n=t.s,r=e.x,s=e.y;return i.x=o*r-n*s,i.y=n*r+o*s,i},t.MulTRV=function(t,e,i){var o=t.c,n=t.s,r=e.x,s=e.y;return i.x=o*r+n*s,i.y=-n*r+o*s,i},t.IDENTITY=new t,t}();i.b2Rot=_;var p=function(){function t(){this.p=new a,this.q=new _}return t.prototype.Clone=function(){return(new t).Copy(this)},t.prototype.Copy=function(t){return this.p.Copy(t.p),this.q.Copy(t.q),this},t.prototype.SetIdentity=function(){return this.p.SetZero(),this.q.SetIdentity(),this},t.prototype.SetPositionRotation=function(t,e){return this.p.Copy(t),this.q.Copy(e),this},t.prototype.SetPositionAngle=function(t,e){return this.p.Copy(t),this.q.SetAngle(e),this},t.prototype.SetPosition=function(t){return this.p.Copy(t),this},t.prototype.SetPositionXY=function(t,e){return this.p.Set(t,e),this},t.prototype.SetRotation=function(t){return this.q.Copy(t),this},t.prototype.SetRotationAngle=function(t){return this.q.SetAngle(t),this},t.prototype.GetPosition=function(){return this.p},t.prototype.GetRotation=function(){return this.q},t.prototype.GetRotationAngle=function(){return this.q.GetAngle()},t.prototype.GetAngle=function(){return this.q.GetAngle()},t.MulXV=function(t,e,i){var o=t.q.c,n=t.q.s,r=e.x,s=e.y;return i.x=o*r-n*s+t.p.x,i.y=n*r+o*s+t.p.y,i},t.MulTXV=function(t,e,i){var o=t.q.c,n=t.q.s,r=e.x-t.p.x,s=e.y-t.p.y;return i.x=o*r+n*s,i.y=-n*r+o*s,i},t.MulXX=function(t,e,i){return _.MulRR(t.q,e.q,i.q),a.AddVV(_.MulRV(t.q,e.p,i.p),t.p,i.p),i},t.MulTXX=function(t,e,i){return _.MulTRR(t.q,e.q,i.q),_.MulTRV(t.q,a.SubVV(e.p,t.p,i.p),i.p),i},t.IDENTITY=new t,t}();i.b2Transform=p;var m=function(){function t(){this.localCenter=new a,this.c0=new a,this.c=new a,this.a0=0,this.a=0,this.alpha0=0}return t.prototype.Clone=function(){return(new t).Copy(this)},t.prototype.Copy=function(t){return this.localCenter.Copy(t.localCenter),this.c0.Copy(t.c0),this.c.Copy(t.c),this.a0=t.a0,this.a=t.a,this.alpha0=t.alpha0,this},t.prototype.GetTransform=function(t,e){var i=1-e;t.p.x=i*this.c0.x+e*this.c.x,t.p.y=i*this.c0.y+e*this.c.y;var o=i*this.a0+e*this.a;return t.q.SetAngle(o),t.p.SelfSub(_.MulRV(t.q,this.localCenter,a.s_t0)),t},t.prototype.Advance=function(t){var e=(t-this.alpha0)/(1-this.alpha0),i=1-e;this.c0.x=i*this.c0.x+e*this.c.x,this.c0.y=i*this.c0.y+e*this.c.y,this.a0=i*this.a0+e*this.a,this.alpha0=t},t.prototype.Normalize=function(){var t=i.b2_two_pi*Math.floor(this.a0/i.b2_two_pi);this.a0-=t,this.a-=t},t}();i.b2Sweep=m,cc._RF.pop()},{"./b2Settings":"b2Settings"}],b2MotorJoint:[function(t,e,i){"use strict";cc._RF.push(e,"71bcdC0tHxGP7UaTkKT8kJ1","b2MotorJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2MotorJoint=i.b2MotorJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=function(t){function e(){var e=t.call(this,a.b2JointType.e_motorJoint)||this;return e.linearOffset=new s.b2Vec2(0,0),e.angularOffset=0,e.maxForce=1,e.maxTorque=1,e.correctionFactor=.3,e}return n(e,t),e.prototype.Initialize=function(t,e){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(this.bodyB.GetPosition(),this.linearOffset);var i=this.bodyA.GetAngle(),o=this.bodyB.GetAngle();this.angularOffset=o-i},e}(a.b2JointDef);i.b2MotorJointDef=l;var c=function(t){function e(e){var i=t.call(this,e)||this;return i.m_linearOffset=new s.b2Vec2,i.m_angularOffset=0,i.m_linearImpulse=new s.b2Vec2,i.m_angularImpulse=0,i.m_maxForce=0,i.m_maxTorque=0,i.m_correctionFactor=.3,i.m_indexA=0,i.m_indexB=0,i.m_rA=new s.b2Vec2,i.m_rB=new s.b2Vec2,i.m_localCenterA=new s.b2Vec2,i.m_localCenterB=new s.b2Vec2,i.m_linearError=new s.b2Vec2,i.m_angularError=0,i.m_invMassA=0,i.m_invMassB=0,i.m_invIA=0,i.m_invIB=0,i.m_linearMass=new s.b2Mat22,i.m_angularMass=0,i.m_qA=new s.b2Rot,i.m_qB=new s.b2Rot,i.m_K=new s.b2Mat22,i.m_linearOffset.Copy(r.b2Maybe(e.linearOffset,s.b2Vec2.ZERO)),i.m_linearImpulse.SetZero(),i.m_maxForce=r.b2Maybe(e.maxForce,0),i.m_maxTorque=r.b2Maybe(e.maxTorque,0),i.m_correctionFactor=r.b2Maybe(e.correctionFactor,.3),i}return n(e,t),e.prototype.GetAnchorA=function(t){var e=this.m_bodyA.GetPosition();return t.x=e.x,t.y=e.y,t},e.prototype.GetAnchorB=function(t){var e=this.m_bodyB.GetPosition();return t.x=e.x,t.y=e.y,t},e.prototype.GetReactionForce=function(t,e){return s.b2Vec2.MulSV(t,this.m_linearImpulse,e)},e.prototype.GetReactionTorque=function(t){return t*this.m_angularImpulse},e.prototype.SetLinearOffset=function(t){s.b2Vec2.IsEqualToV(t,this.m_linearOffset)||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(t))},e.prototype.GetLinearOffset=function(){return this.m_linearOffset},e.prototype.SetAngularOffset=function(t){t!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=t)},e.prototype.GetAngularOffset=function(){return this.m_angularOffset},e.prototype.SetMaxForce=function(t){this.m_maxForce=t},e.prototype.GetMaxForce=function(){return this.m_maxForce},e.prototype.SetMaxTorque=function(t){this.m_maxTorque=t},e.prototype.GetMaxTorque=function(){return this.m_maxTorque},e.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].c,i=t.positions[this.m_indexA].a,o=t.velocities[this.m_indexA].v,n=t.velocities[this.m_indexA].w,r=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,l=t.velocities[this.m_indexB].v,c=t.velocities[this.m_indexB].w,u=this.m_qA.SetAngle(i),_=this.m_qB.SetAngle(a),p=s.b2Rot.MulRV(u,s.b2Vec2.SubVV(this.m_linearOffset,this.m_localCenterA,s.b2Vec2.s_t0),this.m_rA),m=s.b2Rot.MulRV(_,s.b2Vec2.NegV(this.m_localCenterB,s.b2Vec2.s_t0),this.m_rB),h=this.m_invMassA,f=this.m_invMassB,d=this.m_invIA,b=this.m_invIB,y=this.m_K;if(y.ex.x=h+f+d*p.y*p.y+b*m.y*m.y,y.ex.y=-d*p.x*p.y-b*m.x*m.y,y.ey.x=y.ex.y,y.ey.y=h+f+d*p.x*p.x+b*m.x*m.x,y.GetInverse(this.m_linearMass),this.m_angularMass=d+b,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),s.b2Vec2.SubVV(s.b2Vec2.AddVV(r,m,s.b2Vec2.s_t0),s.b2Vec2.AddVV(e,p,s.b2Vec2.s_t1),this.m_linearError),this.m_angularError=a-i-this.m_angularOffset,t.step.warmStarting){this.m_linearImpulse.SelfMul(t.step.dtRatio),this.m_angularImpulse*=t.step.dtRatio;var v=this.m_linearImpulse;o.SelfMulSub(h,v),n-=d*(s.b2Vec2.CrossVV(p,v)+this.m_angularImpulse),l.SelfMulAdd(f,v),c+=b*(s.b2Vec2.CrossVV(m,v)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].w=c},e.prototype.SolveVelocityConstraints=function(t){var i=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v,r=t.velocities[this.m_indexB].w,a=this.m_invMassA,l=this.m_invMassB,c=this.m_invIA,u=this.m_invIB,_=t.step.dt,p=t.step.inv_dt,m=r-o+p*this.m_correctionFactor*this.m_angularError,h=-this.m_angularMass*m,f=this.m_angularImpulse,d=_*this.m_maxTorque;this.m_angularImpulse=s.b2Clamp(this.m_angularImpulse+h,-d,d),o-=c*(h=this.m_angularImpulse-f),r+=u*h;var b=this.m_rA,y=this.m_rB,v=s.b2Vec2.AddVV(s.b2Vec2.SubVV(s.b2Vec2.AddVV(n,s.b2Vec2.CrossSV(r,y,s.b2Vec2.s_t0),s.b2Vec2.s_t0),s.b2Vec2.AddVV(i,s.b2Vec2.CrossSV(o,b,s.b2Vec2.s_t1),s.b2Vec2.s_t1),s.b2Vec2.s_t2),s.b2Vec2.MulSV(p*this.m_correctionFactor,this.m_linearError,s.b2Vec2.s_t3),e.SolveVelocityConstraints_s_Cdot_v2),V=s.b2Mat22.MulMV(this.m_linearMass,v,e.SolveVelocityConstraints_s_impulse_v2).SelfNeg(),C=e.SolveVelocityConstraints_s_oldImpulse_v2.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(V),d=_*this.m_maxForce,this.m_linearImpulse.LengthSquared()>d*d&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(d)),s.b2Vec2.SubVV(this.m_linearImpulse,C,V),i.SelfMulSub(a,V),o-=c*s.b2Vec2.CrossVV(b,V),n.SelfMulAdd(l,V),r+=u*s.b2Vec2.CrossVV(y,V),t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=r},e.prototype.SolvePositionConstraints=function(){return!0},e.prototype.Dump=function(t){var e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2MotorJointDef = new b2MotorJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.linearOffset.Set(%.15f, %.15f);\n",this.m_linearOffset.x,this.m_linearOffset.y),t("  jd.angularOffset = %.15f;\n",this.m_angularOffset),t("  jd.maxForce = %.15f;\n",this.m_maxForce),t("  jd.maxTorque = %.15f;\n",this.m_maxTorque),t("  jd.correctionFactor = %.15f;\n",this.m_correctionFactor),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},e.SolveVelocityConstraints_s_Cdot_v2=new s.b2Vec2,e.SolveVelocityConstraints_s_impulse_v2=new s.b2Vec2,e.SolveVelocityConstraints_s_oldImpulse_v2=new s.b2Vec2,e}(a.b2Joint);i.b2MotorJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2MouseJoint:[function(t,e,i){"use strict";cc._RF.push(e,"8c58bkZoupKQLNfIrNOUMR9","b2MouseJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2MouseJoint=i.b2MouseJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=function(t){function e(){var e=t.call(this,a.b2JointType.e_mouseJoint)||this;return e.target=new s.b2Vec2,e.maxForce=0,e.frequencyHz=5,e.dampingRatio=.7,e}return n(e,t),e}(a.b2JointDef);i.b2MouseJointDef=l;var c=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchorB=new s.b2Vec2,i.m_targetA=new s.b2Vec2,i.m_frequencyHz=0,i.m_dampingRatio=0,i.m_beta=0,i.m_impulse=new s.b2Vec2,i.m_maxForce=0,i.m_gamma=0,i.m_indexA=0,i.m_indexB=0,i.m_rB=new s.b2Vec2,i.m_localCenterB=new s.b2Vec2,i.m_invMassB=0,i.m_invIB=0,i.m_mass=new s.b2Mat22,i.m_C=new s.b2Vec2,i.m_qB=new s.b2Rot,i.m_lalcB=new s.b2Vec2,i.m_K=new s.b2Mat22,i.m_targetA.Copy(r.b2Maybe(e.target,s.b2Vec2.ZERO)),s.b2Transform.MulTXV(i.m_bodyB.GetTransform(),i.m_targetA,i.m_localAnchorB),i.m_maxForce=r.b2Maybe(e.maxForce,0),i.m_impulse.SetZero(),i.m_frequencyHz=r.b2Maybe(e.frequencyHz,0),i.m_dampingRatio=r.b2Maybe(e.dampingRatio,0),i.m_beta=0,i.m_gamma=0,i}return n(e,t),e.prototype.SetTarget=function(t){this.m_bodyB.IsAwake()||this.m_bodyB.SetAwake(!0),this.m_targetA.Copy(t)},e.prototype.GetTarget=function(){return this.m_targetA},e.prototype.SetMaxForce=function(t){this.m_maxForce=t},e.prototype.GetMaxForce=function(){return this.m_maxForce},e.prototype.SetFrequency=function(t){this.m_frequencyHz=t},e.prototype.GetFrequency=function(){return this.m_frequencyHz},e.prototype.SetDampingRatio=function(t){this.m_dampingRatio=t},e.prototype.GetDampingRatio=function(){return this.m_dampingRatio},e.prototype.InitVelocityConstraints=function(t){this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexB].c,i=t.positions[this.m_indexB].a,o=t.velocities[this.m_indexB].v,n=t.velocities[this.m_indexB].w,a=this.m_qB.SetAngle(i),l=this.m_bodyB.GetMass(),c=2*r.b2_pi*this.m_frequencyHz,u=2*l*this.m_dampingRatio*c,_=l*c*c,p=t.step.dt;this.m_gamma=p*(u+p*_),0!==this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=p*_*this.m_gamma,s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),s.b2Rot.MulRV(a,this.m_lalcB,this.m_rB);var m=this.m_K;m.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,m.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,m.ey.x=m.ex.y,m.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,m.GetInverse(this.m_mass),this.m_C.x=e.x+this.m_rB.x-this.m_targetA.x,this.m_C.y=e.y+this.m_rB.y-this.m_targetA.y,this.m_C.SelfMul(this.m_beta),n*=.98,t.step.warmStarting?(this.m_impulse.SelfMul(t.step.dtRatio),o.x+=this.m_invMassB*this.m_impulse.x,o.y+=this.m_invMassB*this.m_impulse.y,n+=this.m_invIB*s.b2Vec2.CrossVV(this.m_rB,this.m_impulse)):this.m_impulse.SetZero(),t.velocities[this.m_indexB].w=n},e.prototype.SolveVelocityConstraints=function(t){var i=t.velocities[this.m_indexB].v,o=t.velocities[this.m_indexB].w,n=s.b2Vec2.AddVCrossSV(i,o,this.m_rB,e.SolveVelocityConstraints_s_Cdot),r=s.b2Mat22.MulMV(this.m_mass,s.b2Vec2.AddVV(n,s.b2Vec2.AddVV(this.m_C,s.b2Vec2.MulSV(this.m_gamma,this.m_impulse,s.b2Vec2.s_t0),s.b2Vec2.s_t0),s.b2Vec2.s_t0).SelfNeg(),e.SolveVelocityConstraints_s_impulse),a=e.SolveVelocityConstraints_s_oldImpulse.Copy(this.m_impulse);this.m_impulse.SelfAdd(r);var l=t.step.dt*this.m_maxForce;this.m_impulse.LengthSquared()>l*l&&this.m_impulse.SelfMul(l/this.m_impulse.Length()),s.b2Vec2.SubVV(this.m_impulse,a,r),i.SelfMulAdd(this.m_invMassB,r),o+=this.m_invIB*s.b2Vec2.CrossVV(this.m_rB,r),t.velocities[this.m_indexB].w=o},e.prototype.SolvePositionConstraints=function(){return!0},e.prototype.GetAnchorA=function(t){return t.x=this.m_targetA.x,t.y=this.m_targetA.y,t},e.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)},e.prototype.GetReactionForce=function(t,e){return s.b2Vec2.MulSV(t,this.m_impulse,e)},e.prototype.GetReactionTorque=function(){return 0},e.prototype.Dump=function(t){t("Mouse joint dumping is not supported.\n")},e.prototype.ShiftOrigin=function(t){this.m_targetA.SelfSub(t)},e.SolveVelocityConstraints_s_Cdot=new s.b2Vec2,e.SolveVelocityConstraints_s_impulse=new s.b2Vec2,e.SolveVelocityConstraints_s_oldImpulse=new s.b2Vec2,e}(a.b2Joint);i.b2MouseJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2ParticleGroup:[function(t,e,i){"use strict";cc._RF.push(e,"861f69yEl9JiaUKvA3wexLP","b2ParticleGroup"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2ParticleGroup=i.b2ParticleGroupDef=i.b2ParticleGroupFlag=void 0;var o,n=t("../Common/b2Math"),r=t("../Common/b2Draw");(function(t){t[t.b2_solidParticleGroup=1]="b2_solidParticleGroup",t[t.b2_rigidParticleGroup=2]="b2_rigidParticleGroup",t[t.b2_particleGroupCanBeEmpty=4]="b2_particleGroupCanBeEmpty",t[t.b2_particleGroupWillBeDestroyed=8]="b2_particleGroupWillBeDestroyed",t[t.b2_particleGroupNeedsUpdateDepth=16]="b2_particleGroupNeedsUpdateDepth",t[t.b2_particleGroupInternalMask=24]="b2_particleGroupInternalMask"})(o=i.b2ParticleGroupFlag||(i.b2ParticleGroupFlag={}));i.b2ParticleGroupDef=function(){this.flags=0,this.groupFlags=0,this.position=new n.b2Vec2,this.angle=0,this.linearVelocity=new n.b2Vec2,this.angularVelocity=0,this.color=new r.b2Color,this.strength=1,this.shapeCount=0,this.stride=0,this.particleCount=0,this.lifetime=0,this.userData=null,this.group=null};var s=function(){function t(t){this.m_firstIndex=0,this.m_lastIndex=0,this.m_groupFlags=0,this.m_strength=1,this.m_prev=null,this.m_next=null,this.m_timestamp=-1,this.m_mass=0,this.m_inertia=0,this.m_center=new n.b2Vec2,this.m_linearVelocity=new n.b2Vec2,this.m_angularVelocity=0,this.m_transform=new n.b2Transform,this.m_userData=null,this.m_system=t}return t.prototype.GetNext=function(){return this.m_next},t.prototype.GetParticleSystem=function(){return this.m_system},t.prototype.GetParticleCount=function(){return this.m_lastIndex-this.m_firstIndex},t.prototype.GetBufferIndex=function(){return this.m_firstIndex},t.prototype.ContainsParticle=function(t){return this.m_firstIndex<=t&&t<this.m_lastIndex},t.prototype.GetAllParticleFlags=function(){if(!this.m_system.m_flagsBuffer.data)throw new Error;for(var t=0,e=this.m_firstIndex;e<this.m_lastIndex;e++)t|=this.m_system.m_flagsBuffer.data[e];return t},t.prototype.GetGroupFlags=function(){return this.m_groupFlags},t.prototype.SetGroupFlags=function(t){t|=this.m_groupFlags&o.b2_particleGroupInternalMask,this.m_system.SetGroupFlags(this,t)},t.prototype.GetMass=function(){return this.UpdateStatistics(),this.m_mass},t.prototype.GetInertia=function(){return this.UpdateStatistics(),this.m_inertia},t.prototype.GetCenter=function(){return this.UpdateStatistics(),this.m_center},t.prototype.GetLinearVelocity=function(){return this.UpdateStatistics(),this.m_linearVelocity},t.prototype.GetAngularVelocity=function(){return this.UpdateStatistics(),this.m_angularVelocity},t.prototype.GetTransform=function(){return this.m_transform},t.prototype.GetPosition=function(){return this.m_transform.p},t.prototype.GetAngle=function(){return this.m_transform.q.GetAngle()},t.prototype.GetLinearVelocityFromWorldPoint=function(e,i){var o=t.GetLinearVelocityFromWorldPoint_s_t0;return this.UpdateStatistics(),n.b2Vec2.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,n.b2Vec2.SubVV(e,this.m_center,o),i)},t.prototype.GetUserData=function(){return this.m_userData},t.prototype.SetUserData=function(t){this.m_userData=t},t.prototype.ApplyForce=function(t){this.m_system.ApplyForce(this.m_firstIndex,this.m_lastIndex,t)},t.prototype.ApplyLinearImpulse=function(t){this.m_system.ApplyLinearImpulse(this.m_firstIndex,this.m_lastIndex,t)},t.prototype.DestroyParticles=function(t){if(this.m_system.m_world.IsLocked())throw new Error;for(var e=this.m_firstIndex;e<this.m_lastIndex;e++)this.m_system.DestroyParticle(e,t)},t.prototype.UpdateStatistics=function(){if(!this.m_system.m_positionBuffer.data)throw new Error;if(!this.m_system.m_velocityBuffer.data)throw new Error;var t=new n.b2Vec2,e=new n.b2Vec2;if(this.m_timestamp!==this.m_system.m_timestamp){var i=this.m_system.GetParticleMass();this.m_mass=i*(this.m_lastIndex-this.m_firstIndex),this.m_center.SetZero(),this.m_linearVelocity.SetZero();for(var o=this.m_firstIndex;o<this.m_lastIndex;o++)this.m_center.SelfMulAdd(i,this.m_system.m_positionBuffer.data[o]),this.m_linearVelocity.SelfMulAdd(i,this.m_system.m_velocityBuffer.data[o]);if(this.m_mass>0){var r=1/this.m_mass;this.m_center.SelfMul(r),this.m_linearVelocity.SelfMul(r)}for(this.m_inertia=0,this.m_angularVelocity=0,o=this.m_firstIndex;o<this.m_lastIndex;o++)n.b2Vec2.SubVV(this.m_system.m_positionBuffer.data[o],this.m_center,t),n.b2Vec2.SubVV(this.m_system.m_velocityBuffer.data[o],this.m_linearVelocity,e),this.m_inertia+=i*n.b2Vec2.DotVV(t,t),this.m_angularVelocity+=i*n.b2Vec2.CrossVV(t,e);this.m_inertia>0&&(this.m_angularVelocity*=1/this.m_inertia),this.m_timestamp=this.m_system.m_timestamp}},t.GetLinearVelocityFromWorldPoint_s_t0=new n.b2Vec2,t}();i.b2ParticleGroup=s,cc._RF.pop()},{"../Common/b2Draw":"b2Draw","../Common/b2Math":"b2Math"}],b2ParticleSystem:[function(t,e,i){"use strict";cc._RF.push(e,"26af0Pkr4VN5Z9gEkkbSBYN","b2ParticleSystem");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2ParticleSystem_SolveCollisionCallback=i.b2ParticleSystem_UpdateBodyContactsCallback=i.b2ParticleSystem_ReactiveFilter=i.b2ParticleSystem_CompositeShape=i.b2ParticleSystem_JoinParticleGroupsFilter=i.b2ParticleSystem_DestroyParticlesInShapeCallback=i.b2ParticleSystem_ConnectionFilter=i.b2ParticlePairSet=i.b2ParticleSystem_ParticlePair=i.b2ParticleSystem_FixtureParticleSet=i.b2ParticleSystem_FixtureParticle=i.b2ParticleSystem_FixedSetAllocator=i.b2ParticleSystem_ParticleListNode=i.b2ParticleSystem_InsideBoundsEnumerator=i.b2ParticleSystem_Proxy=i.b2ParticleSystem_UserOverridableBuffer=i.b2ParticleSystem=i.b2ParticleSystemDef=i.b2ParticleTriad=i.b2ParticlePair=i.b2ParticleBodyContact=i.b2ParticleContact=i.b2FixtureParticleQueryCallback=i.b2GrowableBuffer=void 0;var r=t("../Common/b2Settings"),s=t("../Common/b2Settings"),a=t("../Common/b2Math"),l=t("../Common/b2Draw"),c=t("../Collision/b2Collision"),u=t("../Collision/Shapes/b2Shape"),_=t("../Collision/Shapes/b2EdgeShape"),p=t("../Dynamics/b2TimeStep"),m=t("../Dynamics/b2WorldCallbacks"),h=t("./b2Particle"),f=t("./b2ParticleGroup"),d=t("./b2VoronoiDiagram");function b(t,e,i){var o=t[e];t[e]=t[i],t[i]=o}function y(t,e){return t<e}function v(t,e,i,o){void 0===e&&(e=0),void 0===i&&(i=t.length-e),void 0===o&&(o=y);for(var n=e,r=[],s=0;;){for(;n+1<i;i++){var a=t[n+Math.floor(Math.random()*(i-n))];r[s++]=i;for(var l=n-1;;){for(;o(t[++l],a););for(;o(a,t[--i]););if(l>=i)break;b(t,l,i)}}if(0===s)break;n=i,i=r[--s]}return t}function V(t,e,i,o){return void 0===e&&(e=0),void 0===i&&(i=t.length-e),void 0===o&&(o=y),v(t,e,i,o)}function C(t,e,i){void 0===i&&(i=t.length);for(var o=0,n=0;n<i;++n)e(t[n])||(n!==o?b(t,o++,n):++o);return o}function g(t,e,i,o,n){for(var r=i-e;r>0;){var s=Math.floor(r/2),a=e+s;n(t[a],o)?(e=++a,r-=s+1):r=s}return e}function x(t,e,i,o,n){for(var r=i-e;r>0;){var s=Math.floor(r/2),a=e+s;n(o,t[a])?r=s:(e=++a,r-=s+1)}return e}function S(t,e,i,o){for(var n=i;e!==n;)b(t,e++,n++),n===o?n=i:e===i&&(i=n)}function B(t,e,i,o){if(e===i)return i;for(var n=e;++e!==i;)o(t[n],t[e])||b(t,++n,e);return++n}var A=function(){function t(t){this.data=[],this.count=0,this.capacity=0,this.allocator=t}return t.prototype.Append=function(){return this.count>=this.capacity&&this.Grow(),this.count++},t.prototype.Reserve=function(t){if(!(this.capacity>=t)){for(var e=this.capacity;e<t;++e)this.data[e]=this.allocator();this.capacity=t}},t.prototype.Grow=function(){var t=this.capacity?2*this.capacity:r.b2_minParticleSystemBufferCapacity;this.Reserve(t)},t.prototype.Free=function(){0!==this.data.length&&(this.data=[],this.capacity=0,this.count=0)},t.prototype.Shorten=function(){},t.prototype.Data=function(){return this.data},t.prototype.GetCount=function(){return this.count},t.prototype.SetCount=function(t){this.count=t},t.prototype.GetCapacity=function(){return this.capacity},t.prototype.RemoveIf=function(t){this.count=C(this.data,t,this.count)},t.prototype.Unique=function(t){this.count=B(this.data,0,this.count,t)},t}();i.b2GrowableBuffer=A;var P=function(t){function e(e){var i=t.call(this)||this;return i.m_system=e,i}return n(e,t),e.prototype.ShouldQueryParticleSystem=function(){return!1},e.prototype.ReportFixture=function(t){if(t.IsSensor())return!0;for(var e=t.GetShape().GetChildCount(),i=0;i<e;i++)for(var o=t.GetAABB(i),n=this.m_system.GetInsideBoundsEnumerator(o),r=void 0;(r=n.GetNext())>=0;)this.ReportFixtureAndParticle(t,i,r);return!0},e.prototype.ReportParticle=function(){return!1},e.prototype.ReportFixtureAndParticle=function(){},e}(m.b2QueryCallback);i.b2FixtureParticleQueryCallback=P;var w=function(){function t(){this.indexA=0,this.indexB=0,this.weight=0,this.normal=new a.b2Vec2,this.flags=0}return t.prototype.SetIndices=function(t,e){this.indexA=t,this.indexB=e},t.prototype.SetWeight=function(t){this.weight=t},t.prototype.SetNormal=function(t){this.normal.Copy(t)},t.prototype.SetFlags=function(t){this.flags=t},t.prototype.GetIndexA=function(){return this.indexA},t.prototype.GetIndexB=function(){return this.indexB},t.prototype.GetWeight=function(){return this.weight},t.prototype.GetNormal=function(){return this.normal},t.prototype.GetFlags=function(){return this.flags},t.prototype.IsEqual=function(t){return this.indexA===t.indexA&&this.indexB===t.indexB&&this.flags===t.flags&&this.weight===t.weight&&this.normal.x===t.normal.x&&this.normal.y===t.normal.y},t.prototype.IsNotEqual=function(t){return!this.IsEqual(t)},t.prototype.ApproximatelyEqual=function(t){return this.indexA===t.indexA&&this.indexB===t.indexB&&this.flags===t.flags&&a.b2Abs(this.weight-t.weight)<.01&&a.b2Vec2.DistanceSquaredVV(this.normal,t.normal)<1e-4},t}();i.b2ParticleContact=w;var M=function(){this.index=0,this.weight=0,this.normal=new a.b2Vec2,this.mass=0};i.b2ParticleBodyContact=M;var D=function(){this.indexA=0,this.indexB=0,this.flags=0,this.strength=0,this.distance=0};i.b2ParticlePair=D;var I=function(){this.indexA=0,this.indexB=0,this.indexC=0,this.flags=0,this.strength=0,this.pa=new a.b2Vec2(0,0),this.pb=new a.b2Vec2(0,0),this.pc=new a.b2Vec2(0,0),this.ka=0,this.kb=0,this.kc=0,this.s=0};i.b2ParticleTriad=I;var G=function(){function t(){this.strictContactCheck=!1,this.density=1,this.gravityScale=1,this.radius=1,this.maxCount=0,this.pressureStrength=.005,this.dampingStrength=1,this.elasticStrength=.25,this.springStrength=.25,this.viscousStrength=.25,this.surfaceTensionPressureStrength=.2,this.surfaceTensionNormalStrength=.2,this.repulsiveStrength=1,this.powderStrength=.5,this.ejectionStrength=.5,this.staticPressureStrength=.2,this.staticPressureRelaxation=.2,this.staticPressureIterations=8,this.colorMixingStrength=.5,this.destroyByAge=!0,this.lifetimeGranularity=1/60}return t.prototype.Copy=function(t){return this.strictContactCheck=t.strictContactCheck,this.density=t.density,this.gravityScale=t.gravityScale,this.radius=t.radius,this.maxCount=t.maxCount,this.pressureStrength=t.pressureStrength,this.dampingStrength=t.dampingStrength,this.elasticStrength=t.elasticStrength,this.springStrength=t.springStrength,this.viscousStrength=t.viscousStrength,this.surfaceTensionPressureStrength=t.surfaceTensionPressureStrength,this.surfaceTensionNormalStrength=t.surfaceTensionNormalStrength,this.repulsiveStrength=t.repulsiveStrength,this.powderStrength=t.powderStrength,this.ejectionStrength=t.ejectionStrength,this.staticPressureStrength=t.staticPressureStrength,this.staticPressureRelaxation=t.staticPressureRelaxation,this.staticPressureIterations=t.staticPressureIterations,this.colorMixingStrength=t.colorMixingStrength,this.destroyByAge=t.destroyByAge,this.lifetimeGranularity=t.lifetimeGranularity,this},t.prototype.Clone=function(){return(new t).Copy(this)},t}();i.b2ParticleSystemDef=G;var T=function(){function t(t,e){this.m_paused=!1,this.m_timestamp=0,this.m_allParticleFlags=0,this.m_needsUpdateAllParticleFlags=!1,this.m_allGroupFlags=0,this.m_needsUpdateAllGroupFlags=!1,this.m_hasForce=!1,this.m_iterationIndex=0,this.m_inverseDensity=0,this.m_particleDiameter=0,this.m_inverseDiameter=0,this.m_squaredDiameter=0,this.m_count=0,this.m_internalAllocatedCapacity=0,this.m_handleIndexBuffer=new R,this.m_flagsBuffer=new R,this.m_positionBuffer=new R,this.m_velocityBuffer=new R,this.m_forceBuffer=[],this.m_weightBuffer=[],this.m_staticPressureBuffer=[],this.m_accumulationBuffer=[],this.m_accumulation2Buffer=[],this.m_depthBuffer=[],this.m_colorBuffer=new R,this.m_groupBuffer=[],this.m_userDataBuffer=new R,this.m_stuckThreshold=0,this.m_lastBodyContactStepBuffer=new R,this.m_bodyContactCountBuffer=new R,this.m_consecutiveContactStepsBuffer=new R,this.m_stuckParticleBuffer=new A(function(){return 0}),this.m_proxyBuffer=new A(function(){return new F}),this.m_contactBuffer=new A(function(){return new w}),this.m_bodyContactBuffer=new A(function(){return new M}),this.m_pairBuffer=new A(function(){return new D}),this.m_triadBuffer=new A(function(){return new I}),this.m_expirationTimeBuffer=new R,this.m_indexByExpirationTimeBuffer=new R,this.m_timeElapsed=0,this.m_expirationTimeBufferRequiresSorting=!1,this.m_groupCount=0,this.m_groupList=null,this.m_def=new G,this.m_prev=null,this.m_next=null,this.UpdateBodyContacts_callback=null,this.SolveCollision_callback=null,this.SetStrictContactCheck(t.strictContactCheck),this.SetDensity(t.density),this.SetGravityScale(t.gravityScale),this.SetRadius(t.radius),this.SetMaxParticleCount(t.maxCount),this.m_def=t.Clone(),this.m_world=e,this.SetDestructionByAge(this.m_def.destroyByAge)}return t.computeTag=function(e,i){return(i+t.yOffset>>>0<<t.yShift)+(t.xScale*e+t.xOffset>>>0)>>>0},t.computeRelativeTag=function(e,i,o){return e+(o<<t.yShift)+(i<<t.xShift)>>>0},t.prototype.Drop=function(){for(;this.m_groupList;)this.DestroyParticleGroup(this.m_groupList);this.FreeUserOverridableBuffer(this.m_handleIndexBuffer),this.FreeUserOverridableBuffer(this.m_flagsBuffer),this.FreeUserOverridableBuffer(this.m_lastBodyContactStepBuffer),this.FreeUserOverridableBuffer(this.m_bodyContactCountBuffer),this.FreeUserOverridableBuffer(this.m_consecutiveContactStepsBuffer),this.FreeUserOverridableBuffer(this.m_positionBuffer),this.FreeUserOverridableBuffer(this.m_velocityBuffer),this.FreeUserOverridableBuffer(this.m_colorBuffer),this.FreeUserOverridableBuffer(this.m_userDataBuffer),this.FreeUserOverridableBuffer(this.m_expirationTimeBuffer),this.FreeUserOverridableBuffer(this.m_indexByExpirationTimeBuffer),this.FreeBuffer(this.m_forceBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_weightBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_staticPressureBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_accumulationBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_accumulation2Buffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_depthBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_groupBuffer,this.m_internalAllocatedCapacity)},t.prototype.CreateParticle=function(t){if(this.m_world.IsLocked())throw new Error;if(this.m_count>=this.m_internalAllocatedCapacity){var e=this.m_count?2*this.m_count:r.b2_minParticleSystemBufferCapacity;this.ReallocateInternalAllocatedBuffers(e)}if(this.m_count>=this.m_internalAllocatedCapacity){if(!this.m_def.destroyByAge)return r.b2_invalidParticleIndex;this.DestroyOldestParticle(0,!1),this.SolveZombie()}var i=this.m_count++;this.m_flagsBuffer.data[i]=0,this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[i]=0),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[i]=0),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[i]=0),this.m_positionBuffer.data[i]=(this.m_positionBuffer.data[i]||new a.b2Vec2).Copy(r.b2Maybe(t.position,a.b2Vec2.ZERO)),this.m_velocityBuffer.data[i]=(this.m_velocityBuffer.data[i]||new a.b2Vec2).Copy(r.b2Maybe(t.velocity,a.b2Vec2.ZERO)),this.m_weightBuffer[i]=0,this.m_forceBuffer[i]=(this.m_forceBuffer[i]||new a.b2Vec2).SetZero(),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[i]=0),this.m_depthBuffer&&(this.m_depthBuffer[i]=0);var o=(new l.b2Color).Copy(r.b2Maybe(t.color,l.b2Color.ZERO));!this.m_colorBuffer.data&&o.IsZero()||(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data[i]=(this.m_colorBuffer.data[i]||new l.b2Color).Copy(o)),(this.m_userDataBuffer.data||t.userData)&&(this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data[i]=t.userData),this.m_handleIndexBuffer.data&&(this.m_handleIndexBuffer.data[i]=null);var n=this.m_proxyBuffer.data[this.m_proxyBuffer.Append()],s=r.b2Maybe(t.lifetime,0),c=s>0;(this.m_expirationTimeBuffer.data||c)&&(this.SetParticleLifetime(i,c?s:this.ExpirationTimeToLifetime(-this.GetQuantizedTimeElapsed())),this.m_indexByExpirationTimeBuffer.data[i]=i),n.index=i;var u=r.b2Maybe(t.group,null);return this.m_groupBuffer[i]=u,u&&(u.m_firstIndex<u.m_lastIndex?(this.RotateBuffer(u.m_firstIndex,u.m_lastIndex,i),u.m_lastIndex=i+1):(u.m_firstIndex=i,u.m_lastIndex=i+1)),this.SetParticleFlags(i,r.b2Maybe(t.flags,0)),i},t.prototype.GetParticleHandleFromIndex=function(t){this.m_handleIndexBuffer.data=this.RequestBuffer(this.m_handleIndexBuffer.data);var e=this.m_handleIndexBuffer.data[t];return e||((e=new h.b2ParticleHandle).SetIndex(t),this.m_handleIndexBuffer.data[t]=e,e)},t.prototype.DestroyParticle=function(t,e){void 0===e&&(e=!1);var i=h.b2ParticleFlag.b2_zombieParticle;e&&(i|=h.b2ParticleFlag.b2_destructionListenerParticle),this.SetParticleFlags(t,this.m_flagsBuffer.data[t]|i)},t.prototype.DestroyOldestParticle=function(t,e){void 0===e&&(e=!1);var i=this.GetParticleCount(),o=this.m_indexByExpirationTimeBuffer.data[i-(t+1)],n=this.m_indexByExpirationTimeBuffer.data[t];this.DestroyParticle(this.m_expirationTimeBuffer.data[o]>0?o:n,e)},t.prototype.DestroyParticlesInShape=function(e,i,o){void 0===o&&(o=!1);var n=t.DestroyParticlesInShape_s_aabb;if(this.m_world.IsLocked())throw new Error;var r=new U(this,e,i,o),s=n;return e.ComputeAABB(s,i,0),this.m_world.QueryAABB(r,s),r.Destroyed()},t.prototype.CreateParticleGroup=function(e){var i=t.CreateParticleGroup_s_transform;if(this.m_world.IsLocked())throw new Error;var o=i;o.SetPositionAngle(r.b2Maybe(e.position,a.b2Vec2.ZERO),r.b2Maybe(e.angle,0));var n=this.m_count;if(e.shape&&this.CreateParticlesWithShapeForGroup(e.shape,e,o),e.shapes&&this.CreateParticlesWithShapesForGroup(e.shapes,r.b2Maybe(e.shapeCount,e.shapes.length),e,o),e.positionData)for(var s=r.b2Maybe(e.particleCount,e.positionData.length),l=0;l<s;l++){var c=e.positionData[l];this.CreateParticleForGroup(e,o,c)}var u=this.m_count,_=new f.b2ParticleGroup(this);for(_.m_firstIndex=n,_.m_lastIndex=u,_.m_strength=r.b2Maybe(e.strength,1),_.m_userData=e.userData,_.m_transform.Copy(o),_.m_prev=null,_.m_next=this.m_groupList,this.m_groupList&&(this.m_groupList.m_prev=_),this.m_groupList=_,++this.m_groupCount,l=n;l<u;l++)this.m_groupBuffer[l]=_;this.SetGroupFlags(_,r.b2Maybe(e.groupFlags,0));var p=new k;return this.UpdateContacts(!0),this.UpdatePairsAndTriads(n,u,p),e.group&&(this.JoinParticleGroups(e.group,_),_=e.group),_},t.prototype.JoinParticleGroups=function(t,e){if(this.m_world.IsLocked())throw new Error;this.RotateBuffer(e.m_firstIndex,e.m_lastIndex,this.m_count),this.RotateBuffer(t.m_firstIndex,t.m_lastIndex,e.m_firstIndex);var i=new N(e.m_firstIndex);this.UpdateContacts(!0),this.UpdatePairsAndTriads(t.m_firstIndex,e.m_lastIndex,i);for(var o=e.m_firstIndex;o<e.m_lastIndex;o++)this.m_groupBuffer[o]=t;var n=t.m_groupFlags|e.m_groupFlags;this.SetGroupFlags(t,n),t.m_lastIndex=e.m_lastIndex,e.m_firstIndex=e.m_lastIndex,this.DestroyParticleGroup(e)},t.prototype.SplitParticleGroup=function(e){this.UpdateContacts(!0);var i=e.GetParticleCount(),o=r.b2MakeArray(i,function(){return new L});t.InitializeParticleLists(e,o),this.MergeParticleListsInContact(e,o);var n=t.FindLongestParticleList(e,o);this.MergeZombieParticleListNodes(e,o,n),this.CreateParticleGroupsFromParticleList(e,o,n),this.UpdatePairsAndTriadsWithParticleList(e,o)},t.prototype.GetParticleGroupList=function(){return this.m_groupList},t.prototype.GetParticleGroupCount=function(){return this.m_groupCount},t.prototype.GetParticleCount=function(){return this.m_count},t.prototype.GetMaxParticleCount=function(){return this.m_def.maxCount},t.prototype.SetMaxParticleCount=function(t){this.m_def.maxCount=t},t.prototype.GetAllParticleFlags=function(){return this.m_allParticleFlags},t.prototype.GetAllGroupFlags=function(){return this.m_allGroupFlags},t.prototype.SetPaused=function(t){this.m_paused=t},t.prototype.GetPaused=function(){return this.m_paused},t.prototype.SetDensity=function(t){this.m_def.density=t,this.m_inverseDensity=1/this.m_def.density},t.prototype.GetDensity=function(){return this.m_def.density},t.prototype.SetGravityScale=function(t){this.m_def.gravityScale=t},t.prototype.GetGravityScale=function(){return this.m_def.gravityScale},t.prototype.SetDamping=function(t){this.m_def.dampingStrength=t},t.prototype.GetDamping=function(){return this.m_def.dampingStrength},t.prototype.SetStaticPressureIterations=function(t){this.m_def.staticPressureIterations=t},t.prototype.GetStaticPressureIterations=function(){return this.m_def.staticPressureIterations},t.prototype.SetRadius=function(t){this.m_particleDiameter=2*t,this.m_squaredDiameter=this.m_particleDiameter*this.m_particleDiameter,this.m_inverseDiameter=1/this.m_particleDiameter},t.prototype.GetRadius=function(){return this.m_particleDiameter/2},t.prototype.GetPositionBuffer=function(){return this.m_positionBuffer.data},t.prototype.GetVelocityBuffer=function(){return this.m_velocityBuffer.data},t.prototype.GetColorBuffer=function(){return this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data},t.prototype.GetGroupBuffer=function(){return this.m_groupBuffer},t.prototype.GetWeightBuffer=function(){return this.m_weightBuffer},t.prototype.GetUserDataBuffer=function(){return this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data},t.prototype.GetFlagsBuffer=function(){return this.m_flagsBuffer.data},t.prototype.SetParticleFlags=function(t,e){this.m_flagsBuffer.data[t]&~e&&(this.m_needsUpdateAllParticleFlags=!0),~this.m_allParticleFlags&e&&(e&h.b2ParticleFlag.b2_tensileParticle&&(this.m_accumulation2Buffer=this.RequestBuffer(this.m_accumulation2Buffer)),e&h.b2ParticleFlag.b2_colorMixingParticle&&(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data)),this.m_allParticleFlags|=e),this.m_flagsBuffer.data[t]=e},t.prototype.GetParticleFlags=function(t){return this.m_flagsBuffer.data[t]},t.prototype.SetFlagsBuffer=function(t){this.SetUserOverridableBuffer(this.m_flagsBuffer,t)},t.prototype.SetPositionBuffer=function(t){if(t instanceof Float32Array){if(t.length%2!=0)throw new Error;for(var e=t.length/2,i=new Array(e),o=0;o<e;++o)i[o]=new a.b2Vec2(t.subarray(2*o,2*o+2));t=i}this.SetUserOverridableBuffer(this.m_positionBuffer,t)},t.prototype.SetVelocityBuffer=function(t){if(t instanceof Float32Array){if(t.length%2!=0)throw new Error;for(var e=t.length/2,i=new Array(e),o=0;o<e;++o)i[o]=new a.b2Vec2(t.subarray(2*o,2*o+2));t=i}this.SetUserOverridableBuffer(this.m_velocityBuffer,t)},t.prototype.SetColorBuffer=function(t){if(t instanceof Float32Array){if(t.length%4!=0)throw new Error;for(var e=t.length/4,i=new Array(e),o=0;o<e;++o)i[o]=new l.b2Color(t.subarray(4*o,4*o+4));t=i}this.SetUserOverridableBuffer(this.m_colorBuffer,t)},t.prototype.SetUserDataBuffer=function(t){this.SetUserOverridableBuffer(this.m_userDataBuffer,t)},t.prototype.GetContacts=function(){return this.m_contactBuffer.data},t.prototype.GetContactCount=function(){return this.m_contactBuffer.count},t.prototype.GetBodyContacts=function(){return this.m_bodyContactBuffer.data},t.prototype.GetBodyContactCount=function(){return this.m_bodyContactBuffer.count},t.prototype.GetPairs=function(){return this.m_pairBuffer.data},t.prototype.GetPairCount=function(){return this.m_pairBuffer.count},t.prototype.GetTriads=function(){return this.m_triadBuffer.data},t.prototype.GetTriadCount=function(){return this.m_triadBuffer.count},t.prototype.SetStuckThreshold=function(t){this.m_stuckThreshold=t,t>0&&(this.m_lastBodyContactStepBuffer.data=this.RequestBuffer(this.m_lastBodyContactStepBuffer.data),this.m_bodyContactCountBuffer.data=this.RequestBuffer(this.m_bodyContactCountBuffer.data),this.m_consecutiveContactStepsBuffer.data=this.RequestBuffer(this.m_consecutiveContactStepsBuffer.data))},t.prototype.GetStuckCandidates=function(){return this.m_stuckParticleBuffer.Data()},t.prototype.GetStuckCandidateCount=function(){return this.m_stuckParticleBuffer.GetCount()},t.prototype.ComputeCollisionEnergy=function(){for(var e=t.ComputeCollisionEnergy_s_v,i=this.m_velocityBuffer.data,o=0,n=0;n<this.m_contactBuffer.count;n++){var r=this.m_contactBuffer.data[n],s=r.indexA,l=r.indexB,c=r.normal,u=a.b2Vec2.SubVV(i[l],i[s],e),_=a.b2Vec2.DotVV(u,c);_<0&&(o+=_*_)}return.5*this.GetParticleMass()*o},t.prototype.SetStrictContactCheck=function(t){this.m_def.strictContactCheck=t},t.prototype.GetStrictContactCheck=function(){return this.m_def.strictContactCheck},t.prototype.SetParticleLifetime=function(t,e){var i=null===this.m_indexByExpirationTimeBuffer.data;if(this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data),this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data),i)for(var o=this.GetParticleCount(),n=0;n<o;++n)this.m_indexByExpirationTimeBuffer.data[n]=n;var r=e/this.m_def.lifetimeGranularity,s=r>0?this.GetQuantizedTimeElapsed()+r:r;s!==this.m_expirationTimeBuffer.data[t]&&(this.m_expirationTimeBuffer.data[t]=s,this.m_expirationTimeBufferRequiresSorting=!0)},t.prototype.GetParticleLifetime=function(t){return this.ExpirationTimeToLifetime(this.GetExpirationTimeBuffer()[t])},t.prototype.SetDestructionByAge=function(t){t&&this.GetExpirationTimeBuffer(),this.m_def.destroyByAge=t},t.prototype.GetDestructionByAge=function(){return this.m_def.destroyByAge},t.prototype.GetExpirationTimeBuffer=function(){return this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data),this.m_expirationTimeBuffer.data},t.prototype.ExpirationTimeToLifetime=function(t){return(t>0?t-this.GetQuantizedTimeElapsed():t)*this.m_def.lifetimeGranularity},t.prototype.GetIndexByExpirationTimeBuffer=function(){return this.GetParticleCount()?this.SetParticleLifetime(0,this.GetParticleLifetime(0)):this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data),this.m_indexByExpirationTimeBuffer.data},t.prototype.ParticleApplyLinearImpulse=function(t,e){this.ApplyLinearImpulse(t,t+1,e)},t.prototype.ApplyLinearImpulse=function(t,e,i){for(var o=this.m_velocityBuffer.data,n=(e-t)*this.GetParticleMass(),r=(new a.b2Vec2).Copy(i).SelfMul(1/n),s=t;s<e;s++)o[s].SelfAdd(r)},t.IsSignificantForce=function(t){return 0!==t.x||0!==t.y},t.prototype.ParticleApplyForce=function(e,i){t.IsSignificantForce(i)&&this.ForceCanBeApplied(this.m_flagsBuffer.data[e])&&(this.PrepareForceBuffer(),this.m_forceBuffer[e].SelfAdd(i))},t.prototype.ApplyForce=function(e,i,o){var n=(new a.b2Vec2).Copy(o).SelfMul(1/(i-e));if(t.IsSignificantForce(n)){this.PrepareForceBuffer();for(var r=e;r<i;r++)this.m_forceBuffer[r].SelfAdd(n)}},t.prototype.GetNext=function(){return this.m_next},t.prototype.QueryAABB=function(e,i){if(0!==this.m_proxyBuffer.count)for(var o=this.m_proxyBuffer.count,n=g(this.m_proxyBuffer.data,0,o,t.computeTag(this.m_inverseDiameter*i.lowerBound.x,this.m_inverseDiameter*i.lowerBound.y),F.CompareProxyTag),r=x(this.m_proxyBuffer.data,n,o,t.computeTag(this.m_inverseDiameter*i.upperBound.x,this.m_inverseDiameter*i.upperBound.y),F.CompareTagProxy),s=this.m_positionBuffer.data,a=n;a<r;++a){var l=this.m_proxyBuffer.data[a].index,c=s[l];if(i.lowerBound.x<c.x&&c.x<i.upperBound.x&&i.lowerBound.y<c.y&&c.y<i.upperBound.y&&!e.ReportParticle(this,l))break}},t.prototype.QueryShapeAABB=function(e,i,o,n){void 0===n&&(n=0);var r=t.QueryShapeAABB_s_aabb;i.ComputeAABB(r,o,n),this.QueryAABB(e,r)},t.prototype.QueryPointAABB=function(e,i,o){void 0===o&&(o=r.b2_linearSlop);var n=t.QueryPointAABB_s_aabb;n.lowerBound.Set(i.x-o,i.y-o),n.upperBound.Set(i.x+o,i.y+o),this.QueryAABB(e,n)},t.prototype.RayCast=function(e,i,o){var n=t.RayCast_s_aabb,r=t.RayCast_s_p,s=t.RayCast_s_v,l=t.RayCast_s_n,c=t.RayCast_s_point;if(0!==this.m_proxyBuffer.count){var u=this.m_positionBuffer.data,_=n;a.b2Vec2.MinV(i,o,_.lowerBound),a.b2Vec2.MaxV(i,o,_.upperBound);for(var p,m=1,h=a.b2Vec2.SubVV(o,i,s),f=a.b2Vec2.DotVV(h,h),d=this.GetInsideBoundsEnumerator(_);(p=d.GetNext())>=0;){var b=a.b2Vec2.SubVV(i,u[p],r),y=a.b2Vec2.DotVV(b,h),v=y*y-f*(a.b2Vec2.DotVV(b,b)-this.m_squaredDiameter);if(v>=0){var V=a.b2Sqrt(v),C=(-y-V)/f;if(C>m)continue;if(C<0&&((C=(-y+V)/f)<0||C>m))continue;var g=a.b2Vec2.AddVMulSV(b,C,h,l);g.Normalize();var x=e.ReportParticle(this,p,a.b2Vec2.AddVMulSV(i,C,h,c),g,C);if((m=a.b2Min(m,x))<=0)break}}}},t.prototype.ComputeAABB=function(t){var e=this.GetParticleCount();t.lowerBound.x=+r.b2_maxFloat,t.lowerBound.y=+r.b2_maxFloat,t.upperBound.x=-r.b2_maxFloat,t.upperBound.y=-r.b2_maxFloat;for(var i=this.m_positionBuffer.data,o=0;o<e;o++){var n=i[o];a.b2Vec2.MinV(t.lowerBound,n,t.lowerBound),a.b2Vec2.MaxV(t.upperBound,n,t.upperBound)}t.lowerBound.x-=this.m_particleDiameter,t.lowerBound.y-=this.m_particleDiameter,t.upperBound.x+=this.m_particleDiameter,t.upperBound.y+=this.m_particleDiameter},t.prototype.FreeBuffer=function(t){null!==t&&(t.length=0)},t.prototype.FreeUserOverridableBuffer=function(t){0===t.userSuppliedCapacity&&this.FreeBuffer(t.data,this.m_internalAllocatedCapacity)},t.prototype.ReallocateBuffer3=function(t,e,i){if(i<=e)throw new Error;var o=t?t.slice():[];return o.length=i,o},t.prototype.ReallocateBuffer5=function(t,e,i,o,n){if(o<=i)throw new Error;if(e&&!(o<=e))throw new Error;return n&&!t||e||(t=this.ReallocateBuffer3(t,i,o)),t},t.prototype.ReallocateBuffer4=function(t,e,i,o){return this.ReallocateBuffer5(t.data,t.userSuppliedCapacity,e,i,o)},t.prototype.RequestBuffer=function(t){return t||(0===this.m_internalAllocatedCapacity&&this.ReallocateInternalAllocatedBuffers(r.b2_minParticleSystemBufferCapacity),(t=[]).length=this.m_internalAllocatedCapacity),t},t.prototype.ReallocateHandleBuffers=function(t){this.m_handleIndexBuffer.data=this.ReallocateBuffer4(this.m_handleIndexBuffer,this.m_internalAllocatedCapacity,t,!0)},t.prototype.ReallocateInternalAllocatedBuffers=function(t){function e(t,e){return e&&t>e?e:t}if(t=e(t,this.m_def.maxCount),t=e(t,this.m_flagsBuffer.userSuppliedCapacity),t=e(t,this.m_positionBuffer.userSuppliedCapacity),t=e(t,this.m_velocityBuffer.userSuppliedCapacity),t=e(t,this.m_colorBuffer.userSuppliedCapacity),t=e(t,this.m_userDataBuffer.userSuppliedCapacity),this.m_internalAllocatedCapacity<t){this.ReallocateHandleBuffers(t),this.m_flagsBuffer.data=this.ReallocateBuffer4(this.m_flagsBuffer,this.m_internalAllocatedCapacity,t,!1);var i=this.m_stuckThreshold>0;this.m_lastBodyContactStepBuffer.data=this.ReallocateBuffer4(this.m_lastBodyContactStepBuffer,this.m_internalAllocatedCapacity,t,i),this.m_bodyContactCountBuffer.data=this.ReallocateBuffer4(this.m_bodyContactCountBuffer,this.m_internalAllocatedCapacity,t,i),this.m_consecutiveContactStepsBuffer.data=this.ReallocateBuffer4(this.m_consecutiveContactStepsBuffer,this.m_internalAllocatedCapacity,t,i),this.m_positionBuffer.data=this.ReallocateBuffer4(this.m_positionBuffer,this.m_internalAllocatedCapacity,t,!1),this.m_velocityBuffer.data=this.ReallocateBuffer4(this.m_velocityBuffer,this.m_internalAllocatedCapacity,t,!1),this.m_forceBuffer=this.ReallocateBuffer5(this.m_forceBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_weightBuffer=this.ReallocateBuffer5(this.m_weightBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_staticPressureBuffer=this.ReallocateBuffer5(this.m_staticPressureBuffer,0,this.m_internalAllocatedCapacity,t,!0),this.m_accumulationBuffer=this.ReallocateBuffer5(this.m_accumulationBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_accumulation2Buffer=this.ReallocateBuffer5(this.m_accumulation2Buffer,0,this.m_internalAllocatedCapacity,t,!0),this.m_depthBuffer=this.ReallocateBuffer5(this.m_depthBuffer,0,this.m_internalAllocatedCapacity,t,!0),this.m_colorBuffer.data=this.ReallocateBuffer4(this.m_colorBuffer,this.m_internalAllocatedCapacity,t,!0),this.m_groupBuffer=this.ReallocateBuffer5(this.m_groupBuffer,0,this.m_internalAllocatedCapacity,t,!1),this.m_userDataBuffer.data=this.ReallocateBuffer4(this.m_userDataBuffer,this.m_internalAllocatedCapacity,t,!0),this.m_expirationTimeBuffer.data=this.ReallocateBuffer4(this.m_expirationTimeBuffer,this.m_internalAllocatedCapacity,t,!0),this.m_indexByExpirationTimeBuffer.data=this.ReallocateBuffer4(this.m_indexByExpirationTimeBuffer,this.m_internalAllocatedCapacity,t,!1),this.m_internalAllocatedCapacity=t}},t.prototype.CreateParticleForGroup=function(t,e,i){var o=new h.b2ParticleDef;o.flags=r.b2Maybe(t.flags,0),a.b2Transform.MulXV(e,i,o.position),a.b2Vec2.AddVV(r.b2Maybe(t.linearVelocity,a.b2Vec2.ZERO),a.b2Vec2.CrossSV(r.b2Maybe(t.angularVelocity,0),a.b2Vec2.SubVV(o.position,r.b2Maybe(t.position,a.b2Vec2.ZERO),a.b2Vec2.s_t0),a.b2Vec2.s_t0),o.velocity),o.color.Copy(r.b2Maybe(t.color,l.b2Color.ZERO)),o.lifetime=r.b2Maybe(t.lifetime,0),o.userData=t.userData,this.CreateParticle(o)},t.prototype.CreateParticlesStrokeShapeForGroup=function(e,i,o){var n=t.CreateParticlesStrokeShapeForGroup_s_edge,s=t.CreateParticlesStrokeShapeForGroup_s_d,l=t.CreateParticlesStrokeShapeForGroup_s_p,c=r.b2Maybe(i.stride,0);0===c&&(c=this.GetParticleStride());for(var _=0,p=e.GetChildCount(),m=0;m<p;m++){var h=null;e.GetType()===u.b2ShapeType.e_edgeShape?h=e:(h=n,e.GetChildEdge(h,m));for(var f=a.b2Vec2.SubVV(h.m_vertex2,h.m_vertex1,s),d=f.Length();_<d;){var b=a.b2Vec2.AddVMulSV(h.m_vertex1,_/d,f,l);this.CreateParticleForGroup(i,o,b),_+=c}_-=d}},t.prototype.CreateParticlesFillShapeForGroup=function(e,i,o){var n=t.CreateParticlesFillShapeForGroup_s_aabb,s=t.CreateParticlesFillShapeForGroup_s_p,l=r.b2Maybe(i.stride,0);0===l&&(l=this.GetParticleStride());var c=a.b2Transform.IDENTITY,u=n;e.ComputeAABB(u,c,0);for(var _=Math.floor(u.lowerBound.y/l)*l;_<u.upperBound.y;_+=l)for(var p=Math.floor(u.lowerBound.x/l)*l;p<u.upperBound.x;p+=l){var m=s.Set(p,_);e.TestPoint(c,m)&&this.CreateParticleForGroup(i,o,m)}},t.prototype.CreateParticlesWithShapeForGroup=function(t,e,i){switch(t.GetType()){case u.b2ShapeType.e_edgeShape:case u.b2ShapeType.e_chainShape:this.CreateParticlesStrokeShapeForGroup(t,e,i);break;case u.b2ShapeType.e_polygonShape:case u.b2ShapeType.e_circleShape:this.CreateParticlesFillShapeForGroup(t,e,i)}},t.prototype.CreateParticlesWithShapesForGroup=function(t,e,i,o){var n=new q(t,e);this.CreateParticlesFillShapeForGroup(n,i,o)},t.prototype.CloneParticle=function(t,e){var i=new h.b2ParticleDef;i.flags=this.m_flagsBuffer.data[t],i.position.Copy(this.m_positionBuffer.data[t]),i.velocity.Copy(this.m_velocityBuffer.data[t]),this.m_colorBuffer.data&&i.color.Copy(this.m_colorBuffer.data[t]),this.m_userDataBuffer.data&&(i.userData=this.m_userDataBuffer.data[t]),i.group=e;var o=this.CreateParticle(i);if(this.m_handleIndexBuffer.data){var n=this.m_handleIndexBuffer.data[t];n&&n.SetIndex(o),this.m_handleIndexBuffer.data[o]=n,this.m_handleIndexBuffer.data[t]=null}return this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[o]=this.m_lastBodyContactStepBuffer.data[t]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[o]=this.m_bodyContactCountBuffer.data[t]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[o]=this.m_consecutiveContactStepsBuffer.data[t]),this.m_hasForce&&this.m_forceBuffer[o].Copy(this.m_forceBuffer[t]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[o]=this.m_staticPressureBuffer[t]),this.m_depthBuffer&&(this.m_depthBuffer[o]=this.m_depthBuffer[t]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[o]=this.m_expirationTimeBuffer.data[t]),o},t.prototype.DestroyParticlesInGroup=function(t,e){void 0===e&&(e=!1);for(var i=t.m_firstIndex;i<t.m_lastIndex;i++)this.DestroyParticle(i,e)},t.prototype.DestroyParticleGroup=function(t){this.m_world.m_destructionListener&&this.m_world.m_destructionListener.SayGoodbyeParticleGroup(t),this.SetGroupFlags(t,0);for(var e=t.m_firstIndex;e<t.m_lastIndex;e++)this.m_groupBuffer[e]=null;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_groupList&&(this.m_groupList=t.m_next),--this.m_groupCount},t.ParticleCanBeConnected=function(t,e){return 0!=(t&(h.b2ParticleFlag.b2_wallParticle|h.b2ParticleFlag.b2_springParticle|h.b2ParticleFlag.b2_elasticParticle))||null!==e&&0!=(e.GetGroupFlags()&f.b2ParticleGroupFlag.b2_rigidParticleGroup)},t.prototype.UpdatePairsAndTriads=function(e,i,o){for(var n=t.UpdatePairsAndTriads_s_dab,s=t.UpdatePairsAndTriads_s_dbc,l=t.UpdatePairsAndTriads_s_dca,c=this.m_positionBuffer.data,u=0,_=e;_<i;_++)u|=this.m_flagsBuffer.data[_];if(u&t.k_pairFlags)for(var p=0;p<this.m_contactBuffer.count;p++){var m=this.m_contactBuffer.data[p],f=m.indexA,b=m.indexB,y=this.m_flagsBuffer.data[f],v=this.m_flagsBuffer.data[b],C=this.m_groupBuffer[f],g=this.m_groupBuffer[b];if(f>=e&&f<i&&b>=e&&b<i&&!((y|v)&h.b2ParticleFlag.b2_zombieParticle)&&(y|v)&t.k_pairFlags&&(o.IsNecessary(f)||o.IsNecessary(b))&&t.ParticleCanBeConnected(y,C)&&t.ParticleCanBeConnected(v,g)&&o.ShouldCreatePair(f,b)){var x=this.m_pairBuffer.data[this.m_pairBuffer.Append()];x.indexA=f,x.indexB=b,x.flags=m.flags,x.strength=a.b2Min(C?C.m_strength:1,g?g.m_strength:1),x.distance=a.b2Vec2.DistanceVV(c[f],c[b])}V(this.m_pairBuffer.data,0,this.m_pairBuffer.count,t.ComparePairIndices),this.m_pairBuffer.Unique(t.MatchPairIndices)}if(u&t.k_triadFlags){var S=new d.b2VoronoiDiagram(i-e);for(_=e;_<i;_++){var B=this.m_flagsBuffer.data[_],A=this.m_groupBuffer[_];B&h.b2ParticleFlag.b2_zombieParticle||!t.ParticleCanBeConnected(B,A)||S.AddGenerator(c[_],_,o.IsNecessary(_))}var P=this.GetParticleStride();S.Generate(P/2,2*P);var w=this;S.GetNodes(function(e,i,u){var _=w.m_flagsBuffer.data[e],p=w.m_flagsBuffer.data[i],m=w.m_flagsBuffer.data[u];if((_|p|m)&t.k_triadFlags&&o.ShouldCreateTriad(e,i,u)){var h=c[e],f=c[i],d=c[u],b=a.b2Vec2.SubVV(h,f,n),y=a.b2Vec2.SubVV(f,d,s),v=a.b2Vec2.SubVV(d,h,l),V=r.b2_maxTriadDistanceSquared*w.m_squaredDiameter;if(a.b2Vec2.DotVV(b,b)>V||a.b2Vec2.DotVV(y,y)>V||a.b2Vec2.DotVV(v,v)>V)return;var C=w.m_groupBuffer[e],g=w.m_groupBuffer[i],x=w.m_groupBuffer[u],S=w.m_triadBuffer.data[w.m_triadBuffer.Append()];S.indexA=e,S.indexB=i,S.indexC=u,S.flags=_|p|m,S.strength=a.b2Min(a.b2Min(C?C.m_strength:1,g?g.m_strength:1),x?x.m_strength:1);var B=(h.x+f.x+d.x)/3,A=(h.y+f.y+d.y)/3;S.pa.x=h.x-B,S.pa.y=h.y-A,S.pb.x=f.x-B,S.pb.y=f.y-A,S.pc.x=d.x-B,S.pc.y=d.y-A,S.ka=-a.b2Vec2.DotVV(v,b),S.kb=-a.b2Vec2.DotVV(b,y),S.kc=-a.b2Vec2.DotVV(y,v),S.s=a.b2Vec2.CrossVV(h,f)+a.b2Vec2.CrossVV(f,d)+a.b2Vec2.CrossVV(d,h)}}),V(this.m_triadBuffer.data,0,this.m_triadBuffer.count,t.CompareTriadIndices),this.m_triadBuffer.Unique(t.MatchTriadIndices)}},t.prototype.UpdatePairsAndTriadsWithReactiveParticles=function(){var t=new z(this.m_flagsBuffer);this.UpdatePairsAndTriads(0,this.m_count,t);for(var e=0;e<this.m_count;e++)this.m_flagsBuffer.data[e]&=~h.b2ParticleFlag.b2_reactiveParticle;this.m_allParticleFlags&=~h.b2ParticleFlag.b2_reactiveParticle},t.ComparePairIndices=function(t,e){var i=t.indexA-e.indexA;return 0!==i?i<0:t.indexB<e.indexB},t.MatchPairIndices=function(t,e){return t.indexA===e.indexA&&t.indexB===e.indexB},t.CompareTriadIndices=function(t,e){var i=t.indexA-e.indexA;if(0!==i)return i<0;var o=t.indexB-e.indexB;return 0!==o?o<0:t.indexC<e.indexC},t.MatchTriadIndices=function(t,e){return t.indexA===e.indexA&&t.indexB===e.indexB&&t.indexC===e.indexC},t.InitializeParticleLists=function(t,e){for(var i=t.GetBufferIndex(),o=t.GetParticleCount(),n=0;n<o;n++){var r=e[n];r.list=r,r.next=null,r.count=1,r.index=n+i}},t.prototype.MergeParticleListsInContact=function(e,i){for(var o=e.GetBufferIndex(),n=0;n<this.m_contactBuffer.count;n++){var r=this.m_contactBuffer.data[n],s=r.indexA,a=r.indexB;if(e.ContainsParticle(s)&&e.ContainsParticle(a)){var l=i[s-o].list,c=i[a-o].list;if(l!==c){if(l.count<c.count){var u=l;l=c,c=u}t.MergeParticleLists(l,c)}}}},t.MergeParticleLists=function(t,e){for(var i=e;;){i.list=t;var o=i.next;if(!o){i.next=t.next;break}i=o}t.next=e,t.count+=e.count,e.count=0},t.FindLongestParticleList=function(t,e){for(var i=t.GetParticleCount(),o=e[0],n=0;n<i;n++){var r=e[n];o.count<r.count&&(o=r)}return o},t.prototype.MergeZombieParticleListNodes=function(e,i,o){for(var n=e.GetParticleCount(),r=0;r<n;r++){var s=i[r];s!==o&&this.m_flagsBuffer.data[s.index]&h.b2ParticleFlag.b2_zombieParticle&&t.MergeParticleListAndNode(o,s)}},t.MergeParticleListAndNode=function(t,e){e.list=t,e.next=t.next,t.next=e,t.count++,e.count=0},t.prototype.CreateParticleGroupsFromParticleList=function(t,e,i){var o=t.GetParticleCount(),n=new f.b2ParticleGroupDef;n.groupFlags=t.GetGroupFlags(),n.userData=t.GetUserData();for(var r=0;r<o;r++){var s=e[r];if(s.count&&s!==i)for(var a=this.CreateParticleGroup(n),l=s;l;l=l.next){var c=l.index,u=this.CloneParticle(c,a);this.m_flagsBuffer.data[c]|=h.b2ParticleFlag.b2_zombieParticle,l.index=u}}},t.prototype.UpdatePairsAndTriadsWithParticleList=function(t,e){for(var i=t.GetBufferIndex(),o=0;o<this.m_pairBuffer.count;o++){var n=this.m_pairBuffer.data[o],r=n.indexA,s=n.indexB;t.ContainsParticle(r)&&(n.indexA=e[r-i].index),t.ContainsParticle(s)&&(n.indexB=e[s-i].index)}for(o=0;o<this.m_triadBuffer.count;o++){var a=this.m_triadBuffer.data[o],l=(r=a.indexA,s=a.indexB,a.indexC);t.ContainsParticle(r)&&(a.indexA=e[r-i].index),t.ContainsParticle(s)&&(a.indexB=e[s-i].index),t.ContainsParticle(l)&&(a.indexC=e[l-i].index)}},t.prototype.ComputeDepth=function(){for(var t=[],e=0,i=0;i<this.m_contactBuffer.count;i++){var o=(v=this.m_contactBuffer.data[i]).indexA,n=v.indexB,s=this.m_groupBuffer[o],l=this.m_groupBuffer[n];s&&s===l&&s.m_groupFlags&f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&(t[e++]=v)}for(var c=[],u=0,_=this.m_groupList;_;_=_.GetNext())if(_.m_groupFlags&f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth){c[u++]=_,this.SetGroupFlags(_,_.m_groupFlags&~f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);for(var p=_.m_firstIndex;p<_.m_lastIndex;p++)this.m_accumulationBuffer[p]=0}for(i=0;i<e;i++){o=(v=t[i]).indexA,n=v.indexB;var m=v.weight;this.m_accumulationBuffer[o]+=m,this.m_accumulationBuffer[n]+=m}for(p=0;p<u;p++)for(var h=(_=c[p]).m_firstIndex;h<_.m_lastIndex;h++)m=this.m_accumulationBuffer[h],this.m_depthBuffer[h]=m<.8?0:r.b2_maxFloat;for(var d=a.b2Sqrt(this.m_count)>>0,b=0;b<d;b++){var y=!1;for(i=0;i<e;i++){o=(v=t[i]).indexA,n=v.indexB;var v,V=1-v.weight,C=this.m_depthBuffer[o],g=this.m_depthBuffer[n],x=g+V,S=C+V;C>x&&(this.m_depthBuffer[o]=x,y=!0),g>S&&(this.m_depthBuffer[n]=S,y=!0)}if(!y)break}for(p=0;p<u;p++)for(var B=(_=c[p]).m_firstIndex;B<_.m_lastIndex;B++)this.m_depthBuffer[B]<r.b2_maxFloat?this.m_depthBuffer[B]*=this.m_particleDiameter:this.m_depthBuffer[B]=0},t.prototype.GetInsideBoundsEnumerator=function(e){var i=t.computeTag(this.m_inverseDiameter*e.lowerBound.x-1,this.m_inverseDiameter*e.lowerBound.y-1),o=t.computeTag(this.m_inverseDiameter*e.upperBound.x+1,this.m_inverseDiameter*e.upperBound.y+1),n=this.m_proxyBuffer.count,r=g(this.m_proxyBuffer.data,0,n,i,F.CompareProxyTag),s=x(this.m_proxyBuffer.data,0,n,o,F.CompareTagProxy);return new O(this,i,o,r,s)},t.prototype.UpdateAllParticleFlags=function(){this.m_allParticleFlags=0;for(var t=0;t<this.m_count;t++)this.m_allParticleFlags|=this.m_flagsBuffer.data[t];this.m_needsUpdateAllParticleFlags=!1},t.prototype.UpdateAllGroupFlags=function(){this.m_allGroupFlags=0;for(var t=this.m_groupList;t;t=t.GetNext())this.m_allGroupFlags|=t.m_groupFlags;this.m_needsUpdateAllGroupFlags=!1},t.prototype.AddContact=function(e,i){var o=this.m_flagsBuffer.data,n=this.m_positionBuffer.data,r=a.b2Vec2.SubVV(n[i],n[e],t.AddContact_s_d),s=a.b2Vec2.DotVV(r,r);if(0<s&&s<this.m_squaredDiameter){var l=a.b2InvSqrt(s),c=this.m_contactBuffer.data[this.m_contactBuffer.Append()];c.indexA=e,c.indexB=i,c.flags=o[e]|o[i],c.weight=1-s*l*this.m_inverseDiameter,c.normal.x=l*r.x,c.normal.y=l*r.y}},t.prototype.FindContacts_Reference=function(){var e=this.m_proxyBuffer.count;this.m_contactBuffer.count=0;for(var i=0,o=0;i<e;i++){for(var n=t.computeRelativeTag(this.m_proxyBuffer.data[i].tag,1,0),r=i+1;r<e&&!(n<this.m_proxyBuffer.data[r].tag);r++)this.AddContact(this.m_proxyBuffer.data[i].index,this.m_proxyBuffer.data[r].index,this.m_contactBuffer);for(var s=t.computeRelativeTag(this.m_proxyBuffer.data[i].tag,-1,1);o<e&&!(s<=this.m_proxyBuffer.data[o].tag);o++);var a=t.computeRelativeTag(this.m_proxyBuffer.data[i].tag,1,1);for(r=o;r<e&&!(a<this.m_proxyBuffer.data[r].tag);r++)this.AddContact(this.m_proxyBuffer.data[i].index,this.m_proxyBuffer.data[r].index,this.m_contactBuffer)}},t.prototype.FindContacts=function(t){this.FindContacts_Reference(t)},t.prototype.UpdateProxies_Reference=function(){for(var e=this.m_positionBuffer.data,i=this.m_inverseDiameter,o=0;o<this.m_proxyBuffer.count;++o){var n=this.m_proxyBuffer.data[o],r=e[n.index];n.tag=t.computeTag(i*r.x,i*r.y)}},t.prototype.UpdateProxies=function(t){this.UpdateProxies_Reference(t)},t.prototype.SortProxies=function(){v(this.m_proxyBuffer.data,0,this.m_proxyBuffer.count,F.CompareProxyProxy)},t.prototype.FilterContacts=function(){var t=this.GetParticleContactFilter();if(null!==t){var e=this;this.m_contactBuffer.RemoveIf(function(i){return 0!=(i.flags&h.b2ParticleFlag.b2_particleContactFilterParticle)&&!t.ShouldCollideParticleParticle(e,i.indexA,i.indexB)})}},t.prototype.NotifyContactListenerPreContact=function(t){if(null!==this.GetParticleContactListener())throw t.Initialize(this.m_contactBuffer,this.m_flagsBuffer),new Error},t.prototype.NotifyContactListenerPostContact=function(){var t=this.GetParticleContactListener();if(null!==t){for(var e=0;e<this.m_contactBuffer.count;++e){var i=this.m_contactBuffer.data[e];t.BeginContactParticleParticle(this,i)}throw new Error}},t.b2ParticleContactIsZombie=function(t){return(t.flags&h.b2ParticleFlag.b2_zombieParticle)===h.b2ParticleFlag.b2_zombieParticle},t.prototype.UpdateContacts=function(e){this.UpdateProxies(this.m_proxyBuffer),this.SortProxies(this.m_proxyBuffer);var i=new E;this.NotifyContactListenerPreContact(i),this.FindContacts(this.m_contactBuffer),this.FilterContacts(this.m_contactBuffer),this.NotifyContactListenerPostContact(i),e&&this.m_contactBuffer.RemoveIf(t.b2ParticleContactIsZombie)},t.prototype.NotifyBodyContactListenerPreContact=function(t){if(null!==this.GetFixtureContactListener())throw t.Initialize(this.m_bodyContactBuffer,this.m_flagsBuffer),new Error},t.prototype.NotifyBodyContactListenerPostContact=function(){var t=this.GetFixtureContactListener();if(null!==t){for(var e=0;e<this.m_bodyContactBuffer.count;e++){var i=this.m_bodyContactBuffer.data[e];t.BeginContactFixtureParticle(this,i)}throw new Error}},t.prototype.UpdateBodyContacts=function(){var e=t.UpdateBodyContacts_s_aabb,i=new J;if(this.NotifyBodyContactListenerPreContact(i),this.m_stuckThreshold>0)for(var o=this.GetParticleCount(),n=0;n<o;n++)this.m_bodyContactCountBuffer.data[n]=0,this.m_timestamp>this.m_lastBodyContactStepBuffer.data[n]+1&&(this.m_consecutiveContactStepsBuffer.data[n]=0);this.m_bodyContactBuffer.SetCount(0),this.m_stuckParticleBuffer.SetCount(0);var r=e;this.ComputeAABB(r),null===this.UpdateBodyContacts_callback&&(this.UpdateBodyContacts_callback=new W(this));var s=this.UpdateBodyContacts_callback;s.m_contactFilter=this.GetFixtureContactFilter(),this.m_world.QueryAABB(s,r),this.m_def.strictContactCheck&&this.RemoveSpuriousBodyContacts(),this.NotifyBodyContactListenerPostContact(i)},t.prototype.Solve=function(e){var i=t.Solve_s_subStep;if(0!==this.m_count&&(this.m_expirationTimeBuffer.data&&this.SolveLifetimes(e),this.m_allParticleFlags&h.b2ParticleFlag.b2_zombieParticle&&this.SolveZombie(),this.m_needsUpdateAllParticleFlags&&this.UpdateAllParticleFlags(),this.m_needsUpdateAllGroupFlags&&this.UpdateAllGroupFlags(),!this.m_paused))for(this.m_iterationIndex=0;this.m_iterationIndex<e.particleIterations;this.m_iterationIndex++){++this.m_timestamp;var o=i.Copy(e);o.dt/=e.particleIterations,o.inv_dt*=e.particleIterations,this.UpdateContacts(!1),this.UpdateBodyContacts(),this.ComputeWeight(),this.m_allGroupFlags&f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&this.ComputeDepth(),this.m_allParticleFlags&h.b2ParticleFlag.b2_reactiveParticle&&this.UpdatePairsAndTriadsWithReactiveParticles(),this.m_hasForce&&this.SolveForce(o),this.m_allParticleFlags&h.b2ParticleFlag.b2_viscousParticle&&this.SolveViscous(),this.m_allParticleFlags&h.b2ParticleFlag.b2_repulsiveParticle&&this.SolveRepulsive(o),this.m_allParticleFlags&h.b2ParticleFlag.b2_powderParticle&&this.SolvePowder(o),this.m_allParticleFlags&h.b2ParticleFlag.b2_tensileParticle&&this.SolveTensile(o),this.m_allGroupFlags&f.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SolveSolid(o),this.m_allParticleFlags&h.b2ParticleFlag.b2_colorMixingParticle&&this.SolveColorMixing(),this.SolveGravity(o),this.m_allParticleFlags&h.b2ParticleFlag.b2_staticPressureParticle&&this.SolveStaticPressure(o),this.SolvePressure(o),this.SolveDamping(o),this.m_allParticleFlags&t.k_extraDampingFlags&&this.SolveExtraDamping(),this.m_allParticleFlags&h.b2ParticleFlag.b2_elasticParticle&&this.SolveElastic(o),this.m_allParticleFlags&h.b2ParticleFlag.b2_springParticle&&this.SolveSpring(o),this.LimitVelocity(o),this.m_allGroupFlags&f.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigidDamping(),this.m_allParticleFlags&h.b2ParticleFlag.b2_barrierParticle&&this.SolveBarrier(o),this.SolveCollision(o),this.m_allGroupFlags&f.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigid(o),this.m_allParticleFlags&h.b2ParticleFlag.b2_wallParticle&&this.SolveWall();for(var n=0;n<this.m_count;n++)this.m_positionBuffer.data[n].SelfMulAdd(o.dt,this.m_velocityBuffer.data[n])}},t.prototype.SolveCollision=function(e){var i=t.SolveCollision_s_aabb,o=this.m_positionBuffer.data,n=this.m_velocityBuffer.data,s=i;s.lowerBound.x=+r.b2_maxFloat,s.lowerBound.y=+r.b2_maxFloat,s.upperBound.x=-r.b2_maxFloat,s.upperBound.y=-r.b2_maxFloat;for(var l=0;l<this.m_count;l++){var c=n[l],u=o[l],_=u.x+e.dt*c.x,p=u.y+e.dt*c.y;s.lowerBound.x=a.b2Min(s.lowerBound.x,a.b2Min(u.x,_)),s.lowerBound.y=a.b2Min(s.lowerBound.y,a.b2Min(u.y,p)),s.upperBound.x=a.b2Max(s.upperBound.x,a.b2Max(u.x,_)),s.upperBound.y=a.b2Max(s.upperBound.y,a.b2Max(u.y,p))}null===this.SolveCollision_callback&&(this.SolveCollision_callback=new X(this,e));var m=this.SolveCollision_callback;m.m_step=e,this.m_world.QueryAABB(m,s)},t.prototype.LimitVelocity=function(t){for(var e=this.m_velocityBuffer.data,i=this.GetCriticalVelocitySquared(t),o=0;o<this.m_count;o++){var n=e[o],r=a.b2Vec2.DotVV(n,n);r>i&&n.SelfMul(a.b2Sqrt(i/r))}},t.prototype.SolveGravity=function(e){for(var i=t.SolveGravity_s_gravity,o=this.m_velocityBuffer.data,n=a.b2Vec2.MulSV(e.dt*this.m_def.gravityScale,this.m_world.GetGravity(),i),r=0;r<this.m_count;r++)o[r].SelfAdd(n)},t.prototype.SolveBarrier=function(e){for(var i=t.SolveBarrier_s_aabb,o=t.SolveBarrier_s_va,n=t.SolveBarrier_s_vb,s=t.SolveBarrier_s_pba,l=t.SolveBarrier_s_vba,c=t.SolveBarrier_s_vc,u=t.SolveBarrier_s_pca,_=t.SolveBarrier_s_vca,p=t.SolveBarrier_s_qba,m=t.SolveBarrier_s_qca,f=t.SolveBarrier_s_dv,d=t.SolveBarrier_s_f,b=this.m_positionBuffer.data,y=this.m_velocityBuffer.data,v=0;v<this.m_count;v++)0!=(this.m_flagsBuffer.data[v]&t.k_barrierWallFlags)&&y[v].SetZero();for(var V=r.b2_barrierCollisionTime*e.dt,C=this.GetParticleMass(),g=0;g<this.m_pairBuffer.count;g++){var x=this.m_pairBuffer.data[g];if(x.flags&h.b2ParticleFlag.b2_barrierParticle){var S=x.indexA,B=x.indexB,A=b[S],P=b[B],w=i;a.b2Vec2.MinV(A,P,w.lowerBound),a.b2Vec2.MaxV(A,P,w.upperBound);for(var M=this.m_groupBuffer[S],D=this.m_groupBuffer[B],I=this.GetLinearVelocity(M,S,A,o),G=this.GetLinearVelocity(D,B,P,n),T=a.b2Vec2.SubVV(P,A,s),R=a.b2Vec2.SubVV(G,I,l),F=this.GetInsideBoundsEnumerator(w),O=void 0;(O=F.GetNext())>=0;){var L=b[O],j=this.m_groupBuffer[O];if(M!==j&&D!==j){var J=this.GetLinearVelocity(j,O,L,c),E=a.b2Vec2.SubVV(L,A,u),k=a.b2Vec2.SubVV(J,I,_),U=a.b2Vec2.CrossVV(R,k),N=a.b2Vec2.CrossVV(T,k)-a.b2Vec2.CrossVV(E,R),q=a.b2Vec2.CrossVV(T,E),z=void 0,W=void 0,X=p,Z=m;if(0===U){if(0===N)continue;if(!((W=-q/N)>=0&&W<V))continue;if(a.b2Vec2.AddVMulSV(T,W,R,X),a.b2Vec2.AddVMulSV(E,W,k,Z),!((z=a.b2Vec2.DotVV(X,Z)/a.b2Vec2.DotVV(X,X))>=0&&z<=1))continue}else{var H=N*N-4*q*U;if(H<0)continue;var Q=a.b2Sqrt(H),Y=(-N-Q)/(2*U),K=(-N+Q)/(2*U);if(Y>K){var $=Y;Y=K,K=$}if(W=Y,a.b2Vec2.AddVMulSV(T,W,R,X),a.b2Vec2.AddVMulSV(E,W,k,Z),z=a.b2Vec2.DotVV(X,Z)/a.b2Vec2.DotVV(X,X),!(W>=0&&W<V&&z>=0&&z<=1)){if(!((W=K)>=0&&W<V))continue;if(a.b2Vec2.AddVMulSV(T,W,R,X),a.b2Vec2.AddVMulSV(E,W,k,Z),!((z=a.b2Vec2.DotVV(X,Z)/a.b2Vec2.DotVV(X,X))>=0&&z<=1))continue}}var tt=f;tt.x=I.x+z*R.x-J.x,tt.y=I.y+z*R.y-J.y;var et=a.b2Vec2.MulSV(C,tt,d);if(j&&this.IsRigidGroup(j)){var it=j.GetMass(),ot=j.GetInertia();it>0&&j.m_linearVelocity.SelfMulAdd(1/it,et),ot>0&&(j.m_angularVelocity+=a.b2Vec2.CrossVV(a.b2Vec2.SubVV(L,j.GetCenter(),a.b2Vec2.s_t0),et)/ot)}else y[O].SelfAdd(tt);this.ParticleApplyForce(O,et.SelfMul(-e.inv_dt))}}}}},t.prototype.SolveStaticPressure=function(t){this.m_staticPressureBuffer=this.RequestBuffer(this.m_staticPressureBuffer);for(var e=this.GetCriticalPressure(t),i=this.m_def.staticPressureStrength*e,o=s.b2_maxParticlePressure*e,n=this.m_def.staticPressureRelaxation,r=0;r<this.m_def.staticPressureIterations;r++){for(var l=0;l<this.m_count;l++)this.m_accumulationBuffer[l]=0;for(var c=0;c<this.m_contactBuffer.count;c++){var u=this.m_contactBuffer.data[c];if(u.flags&h.b2ParticleFlag.b2_staticPressureParticle){var _=u.indexA,p=u.indexB,m=u.weight;this.m_accumulationBuffer[_]+=m*this.m_staticPressureBuffer[p],this.m_accumulationBuffer[p]+=m*this.m_staticPressureBuffer[_]}}for(l=0;l<this.m_count;l++)if(m=this.m_weightBuffer[l],this.m_flagsBuffer.data[l]&h.b2ParticleFlag.b2_staticPressureParticle){var f=(this.m_accumulationBuffer[l]+i*(m-s.b2_minParticleWeight))/(m+n);this.m_staticPressureBuffer[l]=a.b2Clamp(f,0,o)}else this.m_staticPressureBuffer[l]=0}},t.prototype.ComputeWeight=function(){for(var t=0;t<this.m_count;t++)this.m_weightBuffer[t]=0;for(t=0;t<this.m_bodyContactBuffer.count;t++){var e=(o=this.m_bodyContactBuffer.data[t]).index,i=o.weight;this.m_weightBuffer[e]+=i}for(t=0;t<this.m_contactBuffer.count;t++){e=(o=this.m_contactBuffer.data[t]).indexA;var o,n=o.indexB;i=o.weight,this.m_weightBuffer[e]+=i,this.m_weightBuffer[n]+=i}},t.prototype.SolvePressure=function(e){for(var i=t.SolvePressure_s_f,o=this.m_positionBuffer.data,n=this.m_velocityBuffer.data,r=this.GetCriticalPressure(e),l=this.m_def.pressureStrength*r,c=s.b2_maxParticlePressure*r,u=0;u<this.m_count;u++){var _=this.m_weightBuffer[u],p=l*a.b2Max(0,_-s.b2_minParticleWeight);this.m_accumulationBuffer[u]=a.b2Min(p,c)}if(this.m_allParticleFlags&t.k_noPressureFlags)for(u=0;u<this.m_count;u++)this.m_flagsBuffer.data[u]&t.k_noPressureFlags&&(this.m_accumulationBuffer[u]=0);if(this.m_allParticleFlags&h.b2ParticleFlag.b2_staticPressureParticle)for(u=0;u<this.m_count;u++)this.m_flagsBuffer.data[u]&h.b2ParticleFlag.b2_staticPressureParticle&&(this.m_accumulationBuffer[u]+=this.m_staticPressureBuffer[u]);for(var m=e.dt/(this.m_def.density*this.m_particleDiameter),f=this.GetParticleInvMass(),d=0;d<this.m_bodyContactBuffer.count;d++){var b=(x=this.m_bodyContactBuffer.data[d]).index,y=x.body,v=(_=x.weight,x.mass),V=x.normal,C=o[b],g=(p=this.m_accumulationBuffer[b]+l*_,a.b2Vec2.MulSV(m*_*v*p,V,i));n[b].SelfMulSub(f,g),y.ApplyLinearImpulse(g,C,!0)}for(d=0;d<this.m_contactBuffer.count;d++){var x;b=(x=this.m_contactBuffer.data[d]).indexA,y=x.indexB,_=x.weight,V=x.normal,p=this.m_accumulationBuffer[b]+this.m_accumulationBuffer[y],g=a.b2Vec2.MulSV(m*_*p,V,i),n[b].SelfSub(g),n[y].SelfAdd(g)}},t.prototype.SolveDamping=function(e){for(var i=t.SolveDamping_s_v,o=t.SolveDamping_s_f,n=this.m_positionBuffer.data,r=this.m_velocityBuffer.data,s=this.m_def.dampingStrength,l=1/this.GetCriticalVelocity(e),c=this.GetParticleInvMass(),u=0;u<this.m_bodyContactBuffer.count;u++){var _=(V=this.m_bodyContactBuffer.data[u]).index,p=V.body,m=V.weight,h=V.mass,f=V.normal,d=n[_],b=a.b2Vec2.SubVV(p.GetLinearVelocityFromWorldPoint(d,a.b2Vec2.s_t0),r[_],i);if((C=a.b2Vec2.DotVV(b,f))<0){var y=a.b2Max(s*m,a.b2Min(-l*C,.5)),v=a.b2Vec2.MulSV(y*h*C,f,o);r[_].SelfMulAdd(c,v),p.ApplyLinearImpulse(v.SelfNeg(),d,!0)}}for(u=0;u<this.m_contactBuffer.count;u++){var V,C;_=(V=this.m_contactBuffer.data[u]).indexA,p=V.indexB,m=V.weight,f=V.normal,b=a.b2Vec2.SubVV(r[p],r[_],i),(C=a.b2Vec2.DotVV(b,f))<0&&(y=a.b2Max(s*m,a.b2Min(-l*C,.5)),v=a.b2Vec2.MulSV(y*C,f,o),r[_].SelfAdd(v),r[p].SelfSub(v))}},t.prototype.SolveRigidDamping=function(){for(var e=t.SolveRigidDamping_s_t0,i=t.SolveRigidDamping_s_t1,o=t.SolveRigidDamping_s_p,n=t.SolveRigidDamping_s_v,r=[0],s=[0],l=[0],c=[0],u=[0],_=[0],p=this.m_positionBuffer.data,m=this.m_def.dampingStrength,h=0;h<this.m_bodyContactBuffer.count;h++){var f=(g=this.m_bodyContactBuffer.data[h]).index;if((S=this.m_groupBuffer[f])&&this.IsRigidGroup(S)){var d=g.body,b=g.normal,y=g.weight,v=p[f],V=a.b2Vec2.SubVV(d.GetLinearVelocityFromWorldPoint(v,e),S.GetLinearVelocityFromWorldPoint(v,i),n);if((x=a.b2Vec2.DotVV(V,b))<0){this.InitDampingParameterWithRigidGroupOrParticle(r,s,l,!0,S,f,v,b),this.InitDampingParameter(c,u,_,d.GetMass(),d.GetInertia()-d.GetMass()*d.GetLocalCenter().LengthSquared(),d.GetWorldCenter(),v,b);var C=m*a.b2Min(y,1)*this.ComputeDampingImpulse(r[0],s[0],l[0],c[0],u[0],_[0],x);this.ApplyDamping(r[0],s[0],l[0],!0,S,f,C,b),d.ApplyLinearImpulse(a.b2Vec2.MulSV(-C,b,a.b2Vec2.s_t0),v,!0)}}}for(h=0;h<this.m_contactBuffer.count;h++){f=(g=this.m_contactBuffer.data[h]).indexA,d=g.indexB,b=g.normal,y=g.weight;var g,x,S=this.m_groupBuffer[f],B=this.m_groupBuffer[d],A=this.IsRigidGroup(S),P=this.IsRigidGroup(B);if(S!==B&&(A||P))v=a.b2Vec2.MidVV(p[f],p[d],o),V=a.b2Vec2.SubVV(this.GetLinearVelocity(B,d,v,e),this.GetLinearVelocity(S,f,v,i),n),(x=a.b2Vec2.DotVV(V,b))<0&&(this.InitDampingParameterWithRigidGroupOrParticle(r,s,l,A,S,f,v,b),this.InitDampingParameterWithRigidGroupOrParticle(c,u,_,P,B,d,v,b),C=m*y*this.ComputeDampingImpulse(r[0],s[0],l[0],c[0],u[0],_[0],x),this.ApplyDamping(r[0],s[0],l[0],A,S,f,C,b),this.ApplyDamping(c[0],u[0],_[0],P,B,d,-C,b))}},t.prototype.SolveExtraDamping=function(){for(var e=t.SolveExtraDamping_s_v,i=t.SolveExtraDamping_s_f,o=this.m_velocityBuffer.data,n=this.m_positionBuffer.data,r=this.GetParticleInvMass(),s=0;s<this.m_bodyContactBuffer.count;s++){var l=this.m_bodyContactBuffer.data[s],c=l.index;if(this.m_flagsBuffer.data[c]&t.k_extraDampingFlags){var u=l.body,_=l.mass,p=l.normal,m=n[c],h=a.b2Vec2.SubVV(u.GetLinearVelocityFromWorldPoint(m,a.b2Vec2.s_t0),o[c],e),f=a.b2Vec2.DotVV(h,p);if(f<0){var d=a.b2Vec2.MulSV(.5*_*f,p,i);o[c].SelfMulAdd(r,d),u.ApplyLinearImpulse(d.SelfNeg(),m,!0)}}}},t.prototype.SolveWall=function(){for(var t=this.m_velocityBuffer.data,e=0;e<this.m_count;e++)this.m_flagsBuffer.data[e]&h.b2ParticleFlag.b2_wallParticle&&t[e].SetZero()},t.prototype.SolveRigid=function(e){for(var i=t.SolveRigid_s_position,o=t.SolveRigid_s_rotation,n=t.SolveRigid_s_transform,r=t.SolveRigid_s_velocityTransform,s=this.m_positionBuffer.data,l=this.m_velocityBuffer.data,c=this.m_groupList;c;c=c.GetNext())if(c.m_groupFlags&f.b2ParticleGroupFlag.b2_rigidParticleGroup){c.UpdateStatistics();var u=o;u.SetAngle(e.dt*c.m_angularVelocity);var _=a.b2Vec2.AddVV(c.m_center,a.b2Vec2.SubVV(a.b2Vec2.MulSV(e.dt,c.m_linearVelocity,a.b2Vec2.s_t0),a.b2Rot.MulRV(u,c.m_center,a.b2Vec2.s_t1),a.b2Vec2.s_t0),i),p=n;p.SetPositionRotation(_,u),a.b2Transform.MulXX(p,c.m_transform,c.m_transform);var m=r;m.p.x=e.inv_dt*p.p.x,m.p.y=e.inv_dt*p.p.y,m.q.s=e.inv_dt*p.q.s,m.q.c=e.inv_dt*(p.q.c-1);for(var h=c.m_firstIndex;h<c.m_lastIndex;h++)a.b2Transform.MulXV(m,s[h],l[h])}},t.prototype.SolveElastic=function(e){for(var i=t.SolveElastic_s_pa,o=t.SolveElastic_s_pb,n=t.SolveElastic_s_pc,r=t.SolveElastic_s_r,s=t.SolveElastic_s_t0,l=this.m_positionBuffer.data,c=this.m_velocityBuffer.data,u=e.inv_dt*this.m_def.elasticStrength,_=0;_<this.m_triadBuffer.count;_++){var p=this.m_triadBuffer.data[_];if(p.flags&h.b2ParticleFlag.b2_elasticParticle){var m=p.indexA,f=p.indexB,d=p.indexC,b=p.pa,y=p.pb,v=p.pc,V=i.Copy(l[m]),C=o.Copy(l[f]),g=n.Copy(l[d]),x=c[m],S=c[f],B=c[d];V.SelfMulAdd(e.dt,x),C.SelfMulAdd(e.dt,S),g.SelfMulAdd(e.dt,B);var A=(V.x+C.x+g.x)/3,P=(V.y+C.y+g.y)/3;V.x-=A,V.y-=P,C.x-=A,C.y-=P,g.x-=A,g.y-=P;var w=r;w.s=a.b2Vec2.CrossVV(b,V)+a.b2Vec2.CrossVV(y,C)+a.b2Vec2.CrossVV(v,g),w.c=a.b2Vec2.DotVV(b,V)+a.b2Vec2.DotVV(y,C)+a.b2Vec2.DotVV(v,g);var M=w.s*w.s+w.c*w.c,D=a.b2InvSqrt(M);isFinite(D)||(D=198177537e11),w.s*=D,w.c*=D;var I=u*p.strength;a.b2Rot.MulRV(w,b,s),a.b2Vec2.SubVV(s,V,s),a.b2Vec2.MulSV(I,s,s),x.SelfAdd(s),a.b2Rot.MulRV(w,y,s),a.b2Vec2.SubVV(s,C,s),a.b2Vec2.MulSV(I,s,s),S.SelfAdd(s),a.b2Rot.MulRV(w,v,s),a.b2Vec2.SubVV(s,g,s),a.b2Vec2.MulSV(I,s,s),B.SelfAdd(s)}}},t.prototype.SolveSpring=function(e){for(var i=t.SolveSpring_s_pa,o=t.SolveSpring_s_pb,n=t.SolveSpring_s_d,r=t.SolveSpring_s_f,s=this.m_positionBuffer.data,l=this.m_velocityBuffer.data,c=e.inv_dt*this.m_def.springStrength,u=0;u<this.m_pairBuffer.count;u++){var _=this.m_pairBuffer.data[u];if(_.flags&h.b2ParticleFlag.b2_springParticle){var p=_.indexA,m=_.indexB,f=i.Copy(s[p]),d=o.Copy(s[m]),b=l[p],y=l[m];f.SelfMulAdd(e.dt,b),d.SelfMulAdd(e.dt,y);var v=a.b2Vec2.SubVV(d,f,n),V=_.distance,C=v.Length(),g=c*_.strength,x=a.b2Vec2.MulSV(g*(V-C)/C,v,r);b.SelfSub(x),y.SelfAdd(x)}}},t.prototype.SolveTensile=function(e){for(var i=t.SolveTensile_s_weightedNormal,o=t.SolveTensile_s_s,n=t.SolveTensile_s_f,r=this.m_velocityBuffer.data,l=0;l<this.m_count;l++)this.m_accumulation2Buffer[l]=new a.b2Vec2,this.m_accumulation2Buffer[l].SetZero();for(var c=0;c<this.m_contactBuffer.count;c++)if((V=this.m_contactBuffer.data[c]).flags&h.b2ParticleFlag.b2_tensileParticle){var u=V.indexA,_=V.indexB,p=V.weight,m=V.normal,f=a.b2Vec2.MulSV((1-p)*p,m,i);this.m_accumulation2Buffer[u].SelfSub(f),this.m_accumulation2Buffer[_].SelfAdd(f)}var d=this.GetCriticalVelocity(e),b=this.m_def.surfaceTensionPressureStrength*d,y=this.m_def.surfaceTensionNormalStrength*d,v=s.b2_maxParticleForce*d;for(c=0;c<this.m_contactBuffer.count;c++){var V;if((V=this.m_contactBuffer.data[c]).flags&h.b2ParticleFlag.b2_tensileParticle){u=V.indexA,_=V.indexB,p=V.weight,m=V.normal;var C=this.m_weightBuffer[u]+this.m_weightBuffer[_],g=a.b2Vec2.SubVV(this.m_accumulation2Buffer[_],this.m_accumulation2Buffer[u],o),x=a.b2Min(b*(C-2)+y*a.b2Vec2.DotVV(g,m),v)*p,S=a.b2Vec2.MulSV(x,m,n);r[u].SelfSub(S),r[_].SelfAdd(S)}}},t.prototype.SolveViscous=function(){for(var e=t.SolveViscous_s_v,i=t.SolveViscous_s_f,o=this.m_positionBuffer.data,n=this.m_velocityBuffer.data,r=this.m_def.viscousStrength,s=this.GetParticleInvMass(),l=0;l<this.m_bodyContactBuffer.count;l++){var c=(b=this.m_bodyContactBuffer.data[l]).index;if(this.m_flagsBuffer.data[c]&h.b2ParticleFlag.b2_viscousParticle){var u=b.body,_=b.weight,p=b.mass,m=o[c],f=a.b2Vec2.SubVV(u.GetLinearVelocityFromWorldPoint(m,a.b2Vec2.s_t0),n[c],e),d=a.b2Vec2.MulSV(r*p*_,f,i);n[c].SelfMulAdd(s,d),u.ApplyLinearImpulse(d.SelfNeg(),m,!0)}}for(l=0;l<this.m_contactBuffer.count;l++){var b;(b=this.m_contactBuffer.data[l]).flags&h.b2ParticleFlag.b2_viscousParticle&&(c=b.indexA,u=b.indexB,_=b.weight,f=a.b2Vec2.SubVV(n[u],n[c],e),d=a.b2Vec2.MulSV(r*_,f,i),n[c].SelfAdd(d),n[u].SelfSub(d))}},t.prototype.SolveRepulsive=function(e){for(var i=t.SolveRepulsive_s_f,o=this.m_velocityBuffer.data,n=this.m_def.repulsiveStrength*this.GetCriticalVelocity(e),r=0;r<this.m_contactBuffer.count;r++){var s=this.m_contactBuffer.data[r];if(s.flags&h.b2ParticleFlag.b2_repulsiveParticle){var l=s.indexA,c=s.indexB;if(this.m_groupBuffer[l]!==this.m_groupBuffer[c]){var u=s.weight,_=s.normal,p=a.b2Vec2.MulSV(n*u,_,i);o[l].SelfSub(p),o[c].SelfAdd(p)}}}},t.prototype.SolvePowder=function(e){for(var i=t.SolvePowder_s_f,o=this.m_positionBuffer.data,n=this.m_velocityBuffer.data,r=this.m_def.powderStrength*this.GetCriticalVelocity(e),l=1-s.b2_particleStride,c=this.GetParticleInvMass(),u=0;u<this.m_bodyContactBuffer.count;u++){var _=(y=this.m_bodyContactBuffer.data[u]).index;if(this.m_flagsBuffer.data[_]&h.b2ParticleFlag.b2_powderParticle&&(v=y.weight)>l){var p=y.body,m=y.mass,f=o[_],d=y.normal,b=a.b2Vec2.MulSV(r*m*(v-l),d,i);n[_].SelfMulSub(c,b),p.ApplyLinearImpulse(b,f,!0)}}for(u=0;u<this.m_contactBuffer.count;u++){var y,v;(y=this.m_contactBuffer.data[u]).flags&h.b2ParticleFlag.b2_powderParticle&&(v=y.weight)>l&&(_=y.indexA,p=y.indexB,d=y.normal,b=a.b2Vec2.MulSV(r*(v-l),d,i),n[_].SelfSub(b),n[p].SelfAdd(b))}},t.prototype.SolveSolid=function(e){var i=t.SolveSolid_s_f,o=this.m_velocityBuffer.data;this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer);for(var n=e.inv_dt*this.m_def.ejectionStrength,r=0;r<this.m_contactBuffer.count;r++){var s=this.m_contactBuffer.data[r],l=s.indexA,c=s.indexB;if(this.m_groupBuffer[l]!==this.m_groupBuffer[c]){var u=s.weight,_=s.normal,p=this.m_depthBuffer[l]+this.m_depthBuffer[c],m=a.b2Vec2.MulSV(n*p*u,_,i);o[l].SelfSub(m),o[c].SelfAdd(m)}}},t.prototype.SolveForce=function(t){for(var e=this.m_velocityBuffer.data,i=t.dt*this.GetParticleInvMass(),o=0;o<this.m_count;o++)e[o].SelfMulAdd(i,this.m_forceBuffer[o]);this.m_hasForce=!1},t.prototype.SolveColorMixing=function(){var t=.5*this.m_def.colorMixingStrength;if(t)for(var e=0;e<this.m_contactBuffer.count;e++){var i=this.m_contactBuffer.data[e],o=i.indexA,n=i.indexB;if(this.m_flagsBuffer.data[o]&this.m_flagsBuffer.data[n]&h.b2ParticleFlag.b2_colorMixingParticle){var r=this.m_colorBuffer.data[o],s=this.m_colorBuffer.data[n];l.b2Color.MixColors(r,s,t)}}},t.prototype.SolveZombie=function(){for(var t=0,e=[],i=0;i<this.m_count;i++)e[i]=r.b2_invalidParticleIndex;var o=0;for(i=0;i<this.m_count;i++){var n=this.m_flagsBuffer.data[i];if(n&h.b2ParticleFlag.b2_zombieParticle){var s=this.m_world.m_destructionListener;n&h.b2ParticleFlag.b2_destructionListenerParticle&&s&&s.SayGoodbyeParticle(this,i),this.m_handleIndexBuffer.data&&(l=this.m_handleIndexBuffer.data[i])&&(l.SetIndex(r.b2_invalidParticleIndex),this.m_handleIndexBuffer.data[i]=null),e[i]=r.b2_invalidParticleIndex}else{var l;if(e[i]=t,i!==t)this.m_handleIndexBuffer.data&&((l=this.m_handleIndexBuffer.data[i])&&l.SetIndex(t),this.m_handleIndexBuffer.data[t]=l),this.m_flagsBuffer.data[t]=this.m_flagsBuffer.data[i],this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[t]=this.m_lastBodyContactStepBuffer.data[i]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[t]=this.m_bodyContactCountBuffer.data[i]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[t]=this.m_consecutiveContactStepsBuffer.data[i]),this.m_positionBuffer.data[t].Copy(this.m_positionBuffer.data[i]),this.m_velocityBuffer.data[t].Copy(this.m_velocityBuffer.data[i]),this.m_groupBuffer[t]=this.m_groupBuffer[i],this.m_hasForce&&this.m_forceBuffer[t].Copy(this.m_forceBuffer[i]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[t]=this.m_staticPressureBuffer[i]),this.m_depthBuffer&&(this.m_depthBuffer[t]=this.m_depthBuffer[i]),this.m_colorBuffer.data&&this.m_colorBuffer.data[t].Copy(this.m_colorBuffer.data[i]),this.m_userDataBuffer.data&&(this.m_userDataBuffer.data[t]=this.m_userDataBuffer.data[i]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[t]=this.m_expirationTimeBuffer.data[i]);t++,o|=n}}for(var c=0;c<this.m_proxyBuffer.count;c++){var u=this.m_proxyBuffer.data[c];u.index=e[u.index]}for(this.m_proxyBuffer.RemoveIf(function(t){return t.index<0}),c=0;c<this.m_contactBuffer.count;c++)(_=this.m_contactBuffer.data[c]).indexA=e[_.indexA],_.indexB=e[_.indexB];for(this.m_contactBuffer.RemoveIf(function(t){return t.indexA<0||t.indexB<0}),c=0;c<this.m_bodyContactBuffer.count;c++){var _;(_=this.m_bodyContactBuffer.data[c]).index=e[_.index]}for(this.m_bodyContactBuffer.RemoveIf(function(t){return t.index<0}),c=0;c<this.m_pairBuffer.count;c++){var p=this.m_pairBuffer.data[c];p.indexA=e[p.indexA],p.indexB=e[p.indexB]}for(this.m_pairBuffer.RemoveIf(function(t){return t.indexA<0||t.indexB<0}),c=0;c<this.m_triadBuffer.count;c++){var m=this.m_triadBuffer.data[c];m.indexA=e[m.indexA],m.indexB=e[m.indexB],m.indexC=e[m.indexC]}if(this.m_triadBuffer.RemoveIf(function(t){return t.indexA<0||t.indexB<0||t.indexC<0}),this.m_indexByExpirationTimeBuffer.data)for(var d=0,b=0;b<this.m_count;b++){var y=e[this.m_indexByExpirationTimeBuffer.data[b]];y!==r.b2_invalidParticleIndex&&(this.m_indexByExpirationTimeBuffer.data[d++]=y)}for(var v=this.m_groupList;v;v=v.GetNext()){var V=t,C=0,g=!1;for(i=v.m_firstIndex;i<v.m_lastIndex;i++){var x=e[i];x>=0?(V=a.b2Min(V,x),C=a.b2Max(C,x+1)):g=!0}V<C?(v.m_firstIndex=V,v.m_lastIndex=C,g&&v.m_groupFlags&f.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SetGroupFlags(v,v.m_groupFlags|f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)):(v.m_firstIndex=0,v.m_lastIndex=0,v.m_groupFlags&f.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty||this.SetGroupFlags(v,v.m_groupFlags|f.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed))}for(this.m_count=t,this.m_allParticleFlags=o,this.m_needsUpdateAllParticleFlags=!1,v=this.m_groupList;v;){var S=v.GetNext();v.m_groupFlags&f.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed&&this.DestroyParticleGroup(v),v=S}},t.prototype.SolveLifetimes=function(t){this.m_timeElapsed=this.LifetimeToExpirationTime(t.dt);var e=this.GetQuantizedTimeElapsed(),i=this.m_expirationTimeBuffer.data,o=this.m_indexByExpirationTimeBuffer.data,n=this.GetParticleCount();this.m_expirationTimeBufferRequiresSorting&&(v(o,0,n,function(t,e){var o=i[t],n=i[e],r=o<=0;return r===n<=0?o>n:r}),this.m_expirationTimeBufferRequiresSorting=!1);for(var r=n-1;r>=0;--r){var s=o[r],a=i[s];if(e<a||a<=0)break;this.DestroyParticle(s)}},t.prototype.RotateBuffer=function(t,e,i){if(t!==e&&e!==i){if(S(this.m_flagsBuffer.data,t,e,i),this.m_lastBodyContactStepBuffer.data&&S(this.m_lastBodyContactStepBuffer.data,t,e,i),this.m_bodyContactCountBuffer.data&&S(this.m_bodyContactCountBuffer.data,t,e,i),this.m_consecutiveContactStepsBuffer.data&&S(this.m_consecutiveContactStepsBuffer.data,t,e,i),S(this.m_positionBuffer.data,t,e,i),S(this.m_velocityBuffer.data,t,e,i),S(this.m_groupBuffer,t,e,i),this.m_hasForce&&S(this.m_forceBuffer,t,e,i),this.m_staticPressureBuffer&&S(this.m_staticPressureBuffer,t,e,i),this.m_depthBuffer&&S(this.m_depthBuffer,t,e,i),this.m_colorBuffer.data&&S(this.m_colorBuffer.data,t,e,i),this.m_userDataBuffer.data&&S(this.m_userDataBuffer.data,t,e,i),this.m_handleIndexBuffer.data){S(this.m_handleIndexBuffer.data,t,e,i);for(var o=t;o<i;++o){var n=this.m_handleIndexBuffer.data[o];n&&n.SetIndex(m(n.GetIndex()))}}if(this.m_expirationTimeBuffer.data){S(this.m_expirationTimeBuffer.data,t,e,i);var r=this.GetParticleCount(),s=this.m_indexByExpirationTimeBuffer.data;for(o=0;o<r;++o)s[o]=m(s[o])}for(var a=0;a<this.m_proxyBuffer.count;a++){var l=this.m_proxyBuffer.data[a];l.index=m(l.index)}for(a=0;a<this.m_contactBuffer.count;a++)(c=this.m_contactBuffer.data[a]).indexA=m(c.indexA),c.indexB=m(c.indexB);for(a=0;a<this.m_bodyContactBuffer.count;a++){var c;(c=this.m_bodyContactBuffer.data[a]).index=m(c.index)}for(a=0;a<this.m_pairBuffer.count;a++){var u=this.m_pairBuffer.data[a];u.indexA=m(u.indexA),u.indexB=m(u.indexB)}for(a=0;a<this.m_triadBuffer.count;a++){var _=this.m_triadBuffer.data[a];_.indexA=m(_.indexA),_.indexB=m(_.indexB),_.indexC=m(_.indexC)}for(var p=this.m_groupList;p;p=p.GetNext())p.m_firstIndex=m(p.m_firstIndex),p.m_lastIndex=m(p.m_lastIndex-1)+1}function m(o){return o<t?o:o<e?o+i-e:o<i?o+t-e:o}},t.prototype.GetCriticalVelocity=function(t){return this.m_particleDiameter*t.inv_dt},t.prototype.GetCriticalVelocitySquared=function(t){var e=this.GetCriticalVelocity(t);return e*e},t.prototype.GetCriticalPressure=function(t){return this.m_def.density*this.GetCriticalVelocitySquared(t)},t.prototype.GetParticleStride=function(){return s.b2_particleStride*this.m_particleDiameter},t.prototype.GetParticleMass=function(){var t=this.GetParticleStride();return this.m_def.density*t*t},t.prototype.GetParticleInvMass=function(){var t=this.m_inverseDiameter*(1/s.b2_particleStride);return this.m_inverseDensity*t*t},t.prototype.GetFixtureContactFilter=function(){return this.m_allParticleFlags&h.b2ParticleFlag.b2_fixtureContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null},t.prototype.GetParticleContactFilter=function(){return this.m_allParticleFlags&h.b2ParticleFlag.b2_particleContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null},t.prototype.GetFixtureContactListener=function(){return this.m_allParticleFlags&h.b2ParticleFlag.b2_fixtureContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null},t.prototype.GetParticleContactListener=function(){return this.m_allParticleFlags&h.b2ParticleFlag.b2_particleContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null},t.prototype.SetUserOverridableBuffer=function(t,e){t.data=e,t.userSuppliedCapacity=e.length},t.prototype.SetGroupFlags=function(t,e){var i=t.m_groupFlags;(i^e)&f.b2ParticleGroupFlag.b2_solidParticleGroup&&(e|=f.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth),i&~e&&(this.m_needsUpdateAllGroupFlags=!0),~this.m_allGroupFlags&e&&(e&f.b2ParticleGroupFlag.b2_solidParticleGroup&&(this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer)),this.m_allGroupFlags|=e),t.m_groupFlags=e},t.BodyContactCompare=function(t,e){return t.index===e.index?t.weight>e.weight:t.index<e.index},t.prototype.RemoveSpuriousBodyContacts=function(){v(this.m_bodyContactBuffer.data,0,this.m_bodyContactBuffer.count,t.BodyContactCompare);var e=t.RemoveSpuriousBodyContacts_s_n,i=t.RemoveSpuriousBodyContacts_s_pos,o=t.RemoveSpuriousBodyContacts_s_normal,n=this,s=-1,l=0;this.m_bodyContactBuffer.count=C(this.m_bodyContactBuffer.data,function(t){if(t.index!==s&&(l=0,s=t.index),l++>3)return!0;var c=e.Copy(t.normal);c.SelfMul(n.m_particleDiameter*(1-t.weight));var u=a.b2Vec2.AddVV(n.m_positionBuffer.data[t.index],c,i);if(!t.fixture.TestPoint(u)){for(var _=t.fixture.GetShape().GetChildCount(),p=0;p<_;p++){var m=o;if(t.fixture.ComputeDistance(u,m,p)<r.b2_linearSlop)return!1}return!0}return!1},this.m_bodyContactBuffer.count)},t.prototype.DetectStuckParticle=function(t){this.m_stuckThreshold<=0||(++this.m_bodyContactCountBuffer.data[t],2===this.m_bodyContactCountBuffer.data[t]&&(++this.m_consecutiveContactStepsBuffer.data[t],this.m_consecutiveContactStepsBuffer.data[t]>this.m_stuckThreshold&&(this.m_stuckParticleBuffer.data[this.m_stuckParticleBuffer.Append()]=t)),this.m_lastBodyContactStepBuffer.data[t]=this.m_timestamp)},t.prototype.ValidateParticleIndex=function(t){return t>=0&&t<this.GetParticleCount()&&t!==r.b2_invalidParticleIndex},t.prototype.GetQuantizedTimeElapsed=function(){return Math.floor(this.m_timeElapsed/4294967296)},t.prototype.LifetimeToExpirationTime=function(t){return this.m_timeElapsed+Math.floor(t/this.m_def.lifetimeGranularity*4294967296)},t.prototype.ForceCanBeApplied=function(t){return!(t&h.b2ParticleFlag.b2_wallParticle)},t.prototype.PrepareForceBuffer=function(){if(!this.m_hasForce){for(var t=0;t<this.m_count;t++)this.m_forceBuffer[t].SetZero();this.m_hasForce=!0}},t.prototype.IsRigidGroup=function(t){return null!==t&&0!=(t.m_groupFlags&f.b2ParticleGroupFlag.b2_rigidParticleGroup)},t.prototype.GetLinearVelocity=function(t,e,i,o){return t&&this.IsRigidGroup(t)?t.GetLinearVelocityFromWorldPoint(i,o):o.Copy(this.m_velocityBuffer.data[e])},t.prototype.InitDampingParameter=function(t,e,i,o,n,r,s,l){t[0]=o>0?1/o:0,e[0]=n>0?1/n:0,i[0]=a.b2Vec2.CrossVV(a.b2Vec2.SubVV(s,r,a.b2Vec2.s_t0),l)},t.prototype.InitDampingParameterWithRigidGroupOrParticle=function(t,e,i,o,n,r,s,a){if(n&&o)this.InitDampingParameter(t,e,i,n.GetMass(),n.GetInertia(),n.GetCenter(),s,a);else{var l=this.m_flagsBuffer.data[r];this.InitDampingParameter(t,e,i,l&h.b2ParticleFlag.b2_wallParticle?0:this.GetParticleMass(),0,s,s,a)}},t.prototype.ComputeDampingImpulse=function(t,e,i,o,n,r,s){var a=t+e*i*i+o+n*r*r;return a>0?s/a:0},t.prototype.ApplyDamping=function(t,e,i,o,n,r,s,a){n&&o?(n.m_linearVelocity.SelfMulAdd(s*t,a),n.m_angularVelocity+=s*i*e):this.m_velocityBuffer.data[r].SelfMulAdd(s*t,a)},t.xTruncBits=12,t.yTruncBits=12,t.tagBits=32,t.yOffset=1<<t.yTruncBits-1,t.yShift=t.tagBits-t.yTruncBits,t.xShift=t.tagBits-t.yTruncBits-t.xTruncBits,t.xScale=1<<t.xShift,t.xOffset=t.xScale*(1<<t.xTruncBits-1),t.yMask=(1<<t.yTruncBits)-1<<t.yShift,t.xMask=~t.yMask,t.DestroyParticlesInShape_s_aabb=new c.b2AABB,t.CreateParticleGroup_s_transform=new a.b2Transform,t.ComputeCollisionEnergy_s_v=new a.b2Vec2,t.QueryShapeAABB_s_aabb=new c.b2AABB,t.QueryPointAABB_s_aabb=new c.b2AABB,t.RayCast_s_aabb=new c.b2AABB,t.RayCast_s_p=new a.b2Vec2,t.RayCast_s_v=new a.b2Vec2,t.RayCast_s_n=new a.b2Vec2,t.RayCast_s_point=new a.b2Vec2,t.k_pairFlags=h.b2ParticleFlag.b2_springParticle,t.k_triadFlags=h.b2ParticleFlag.b2_elasticParticle,t.k_noPressureFlags=h.b2ParticleFlag.b2_powderParticle|h.b2ParticleFlag.b2_tensileParticle,t.k_extraDampingFlags=h.b2ParticleFlag.b2_staticPressureParticle,t.k_barrierWallFlags=h.b2ParticleFlag.b2_barrierParticle|h.b2ParticleFlag.b2_wallParticle,t.CreateParticlesStrokeShapeForGroup_s_edge=new _.b2EdgeShape,t.CreateParticlesStrokeShapeForGroup_s_d=new a.b2Vec2,t.CreateParticlesStrokeShapeForGroup_s_p=new a.b2Vec2,t.CreateParticlesFillShapeForGroup_s_aabb=new c.b2AABB,t.CreateParticlesFillShapeForGroup_s_p=new a.b2Vec2,t.UpdatePairsAndTriads_s_dab=new a.b2Vec2,t.UpdatePairsAndTriads_s_dbc=new a.b2Vec2,t.UpdatePairsAndTriads_s_dca=new a.b2Vec2,t.AddContact_s_d=new a.b2Vec2,t.UpdateBodyContacts_s_aabb=new c.b2AABB,t.Solve_s_subStep=new p.b2TimeStep,t.SolveCollision_s_aabb=new c.b2AABB,t.SolveGravity_s_gravity=new a.b2Vec2,t.SolveBarrier_s_aabb=new c.b2AABB,t.SolveBarrier_s_va=new a.b2Vec2,t.SolveBarrier_s_vb=new a.b2Vec2,t.SolveBarrier_s_pba=new a.b2Vec2,t.SolveBarrier_s_vba=new a.b2Vec2,t.SolveBarrier_s_vc=new a.b2Vec2,t.SolveBarrier_s_pca=new a.b2Vec2,t.SolveBarrier_s_vca=new a.b2Vec2,t.SolveBarrier_s_qba=new a.b2Vec2,t.SolveBarrier_s_qca=new a.b2Vec2,t.SolveBarrier_s_dv=new a.b2Vec2,t.SolveBarrier_s_f=new a.b2Vec2,t.SolvePressure_s_f=new a.b2Vec2,t.SolveDamping_s_v=new a.b2Vec2,t.SolveDamping_s_f=new a.b2Vec2,t.SolveRigidDamping_s_t0=new a.b2Vec2,t.SolveRigidDamping_s_t1=new a.b2Vec2,t.SolveRigidDamping_s_p=new a.b2Vec2,t.SolveRigidDamping_s_v=new a.b2Vec2,t.SolveExtraDamping_s_v=new a.b2Vec2,t.SolveExtraDamping_s_f=new a.b2Vec2,t.SolveRigid_s_position=new a.b2Vec2,t.SolveRigid_s_rotation=new a.b2Rot,t.SolveRigid_s_transform=new a.b2Transform,t.SolveRigid_s_velocityTransform=new a.b2Transform,t.SolveElastic_s_pa=new a.b2Vec2,t.SolveElastic_s_pb=new a.b2Vec2,t.SolveElastic_s_pc=new a.b2Vec2,t.SolveElastic_s_r=new a.b2Rot,t.SolveElastic_s_t0=new a.b2Vec2,t.SolveSpring_s_pa=new a.b2Vec2,t.SolveSpring_s_pb=new a.b2Vec2,t.SolveSpring_s_d=new a.b2Vec2,t.SolveSpring_s_f=new a.b2Vec2,t.SolveTensile_s_weightedNormal=new a.b2Vec2,t.SolveTensile_s_s=new a.b2Vec2,t.SolveTensile_s_f=new a.b2Vec2,t.SolveViscous_s_v=new a.b2Vec2,t.SolveViscous_s_f=new a.b2Vec2,t.SolveRepulsive_s_f=new a.b2Vec2,t.SolvePowder_s_f=new a.b2Vec2,t.SolveSolid_s_f=new a.b2Vec2,t.RemoveSpuriousBodyContacts_s_n=new a.b2Vec2,t.RemoveSpuriousBodyContacts_s_pos=new a.b2Vec2,t.RemoveSpuriousBodyContacts_s_normal=new a.b2Vec2,t}();i.b2ParticleSystem=T;var R=function(){function t(){this._data=null,this.userSuppliedCapacity=0}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),t}();i.b2ParticleSystem_UserOverridableBuffer=R;var F=function(){function t(){this.index=r.b2_invalidParticleIndex,this.tag=0}return t.CompareProxyProxy=function(t,e){return t.tag<e.tag},t.CompareTagProxy=function(t,e){return t<e.tag},t.CompareProxyTag=function(t,e){return t.tag<e},t}();i.b2ParticleSystem_Proxy=F;var O=function(){function t(t,e,i,o,n){this.m_system=t,this.m_xLower=(e&T.xMask)>>>0,this.m_xUpper=(i&T.xMask)>>>0,this.m_yLower=(e&T.yMask)>>>0,this.m_yUpper=(i&T.yMask)>>>0,this.m_first=o,this.m_last=n}return t.prototype.GetNext=function(){for(;this.m_first<this.m_last;){var t=(this.m_system.m_proxyBuffer.data[this.m_first].tag&T.xMask)>>>0;if(t>=this.m_xLower&&t<=this.m_xUpper)return this.m_system.m_proxyBuffer.data[this.m_first++].index;this.m_first++}return r.b2_invalidParticleIndex},t}();i.b2ParticleSystem_InsideBoundsEnumerator=O;var L=function(){this.next=null,this.count=0,this.index=0};i.b2ParticleSystem_ParticleListNode=L;var j=function(){function t(){}return t.prototype.Allocate=function(t,e){return e},t.prototype.Clear=function(){},t.prototype.GetCount=function(){return 0},t.prototype.Invalidate=function(){},t.prototype.GetValidBuffer=function(){return[]},t.prototype.GetBuffer=function(){return[]},t.prototype.SetCount=function(){},t}();i.b2ParticleSystem_FixedSetAllocator=j;i.b2ParticleSystem_FixtureParticle=function(t,e){this.second=r.b2_invalidParticleIndex,this.first=t,this.second=e};var J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Initialize=function(){},e.prototype.Find=function(){return r.b2_invalidParticleIndex},e}(j);i.b2ParticleSystem_FixtureParticleSet=J;i.b2ParticleSystem_ParticlePair=function(t,e){this.first=r.b2_invalidParticleIndex,this.second=r.b2_invalidParticleIndex,this.first=t,this.second=e};var E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.Initialize=function(){},e.prototype.Find=function(){return r.b2_invalidParticleIndex},e}(j);i.b2ParticlePairSet=E;var k=function(){function t(){}return t.prototype.IsNecessary=function(){return!0},t.prototype.ShouldCreatePair=function(){return!0},t.prototype.ShouldCreateTriad=function(){return!0},t}();i.b2ParticleSystem_ConnectionFilter=k;var U=function(t){function e(e,i,o,n){var r=t.call(this)||this;return r.m_callDestructionListener=!1,r.m_destroyed=0,r.m_system=e,r.m_shape=i,r.m_xf=o,r.m_callDestructionListener=n,r.m_destroyed=0,r}return n(e,t),e.prototype.ReportFixture=function(){return!1},e.prototype.ReportParticle=function(t,e){return t===this.m_system&&(this.m_shape.TestPoint(this.m_xf,this.m_system.m_positionBuffer.data[e])&&(this.m_system.DestroyParticle(e,this.m_callDestructionListener),this.m_destroyed++),!0)},e.prototype.Destroyed=function(){return this.m_destroyed},e}(m.b2QueryCallback);i.b2ParticleSystem_DestroyParticlesInShapeCallback=U;var N=function(t){function e(e){var i=t.call(this)||this;return i.m_threshold=0,i.m_threshold=e,i}return n(e,t),e.prototype.ShouldCreatePair=function(t,e){return t<this.m_threshold&&this.m_threshold<=e||e<this.m_threshold&&this.m_threshold<=t},e.prototype.ShouldCreateTriad=function(t,e,i){return(t<this.m_threshold||e<this.m_threshold||i<this.m_threshold)&&(this.m_threshold<=t||this.m_threshold<=e||this.m_threshold<=i)},e}(k);i.b2ParticleSystem_JoinParticleGroupsFilter=N;var q=function(t){function e(e,i){void 0===i&&(i=e.length);var o=t.call(this,u.b2ShapeType.e_unknown,0)||this;return o.m_shapeCount=0,o.m_shapes=e,o.m_shapeCount=i,o}return n(e,t),e.prototype.Clone=function(){throw new Error},e.prototype.GetChildCount=function(){return 1},e.prototype.TestPoint=function(t,e){for(var i=0;i<this.m_shapeCount;i++)if(this.m_shapes[i].TestPoint(t,e))return!0;return!1},e.prototype.ComputeDistance=function(){return 0},e.prototype.RayCast=function(){return!1},e.prototype.ComputeAABB=function(t,e){var i=new c.b2AABB;t.lowerBound.x=+r.b2_maxFloat,t.lowerBound.y=+r.b2_maxFloat,t.upperBound.x=-r.b2_maxFloat,t.upperBound.y=-r.b2_maxFloat;for(var o=0;o<this.m_shapeCount;o++)for(var n=this.m_shapes[o].GetChildCount(),s=0;s<n;s++){var a=i;this.m_shapes[o].ComputeAABB(a,e,s),t.Combine1(a)}},e.prototype.ComputeMass=function(){},e.prototype.SetupDistanceProxy=function(){},e.prototype.ComputeSubmergedArea=function(){return 0},e.prototype.Dump=function(){},e}(u.b2Shape);i.b2ParticleSystem_CompositeShape=q;var z=function(t){function e(e){var i=t.call(this)||this;return i.m_flagsBuffer=e,i}return n(e,t),e.prototype.IsNecessary=function(t){return 0!=(this.m_flagsBuffer.data[t]&h.b2ParticleFlag.b2_reactiveParticle)},e}(k);i.b2ParticleSystem_ReactiveFilter=z;var W=function(t){function e(e,i){void 0===i&&(i=null);var o=t.call(this,e)||this;return o.m_contactFilter=null,o.m_contactFilter=i,o}return n(e,t),e.prototype.ShouldCollideFixtureParticle=function(t,e,i){return!(this.m_contactFilter&&this.m_system.GetFlagsBuffer()[i]&h.b2ParticleFlag.b2_fixtureContactFilterParticle)||this.m_contactFilter.ShouldCollideFixtureParticle(t,this.m_system,i)},e.prototype.ReportFixtureAndParticle=function(t,i,o){var n=e.ReportFixtureAndParticle_s_n,r=e.ReportFixtureAndParticle_s_rp,s=this.m_system.m_positionBuffer.data[o],l=n,c=t.ComputeDistance(s,l,i);if(c<this.m_system.m_particleDiameter&&this.ShouldCollideFixtureParticle(t,this.m_system,o)){var u=t.GetBody(),_=u.GetWorldCenter(),p=u.GetMass(),m=u.GetInertia()-p*u.GetLocalCenter().LengthSquared(),f=p>0?1/p:0,d=m>0?1/m:0,b=this.m_system.m_flagsBuffer.data[o]&h.b2ParticleFlag.b2_wallParticle?0:this.m_system.GetParticleInvMass(),y=a.b2Vec2.SubVV(s,_,r),v=a.b2Vec2.CrossVV(y,l),V=b+f+d*v*v,C=this.m_system.m_bodyContactBuffer.data[this.m_system.m_bodyContactBuffer.Append()];C.index=o,C.body=u,C.fixture=t,C.weight=1-c*this.m_system.m_inverseDiameter,C.normal.Copy(l.SelfNeg()),C.mass=V>0?1/V:0,this.m_system.DetectStuckParticle(o)}},e.ReportFixtureAndParticle_s_n=new a.b2Vec2,e.ReportFixtureAndParticle_s_rp=new a.b2Vec2,e}(P);i.b2ParticleSystem_UpdateBodyContactsCallback=W;var X=function(t){function e(e,i){var o=t.call(this,e)||this;return o.m_step=i,o}return n(e,t),e.prototype.ReportFixtureAndParticle=function(t,i,o){var n=e.ReportFixtureAndParticle_s_p1,s=e.ReportFixtureAndParticle_s_output,l=e.ReportFixtureAndParticle_s_input,c=e.ReportFixtureAndParticle_s_p,_=e.ReportFixtureAndParticle_s_v,p=e.ReportFixtureAndParticle_s_f,m=t.GetBody(),h=this.m_system.m_positionBuffer.data[o],f=this.m_system.m_velocityBuffer.data[o],d=s,b=l;if(0===this.m_system.m_iterationIndex){var y=a.b2Transform.MulTXV(m.m_xf0,h,n);t.GetShape().GetType()===u.b2ShapeType.e_circleShape&&(y.SelfSub(m.GetLocalCenter()),a.b2Rot.MulRV(m.m_xf0.q,y,y),a.b2Rot.MulTRV(m.m_xf.q,y,y),y.SelfAdd(m.GetLocalCenter())),a.b2Transform.MulXV(m.m_xf,y,b.p1)}else b.p1.Copy(h);if(a.b2Vec2.AddVMulSV(h,this.m_step.dt,f,b.p2),b.maxFraction=1,t.RayCast(d,b,i)){var v=d.normal,V=c;V.x=(1-d.fraction)*b.p1.x+d.fraction*b.p2.x+r.b2_linearSlop*v.x,V.y=(1-d.fraction)*b.p1.y+d.fraction*b.p2.y+r.b2_linearSlop*v.y;var C=_;C.x=this.m_step.inv_dt*(V.x-h.x),C.y=this.m_step.inv_dt*(V.y-h.y),this.m_system.m_velocityBuffer.data[o].Copy(C);var g=p;g.x=this.m_step.inv_dt*this.m_system.GetParticleMass()*(f.x-C.x),g.y=this.m_step.inv_dt*this.m_system.GetParticleMass()*(f.y-C.y),this.m_system.ParticleApplyForce(o,g)}},e.prototype.ReportParticle=function(){return!1},e.ReportFixtureAndParticle_s_p1=new a.b2Vec2,e.ReportFixtureAndParticle_s_output=new c.b2RayCastOutput,e.ReportFixtureAndParticle_s_input=new c.b2RayCastInput,e.ReportFixtureAndParticle_s_p=new a.b2Vec2,e.ReportFixtureAndParticle_s_v=new a.b2Vec2,e.ReportFixtureAndParticle_s_f=new a.b2Vec2,e}(P);i.b2ParticleSystem_SolveCollisionCallback=X,cc._RF.pop()},{"../Collision/Shapes/b2EdgeShape":"b2EdgeShape","../Collision/Shapes/b2Shape":"b2Shape","../Collision/b2Collision":"b2Collision","../Common/b2Draw":"b2Draw","../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","../Dynamics/b2TimeStep":"b2TimeStep","../Dynamics/b2WorldCallbacks":"b2WorldCallbacks","./b2Particle":"b2Particle","./b2ParticleGroup":"b2ParticleGroup","./b2VoronoiDiagram":"b2VoronoiDiagram"}],b2Particle:[function(t,e,i){"use strict";cc._RF.push(e,"796c671RDFMI5JFCTukpdrC","b2Particle"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2ParticleHandle=i.b2CalculateParticleIterations=i.b2ParticleDef=i.b2ParticleFlag=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Math"),r=t("../Common/b2Draw");(function(t){t[t.b2_waterParticle=0]="b2_waterParticle",t[t.b2_zombieParticle=2]="b2_zombieParticle",t[t.b2_wallParticle=4]="b2_wallParticle",t[t.b2_springParticle=8]="b2_springParticle",t[t.b2_elasticParticle=16]="b2_elasticParticle",t[t.b2_viscousParticle=32]="b2_viscousParticle",t[t.b2_powderParticle=64]="b2_powderParticle",t[t.b2_tensileParticle=128]="b2_tensileParticle",t[t.b2_colorMixingParticle=256]="b2_colorMixingParticle",t[t.b2_destructionListenerParticle=512]="b2_destructionListenerParticle",t[t.b2_barrierParticle=1024]="b2_barrierParticle",t[t.b2_staticPressureParticle=2048]="b2_staticPressureParticle",t[t.b2_reactiveParticle=4096]="b2_reactiveParticle",t[t.b2_repulsiveParticle=8192]="b2_repulsiveParticle",t[t.b2_fixtureContactListenerParticle=16384]="b2_fixtureContactListenerParticle",t[t.b2_particleContactListenerParticle=32768]="b2_particleContactListenerParticle",t[t.b2_fixtureContactFilterParticle=65536]="b2_fixtureContactFilterParticle",t[t.b2_particleContactFilterParticle=131072]="b2_particleContactFilterParticle"})(i.b2ParticleFlag||(i.b2ParticleFlag={}));i.b2ParticleDef=function(){this.flags=0,this.position=new n.b2Vec2,this.velocity=new n.b2Vec2,this.color=new r.b2Color(0,0,0,0),this.lifetime=0,this.userData=null,this.group=null},i.b2CalculateParticleIterations=function(t,e,i){var o=Math.ceil(Math.sqrt(t/(.01*e))*i);return n.b2Clamp(o,1,8)};var s=function(){function t(){this.m_index=o.b2_invalidParticleIndex}return t.prototype.GetIndex=function(){return this.m_index},t.prototype.SetIndex=function(t){this.m_index=t},t}();i.b2ParticleHandle=s,cc._RF.pop()},{"../Common/b2Draw":"b2Draw","../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings"}],b2PolygonAndCircleContact:[function(t,e,i){"use strict";cc._RF.push(e,"61a90LRgAdASI05vL3AqHrj","b2PolygonAndCircleContact");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2PolygonAndCircleContact=void 0;var r=t("../../Collision/b2CollideCircle"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(){return new e},e.Destroy=function(){},e.prototype.Evaluate=function(t,e,i){r.b2CollidePolygonAndCircle(t,this.GetShapeA(),e,this.GetShapeB(),i)},e}(t("./b2Contact").b2Contact);i.b2PolygonAndCircleContact=s,cc._RF.pop()},{"../../Collision/b2CollideCircle":"b2CollideCircle","./b2Contact":"b2Contact"}],b2PolygonContact:[function(t,e,i){"use strict";cc._RF.push(e,"096a2PNCv1EOL4uAP1Z0kIm","b2PolygonContact");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2PolygonContact=void 0;var r=t("../../Collision/b2CollidePolygon"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.Create=function(){return new e},e.Destroy=function(){},e.prototype.Evaluate=function(t,e,i){r.b2CollidePolygons(t,this.GetShapeA(),e,this.GetShapeB(),i)},e}(t("./b2Contact").b2Contact);i.b2PolygonContact=s,cc._RF.pop()},{"../../Collision/b2CollidePolygon":"b2CollidePolygon","./b2Contact":"b2Contact"}],b2PolygonShape:[function(t,e,i){"use strict";cc._RF.push(e,"8a377RvgzxBPbNek/NpPR2H","b2PolygonShape");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2PolygonShape=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Shape"),l=t("./b2Shape"),c=function(t){function e(){var e=t.call(this,l.b2ShapeType.e_polygonShape,r.b2_polygonRadius)||this;return e.m_centroid=new s.b2Vec2(0,0),e.m_vertices=[],e.m_normals=[],e.m_count=0,e}return n(e,t),e.prototype.Clone=function(){return(new e).Copy(this)},e.prototype.Copy=function(e){t.prototype.Copy.call(this,e),this.m_centroid.Copy(e.m_centroid),this.m_count=e.m_count,this.m_vertices=s.b2Vec2.MakeArray(this.m_count),this.m_normals=s.b2Vec2.MakeArray(this.m_count);for(var i=0;i<this.m_count;++i)this.m_vertices[i].Copy(e.m_vertices[i]),this.m_normals[i].Copy(e.m_normals[i]);return this},e.prototype.GetChildCount=function(){return 1},e.prototype.Set=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("number"==typeof t[0][0]){var i=t[0];if(i.length%2!=0)throw new Error;return this._Set(function(t){return{x:i[2*t],y:i[2*t+1]}},i.length/2)}var o=t[0],n=t[1]||o.length;return this._Set(function(t){return o[t]},n)},e.prototype._Set=function(t,i){if(i<3)return this.SetAsBox(1,1);for(var o=i,n=[],a=0;a<o;++a){for(var l=t(a),c=!0,u=0;u<n.length;++u)if(s.b2Vec2.DistanceSquaredVV(l,n[u])<.25*r.b2_linearSlop*r.b2_linearSlop){c=!1;break}c&&n.push(l)}if((o=n.length)<3)return this.SetAsBox(1,1);var _=0,p=n[0].x;for(a=1;a<o;++a){var m=n[a].x;(m>p||m===p&&n[a].y<n[_].y)&&(_=a,p=m)}for(var h=[],f=0,d=_;;){h[f]=d;var b=0;for(u=1;u<o;++u)if(b!==d){var y=s.b2Vec2.SubVV(n[b],n[h[f]],e.Set_s_r),v=(l=s.b2Vec2.SubVV(n[u],n[h[f]],e.Set_s_v),s.b2Vec2.CrossVV(y,l));v<0&&(b=u),0===v&&l.LengthSquared()>y.LengthSquared()&&(b=u)}else b=u;if(++f,d=b,b===_)break}for(this.m_count=f,this.m_vertices=s.b2Vec2.MakeArray(this.m_count),this.m_normals=s.b2Vec2.MakeArray(this.m_count),a=0;a<f;++a)this.m_vertices[a].Copy(n[h[a]]);for(a=0;a<f;++a){var V=this.m_vertices[a],C=this.m_vertices[(a+1)%f],g=s.b2Vec2.SubVV(C,V,s.b2Vec2.s_t0);s.b2Vec2.CrossVOne(g,this.m_normals[a]).SelfNormalize()}return e.ComputeCentroid(this.m_vertices,f,this.m_centroid),this},e.prototype.SetAsBox=function(t,e,i,o){if(void 0===o&&(o=0),this.m_count=4,this.m_vertices=s.b2Vec2.MakeArray(this.m_count),this.m_normals=s.b2Vec2.MakeArray(this.m_count),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero(),i){this.m_centroid.Copy(i);var n=new s.b2Transform;n.SetPosition(i),n.SetRotationAngle(o);for(var r=0;r<this.m_count;++r)s.b2Transform.MulXV(n,this.m_vertices[r],this.m_vertices[r]),s.b2Rot.MulRV(n.q,this.m_normals[r],this.m_normals[r])}return this},e.prototype.TestPoint=function(t,i){for(var o=s.b2Transform.MulTXV(t,i,e.TestPoint_s_pLocal),n=0;n<this.m_count;++n)if(s.b2Vec2.DotVV(this.m_normals[n],s.b2Vec2.SubVV(o,this.m_vertices[n],s.b2Vec2.s_t0))>0)return!1;return!0},e.prototype.ComputeDistance=function(t,i,o){for(var n=s.b2Transform.MulTXV(t,i,e.ComputeDistance_s_pLocal),a=-r.b2_maxFloat,l=e.ComputeDistance_s_normalForMaxDistance.Copy(n),c=0;c<this.m_count;++c){var u=s.b2Vec2.DotVV(this.m_normals[c],s.b2Vec2.SubVV(n,this.m_vertices[c],s.b2Vec2.s_t0));u>a&&(a=u,l.Copy(this.m_normals[c]))}if(a>0){var _=e.ComputeDistance_s_minDistance.Copy(l),p=a*a;for(c=0;c<this.m_count;++c){var m=s.b2Vec2.SubVV(n,this.m_vertices[c],e.ComputeDistance_s_distance),h=m.LengthSquared();p>h&&(_.Copy(m),p=h)}return s.b2Rot.MulRV(t.q,_,o),o.Normalize(),Math.sqrt(p)}return s.b2Rot.MulRV(t.q,l,o),a},e.prototype.RayCast=function(t,i,o){for(var n=s.b2Transform.MulTXV(o,i.p1,e.RayCast_s_p1),r=s.b2Transform.MulTXV(o,i.p2,e.RayCast_s_p2),a=s.b2Vec2.SubVV(r,n,e.RayCast_s_d),l=0,c=i.maxFraction,u=-1,_=0;_<this.m_count;++_){var p=s.b2Vec2.DotVV(this.m_normals[_],s.b2Vec2.SubVV(this.m_vertices[_],n,s.b2Vec2.s_t0)),m=s.b2Vec2.DotVV(this.m_normals[_],a);if(0===m){if(p<0)return!1}else m<0&&p<l*m?(l=p/m,u=_):m>0&&p<c*m&&(c=p/m);if(c<l)return!1}return u>=0&&(t.fraction=l,s.b2Rot.MulRV(o.q,this.m_normals[u],t.normal),!0)},e.prototype.ComputeAABB=function(t,i){for(var o=s.b2Transform.MulXV(i,this.m_vertices[0],t.lowerBound),n=t.upperBound.Copy(o),r=0;r<this.m_count;++r){var a=s.b2Transform.MulXV(i,this.m_vertices[r],e.ComputeAABB_s_v);s.b2Vec2.MinV(a,o,o),s.b2Vec2.MaxV(a,n,n)}var l=this.m_radius;o.SelfSubXY(l,l),n.SelfAddXY(l,l)},e.prototype.ComputeMass=function(t,i){for(var o=e.ComputeMass_s_center.SetZero(),n=0,r=0,a=e.ComputeMass_s_s.SetZero(),l=0;l<this.m_count;++l)a.SelfAdd(this.m_vertices[l]);for(a.SelfMul(1/this.m_count),l=0;l<this.m_count;++l){var c=s.b2Vec2.SubVV(this.m_vertices[l],a,e.ComputeMass_s_e1),u=s.b2Vec2.SubVV(this.m_vertices[(l+1)%this.m_count],a,e.ComputeMass_s_e2),_=s.b2Vec2.CrossVV(c,u),p=.5*_;n+=p,o.SelfAdd(s.b2Vec2.MulSV(p*(1/3),s.b2Vec2.AddVV(c,u,s.b2Vec2.s_t0),s.b2Vec2.s_t1));var m=c.x,h=c.y,f=u.x,d=u.y;r+=1/3*.25*_*(m*m+f*m+f*f+h*h+d*h+d*d)}t.mass=i*n,o.SelfMul(1/n),s.b2Vec2.AddVV(o,a,t.center),t.I=i*r,t.I+=t.mass*(s.b2Vec2.DotVV(t.center,t.center)-s.b2Vec2.DotVV(o,o))},e.prototype.Validate=function(){for(var t=0;t<this.m_count;++t)for(var i=t,o=(t+1)%this.m_count,n=this.m_vertices[i],r=s.b2Vec2.SubVV(this.m_vertices[o],n,e.Validate_s_e),a=0;a<this.m_count;++a)if(a!==i&&a!==o){var l=s.b2Vec2.SubVV(this.m_vertices[a],n,e.Validate_s_v);if(s.b2Vec2.CrossVV(r,l)<0)return!1}return!0},e.prototype.SetupDistanceProxy=function(t){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius},e.prototype.ComputeSubmergedArea=function(t,i,o,n){for(var a=s.b2Rot.MulTRV(o.q,t,e.ComputeSubmergedArea_s_normalL),l=i-s.b2Vec2.DotVV(t,o.p),c=[],u=0,_=-1,p=-1,m=!1,h=0;h<this.m_count;++h){c[h]=s.b2Vec2.DotVV(a,this.m_vertices[h])-l;var f=c[h]<-r.b2_epsilon;h>0&&(f?m||(_=h-1,u++):m&&(p=h-1,u++)),m=f}switch(u){case 0:if(m){var d=e.ComputeSubmergedArea_s_md;return this.ComputeMass(d,1),s.b2Transform.MulXV(o,d.center,n),d.mass}return 0;case 1:-1===_?_=this.m_count-1:p=this.m_count-1}for(var b,y=(_+1)%this.m_count,v=(p+1)%this.m_count,V=(0-c[_])/(c[y]-c[_]),C=(0-c[p])/(c[v]-c[p]),g=e.ComputeSubmergedArea_s_intoVec.Set(this.m_vertices[_].x*(1-V)+this.m_vertices[y].x*V,this.m_vertices[_].y*(1-V)+this.m_vertices[y].y*V),x=e.ComputeSubmergedArea_s_outoVec.Set(this.m_vertices[p].x*(1-C)+this.m_vertices[v].x*C,this.m_vertices[p].y*(1-C)+this.m_vertices[v].y*C),S=0,B=e.ComputeSubmergedArea_s_center.SetZero(),A=this.m_vertices[y],P=y;P!==v;){b=(P=(P+1)%this.m_count)===v?x:this.m_vertices[P];var w=.5*((A.x-g.x)*(b.y-g.y)-(A.y-g.y)*(b.x-g.x));S+=w,B.x+=w*(g.x+A.x+b.x)/3,B.y+=w*(g.y+A.y+b.y)/3,A=b}return B.SelfMul(1/S),s.b2Transform.MulXV(o,B,n),S},e.prototype.Dump=function(t){t("    const shape: b2PolygonShape = new b2PolygonShape();\n"),t("    const vs: b2Vec2[] = [];\n");for(var e=0;e<this.m_count;++e)t("    vs[%d] = new b2Vec2(%.15f, %.15f);\n",e,this.m_vertices[e].x,this.m_vertices[e].y);t("    shape.Set(vs, %d);\n",this.m_count)},e.ComputeCentroid=function(t,i,o){var n=o;n.SetZero();for(var r=0,a=e.ComputeCentroid_s_pRef.SetZero(),l=0;l<i;++l){var c=a,u=t[l],_=t[(l+1)%i],p=s.b2Vec2.SubVV(u,c,e.ComputeCentroid_s_e1),m=s.b2Vec2.SubVV(_,c,e.ComputeCentroid_s_e2),h=.5*s.b2Vec2.CrossVV(p,m);r+=h,n.x+=h*(1/3)*(c.x+u.x+_.x),n.y+=h*(1/3)*(c.y+u.y+_.y)}return n.SelfMul(1/r),n},e.Set_s_r=new s.b2Vec2,e.Set_s_v=new s.b2Vec2,e.TestPoint_s_pLocal=new s.b2Vec2,e.ComputeDistance_s_pLocal=new s.b2Vec2,e.ComputeDistance_s_normalForMaxDistance=new s.b2Vec2,e.ComputeDistance_s_minDistance=new s.b2Vec2,e.ComputeDistance_s_distance=new s.b2Vec2,e.RayCast_s_p1=new s.b2Vec2,e.RayCast_s_p2=new s.b2Vec2,e.RayCast_s_d=new s.b2Vec2,e.ComputeAABB_s_v=new s.b2Vec2,e.ComputeMass_s_center=new s.b2Vec2,e.ComputeMass_s_s=new s.b2Vec2,e.ComputeMass_s_e1=new s.b2Vec2,e.ComputeMass_s_e2=new s.b2Vec2,e.Validate_s_e=new s.b2Vec2,e.Validate_s_v=new s.b2Vec2,e.ComputeSubmergedArea_s_normalL=new s.b2Vec2,e.ComputeSubmergedArea_s_md=new a.b2MassData,e.ComputeSubmergedArea_s_intoVec=new s.b2Vec2,e.ComputeSubmergedArea_s_outoVec=new s.b2Vec2,e.ComputeSubmergedArea_s_center=new s.b2Vec2,e.ComputeCentroid_s_pRef=new s.b2Vec2,e.ComputeCentroid_s_e1=new s.b2Vec2,e.ComputeCentroid_s_e2=new s.b2Vec2,e}(l.b2Shape);i.b2PolygonShape=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Shape":"b2Shape"}],b2PrismaticJoint:[function(t,e,i){"use strict";cc._RF.push(e,"f184cy1oqhMy5e5xSfAq7ga","b2PrismaticJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2PrismaticJoint=i.b2PrismaticJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=function(t){function e(){var e=t.call(this,a.b2JointType.e_prismaticJoint)||this;return e.localAnchorA=new s.b2Vec2,e.localAnchorB=new s.b2Vec2,e.localAxisA=new s.b2Vec2(1,0),e.referenceAngle=0,e.enableLimit=!1,e.lowerTranslation=0,e.upperTranslation=0,e.enableMotor=!1,e.maxMotorForce=0,e.motorSpeed=0,e}return n(e,t),e.prototype.Initialize=function(t,e,i,o){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.bodyA.GetLocalVector(o,this.localAxisA),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},e}(a.b2JointDef);i.b2PrismaticJointDef=l;var c=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchorA=new s.b2Vec2,i.m_localAnchorB=new s.b2Vec2,i.m_localXAxisA=new s.b2Vec2,i.m_localYAxisA=new s.b2Vec2,i.m_referenceAngle=0,i.m_impulse=new s.b2Vec3(0,0,0),i.m_motorImpulse=0,i.m_lowerTranslation=0,i.m_upperTranslation=0,i.m_maxMotorForce=0,i.m_motorSpeed=0,i.m_enableLimit=!1,i.m_enableMotor=!1,i.m_limitState=a.b2LimitState.e_inactiveLimit,i.m_indexA=0,i.m_indexB=0,i.m_localCenterA=new s.b2Vec2,i.m_localCenterB=new s.b2Vec2,i.m_invMassA=0,i.m_invMassB=0,i.m_invIA=0,i.m_invIB=0,i.m_axis=new s.b2Vec2(0,0),i.m_perp=new s.b2Vec2(0,0),i.m_s1=0,i.m_s2=0,i.m_a1=0,i.m_a2=0,i.m_K=new s.b2Mat33,i.m_K3=new s.b2Mat33,i.m_K2=new s.b2Mat22,i.m_motorMass=0,i.m_qA=new s.b2Rot,i.m_qB=new s.b2Rot,i.m_lalcA=new s.b2Vec2,i.m_lalcB=new s.b2Vec2,i.m_rA=new s.b2Vec2,i.m_rB=new s.b2Vec2,i.m_localAnchorA.Copy(r.b2Maybe(e.localAnchorA,s.b2Vec2.ZERO)),i.m_localAnchorB.Copy(r.b2Maybe(e.localAnchorB,s.b2Vec2.ZERO)),i.m_localXAxisA.Copy(r.b2Maybe(e.localAxisA,new s.b2Vec2(1,0))).SelfNormalize(),s.b2Vec2.CrossOneV(i.m_localXAxisA,i.m_localYAxisA),i.m_referenceAngle=r.b2Maybe(e.referenceAngle,0),i.m_lowerTranslation=r.b2Maybe(e.lowerTranslation,0),i.m_upperTranslation=r.b2Maybe(e.upperTranslation,0),i.m_maxMotorForce=r.b2Maybe(e.maxMotorForce,0),i.m_motorSpeed=r.b2Maybe(e.motorSpeed,0),i.m_enableLimit=r.b2Maybe(e.enableLimit,!1),i.m_enableMotor=r.b2Maybe(e.enableMotor,!1),i}return n(e,t),e.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v,l=t.velocities[this.m_indexA].w,c=t.positions[this.m_indexB].c,u=t.positions[this.m_indexB].a,_=t.velocities[this.m_indexB].v,p=t.velocities[this.m_indexB].w,m=this.m_qA.SetAngle(o),h=this.m_qB.SetAngle(u);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var f=s.b2Rot.MulRV(m,this.m_lalcA,this.m_rA);s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var d=s.b2Rot.MulRV(h,this.m_lalcB,this.m_rB),b=s.b2Vec2.AddVV(s.b2Vec2.SubVV(c,i,s.b2Vec2.s_t0),s.b2Vec2.SubVV(d,f,s.b2Vec2.s_t1),e.InitVelocityConstraints_s_d),y=this.m_invMassA,v=this.m_invMassB,V=this.m_invIA,C=this.m_invIB;if(s.b2Rot.MulRV(m,this.m_localXAxisA,this.m_axis),this.m_a1=s.b2Vec2.CrossVV(s.b2Vec2.AddVV(b,f,s.b2Vec2.s_t0),this.m_axis),this.m_a2=s.b2Vec2.CrossVV(d,this.m_axis),this.m_motorMass=y+v+V*this.m_a1*this.m_a1+C*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),s.b2Rot.MulRV(m,this.m_localYAxisA,this.m_perp),this.m_s1=s.b2Vec2.CrossVV(s.b2Vec2.AddVV(b,f,s.b2Vec2.s_t0),this.m_perp),this.m_s2=s.b2Vec2.CrossVV(d,this.m_perp),this.m_K.ex.x=y+v+V*this.m_s1*this.m_s1+C*this.m_s2*this.m_s2,this.m_K.ex.y=V*this.m_s1+C*this.m_s2,this.m_K.ex.z=V*this.m_s1*this.m_a1+C*this.m_s2*this.m_a2,this.m_K.ey.x=this.m_K.ex.y,this.m_K.ey.y=V+C,0===this.m_K.ey.y&&(this.m_K.ey.y=1),this.m_K.ey.z=V*this.m_a1+C*this.m_a2,this.m_K.ez.x=this.m_K.ex.z,this.m_K.ez.y=this.m_K.ey.z,this.m_K.ez.z=y+v+V*this.m_a1*this.m_a1+C*this.m_a2*this.m_a2,this.m_enableLimit){var g=s.b2Vec2.DotVV(this.m_axis,b);s.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*r.b2_linearSlop?this.m_limitState=a.b2LimitState.e_equalLimits:g<=this.m_lowerTranslation?this.m_limitState!==a.b2LimitState.e_atLowerLimit&&(this.m_limitState=a.b2LimitState.e_atLowerLimit,this.m_impulse.z=0):g>=this.m_upperTranslation?this.m_limitState!==a.b2LimitState.e_atUpperLimit&&(this.m_limitState=a.b2LimitState.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=a.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=a.b2LimitState.e_inactiveLimit,this.m_impulse.z=0;if(this.m_enableMotor||(this.m_motorImpulse=0),t.step.warmStarting){this.m_impulse.SelfMul(t.step.dtRatio),this.m_motorImpulse*=t.step.dtRatio;var x=s.b2Vec2.AddVV(s.b2Vec2.MulSV(this.m_impulse.x,this.m_perp,s.b2Vec2.s_t0),s.b2Vec2.MulSV(this.m_motorImpulse+this.m_impulse.z,this.m_axis,s.b2Vec2.s_t1),e.InitVelocityConstraints_s_P),S=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,B=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;n.SelfMulSub(y,x),l-=V*S,_.SelfMulAdd(v,x),p+=C*B}else this.m_impulse.SetZero(),this.m_motorImpulse=0;t.velocities[this.m_indexA].w=l,t.velocities[this.m_indexB].w=p},e.prototype.SolveVelocityConstraints=function(t){var i=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v,r=t.velocities[this.m_indexB].w,l=this.m_invMassA,c=this.m_invMassB,u=this.m_invIA,_=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!==a.b2LimitState.e_equalLimits){var p=s.b2Vec2.DotVV(this.m_axis,s.b2Vec2.SubVV(n,i,s.b2Vec2.s_t0))+this.m_a2*r-this.m_a1*o,m=this.m_motorMass*(this.m_motorSpeed-p),h=this.m_motorImpulse,f=t.step.dt*this.m_maxMotorForce;this.m_motorImpulse=s.b2Clamp(this.m_motorImpulse+m,-f,f),m=this.m_motorImpulse-h;var d=s.b2Vec2.MulSV(m,this.m_axis,e.SolveVelocityConstraints_s_P),b=m*this.m_a1,y=m*this.m_a2;i.SelfMulSub(l,d),o-=u*b,n.SelfMulAdd(c,d),r+=_*y}var v=s.b2Vec2.DotVV(this.m_perp,s.b2Vec2.SubVV(n,i,s.b2Vec2.s_t0))+this.m_s2*r-this.m_s1*o,V=r-o;if(this.m_enableLimit&&this.m_limitState!==a.b2LimitState.e_inactiveLimit){var C=s.b2Vec2.DotVV(this.m_axis,s.b2Vec2.SubVV(n,i,s.b2Vec2.s_t0))+this.m_a2*r-this.m_a1*o,g=e.SolveVelocityConstraints_s_f1.Copy(this.m_impulse),x=this.m_K.Solve33(-v,-V,-C,e.SolveVelocityConstraints_s_df3);this.m_impulse.SelfAdd(x),this.m_limitState===a.b2LimitState.e_atLowerLimit?this.m_impulse.z=s.b2Max(this.m_impulse.z,0):this.m_limitState===a.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=s.b2Min(this.m_impulse.z,0));var S=-v-(this.m_impulse.z-g.z)*this.m_K.ez.x,B=-V-(this.m_impulse.z-g.z)*this.m_K.ez.y,A=this.m_K.Solve22(S,B,e.SolveVelocityConstraints_s_f2r);A.x+=g.x,A.y+=g.y,this.m_impulse.x=A.x,this.m_impulse.y=A.y,x.x=this.m_impulse.x-g.x,x.y=this.m_impulse.y-g.y,x.z=this.m_impulse.z-g.z,d=s.b2Vec2.AddVV(s.b2Vec2.MulSV(x.x,this.m_perp,s.b2Vec2.s_t0),s.b2Vec2.MulSV(x.z,this.m_axis,s.b2Vec2.s_t1),e.SolveVelocityConstraints_s_P),b=x.x*this.m_s1+x.y+x.z*this.m_a1,y=x.x*this.m_s2+x.y+x.z*this.m_a2,i.SelfMulSub(l,d),o-=u*b,n.SelfMulAdd(c,d),r+=_*y}else{var P=this.m_K.Solve22(-v,-V,e.SolveVelocityConstraints_s_df2);this.m_impulse.x+=P.x,this.m_impulse.y+=P.y,d=s.b2Vec2.MulSV(P.x,this.m_perp,e.SolveVelocityConstraints_s_P),b=P.x*this.m_s1+P.y,y=P.x*this.m_s2+P.y,i.SelfMulSub(l,d),o-=u*b,n.SelfMulAdd(c,d),r+=_*y}t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=r},e.prototype.SolvePositionConstraints=function(t){var i=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,l=this.m_qA.SetAngle(o),c=this.m_qB.SetAngle(a),u=this.m_invMassA,_=this.m_invMassB,p=this.m_invIA,m=this.m_invIB,h=s.b2Rot.MulRV(l,this.m_lalcA,this.m_rA),f=s.b2Rot.MulRV(c,this.m_lalcB,this.m_rB),d=s.b2Vec2.SubVV(s.b2Vec2.AddVV(n,f,s.b2Vec2.s_t0),s.b2Vec2.AddVV(i,h,s.b2Vec2.s_t1),e.SolvePositionConstraints_s_d),b=s.b2Rot.MulRV(l,this.m_localXAxisA,this.m_axis),y=s.b2Vec2.CrossVV(s.b2Vec2.AddVV(d,h,s.b2Vec2.s_t0),b),v=s.b2Vec2.CrossVV(f,b),V=s.b2Rot.MulRV(l,this.m_localYAxisA,this.m_perp),C=s.b2Vec2.CrossVV(s.b2Vec2.AddVV(d,h,s.b2Vec2.s_t0),V),g=s.b2Vec2.CrossVV(f,V),x=e.SolvePositionConstraints_s_impulse,S=s.b2Vec2.DotVV(V,d),B=a-o-this.m_referenceAngle,A=s.b2Abs(S),P=s.b2Abs(B),w=!1,M=0;if(this.m_enableLimit){var D=s.b2Vec2.DotVV(b,d);s.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*r.b2_linearSlop?(M=s.b2Clamp(D,-r.b2_maxLinearCorrection,r.b2_maxLinearCorrection),A=s.b2Max(A,s.b2Abs(D)),w=!0):D<=this.m_lowerTranslation?(M=s.b2Clamp(D-this.m_lowerTranslation+r.b2_linearSlop,-r.b2_maxLinearCorrection,0),A=s.b2Max(A,this.m_lowerTranslation-D),w=!0):D>=this.m_upperTranslation&&(M=s.b2Clamp(D-this.m_upperTranslation-r.b2_linearSlop,0,r.b2_maxLinearCorrection),A=s.b2Max(A,D-this.m_upperTranslation),w=!0)}if(w){var I=u+_+p*C*C+m*g*g,G=p*C+m*g,T=p*C*y+m*g*v;0===(L=p+m)&&(L=1);var R=p*y+m*v,F=u+_+p*y*y+m*v*v,O=this.m_K3;O.ex.SetXYZ(I,G,T),O.ey.SetXYZ(G,L,R),O.ez.SetXYZ(T,R,F),x=O.Solve33(-S,-B,-M,x)}else{var L;I=u+_+p*C*C+m*g*g,G=p*C+m*g,0===(L=p+m)&&(L=1);var j=this.m_K2;j.ex.Set(I,G),j.ey.Set(G,L);var J=j.Solve(-S,-B,e.SolvePositionConstraints_s_impulse1);x.x=J.x,x.y=J.y,x.z=0}var E=s.b2Vec2.AddVV(s.b2Vec2.MulSV(x.x,V,s.b2Vec2.s_t0),s.b2Vec2.MulSV(x.z,b,s.b2Vec2.s_t1),e.SolvePositionConstraints_s_P),k=x.x*C+x.y+x.z*y,U=x.x*g+x.y+x.z*v;return i.SelfMulSub(u,E),o-=p*k,n.SelfMulAdd(_,E),a+=m*U,t.positions[this.m_indexA].a=o,t.positions[this.m_indexB].a=a,A<=r.b2_linearSlop&&P<=r.b2_angularSlop},e.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)},e.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)},e.prototype.GetReactionForce=function(t,e){return e.x=t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),e.y=t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y),e},e.prototype.GetReactionTorque=function(t){return t*this.m_impulse.y},e.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.GetLocalAxisA=function(){return this.m_localXAxisA},e.prototype.GetReferenceAngle=function(){return this.m_referenceAngle},e.prototype.GetJointTranslation=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e.GetJointTranslation_s_pA),i=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e.GetJointTranslation_s_pB),o=s.b2Vec2.SubVV(i,t,e.GetJointTranslation_s_d),n=this.m_bodyA.GetWorldVector(this.m_localXAxisA,e.GetJointTranslation_s_axis);return s.b2Vec2.DotVV(o,n)},e.prototype.GetJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB;s.b2Vec2.SubVV(this.m_localAnchorA,t.m_sweep.localCenter,this.m_lalcA);var i=s.b2Rot.MulRV(t.m_xf.q,this.m_lalcA,this.m_rA);s.b2Vec2.SubVV(this.m_localAnchorB,e.m_sweep.localCenter,this.m_lalcB);var o=s.b2Rot.MulRV(e.m_xf.q,this.m_lalcB,this.m_rB),n=s.b2Vec2.AddVV(t.m_sweep.c,i,s.b2Vec2.s_t0),r=s.b2Vec2.AddVV(e.m_sweep.c,o,s.b2Vec2.s_t1),a=s.b2Vec2.SubVV(r,n,s.b2Vec2.s_t2),l=t.GetWorldVector(this.m_localXAxisA,this.m_axis),c=t.m_linearVelocity,u=e.m_linearVelocity,_=t.m_angularVelocity,p=e.m_angularVelocity;return s.b2Vec2.DotVV(a,s.b2Vec2.CrossSV(_,l,s.b2Vec2.s_t0))+s.b2Vec2.DotVV(l,s.b2Vec2.SubVV(s.b2Vec2.AddVCrossSV(u,p,o,s.b2Vec2.s_t0),s.b2Vec2.AddVCrossSV(c,_,i,s.b2Vec2.s_t1),s.b2Vec2.s_t0))},e.prototype.IsLimitEnabled=function(){return this.m_enableLimit},e.prototype.EnableLimit=function(t){t!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},e.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},e.prototype.GetUpperLimit=function(){return this.m_upperTranslation},e.prototype.SetLimits=function(t,e){t===this.m_lowerTranslation&&e===this.m_upperTranslation||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0)},e.prototype.IsMotorEnabled=function(){return this.m_enableMotor},e.prototype.EnableMotor=function(t){t!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t)},e.prototype.SetMotorSpeed=function(t){t!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t)},e.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},e.prototype.SetMaxMotorForce=function(t){t!==this.m_maxMotorForce&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t)},e.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},e.prototype.GetMotorForce=function(t){return t*this.m_motorImpulse},e.prototype.Dump=function(t){var e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2PrismaticJointDef = new b2PrismaticJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y),t("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),t("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false"),t("  jd.lowerTranslation = %.15f;\n",this.m_lowerTranslation),t("  jd.upperTranslation = %.15f;\n",this.m_upperTranslation),t("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),t("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),t("  jd.maxMotorForce = %.15f;\n",this.m_maxMotorForce),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},e.InitVelocityConstraints_s_d=new s.b2Vec2,e.InitVelocityConstraints_s_P=new s.b2Vec2,e.SolveVelocityConstraints_s_P=new s.b2Vec2,e.SolveVelocityConstraints_s_f2r=new s.b2Vec2,e.SolveVelocityConstraints_s_f1=new s.b2Vec3,e.SolveVelocityConstraints_s_df3=new s.b2Vec3,e.SolveVelocityConstraints_s_df2=new s.b2Vec2,e.SolvePositionConstraints_s_d=new s.b2Vec2,e.SolvePositionConstraints_s_impulse=new s.b2Vec3,e.SolvePositionConstraints_s_impulse1=new s.b2Vec2,e.SolvePositionConstraints_s_P=new s.b2Vec2,e.GetJointTranslation_s_pA=new s.b2Vec2,e.GetJointTranslation_s_pB=new s.b2Vec2,e.GetJointTranslation_s_d=new s.b2Vec2,e.GetJointTranslation_s_axis=new s.b2Vec2,e}(a.b2Joint);i.b2PrismaticJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2PulleyJoint:[function(t,e,i){"use strict";cc._RF.push(e,"ac2e32W10pLbIf36sTvXvI3","b2PulleyJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2PulleyJoint=i.b2PulleyJointDef=i.b2_minPulleyLength=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint");i.b2_minPulleyLength=2;var l=function(t){function e(){var e=t.call(this,a.b2JointType.e_pulleyJoint)||this;return e.groundAnchorA=new s.b2Vec2(-1,1),e.groundAnchorB=new s.b2Vec2(1,1),e.localAnchorA=new s.b2Vec2(-1,0),e.localAnchorB=new s.b2Vec2(1,0),e.lengthA=0,e.lengthB=0,e.ratio=1,e.collideConnected=!0,e}return n(e,t),e.prototype.Initialize=function(t,e,i,o,n,r,a){this.bodyA=t,this.bodyB=e,this.groundAnchorA.Copy(i),this.groundAnchorB.Copy(o),this.bodyA.GetLocalPoint(n,this.localAnchorA),this.bodyB.GetLocalPoint(r,this.localAnchorB),this.lengthA=s.b2Vec2.DistanceVV(n,i),this.lengthB=s.b2Vec2.DistanceVV(r,o),this.ratio=a},e}(a.b2JointDef);i.b2PulleyJointDef=l;var c=function(t){function e(e){var i=t.call(this,e)||this;return i.m_groundAnchorA=new s.b2Vec2,i.m_groundAnchorB=new s.b2Vec2,i.m_lengthA=0,i.m_lengthB=0,i.m_localAnchorA=new s.b2Vec2,i.m_localAnchorB=new s.b2Vec2,i.m_constant=0,i.m_ratio=0,i.m_impulse=0,i.m_indexA=0,i.m_indexB=0,i.m_uA=new s.b2Vec2,i.m_uB=new s.b2Vec2,i.m_rA=new s.b2Vec2,i.m_rB=new s.b2Vec2,i.m_localCenterA=new s.b2Vec2,i.m_localCenterB=new s.b2Vec2,i.m_invMassA=0,i.m_invMassB=0,i.m_invIA=0,i.m_invIB=0,i.m_mass=0,i.m_qA=new s.b2Rot,i.m_qB=new s.b2Rot,i.m_lalcA=new s.b2Vec2,i.m_lalcB=new s.b2Vec2,i.m_groundAnchorA.Copy(r.b2Maybe(e.groundAnchorA,new s.b2Vec2(-1,1))),i.m_groundAnchorB.Copy(r.b2Maybe(e.groundAnchorB,new s.b2Vec2(1,0))),i.m_localAnchorA.Copy(r.b2Maybe(e.localAnchorA,new s.b2Vec2(-1,0))),i.m_localAnchorB.Copy(r.b2Maybe(e.localAnchorB,new s.b2Vec2(1,0))),i.m_lengthA=r.b2Maybe(e.lengthA,0),i.m_lengthB=r.b2Maybe(e.lengthB,0),i.m_ratio=r.b2Maybe(e.ratio,1),i.m_constant=r.b2Maybe(e.lengthA,0)+i.m_ratio*r.b2Maybe(e.lengthB,0),i.m_impulse=0,i}return n(e,t),e.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v,a=t.velocities[this.m_indexA].w,l=t.positions[this.m_indexB].c,c=t.positions[this.m_indexB].a,u=t.velocities[this.m_indexB].v,_=t.velocities[this.m_indexB].w,p=this.m_qA.SetAngle(o),m=this.m_qB.SetAngle(c);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),s.b2Rot.MulRV(p,this.m_lalcA,this.m_rA),s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),s.b2Rot.MulRV(m,this.m_lalcB,this.m_rB),this.m_uA.Copy(i).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA),this.m_uB.Copy(l).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);var h=this.m_uA.Length(),f=this.m_uB.Length();h>10*r.b2_linearSlop?this.m_uA.SelfMul(1/h):this.m_uA.SetZero(),f>10*r.b2_linearSlop?this.m_uB.SelfMul(1/f):this.m_uB.SetZero();var d=s.b2Vec2.CrossVV(this.m_rA,this.m_uA),b=s.b2Vec2.CrossVV(this.m_rB,this.m_uB),y=this.m_invMassA+this.m_invIA*d*d,v=this.m_invMassB+this.m_invIB*b*b;if(this.m_mass=y+this.m_ratio*this.m_ratio*v,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.step.warmStarting){this.m_impulse*=t.step.dtRatio;var V=s.b2Vec2.MulSV(-this.m_impulse,this.m_uA,e.InitVelocityConstraints_s_PA),C=s.b2Vec2.MulSV(-this.m_ratio*this.m_impulse,this.m_uB,e.InitVelocityConstraints_s_PB);n.SelfMulAdd(this.m_invMassA,V),a+=this.m_invIA*s.b2Vec2.CrossVV(this.m_rA,V),u.SelfMulAdd(this.m_invMassB,C),_+=this.m_invIB*s.b2Vec2.CrossVV(this.m_rB,C)}else this.m_impulse=0;t.velocities[this.m_indexA].w=a,t.velocities[this.m_indexB].w=_},e.prototype.SolveVelocityConstraints=function(t){var i=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v,r=t.velocities[this.m_indexB].w,a=s.b2Vec2.AddVCrossSV(i,o,this.m_rA,e.SolveVelocityConstraints_s_vpA),l=s.b2Vec2.AddVCrossSV(n,r,this.m_rB,e.SolveVelocityConstraints_s_vpB),c=-s.b2Vec2.DotVV(this.m_uA,a)-this.m_ratio*s.b2Vec2.DotVV(this.m_uB,l),u=-this.m_mass*c;this.m_impulse+=u;var _=s.b2Vec2.MulSV(-u,this.m_uA,e.SolveVelocityConstraints_s_PA),p=s.b2Vec2.MulSV(-this.m_ratio*u,this.m_uB,e.SolveVelocityConstraints_s_PB);i.SelfMulAdd(this.m_invMassA,_),o+=this.m_invIA*s.b2Vec2.CrossVV(this.m_rA,_),n.SelfMulAdd(this.m_invMassB,p),r+=this.m_invIB*s.b2Vec2.CrossVV(this.m_rB,p),t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=r},e.prototype.SolvePositionConstraints=function(t){var i=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,l=this.m_qA.SetAngle(o),c=this.m_qB.SetAngle(a);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var u=s.b2Rot.MulRV(l,this.m_lalcA,this.m_rA);s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var _=s.b2Rot.MulRV(c,this.m_lalcB,this.m_rB),p=this.m_uA.Copy(i).SelfAdd(u).SelfSub(this.m_groundAnchorA),m=this.m_uB.Copy(n).SelfAdd(_).SelfSub(this.m_groundAnchorB),h=p.Length(),f=m.Length();h>10*r.b2_linearSlop?p.SelfMul(1/h):p.SetZero(),f>10*r.b2_linearSlop?m.SelfMul(1/f):m.SetZero();var d=s.b2Vec2.CrossVV(u,p),b=s.b2Vec2.CrossVV(_,m),y=this.m_invMassA+this.m_invIA*d*d,v=this.m_invMassB+this.m_invIB*b*b,V=y+this.m_ratio*this.m_ratio*v;V>0&&(V=1/V);var C=this.m_constant-h-this.m_ratio*f,g=s.b2Abs(C),x=-V*C,S=s.b2Vec2.MulSV(-x,p,e.SolvePositionConstraints_s_PA),B=s.b2Vec2.MulSV(-this.m_ratio*x,m,e.SolvePositionConstraints_s_PB);return i.SelfMulAdd(this.m_invMassA,S),o+=this.m_invIA*s.b2Vec2.CrossVV(u,S),n.SelfMulAdd(this.m_invMassB,B),a+=this.m_invIB*s.b2Vec2.CrossVV(_,B),t.positions[this.m_indexA].a=o,t.positions[this.m_indexB].a=a,g<r.b2_linearSlop},e.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)},e.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)},e.prototype.GetReactionForce=function(t,e){return e.x=t*this.m_impulse*this.m_uB.x,e.y=t*this.m_impulse*this.m_uB.y,e},e.prototype.GetReactionTorque=function(){return 0},e.prototype.GetGroundAnchorA=function(){return this.m_groundAnchorA},e.prototype.GetGroundAnchorB=function(){return this.m_groundAnchorB},e.prototype.GetLengthA=function(){return this.m_lengthA},e.prototype.GetLengthB=function(){return this.m_lengthB},e.prototype.GetRatio=function(){return this.m_ratio},e.prototype.GetCurrentLengthA=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e.GetCurrentLengthA_s_p),i=this.m_groundAnchorA;return s.b2Vec2.DistanceVV(t,i)},e.prototype.GetCurrentLengthB=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e.GetCurrentLengthB_s_p),i=this.m_groundAnchorB;return s.b2Vec2.DistanceVV(t,i)},e.prototype.Dump=function(t){var e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2PulleyJointDef = new b2PulleyJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.groundAnchorA.Set(%.15f, %.15f);\n",this.m_groundAnchorA.x,this.m_groundAnchorA.y),t("  jd.groundAnchorB.Set(%.15f, %.15f);\n",this.m_groundAnchorB.x,this.m_groundAnchorB.y),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.lengthA = %.15f;\n",this.m_lengthA),t("  jd.lengthB = %.15f;\n",this.m_lengthB),t("  jd.ratio = %.15f;\n",this.m_ratio),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},e.prototype.ShiftOrigin=function(t){this.m_groundAnchorA.SelfSub(t),this.m_groundAnchorB.SelfSub(t)},e.InitVelocityConstraints_s_PA=new s.b2Vec2,e.InitVelocityConstraints_s_PB=new s.b2Vec2,e.SolveVelocityConstraints_s_vpA=new s.b2Vec2,e.SolveVelocityConstraints_s_vpB=new s.b2Vec2,e.SolveVelocityConstraints_s_PA=new s.b2Vec2,e.SolveVelocityConstraints_s_PB=new s.b2Vec2,e.SolvePositionConstraints_s_PA=new s.b2Vec2,e.SolvePositionConstraints_s_PB=new s.b2Vec2,e.GetCurrentLengthA_s_p=new s.b2Vec2,e.GetCurrentLengthB_s_p=new s.b2Vec2,e}(a.b2Joint);i.b2PulleyJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2RevoluteJoint:[function(t,e,i){"use strict";cc._RF.push(e,"007f55pKWJDLZOcW8HpIsra","b2RevoluteJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2RevoluteJoint=i.b2RevoluteJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=function(t){function e(){var e=t.call(this,a.b2JointType.e_revoluteJoint)||this;return e.localAnchorA=new s.b2Vec2(0,0),e.localAnchorB=new s.b2Vec2(0,0),e.referenceAngle=0,e.enableLimit=!1,e.lowerAngle=0,e.upperAngle=0,e.enableMotor=!1,e.motorSpeed=0,e.maxMotorTorque=0,e}return n(e,t),e.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},e}(a.b2JointDef);i.b2RevoluteJointDef=l;var c=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchorA=new s.b2Vec2,i.m_localAnchorB=new s.b2Vec2,i.m_impulse=new s.b2Vec3,i.m_motorImpulse=0,i.m_enableMotor=!1,i.m_maxMotorTorque=0,i.m_motorSpeed=0,i.m_enableLimit=!1,i.m_referenceAngle=0,i.m_lowerAngle=0,i.m_upperAngle=0,i.m_indexA=0,i.m_indexB=0,i.m_rA=new s.b2Vec2,i.m_rB=new s.b2Vec2,i.m_localCenterA=new s.b2Vec2,i.m_localCenterB=new s.b2Vec2,i.m_invMassA=0,i.m_invMassB=0,i.m_invIA=0,i.m_invIB=0,i.m_mass=new s.b2Mat33,i.m_motorMass=0,i.m_limitState=a.b2LimitState.e_inactiveLimit,i.m_qA=new s.b2Rot,i.m_qB=new s.b2Rot,i.m_lalcA=new s.b2Vec2,i.m_lalcB=new s.b2Vec2,i.m_K=new s.b2Mat22,i.m_localAnchorA.Copy(r.b2Maybe(e.localAnchorA,s.b2Vec2.ZERO)),i.m_localAnchorB.Copy(r.b2Maybe(e.localAnchorB,s.b2Vec2.ZERO)),i.m_referenceAngle=r.b2Maybe(e.referenceAngle,0),i.m_impulse.SetZero(),i.m_motorImpulse=0,i.m_lowerAngle=r.b2Maybe(e.lowerAngle,0),i.m_upperAngle=r.b2Maybe(e.upperAngle,0),i.m_maxMotorTorque=r.b2Maybe(e.maxMotorTorque,0),i.m_motorSpeed=r.b2Maybe(e.motorSpeed,0),i.m_enableLimit=r.b2Maybe(e.enableLimit,!1),i.m_enableMotor=r.b2Maybe(e.enableMotor,!1),i.m_limitState=a.b2LimitState.e_inactiveLimit,i}return n(e,t),e.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=t.positions[this.m_indexA].a,o=t.velocities[this.m_indexA].v,n=t.velocities[this.m_indexA].w,l=t.positions[this.m_indexB].a,c=t.velocities[this.m_indexB].v,u=t.velocities[this.m_indexB].w,_=this.m_qA.SetAngle(i),p=this.m_qB.SetAngle(l);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),s.b2Rot.MulRV(_,this.m_lalcA,this.m_rA),s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),s.b2Rot.MulRV(p,this.m_lalcB,this.m_rB);var m=this.m_invMassA,h=this.m_invMassB,f=this.m_invIA,d=this.m_invIB,b=f+d===0;if(this.m_mass.ex.x=m+h+this.m_rA.y*this.m_rA.y*f+this.m_rB.y*this.m_rB.y*d,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*f-this.m_rB.y*this.m_rB.x*d,this.m_mass.ez.x=-this.m_rA.y*f-this.m_rB.y*d,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=m+h+this.m_rA.x*this.m_rA.x*f+this.m_rB.x*this.m_rB.x*d,this.m_mass.ez.y=this.m_rA.x*f+this.m_rB.x*d,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=f+d,this.m_motorMass=f+d,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),this.m_enableMotor&&!b||(this.m_motorImpulse=0),this.m_enableLimit&&!b){var y=l-i-this.m_referenceAngle;s.b2Abs(this.m_upperAngle-this.m_lowerAngle)<2*r.b2_angularSlop?this.m_limitState=a.b2LimitState.e_equalLimits:y<=this.m_lowerAngle?(this.m_limitState!==a.b2LimitState.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=a.b2LimitState.e_atLowerLimit):y>=this.m_upperAngle?(this.m_limitState!==a.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=a.b2LimitState.e_atUpperLimit):(this.m_limitState=a.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=a.b2LimitState.e_inactiveLimit;if(t.step.warmStarting){this.m_impulse.SelfMul(t.step.dtRatio),this.m_motorImpulse*=t.step.dtRatio;var v=e.InitVelocityConstraints_s_P.Set(this.m_impulse.x,this.m_impulse.y);o.SelfMulSub(m,v),n-=f*(s.b2Vec2.CrossVV(this.m_rA,v)+this.m_motorImpulse+this.m_impulse.z),c.SelfMulAdd(h,v),u+=d*(s.b2Vec2.CrossVV(this.m_rB,v)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0;t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].w=u},e.prototype.SolveVelocityConstraints=function(t){var i=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v,r=t.velocities[this.m_indexB].w,l=this.m_invMassA,c=this.m_invMassB,u=this.m_invIA,_=this.m_invIB,p=u+_===0;if(this.m_enableMotor&&this.m_limitState!==a.b2LimitState.e_equalLimits&&!p){var m=r-o-this.m_motorSpeed,h=-this.m_motorMass*m,f=this.m_motorImpulse,d=t.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=s.b2Clamp(this.m_motorImpulse+h,-d,d),o-=u*(h=this.m_motorImpulse-f),r+=_*h}if(this.m_enableLimit&&this.m_limitState!==a.b2LimitState.e_inactiveLimit&&!p){var b=s.b2Vec2.SubVV(s.b2Vec2.AddVCrossSV(n,r,this.m_rB,s.b2Vec2.s_t0),s.b2Vec2.AddVCrossSV(i,o,this.m_rA,s.b2Vec2.s_t1),e.SolveVelocityConstraints_s_Cdot1),y=r-o,v=this.m_mass.Solve33(b.x,b.y,y,e.SolveVelocityConstraints_s_impulse_v3).SelfNeg();if(this.m_limitState===a.b2LimitState.e_equalLimits)this.m_impulse.SelfAdd(v);else if(this.m_limitState===a.b2LimitState.e_atLowerLimit)if(this.m_impulse.z+v.z<0){var V=-b.x+this.m_impulse.z*this.m_mass.ez.x,C=-b.y+this.m_impulse.z*this.m_mass.ez.y,g=this.m_mass.Solve22(V,C,e.SolveVelocityConstraints_s_reduced_v2);v.x=g.x,v.y=g.y,v.z=-this.m_impulse.z,this.m_impulse.x+=g.x,this.m_impulse.y+=g.y,this.m_impulse.z=0}else this.m_impulse.SelfAdd(v);else this.m_limitState===a.b2LimitState.e_atUpperLimit&&(this.m_impulse.z+v.z>0?(V=-b.x+this.m_impulse.z*this.m_mass.ez.x,C=-b.y+this.m_impulse.z*this.m_mass.ez.y,g=this.m_mass.Solve22(V,C,e.SolveVelocityConstraints_s_reduced_v2),v.x=g.x,v.y=g.y,v.z=-this.m_impulse.z,this.m_impulse.x+=g.x,this.m_impulse.y+=g.y,this.m_impulse.z=0):this.m_impulse.SelfAdd(v));var x=e.SolveVelocityConstraints_s_P.Set(v.x,v.y);i.SelfMulSub(l,x),o-=u*(s.b2Vec2.CrossVV(this.m_rA,x)+v.z),n.SelfMulAdd(c,x),r+=_*(s.b2Vec2.CrossVV(this.m_rB,x)+v.z)}else{var S=s.b2Vec2.SubVV(s.b2Vec2.AddVCrossSV(n,r,this.m_rB,s.b2Vec2.s_t0),s.b2Vec2.AddVCrossSV(i,o,this.m_rA,s.b2Vec2.s_t1),e.SolveVelocityConstraints_s_Cdot_v2),B=this.m_mass.Solve22(-S.x,-S.y,e.SolveVelocityConstraints_s_impulse_v2);this.m_impulse.x+=B.x,this.m_impulse.y+=B.y,i.SelfMulSub(l,B),o-=u*s.b2Vec2.CrossVV(this.m_rA,B),n.SelfMulAdd(c,B),r+=_*s.b2Vec2.CrossVV(this.m_rB,B)}t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=r},e.prototype.SolvePositionConstraints=function(t){var i,o=t.positions[this.m_indexA].c,n=t.positions[this.m_indexA].a,l=t.positions[this.m_indexB].c,c=t.positions[this.m_indexB].a,u=this.m_qA.SetAngle(n),_=this.m_qB.SetAngle(c),p=0,m=this.m_invIA+this.m_invIB===0;if(this.m_enableLimit&&this.m_limitState!==a.b2LimitState.e_inactiveLimit&&!m){var h=c-n-this.m_referenceAngle,f=0;if(this.m_limitState===a.b2LimitState.e_equalLimits){var d=s.b2Clamp(h-this.m_lowerAngle,-r.b2_maxAngularCorrection,r.b2_maxAngularCorrection);f=-this.m_motorMass*d,p=s.b2Abs(d)}else this.m_limitState===a.b2LimitState.e_atLowerLimit?(p=-(d=h-this.m_lowerAngle),d=s.b2Clamp(d+r.b2_angularSlop,-r.b2_maxAngularCorrection,0),f=-this.m_motorMass*d):this.m_limitState===a.b2LimitState.e_atUpperLimit&&(p=d=h-this.m_upperAngle,d=s.b2Clamp(d-r.b2_angularSlop,0,r.b2_maxAngularCorrection),f=-this.m_motorMass*d);n-=this.m_invIA*f,c+=this.m_invIB*f}u.SetAngle(n),_.SetAngle(c),s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var b=s.b2Rot.MulRV(u,this.m_lalcA,this.m_rA);s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var y=s.b2Rot.MulRV(_,this.m_lalcB,this.m_rB),v=s.b2Vec2.SubVV(s.b2Vec2.AddVV(l,y,s.b2Vec2.s_t0),s.b2Vec2.AddVV(o,b,s.b2Vec2.s_t1),e.SolvePositionConstraints_s_C_v2);i=v.Length();var V=this.m_invMassA,C=this.m_invMassB,g=this.m_invIA,x=this.m_invIB,S=this.m_K;S.ex.x=V+C+g*b.y*b.y+x*y.y*y.y,S.ex.y=-g*b.x*b.y-x*y.x*y.y,S.ey.x=S.ex.y,S.ey.y=V+C+g*b.x*b.x+x*y.x*y.x;var B=S.Solve(v.x,v.y,e.SolvePositionConstraints_s_impulse).SelfNeg();return o.SelfMulSub(V,B),n-=g*s.b2Vec2.CrossVV(b,B),l.SelfMulAdd(C,B),c+=x*s.b2Vec2.CrossVV(y,B),t.positions[this.m_indexA].a=n,t.positions[this.m_indexB].a=c,i<=r.b2_linearSlop&&p<=r.b2_angularSlop},e.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)},e.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)},e.prototype.GetReactionForce=function(t,e){return e.x=t*this.m_impulse.x,e.y=t*this.m_impulse.y,e},e.prototype.GetReactionTorque=function(t){return t*this.m_impulse.z},e.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.GetReferenceAngle=function(){return this.m_referenceAngle},e.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},e.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},e.prototype.IsMotorEnabled=function(){return this.m_enableMotor},e.prototype.EnableMotor=function(t){t!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t)},e.prototype.GetMotorTorque=function(t){return t*this.m_motorImpulse},e.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},e.prototype.SetMaxMotorTorque=function(t){t!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=t)},e.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque},e.prototype.IsLimitEnabled=function(){return this.m_enableLimit},e.prototype.EnableLimit=function(t){t!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},e.prototype.GetLowerLimit=function(){return this.m_lowerAngle},e.prototype.GetUpperLimit=function(){return this.m_upperAngle},e.prototype.SetLimits=function(t,e){t===this.m_lowerAngle&&e===this.m_upperAngle||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e)},e.prototype.SetMotorSpeed=function(t){t!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t)},e.prototype.Dump=function(t){var e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2RevoluteJointDef = new b2RevoluteJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),t("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false"),t("  jd.lowerAngle = %.15f;\n",this.m_lowerAngle),t("  jd.upperAngle = %.15f;\n",this.m_upperAngle),t("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),t("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),t("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},e.InitVelocityConstraints_s_P=new s.b2Vec2,e.SolveVelocityConstraints_s_P=new s.b2Vec2,e.SolveVelocityConstraints_s_Cdot_v2=new s.b2Vec2,e.SolveVelocityConstraints_s_Cdot1=new s.b2Vec2,e.SolveVelocityConstraints_s_impulse_v3=new s.b2Vec3,e.SolveVelocityConstraints_s_reduced_v2=new s.b2Vec2,e.SolveVelocityConstraints_s_impulse_v2=new s.b2Vec2,e.SolvePositionConstraints_s_C_v2=new s.b2Vec2,e.SolvePositionConstraints_s_impulse=new s.b2Vec2,e}(a.b2Joint);i.b2RevoluteJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2RopeJoint:[function(t,e,i){"use strict";cc._RF.push(e,"509ae5atWlKDLUOo+W034g/","b2RopeJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2RopeJoint=i.b2RopeJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=function(t){function e(){var e=t.call(this,a.b2JointType.e_ropeJoint)||this;return e.localAnchorA=new s.b2Vec2(-1,0),e.localAnchorB=new s.b2Vec2(1,0),e.maxLength=0,e}return n(e,t),e}(a.b2JointDef);i.b2RopeJointDef=l;var c=function(t){function e(e){var i=t.call(this,e)||this;return i.m_localAnchorA=new s.b2Vec2,i.m_localAnchorB=new s.b2Vec2,i.m_maxLength=0,i.m_length=0,i.m_impulse=0,i.m_indexA=0,i.m_indexB=0,i.m_u=new s.b2Vec2,i.m_rA=new s.b2Vec2,i.m_rB=new s.b2Vec2,i.m_localCenterA=new s.b2Vec2,i.m_localCenterB=new s.b2Vec2,i.m_invMassA=0,i.m_invMassB=0,i.m_invIA=0,i.m_invIB=0,i.m_mass=0,i.m_state=a.b2LimitState.e_inactiveLimit,i.m_qA=new s.b2Rot,i.m_qB=new s.b2Rot,i.m_lalcA=new s.b2Vec2,i.m_lalcB=new s.b2Vec2,i.m_localAnchorA.Copy(r.b2Maybe(e.localAnchorA,new s.b2Vec2(-1,0))),i.m_localAnchorB.Copy(r.b2Maybe(e.localAnchorB,new s.b2Vec2(1,0))),i.m_maxLength=r.b2Maybe(e.maxLength,0),i}return n(e,t),e.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v,l=t.velocities[this.m_indexA].w,c=t.positions[this.m_indexB].c,u=t.positions[this.m_indexB].a,_=t.velocities[this.m_indexB].v,p=t.velocities[this.m_indexB].w,m=this.m_qA.SetAngle(o),h=this.m_qB.SetAngle(u);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),s.b2Rot.MulRV(m,this.m_lalcA,this.m_rA),s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),s.b2Rot.MulRV(h,this.m_lalcB,this.m_rB),this.m_u.Copy(c).SelfAdd(this.m_rB).SelfSub(i).SelfSub(this.m_rA),this.m_length=this.m_u.Length();var f=this.m_length-this.m_maxLength;if(this.m_state=f>0?a.b2LimitState.e_atUpperLimit:a.b2LimitState.e_inactiveLimit,!(this.m_length>r.b2_linearSlop))return this.m_u.SetZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.SelfMul(1/this.m_length);var d=s.b2Vec2.CrossVV(this.m_rA,this.m_u),b=s.b2Vec2.CrossVV(this.m_rB,this.m_u),y=this.m_invMassA+this.m_invIA*d*d+this.m_invMassB+this.m_invIB*b*b;if(this.m_mass=0!==y?1/y:0,t.step.warmStarting){this.m_impulse*=t.step.dtRatio;var v=s.b2Vec2.MulSV(this.m_impulse,this.m_u,e.InitVelocityConstraints_s_P);n.SelfMulSub(this.m_invMassA,v),l-=this.m_invIA*s.b2Vec2.CrossVV(this.m_rA,v),_.SelfMulAdd(this.m_invMassB,v),p+=this.m_invIB*s.b2Vec2.CrossVV(this.m_rB,v)}else this.m_impulse=0;t.velocities[this.m_indexA].w=l,t.velocities[this.m_indexB].w=p},e.prototype.SolveVelocityConstraints=function(t){var i=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v,r=t.velocities[this.m_indexB].w,a=s.b2Vec2.AddVCrossSV(i,o,this.m_rA,e.SolveVelocityConstraints_s_vpA),l=s.b2Vec2.AddVCrossSV(n,r,this.m_rB,e.SolveVelocityConstraints_s_vpB),c=this.m_length-this.m_maxLength,u=s.b2Vec2.DotVV(this.m_u,s.b2Vec2.SubVV(l,a,s.b2Vec2.s_t0));c<0&&(u+=t.step.inv_dt*c);var _=-this.m_mass*u,p=this.m_impulse;this.m_impulse=s.b2Min(0,this.m_impulse+_),_=this.m_impulse-p;var m=s.b2Vec2.MulSV(_,this.m_u,e.SolveVelocityConstraints_s_P);i.SelfMulSub(this.m_invMassA,m),o-=this.m_invIA*s.b2Vec2.CrossVV(this.m_rA,m),n.SelfMulAdd(this.m_invMassB,m),r+=this.m_invIB*s.b2Vec2.CrossVV(this.m_rB,m),t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=r},e.prototype.SolvePositionConstraints=function(t){var i=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,l=this.m_qA.SetAngle(o),c=this.m_qB.SetAngle(a);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var u=s.b2Rot.MulRV(l,this.m_lalcA,this.m_rA);s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var _=s.b2Rot.MulRV(c,this.m_lalcB,this.m_rB),p=this.m_u.Copy(n).SelfAdd(_).SelfSub(i).SelfSub(u),m=p.Normalize(),h=m-this.m_maxLength;h=s.b2Clamp(h,0,r.b2_maxLinearCorrection);var f=-this.m_mass*h,d=s.b2Vec2.MulSV(f,p,e.SolvePositionConstraints_s_P);return i.SelfMulSub(this.m_invMassA,d),o-=this.m_invIA*s.b2Vec2.CrossVV(u,d),n.SelfMulAdd(this.m_invMassB,d),a+=this.m_invIB*s.b2Vec2.CrossVV(_,d),t.positions[this.m_indexA].a=o,t.positions[this.m_indexB].a=a,m-this.m_maxLength<r.b2_linearSlop},e.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)},e.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)},e.prototype.GetReactionForce=function(t,e){return s.b2Vec2.MulSV(t*this.m_impulse,this.m_u,e)},e.prototype.GetReactionTorque=function(){return 0},e.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.SetMaxLength=function(t){this.m_maxLength=t},e.prototype.GetMaxLength=function(){return this.m_maxLength},e.prototype.GetLimitState=function(){return this.m_state},e.prototype.Dump=function(t){var e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2RopeJointDef = new b2RopeJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.maxLength = %.15f;\n",this.m_maxLength),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},e.InitVelocityConstraints_s_P=new s.b2Vec2,e.SolveVelocityConstraints_s_vpA=new s.b2Vec2,e.SolveVelocityConstraints_s_vpB=new s.b2Vec2,e.SolveVelocityConstraints_s_P=new s.b2Vec2,e.SolvePositionConstraints_s_P=new s.b2Vec2,e}(a.b2Joint);i.b2RopeJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2Rope:[function(t,e,i){"use strict";cc._RF.push(e,"221faZRpohGtILSZYVMy3DK","b2Rope"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Rope=i.b2RopeDef=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Math"),r=t("../Common/b2Draw");i.b2RopeDef=function(){this.vertices=[],this.count=0,this.masses=[],this.gravity=new n.b2Vec2(0,0),this.damping=.1,this.k2=.9,this.k3=.1};var s=function(){function t(){this.m_count=0,this.m_ps=[],this.m_p0s=[],this.m_vs=[],this.m_ims=[],this.m_Ls=[],this.m_as=[],this.m_gravity=new n.b2Vec2,this.m_damping=0,this.m_k2=1,this.m_k3=.1}return t.prototype.GetVertexCount=function(){return this.m_count},t.prototype.GetVertices=function(){return this.m_ps},t.prototype.Initialize=function(t){this.m_count=t.count,this.m_ps=n.b2Vec2.MakeArray(this.m_count),this.m_p0s=n.b2Vec2.MakeArray(this.m_count),this.m_vs=n.b2Vec2.MakeArray(this.m_count),this.m_ims=o.b2MakeNumberArray(this.m_count);for(var e=0;e<this.m_count;++e){this.m_ps[e].Copy(t.vertices[e]),this.m_p0s[e].Copy(t.vertices[e]),this.m_vs[e].SetZero();var i=t.masses[e];this.m_ims[e]=i>0?1/i:0}var r=this.m_count-1,s=this.m_count-2;for(this.m_Ls=o.b2MakeNumberArray(r),this.m_as=o.b2MakeNumberArray(s),e=0;e<r;++e){var a=this.m_ps[e],l=this.m_ps[e+1];this.m_Ls[e]=n.b2Vec2.DistanceVV(a,l)}for(e=0;e<s;++e){a=this.m_ps[e],l=this.m_ps[e+1];var c=this.m_ps[e+2],u=n.b2Vec2.SubVV(l,a,n.b2Vec2.s_t0),_=n.b2Vec2.SubVV(c,l,n.b2Vec2.s_t1),p=n.b2Vec2.CrossVV(u,_),m=n.b2Vec2.DotVV(u,_);this.m_as[e]=n.b2Atan2(p,m)}this.m_gravity.Copy(t.gravity),this.m_damping=t.damping,this.m_k2=t.k2,this.m_k3=t.k3},t.prototype.Step=function(t,e){if(0!==t){for(var i=Math.exp(-t*this.m_damping),o=0;o<this.m_count;++o)this.m_p0s[o].Copy(this.m_ps[o]),this.m_ims[o]>0&&this.m_vs[o].SelfMulAdd(t,this.m_gravity),this.m_vs[o].SelfMul(i),this.m_ps[o].SelfMulAdd(t,this.m_vs[o]);for(o=0;o<e;++o)this.SolveC2(),this.SolveC3(),this.SolveC2();var r=1/t;for(o=0;o<this.m_count;++o)n.b2Vec2.MulSV(r,n.b2Vec2.SubVV(this.m_ps[o],this.m_p0s[o],n.b2Vec2.s_t0),this.m_vs[o])}},t.prototype.SolveC2=function(){for(var e=this.m_count-1,i=0;i<e;++i){var o=this.m_ps[i],r=this.m_ps[i+1],s=n.b2Vec2.SubVV(r,o,t.s_d),a=s.Normalize(),l=this.m_ims[i],c=this.m_ims[i+1];if(l+c!==0){var u=l/(l+c),_=c/(l+c);o.SelfMulSub(this.m_k2*u*(this.m_Ls[i]-a),s),r.SelfMulAdd(this.m_k2*_*(this.m_Ls[i]-a),s)}}},t.prototype.SetAngle=function(t){for(var e=this.m_count-2,i=0;i<e;++i)this.m_as[i]=t},t.prototype.SolveC3=function(){for(var e=this.m_count-2,i=0;i<e;++i){var r=this.m_ps[i],s=this.m_ps[i+1],a=this.m_ps[i+2],l=this.m_ims[i],c=this.m_ims[i+1],u=this.m_ims[i+2],_=n.b2Vec2.SubVV(s,r,t.s_d1),p=n.b2Vec2.SubVV(a,s,t.s_d2),m=_.LengthSquared(),h=p.LengthSquared();if(m*h!=0){var f=n.b2Vec2.CrossVV(_,p),d=n.b2Vec2.DotVV(_,p),b=n.b2Atan2(f,d),y=n.b2Vec2.MulSV(-1/m,_.SelfSkew(),t.s_Jd1),v=n.b2Vec2.MulSV(1/h,p.SelfSkew(),t.s_Jd2),V=n.b2Vec2.NegV(y,t.s_J1),C=n.b2Vec2.SubVV(y,v,t.s_J2),g=v,x=l*n.b2Vec2.DotVV(V,V)+c*n.b2Vec2.DotVV(C,C)+u*n.b2Vec2.DotVV(g,g);if(0!==x){x=1/x;for(var S=b-this.m_as[i];S>o.b2_pi;)S=(b-=2*o.b2_pi)-this.m_as[i];for(;S<-o.b2_pi;)S=(b+=2*o.b2_pi)-this.m_as[i];var B=-this.m_k3*x*S;r.SelfMulAdd(l*B,V),s.SelfMulAdd(c*B,C),a.SelfMulAdd(u*B,g)}}}},t.prototype.Draw=function(t){for(var e=new r.b2Color(.4,.5,.7),i=0;i<this.m_count-1;++i)t.DrawSegment(this.m_ps[i],this.m_ps[i+1],e)},t.s_d=new n.b2Vec2,t.s_d1=new n.b2Vec2,t.s_d2=new n.b2Vec2,t.s_Jd1=new n.b2Vec2,t.s_Jd2=new n.b2Vec2,t.s_J1=new n.b2Vec2,t.s_J2=new n.b2Vec2,t}();i.b2Rope=s,cc._RF.pop()},{"../Common/b2Draw":"b2Draw","../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings"}],b2Settings:[function(t,e,i){"use strict";cc._RF.push(e,"a6046LpclxEYYVFDgRkLWjE","b2Settings");var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var o=Array(t),n=0;for(e=0;e<i;e++)for(var r=arguments[e],s=0,a=r.length;s<a;s++,n++)o[n]=r[s];return o};Object.defineProperty(i,"__esModule",{value:!0}),i.b2MakeNumberArray=i.b2MakeNullArray=i.b2MakeArray=i.b2ParseUInt=i.b2ParseInt=i.b2_commit=i.b2_branch=i.b2_version=i.b2Version=i.b2Log=i.b2Free=i.b2Alloc=i.b2_angularSleepTolerance=i.b2_linearSleepTolerance=i.b2_timeToSleep=i.b2_barrierCollisionTime=i.b2_minParticleSystemBufferCapacity=i.b2_maxTriadDistanceSquared=i.b2_maxTriadDistance=i.b2_maxParticleForce=i.b2_maxParticlePressure=i.b2_minParticleWeight=i.b2_particleStride=i.b2_maxParticleIndex=i.b2_invalidParticleIndex=i.b2_toiBaumgarte=i.b2_baumgarte=i.b2_maxRotationSquared=i.b2_maxRotation=i.b2_maxTranslationSquared=i.b2_maxTranslation=i.b2_maxAngularCorrection=i.b2_maxLinearCorrection=i.b2_velocityThreshold=i.b2_maxTOIContacts=i.b2_maxSubSteps=i.b2_polygonRadius=i.b2_angularSlop=i.b2_linearSlop=i.b2_aabbMultiplier=i.b2_aabbExtension=i.b2_maxPolygonVertices=i.b2_maxManifoldPoints=i.b2_pi=i.b2_epsilon_sq=i.b2_epsilon=i.b2_maxFloat=i.b2Maybe=i.b2Assert=void 0,i.b2Assert=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!t)throw new(Error.bind.apply(Error,o([void 0],e)))},i.b2Maybe=function(t,e){return void 0!==t?t:e},i.b2_maxFloat=1e37,i.b2_epsilon=1e-5,i.b2_epsilon_sq=i.b2_epsilon*i.b2_epsilon,i.b2_pi=3.14159265359,i.b2_maxManifoldPoints=2,i.b2_maxPolygonVertices=8,i.b2_aabbExtension=.1,i.b2_aabbMultiplier=2,i.b2_linearSlop=.008,i.b2_angularSlop=2/180*i.b2_pi,i.b2_polygonRadius=2*i.b2_linearSlop,i.b2_maxSubSteps=8,i.b2_maxTOIContacts=32,i.b2_velocityThreshold=1,i.b2_maxLinearCorrection=.2,i.b2_maxAngularCorrection=8/180*i.b2_pi,i.b2_maxTranslation=2,i.b2_maxTranslationSquared=i.b2_maxTranslation*i.b2_maxTranslation,i.b2_maxRotation=.5*i.b2_pi,i.b2_maxRotationSquared=i.b2_maxRotation*i.b2_maxRotation,i.b2_baumgarte=.2,i.b2_toiBaumgarte=.75,i.b2_invalidParticleIndex=-1,i.b2_maxParticleIndex=2147483647,i.b2_particleStride=.75,i.b2_minParticleWeight=1,i.b2_maxParticlePressure=.25,i.b2_maxParticleForce=.5,i.b2_maxTriadDistance=2,i.b2_maxTriadDistanceSquared=i.b2_maxTriadDistance*i.b2_maxTriadDistance,i.b2_minParticleSystemBufferCapacity=256,i.b2_barrierCollisionTime=2.5,i.b2_timeToSleep=.5,i.b2_linearSleepTolerance=.01,i.b2_angularSleepTolerance=2/180*i.b2_pi,i.b2Alloc=function(){return null},i.b2Free=function(){},i.b2Log=function(){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e]};var n=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.major=0,this.minor=0,this.revision=0,this.major=t,this.minor=e,this.revision=i}return t.prototype.toString=function(){return this.major+"."+this.minor+"."+this.revision},t}();i.b2Version=n,i.b2_version=new n(2,3,2),i.b2_branch="master",i.b2_commit="fbf51801d80fc389d43dc46524520e89043b6faf",i.b2ParseInt=function(t){return parseInt(t,10)},i.b2ParseUInt=function(t){return Math.abs(parseInt(t,10))},i.b2MakeArray=function(t,e){for(var i=new Array(t),o=0;o<t;++o)i[o]=e(o);return i},i.b2MakeNullArray=function(t){for(var e=new Array(t),i=0;i<t;++i)e[i]=null;return e},i.b2MakeNumberArray=function(t,e){void 0===e&&(e=0);for(var i=new Array(t),o=0;o<t;++o)i[o]=e;return i},cc._RF.pop()},{}],b2Shape:[function(t,e,i){"use strict";cc._RF.push(e,"45c486w5jVD7rTne2XfN0ME","b2Shape"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Shape=i.b2ShapeType=i.b2MassData=void 0;var o,n=t("../../Common/b2Math");i.b2MassData=function(){this.mass=0,this.center=new n.b2Vec2(0,0),this.I=0},function(t){t[t.e_unknown=-1]="e_unknown",t[t.e_circleShape=0]="e_circleShape",t[t.e_edgeShape=1]="e_edgeShape",t[t.e_polygonShape=2]="e_polygonShape",t[t.e_chainShape=3]="e_chainShape",t[t.e_shapeTypeCount=4]="e_shapeTypeCount"}(o=i.b2ShapeType||(i.b2ShapeType={}));var r=function(){function t(t,e){this.m_type=o.e_unknown,this.m_radius=0,this.m_type=t,this.m_radius=e}return t.prototype.Copy=function(t){return this.m_radius=t.m_radius,this},t.prototype.GetType=function(){return this.m_type},t}();i.b2Shape=r,cc._RF.pop()},{"../../Common/b2Math":"b2Math"}],b2StackAllocator:[function(t,e,i){"use strict";cc._RF.push(e,"7a6f2tdW8NNSoxAaHxKt/sO","b2StackAllocator"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2StackAllocator=void 0;i.b2StackAllocator=function(){},cc._RF.pop()},{}],b2StackQueue:[function(t,e,i){"use strict";cc._RF.push(e,"0e72a0muGBPr59GHRt7oCru","b2StackQueue"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2StackQueue=void 0;var o=t("../Common/b2Settings"),n=function(){function t(t){this.m_front=0,this.m_back=0,this.m_capacity=0,this.m_buffer=o.b2MakeArray(t,function(){return null}),this.m_capacity=t}return t.prototype.Push=function(t){if(this.m_back>=this.m_capacity){for(var e=this.m_front;e<this.m_back;e++)this.m_buffer[e-this.m_front]=this.m_buffer[e];this.m_back-=this.m_front,this.m_front=0,this.m_back>=this.m_capacity&&(this.m_capacity>0?(this.m_buffer.concat(o.b2MakeArray(this.m_capacity,function(){return null})),this.m_capacity*=2):(this.m_buffer.concat(o.b2MakeArray(1,function(){return null})),this.m_capacity=1))}this.m_buffer[this.m_back]=t,this.m_back++},t.prototype.Pop=function(){this.m_buffer[this.m_front]=null,this.m_front++},t.prototype.Empty=function(){return this.m_front===this.m_back},t.prototype.Front=function(){var t=this.m_buffer[this.m_front];if(!t)throw new Error;return t},t}();i.b2StackQueue=n,cc._RF.pop()},{"../Common/b2Settings":"b2Settings"}],b2TensorDampingController:[function(t,e,i){"use strict";cc._RF.push(e,"ce1fa62mdtBLL0RznMR3FPg","b2TensorDampingController");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2TensorDampingController=void 0;var r=t("./b2Controller"),s=t("../Common/b2Math"),a=t("../Common/b2Settings"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.T=new s.b2Mat22,e.maxTimestep=0,e}return n(e,t),e.prototype.Step=function(t){var i=t.dt;if(!(i<=a.b2_epsilon)){i>this.maxTimestep&&this.maxTimestep>0&&(i=this.maxTimestep);for(var o=this.m_bodyList;o;o=o.nextBody){var n=o.body;if(n.IsAwake()){var r=n.GetWorldVector(s.b2Mat22.MulMV(this.T,n.GetLocalVector(n.GetLinearVelocity(),s.b2Vec2.s_t0),s.b2Vec2.s_t1),e.Step_s_damping);n.SetLinearVelocity(s.b2Vec2.AddVV(n.GetLinearVelocity(),s.b2Vec2.MulSV(i,r,s.b2Vec2.s_t0),s.b2Vec2.s_t1))}}}},e.prototype.Draw=function(){},e.prototype.SetAxisAligned=function(t,e){this.T.ex.x=-t,this.T.ex.y=0,this.T.ey.x=0,this.T.ey.y=-e,this.maxTimestep=t>0||e>0?1/s.b2Max(t,e):0},e.Step_s_damping=new s.b2Vec2,e}(r.b2Controller);i.b2TensorDampingController=l,cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","./b2Controller":"b2Controller"}],b2TimeOfImpact:[function(t,e,i){"use strict";cc._RF.push(e,"5805dJYp6tJIovi4GSwjsQ7","b2TimeOfImpact"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2TimeOfImpact=i.b2SeparationFunction=i.b2SeparationFunctionType=i.b2TOIOutput=i.b2TOIOutputState=i.b2TOIInput=i.b2_toi_reset=i.b2_toiMaxRootIters=i.b2_toiRootIters=i.b2_toiMaxIters=i.b2_toiIters=i.b2_toiCalls=i.b2_toiMaxTime=i.b2_toiTime=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Math"),r=t("../Common/b2Timer"),s=t("./b2Distance");i.b2_toiTime=0,i.b2_toiMaxTime=0,i.b2_toiCalls=0,i.b2_toiIters=0,i.b2_toiMaxIters=0,i.b2_toiRootIters=0,i.b2_toiMaxRootIters=0,i.b2_toi_reset=function(){i.b2_toiTime=0,i.b2_toiMaxTime=0,i.b2_toiCalls=0,i.b2_toiIters=0,i.b2_toiMaxIters=0,i.b2_toiRootIters=0,i.b2_toiMaxRootIters=0};var a,l=new n.b2Transform,c=new n.b2Transform,u=new n.b2Vec2,_=new n.b2Vec2,p=new n.b2Vec2,m=new n.b2Vec2,h=new n.b2Vec2;i.b2TOIInput=function(){this.proxyA=new s.b2DistanceProxy,this.proxyB=new s.b2DistanceProxy,this.sweepA=new n.b2Sweep,this.sweepB=new n.b2Sweep,this.tMax=0},function(t){t[t.e_unknown=0]="e_unknown",t[t.e_failed=1]="e_failed",t[t.e_overlapped=2]="e_overlapped",t[t.e_touching=3]="e_touching",t[t.e_separated=4]="e_separated"}(a=i.b2TOIOutputState||(i.b2TOIOutputState={}));var f;i.b2TOIOutput=function(){this.state=a.e_unknown,this.t=0},function(t){t[t.e_unknown=-1]="e_unknown",t[t.e_points=0]="e_points",t[t.e_faceA=1]="e_faceA",t[t.e_faceB=2]="e_faceB"}(f=i.b2SeparationFunctionType||(i.b2SeparationFunctionType={}));var d=function(){function t(){this.m_sweepA=new n.b2Sweep,this.m_sweepB=new n.b2Sweep,this.m_type=f.e_unknown,this.m_localPoint=new n.b2Vec2,this.m_axis=new n.b2Vec2}return t.prototype.Initialize=function(t,e,i,o,r,s){this.m_proxyA=e,this.m_proxyB=o;var a=t.count;this.m_sweepA.Copy(i),this.m_sweepB.Copy(r);var m=l,h=c;if(this.m_sweepA.GetTransform(m,s),this.m_sweepB.GetTransform(h,s),1===a){this.m_type=f.e_points;var d=this.m_proxyA.GetVertex(t.indexA[0]),b=this.m_proxyB.GetVertex(t.indexB[0]),y=n.b2Transform.MulXV(m,d,u),v=n.b2Transform.MulXV(h,b,_);n.b2Vec2.SubVV(v,y,this.m_axis);var V=this.m_axis.Normalize();return this.m_localPoint.SetZero(),V}if(t.indexA[0]===t.indexA[1]){this.m_type=f.e_faceB;var C=this.m_proxyB.GetVertex(t.indexB[0]),g=this.m_proxyB.GetVertex(t.indexB[1]);n.b2Vec2.CrossVOne(n.b2Vec2.SubVV(g,C,n.b2Vec2.s_t0),this.m_axis).SelfNormalize();var x=n.b2Rot.MulRV(h.q,this.m_axis,p);return n.b2Vec2.MidVV(C,g,this.m_localPoint),v=n.b2Transform.MulXV(h,this.m_localPoint,_),d=this.m_proxyA.GetVertex(t.indexA[0]),y=n.b2Transform.MulXV(m,d,u),(V=n.b2Vec2.DotVV(n.b2Vec2.SubVV(y,v,n.b2Vec2.s_t0),x))<0&&(this.m_axis.SelfNeg(),V=-V),V}this.m_type=f.e_faceA;var S=this.m_proxyA.GetVertex(t.indexA[0]),B=this.m_proxyA.GetVertex(t.indexA[1]);return n.b2Vec2.CrossVOne(n.b2Vec2.SubVV(B,S,n.b2Vec2.s_t0),this.m_axis).SelfNormalize(),x=n.b2Rot.MulRV(m.q,this.m_axis,p),n.b2Vec2.MidVV(S,B,this.m_localPoint),y=n.b2Transform.MulXV(m,this.m_localPoint,u),b=this.m_proxyB.GetVertex(t.indexB[0]),v=n.b2Transform.MulXV(h,b,_),(V=n.b2Vec2.DotVV(n.b2Vec2.SubVV(v,y,n.b2Vec2.s_t0),x))<0&&(this.m_axis.SelfNeg(),V=-V),V},t.prototype.FindMinSeparation=function(t,e,i){var o=l,r=c;switch(this.m_sweepA.GetTransform(o,i),this.m_sweepB.GetTransform(r,i),this.m_type){case f.e_points:var s=n.b2Rot.MulTRV(o.q,this.m_axis,m),a=n.b2Rot.MulTRV(r.q,n.b2Vec2.NegV(this.m_axis,n.b2Vec2.s_t0),h);t[0]=this.m_proxyA.GetSupport(s),e[0]=this.m_proxyB.GetSupport(a);var d=this.m_proxyA.GetVertex(t[0]),b=this.m_proxyB.GetVertex(e[0]),y=n.b2Transform.MulXV(o,d,u),v=n.b2Transform.MulXV(r,b,_);return n.b2Vec2.DotVV(n.b2Vec2.SubVV(v,y,n.b2Vec2.s_t0),this.m_axis);case f.e_faceA:var V=n.b2Rot.MulRV(o.q,this.m_axis,p);return y=n.b2Transform.MulXV(o,this.m_localPoint,u),a=n.b2Rot.MulTRV(r.q,n.b2Vec2.NegV(V,n.b2Vec2.s_t0),h),t[0]=-1,e[0]=this.m_proxyB.GetSupport(a),b=this.m_proxyB.GetVertex(e[0]),v=n.b2Transform.MulXV(r,b,_),n.b2Vec2.DotVV(n.b2Vec2.SubVV(v,y,n.b2Vec2.s_t0),V);case f.e_faceB:return V=n.b2Rot.MulRV(r.q,this.m_axis,p),v=n.b2Transform.MulXV(r,this.m_localPoint,_),s=n.b2Rot.MulTRV(o.q,n.b2Vec2.NegV(V,n.b2Vec2.s_t0),m),e[0]=-1,t[0]=this.m_proxyA.GetSupport(s),d=this.m_proxyA.GetVertex(t[0]),y=n.b2Transform.MulXV(o,d,u),n.b2Vec2.DotVV(n.b2Vec2.SubVV(y,v,n.b2Vec2.s_t0),V);default:return t[0]=-1,e[0]=-1,0}},t.prototype.Evaluate=function(t,e,i){var o=l,r=c;switch(this.m_sweepA.GetTransform(o,i),this.m_sweepB.GetTransform(r,i),this.m_type){case f.e_points:var s=this.m_proxyA.GetVertex(t),a=this.m_proxyB.GetVertex(e),m=n.b2Transform.MulXV(o,s,u),h=n.b2Transform.MulXV(r,a,_);return n.b2Vec2.DotVV(n.b2Vec2.SubVV(h,m,n.b2Vec2.s_t0),this.m_axis);case f.e_faceA:var d=n.b2Rot.MulRV(o.q,this.m_axis,p);return m=n.b2Transform.MulXV(o,this.m_localPoint,u),a=this.m_proxyB.GetVertex(e),h=n.b2Transform.MulXV(r,a,_),n.b2Vec2.DotVV(n.b2Vec2.SubVV(h,m,n.b2Vec2.s_t0),d);case f.e_faceB:return d=n.b2Rot.MulRV(r.q,this.m_axis,p),h=n.b2Transform.MulXV(r,this.m_localPoint,_),s=this.m_proxyA.GetVertex(t),m=n.b2Transform.MulXV(o,s,u),n.b2Vec2.DotVV(n.b2Vec2.SubVV(m,h,n.b2Vec2.s_t0),d);default:return 0}},t}();i.b2SeparationFunction=d;var b=new r.b2Timer,y=new s.b2SimplexCache,v=new s.b2DistanceInput,V=new s.b2DistanceOutput,C=new d,g=[0],x=[0],S=new n.b2Sweep,B=new n.b2Sweep;i.b2TimeOfImpact=function(t,e){var r=b.Reset();++i.b2_toiCalls,t.state=a.e_unknown,t.t=e.tMax;var u=e.proxyA,_=e.proxyB,p=n.b2Max(o.b2_maxPolygonVertices,n.b2Max(u.m_count,_.m_count)),m=S.Copy(e.sweepA),h=B.Copy(e.sweepB);m.Normalize(),h.Normalize();var f=e.tMax,d=u.m_radius+_.m_radius,A=n.b2Max(o.b2_linearSlop,d-3*o.b2_linearSlop),P=.25*o.b2_linearSlop,w=0,M=0,D=y;D.count=0;var I=v;for(I.proxyA.Copy(e.proxyA),I.proxyB.Copy(e.proxyB),I.useRadii=!1;;){var G=l,T=c;m.GetTransform(G,w),h.GetTransform(T,w),I.transformA.Copy(G),I.transformB.Copy(T);var R=V;if(s.b2Distance(R,D,I),R.distance<=0){t.state=a.e_overlapped,t.t=0;break}if(R.distance<A+P){t.state=a.e_touching,t.t=w;break}var F=C;F.Initialize(D,u,m,_,h,w);for(var O=!1,L=f,j=0;;){var J=g,E=x,k=F.FindMinSeparation(J,E,L);if(k>A+P){t.state=a.e_separated,t.t=f,O=!0;break}if(k>A-P){w=L;break}var U=F.Evaluate(J[0],E[0],w);if(U<A-P){t.state=a.e_failed,t.t=w,O=!0;break}if(U<=A+P){t.state=a.e_touching,t.t=w,O=!0;break}for(var N=0,q=w,z=L;;){var W;W=1&N?q+(A-U)*(z-q)/(k-U):.5*(q+z),++N,++i.b2_toiRootIters;var X=F.Evaluate(J[0],E[0],W);if(n.b2Abs(X-A)<P){L=W;break}if(X>A?(q=W,U=X):(z=W,k=X),50===N)break}if(i.b2_toiMaxRootIters=n.b2Max(i.b2_toiMaxRootIters,N),++j===p)break}if(++M,++i.b2_toiIters,O)break;if(20===M){t.state=a.e_failed,t.t=w;break}}i.b2_toiMaxIters=n.b2Max(i.b2_toiMaxIters,M);var Z=r.GetMilliseconds();i.b2_toiMaxTime=n.b2Max(i.b2_toiMaxTime,Z),i.b2_toiTime+=Z},cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","../Common/b2Timer":"b2Timer","./b2Distance":"b2Distance"}],b2TimeStep:[function(t,e,i){"use strict";cc._RF.push(e,"88ec4X+kbZPf5AoUJ0JfhyP","b2TimeStep"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2SolverData=i.b2Velocity=i.b2Position=i.b2TimeStep=i.b2Profile=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Math"),r=function(){function t(){this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0}return t.prototype.Reset=function(){return this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0,this},t}();i.b2Profile=r;var s=function(){function t(){this.dt=0,this.inv_dt=0,this.dtRatio=0,this.velocityIterations=0,this.positionIterations=0,this.particleIterations=0,this.warmStarting=!1}return t.prototype.Copy=function(t){return this.dt=t.dt,this.inv_dt=t.inv_dt,this.dtRatio=t.dtRatio,this.positionIterations=t.positionIterations,this.velocityIterations=t.velocityIterations,this.particleIterations=t.particleIterations,this.warmStarting=t.warmStarting,this},t}();i.b2TimeStep=s;var a=function(){function t(){this.c=new n.b2Vec2,this.a=0}return t.MakeArray=function(e){return o.b2MakeArray(e,function(){return new t})},t}();i.b2Position=a;var l=function(){function t(){this.v=new n.b2Vec2,this.w=0}return t.MakeArray=function(e){return o.b2MakeArray(e,function(){return new t})},t}();i.b2Velocity=l;i.b2SolverData=function(){this.step=new s},cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings"}],b2Timer:[function(t,e,i){"use strict";cc._RF.push(e,"24aebCrlbpLWKoZm6OiH/yG","b2Timer"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2Counter=i.b2Timer=void 0;var o=function(){function t(){this.m_start=Date.now()}return t.prototype.Reset=function(){return this.m_start=Date.now(),this},t.prototype.GetMilliseconds=function(){return Date.now()-this.m_start},t}();i.b2Timer=o;var n=function(){function t(){this.m_count=0,this.m_min_count=0,this.m_max_count=0}return t.prototype.GetCount=function(){return this.m_count},t.prototype.GetMinCount=function(){return this.m_min_count},t.prototype.GetMaxCount=function(){return this.m_max_count},t.prototype.ResetCount=function(){var t=this.m_count;return this.m_count=0,t},t.prototype.ResetMinCount=function(){this.m_min_count=0},t.prototype.ResetMaxCount=function(){this.m_max_count=0},t.prototype.Increment=function(){this.m_count++,this.m_max_count<this.m_count&&(this.m_max_count=this.m_count)},t.prototype.Decrement=function(){this.m_count--,this.m_min_count>this.m_count&&(this.m_min_count=this.m_count)},t}();i.b2Counter=n,cc._RF.pop()},{}],b2VoronoiDiagram:[function(t,e,i){"use strict";cc._RF.push(e,"4d38ae67B5LCYZ1UOf7mM/I","b2VoronoiDiagram"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2VoronoiDiagram_Task=i.b2VoronoiDiagram_Generator=i.b2VoronoiDiagram=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Math"),r=t("./b2StackQueue"),s=function(){function t(t){this.m_generatorCapacity=0,this.m_generatorCount=0,this.m_countX=0,this.m_countY=0,this.m_diagram=[],this.m_generatorBuffer=o.b2MakeArray(t,function(){return new a}),this.m_generatorCapacity=t}return t.prototype.AddGenerator=function(t,e,i){var o=this.m_generatorBuffer[this.m_generatorCount++];o.center.Copy(t),o.tag=e,o.necessary=i},t.prototype.Generate=function(t,e){for(var i=1/t,s=new n.b2Vec2(+o.b2_maxFloat,+o.b2_maxFloat),a=new n.b2Vec2(-o.b2_maxFloat,-o.b2_maxFloat),c=0,u=0;u<this.m_generatorCount;u++)(f=this.m_generatorBuffer[u]).necessary&&(n.b2Vec2.MinV(s,f.center,s),n.b2Vec2.MaxV(a,f.center,a),++c);if(0===c)return this.m_countX=0,void(this.m_countY=0);s.x-=e,s.y-=e,a.x+=e,a.y+=e,this.m_countX=1+Math.floor(i*(a.x-s.x)),this.m_countY=1+Math.floor(i*(a.y-s.y)),this.m_diagram=[];var _=new r.b2StackQueue(4*this.m_countX*this.m_countY);for(u=0;u<this.m_generatorCount;u++){(f=this.m_generatorBuffer[u]).center.SelfSub(s).SelfMul(i);var p=Math.floor(f.center.x),m=Math.floor(f.center.y);p>=0&&m>=0&&p<this.m_countX&&m<this.m_countY&&_.Push(new l(p,m,p+m*this.m_countX,f))}for(;!_.Empty();){p=(d=_.Front()).m_x,m=d.m_y;var h=d.m_i,f=d.m_generator;_.Pop(),this.m_diagram[h]||(this.m_diagram[h]=f,p>0&&_.Push(new l(p-1,m,h-1,f)),m>0&&_.Push(new l(p,m-1,h-this.m_countX,f)),p<this.m_countX-1&&_.Push(new l(p+1,m,h+1,f)),m<this.m_countY-1&&_.Push(new l(p,m+1,h+this.m_countX,f)))}for(m=0;m<this.m_countY;m++)for(p=0;p<this.m_countX-1;p++)h=p+m*this.m_countX,(b=this.m_diagram[h])!==(y=this.m_diagram[h+1])&&(_.Push(new l(p,m,h,y)),_.Push(new l(p+1,m,h+1,b)));for(m=0;m<this.m_countY-1;m++)for(p=0;p<this.m_countX;p++)h=p+m*this.m_countX,(b=this.m_diagram[h])!==(y=this.m_diagram[h+this.m_countX])&&(_.Push(new l(p,m,h,y)),_.Push(new l(p,m+1,h+this.m_countX,b)));for(;!_.Empty();){var d,b,y;if(p=(d=_.Front()).m_x,m=d.m_y,h=d.m_i,u=d.m_generator,_.Pop(),(b=this.m_diagram[h])!==(y=u)){var v=b.center.x-p,V=b.center.y-m,C=y.center.x-p,g=y.center.y-m;v*v+V*V>C*C+g*g&&(this.m_diagram[h]=y,p>0&&_.Push(new l(p-1,m,h-1,y)),m>0&&_.Push(new l(p,m-1,h-this.m_countX,y)),p<this.m_countX-1&&_.Push(new l(p+1,m,h+1,y)),m<this.m_countY-1&&_.Push(new l(p,m+1,h+this.m_countX,y)))}}},t.prototype.GetNodes=function(t){for(var e=0;e<this.m_countY-1;e++)for(var i=0;i<this.m_countX-1;i++){var o=i+e*this.m_countX,n=this.m_diagram[o],r=this.m_diagram[o+1],s=this.m_diagram[o+this.m_countX],a=this.m_diagram[o+1+this.m_countX];r!==s&&(n!==r&&n!==s&&(n.necessary||r.necessary||s.necessary)&&t(n.tag,r.tag,s.tag),a!==r&&a!==s&&(n.necessary||r.necessary||s.necessary)&&t(r.tag,a.tag,s.tag))}},t}();i.b2VoronoiDiagram=s;var a=function(){this.center=new n.b2Vec2,this.tag=0,this.necessary=!1};i.b2VoronoiDiagram_Generator=a;var l=function(t,e,i,o){this.m_x=t,this.m_y=e,this.m_i=i,this.m_generator=o};i.b2VoronoiDiagram_Task=l,cc._RF.pop()},{"../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","./b2StackQueue":"b2StackQueue"}],b2WeldJoint:[function(t,e,i){"use strict";cc._RF.push(e,"8c81de78v9EZoV3T5CKv2ca","b2WeldJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2WeldJoint=i.b2WeldJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=function(t){function e(){var e=t.call(this,a.b2JointType.e_weldJoint)||this;return e.localAnchorA=new s.b2Vec2,e.localAnchorB=new s.b2Vec2,e.referenceAngle=0,e.frequencyHz=0,e.dampingRatio=0,e}return n(e,t),e.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},e}(a.b2JointDef);i.b2WeldJointDef=l;var c=function(t){function e(e){var i=t.call(this,e)||this;return i.m_frequencyHz=0,i.m_dampingRatio=0,i.m_bias=0,i.m_localAnchorA=new s.b2Vec2,i.m_localAnchorB=new s.b2Vec2,i.m_referenceAngle=0,i.m_gamma=0,i.m_impulse=new s.b2Vec3(0,0,0),i.m_indexA=0,i.m_indexB=0,i.m_rA=new s.b2Vec2,i.m_rB=new s.b2Vec2,i.m_localCenterA=new s.b2Vec2,i.m_localCenterB=new s.b2Vec2,i.m_invMassA=0,i.m_invMassB=0,i.m_invIA=0,i.m_invIB=0,i.m_mass=new s.b2Mat33,i.m_qA=new s.b2Rot,i.m_qB=new s.b2Rot,i.m_lalcA=new s.b2Vec2,i.m_lalcB=new s.b2Vec2,i.m_K=new s.b2Mat33,i.m_frequencyHz=r.b2Maybe(e.frequencyHz,0),i.m_dampingRatio=r.b2Maybe(e.dampingRatio,0),i.m_localAnchorA.Copy(r.b2Maybe(e.localAnchorA,s.b2Vec2.ZERO)),i.m_localAnchorB.Copy(r.b2Maybe(e.localAnchorB,s.b2Vec2.ZERO)),i.m_referenceAngle=r.b2Maybe(e.referenceAngle,0),i.m_impulse.SetZero(),i}return n(e,t),e.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=t.positions[this.m_indexA].a,o=t.velocities[this.m_indexA].v,n=t.velocities[this.m_indexA].w,a=t.positions[this.m_indexB].a,l=t.velocities[this.m_indexB].v,c=t.velocities[this.m_indexB].w,u=this.m_qA.SetAngle(i),_=this.m_qB.SetAngle(a);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),s.b2Rot.MulRV(u,this.m_lalcA,this.m_rA),s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),s.b2Rot.MulRV(_,this.m_lalcB,this.m_rB);var p=this.m_invMassA,m=this.m_invMassB,h=this.m_invIA,f=this.m_invIB,d=this.m_K;if(d.ex.x=p+m+this.m_rA.y*this.m_rA.y*h+this.m_rB.y*this.m_rB.y*f,d.ey.x=-this.m_rA.y*this.m_rA.x*h-this.m_rB.y*this.m_rB.x*f,d.ez.x=-this.m_rA.y*h-this.m_rB.y*f,d.ex.y=d.ey.x,d.ey.y=p+m+this.m_rA.x*this.m_rA.x*h+this.m_rB.x*this.m_rB.x*f,d.ez.y=this.m_rA.x*h+this.m_rB.x*f,d.ex.z=d.ez.x,d.ey.z=d.ez.y,d.ez.z=h+f,this.m_frequencyHz>0){d.GetInverse22(this.m_mass);var b=h+f,y=b>0?1/b:0,v=a-i-this.m_referenceAngle,V=2*r.b2_pi*this.m_frequencyHz,C=2*y*this.m_dampingRatio*V,g=y*V*V,x=t.step.dt;this.m_gamma=x*(C+x*g),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=v*x*g*this.m_gamma,b+=this.m_gamma,this.m_mass.ez.z=0!==b?1/b:0}else d.GetSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0;if(t.step.warmStarting){this.m_impulse.SelfMul(t.step.dtRatio);var S=e.InitVelocityConstraints_s_P.Set(this.m_impulse.x,this.m_impulse.y);o.SelfMulSub(p,S),n-=h*(s.b2Vec2.CrossVV(this.m_rA,S)+this.m_impulse.z),l.SelfMulAdd(m,S),c+=f*(s.b2Vec2.CrossVV(this.m_rB,S)+this.m_impulse.z)}else this.m_impulse.SetZero();t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].w=c},e.prototype.SolveVelocityConstraints=function(t){var i=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v,r=t.velocities[this.m_indexB].w,a=this.m_invMassA,l=this.m_invMassB,c=this.m_invIA,u=this.m_invIB;if(this.m_frequencyHz>0){var _=r-o,p=-this.m_mass.ez.z*(_+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=p,o-=c*p,r+=u*p;var m=s.b2Vec2.SubVV(s.b2Vec2.AddVCrossSV(n,r,this.m_rB,s.b2Vec2.s_t0),s.b2Vec2.AddVCrossSV(i,o,this.m_rA,s.b2Vec2.s_t1),e.SolveVelocityConstraints_s_Cdot1),h=s.b2Mat33.MulM33XY(this.m_mass,m.x,m.y,e.SolveVelocityConstraints_s_impulse1).SelfNeg();this.m_impulse.x+=h.x,this.m_impulse.y+=h.y;var f=h;i.SelfMulSub(a,f),o-=c*s.b2Vec2.CrossVV(this.m_rA,f),n.SelfMulAdd(l,f),r+=u*s.b2Vec2.CrossVV(this.m_rB,f)}else{m=s.b2Vec2.SubVV(s.b2Vec2.AddVCrossSV(n,r,this.m_rB,s.b2Vec2.s_t0),s.b2Vec2.AddVCrossSV(i,o,this.m_rA,s.b2Vec2.s_t1),e.SolveVelocityConstraints_s_Cdot1),_=r-o;var d=s.b2Mat33.MulM33XYZ(this.m_mass,m.x,m.y,_,e.SolveVelocityConstraints_s_impulse).SelfNeg();this.m_impulse.SelfAdd(d),f=e.SolveVelocityConstraints_s_P.Set(d.x,d.y),i.SelfMulSub(a,f),o-=c*(s.b2Vec2.CrossVV(this.m_rA,f)+d.z),n.SelfMulAdd(l,f),r+=u*(s.b2Vec2.CrossVV(this.m_rB,f)+d.z)}t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=r},e.prototype.SolvePositionConstraints=function(t){var i=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,l=this.m_qA.SetAngle(o),c=this.m_qB.SetAngle(a),u=this.m_invMassA,_=this.m_invMassB,p=this.m_invIA,m=this.m_invIB;s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var h=s.b2Rot.MulRV(l,this.m_lalcA,this.m_rA);s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var f,d,b=s.b2Rot.MulRV(c,this.m_lalcB,this.m_rB),y=this.m_K;if(y.ex.x=u+_+h.y*h.y*p+b.y*b.y*m,y.ey.x=-h.y*h.x*p-b.y*b.x*m,y.ez.x=-h.y*p-b.y*m,y.ex.y=y.ey.x,y.ey.y=u+_+h.x*h.x*p+b.x*b.x*m,y.ez.y=h.x*p+b.x*m,y.ex.z=y.ez.x,y.ey.z=y.ez.y,y.ez.z=p+m,this.m_frequencyHz>0){f=(V=s.b2Vec2.SubVV(s.b2Vec2.AddVV(n,b,s.b2Vec2.s_t0),s.b2Vec2.AddVV(i,h,s.b2Vec2.s_t1),e.SolvePositionConstraints_s_C1)).Length(),d=0;var v=y.Solve22(V.x,V.y,e.SolvePositionConstraints_s_P).SelfNeg();i.SelfMulSub(u,v),o-=p*s.b2Vec2.CrossVV(h,v),n.SelfMulAdd(_,v),a+=m*s.b2Vec2.CrossVV(b,v)}else{var V=s.b2Vec2.SubVV(s.b2Vec2.AddVV(n,b,s.b2Vec2.s_t0),s.b2Vec2.AddVV(i,h,s.b2Vec2.s_t1),e.SolvePositionConstraints_s_C1),C=a-o-this.m_referenceAngle;f=V.Length(),d=s.b2Abs(C);var g=y.Solve33(V.x,V.y,C,e.SolvePositionConstraints_s_impulse).SelfNeg();v=e.SolvePositionConstraints_s_P.Set(g.x,g.y),i.SelfMulSub(u,v),o-=p*(s.b2Vec2.CrossVV(this.m_rA,v)+g.z),n.SelfMulAdd(_,v),a+=m*(s.b2Vec2.CrossVV(this.m_rB,v)+g.z)}return t.positions[this.m_indexA].a=o,t.positions[this.m_indexB].a=a,f<=r.b2_linearSlop&&d<=r.b2_angularSlop},e.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)},e.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)},e.prototype.GetReactionForce=function(t,e){return e.x=t*this.m_impulse.x,e.y=t*this.m_impulse.y,e},e.prototype.GetReactionTorque=function(t){return t*this.m_impulse.z},e.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.GetReferenceAngle=function(){return this.m_referenceAngle},e.prototype.SetFrequency=function(t){this.m_frequencyHz=t},e.prototype.GetFrequency=function(){return this.m_frequencyHz},e.prototype.SetDampingRatio=function(t){this.m_dampingRatio=t},e.prototype.GetDampingRatio=function(){return this.m_dampingRatio},e.prototype.Dump=function(t){var e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2WeldJointDef = new b2WeldJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),t("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),t("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},e.InitVelocityConstraints_s_P=new s.b2Vec2,e.SolveVelocityConstraints_s_Cdot1=new s.b2Vec2,e.SolveVelocityConstraints_s_impulse1=new s.b2Vec2,e.SolveVelocityConstraints_s_impulse=new s.b2Vec3,e.SolveVelocityConstraints_s_P=new s.b2Vec2,e.SolvePositionConstraints_s_C1=new s.b2Vec2,e.SolvePositionConstraints_s_P=new s.b2Vec2,e.SolvePositionConstraints_s_impulse=new s.b2Vec3,e}(a.b2Joint);i.b2WeldJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2WheelJoint:[function(t,e,i){"use strict";cc._RF.push(e,"6ea12jDYA1DDqv5pucK5Nz9","b2WheelJoint");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.b2WheelJoint=i.b2WheelJointDef=void 0;var r=t("../../Common/b2Settings"),s=t("../../Common/b2Math"),a=t("./b2Joint"),l=function(t){function e(){var e=t.call(this,a.b2JointType.e_wheelJoint)||this;return e.localAnchorA=new s.b2Vec2(0,0),e.localAnchorB=new s.b2Vec2(0,0),e.localAxisA=new s.b2Vec2(1,0),e.enableMotor=!1,e.maxMotorTorque=0,e.motorSpeed=0,e.frequencyHz=2,e.dampingRatio=.7,e}return n(e,t),e.prototype.Initialize=function(t,e,i,o){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.bodyA.GetLocalVector(o,this.localAxisA)},e}(a.b2JointDef);i.b2WheelJointDef=l;var c=function(t){function e(e){var i=t.call(this,e)||this;return i.m_frequencyHz=0,i.m_dampingRatio=0,i.m_localAnchorA=new s.b2Vec2,i.m_localAnchorB=new s.b2Vec2,i.m_localXAxisA=new s.b2Vec2,i.m_localYAxisA=new s.b2Vec2,i.m_impulse=0,i.m_motorImpulse=0,i.m_springImpulse=0,i.m_maxMotorTorque=0,i.m_motorSpeed=0,i.m_enableMotor=!1,i.m_indexA=0,i.m_indexB=0,i.m_localCenterA=new s.b2Vec2,i.m_localCenterB=new s.b2Vec2,i.m_invMassA=0,i.m_invMassB=0,i.m_invIA=0,i.m_invIB=0,i.m_ax=new s.b2Vec2,i.m_ay=new s.b2Vec2,i.m_sAx=0,i.m_sBx=0,i.m_sAy=0,i.m_sBy=0,i.m_mass=0,i.m_motorMass=0,i.m_springMass=0,i.m_bias=0,i.m_gamma=0,i.m_qA=new s.b2Rot,i.m_qB=new s.b2Rot,i.m_lalcA=new s.b2Vec2,i.m_lalcB=new s.b2Vec2,i.m_rA=new s.b2Vec2,i.m_rB=new s.b2Vec2,i.m_frequencyHz=r.b2Maybe(e.frequencyHz,2),i.m_dampingRatio=r.b2Maybe(e.dampingRatio,.7),i.m_localAnchorA.Copy(r.b2Maybe(e.localAnchorA,s.b2Vec2.ZERO)),i.m_localAnchorB.Copy(r.b2Maybe(e.localAnchorB,s.b2Vec2.ZERO)),i.m_localXAxisA.Copy(r.b2Maybe(e.localAxisA,s.b2Vec2.UNITX)),s.b2Vec2.CrossOneV(i.m_localXAxisA,i.m_localYAxisA),i.m_maxMotorTorque=r.b2Maybe(e.maxMotorTorque,0),i.m_motorSpeed=r.b2Maybe(e.motorSpeed,0),i.m_enableMotor=r.b2Maybe(e.enableMotor,!1),i.m_ax.SetZero(),i.m_ay.SetZero(),i}return n(e,t),e.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},e.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque},e.prototype.SetSpringFrequencyHz=function(t){this.m_frequencyHz=t},e.prototype.GetSpringFrequencyHz=function(){return this.m_frequencyHz},e.prototype.SetSpringDampingRatio=function(t){this.m_dampingRatio=t},e.prototype.GetSpringDampingRatio=function(){return this.m_dampingRatio},e.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=this.m_invMassA,o=this.m_invMassB,n=this.m_invIA,a=this.m_invIB,l=t.positions[this.m_indexA].c,c=t.positions[this.m_indexA].a,u=t.velocities[this.m_indexA].v,_=t.velocities[this.m_indexA].w,p=t.positions[this.m_indexB].c,m=t.positions[this.m_indexB].a,h=t.velocities[this.m_indexB].v,f=t.velocities[this.m_indexB].w,d=this.m_qA.SetAngle(c),b=this.m_qB.SetAngle(m);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var y=s.b2Rot.MulRV(d,this.m_lalcA,this.m_rA);s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var v=s.b2Rot.MulRV(b,this.m_lalcB,this.m_rB),V=s.b2Vec2.SubVV(s.b2Vec2.AddVV(p,v,s.b2Vec2.s_t0),s.b2Vec2.AddVV(l,y,s.b2Vec2.s_t1),e.InitVelocityConstraints_s_d);if(s.b2Rot.MulRV(d,this.m_localYAxisA,this.m_ay),this.m_sAy=s.b2Vec2.CrossVV(s.b2Vec2.AddVV(V,y,s.b2Vec2.s_t0),this.m_ay),this.m_sBy=s.b2Vec2.CrossVV(v,this.m_ay),this.m_mass=i+o+n*this.m_sAy*this.m_sAy+a*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){s.b2Rot.MulRV(d,this.m_localXAxisA,this.m_ax),this.m_sAx=s.b2Vec2.CrossVV(s.b2Vec2.AddVV(V,y,s.b2Vec2.s_t0),this.m_ax),this.m_sBx=s.b2Vec2.CrossVV(v,this.m_ax);var C=i+o+n*this.m_sAx*this.m_sAx+a*this.m_sBx*this.m_sBx;if(C>0){this.m_springMass=1/C;var g=s.b2Vec2.DotVV(V,this.m_ax),x=2*r.b2_pi*this.m_frequencyHz,S=2*this.m_springMass*this.m_dampingRatio*x,B=this.m_springMass*x*x,A=t.step.dt;this.m_gamma=A*(S+A*B),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=g*A*B*this.m_gamma,this.m_springMass=C+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=n+a,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.step.warmStarting){this.m_impulse*=t.step.dtRatio,this.m_springImpulse*=t.step.dtRatio,this.m_motorImpulse*=t.step.dtRatio;var P=s.b2Vec2.AddVV(s.b2Vec2.MulSV(this.m_impulse,this.m_ay,s.b2Vec2.s_t0),s.b2Vec2.MulSV(this.m_springImpulse,this.m_ax,s.b2Vec2.s_t1),e.InitVelocityConstraints_s_P),w=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,M=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;u.SelfMulSub(this.m_invMassA,P),_-=this.m_invIA*w,h.SelfMulAdd(this.m_invMassB,P),f+=this.m_invIB*M}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;t.velocities[this.m_indexA].w=_,t.velocities[this.m_indexB].w=f},e.prototype.SolveVelocityConstraints=function(t){var i=this.m_invMassA,o=this.m_invMassB,n=this.m_invIA,r=this.m_invIB,a=t.velocities[this.m_indexA].v,l=t.velocities[this.m_indexA].w,c=t.velocities[this.m_indexB].v,u=t.velocities[this.m_indexB].w,_=s.b2Vec2.DotVV(this.m_ax,s.b2Vec2.SubVV(c,a,s.b2Vec2.s_t0))+this.m_sBx*u-this.m_sAx*l,p=-this.m_springMass*(_+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=p;var m=s.b2Vec2.MulSV(p,this.m_ax,e.SolveVelocityConstraints_s_P),h=p*this.m_sAx,f=p*this.m_sBx;a.SelfMulSub(i,m),l-=n*h,c.SelfMulAdd(o,m),_=(u+=r*f)-l-this.m_motorSpeed,p=-this.m_motorMass*_;var d=this.m_motorImpulse,b=t.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=s.b2Clamp(this.m_motorImpulse+p,-b,b),l-=n*(p=this.m_motorImpulse-d),u+=r*p,_=s.b2Vec2.DotVV(this.m_ay,s.b2Vec2.SubVV(c,a,s.b2Vec2.s_t0))+this.m_sBy*u-this.m_sAy*l,p=-this.m_mass*_,this.m_impulse+=p,m=s.b2Vec2.MulSV(p,this.m_ay,e.SolveVelocityConstraints_s_P),h=p*this.m_sAy,f=p*this.m_sBy,a.SelfMulSub(i,m),l-=n*h,c.SelfMulAdd(o,m),u+=r*f,t.velocities[this.m_indexA].w=l,t.velocities[this.m_indexB].w=u},e.prototype.SolvePositionConstraints=function(t){var i=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,n=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,l=this.m_qA.SetAngle(o),c=this.m_qB.SetAngle(a);s.b2Vec2.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var u=s.b2Rot.MulRV(l,this.m_lalcA,this.m_rA);s.b2Vec2.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var _,p=s.b2Rot.MulRV(c,this.m_lalcB,this.m_rB),m=s.b2Vec2.AddVV(s.b2Vec2.SubVV(n,i,s.b2Vec2.s_t0),s.b2Vec2.SubVV(p,u,s.b2Vec2.s_t1),e.SolvePositionConstraints_s_d),h=s.b2Rot.MulRV(l,this.m_localYAxisA,this.m_ay),f=s.b2Vec2.CrossVV(s.b2Vec2.AddVV(m,u,s.b2Vec2.s_t0),h),d=s.b2Vec2.CrossVV(p,h),b=s.b2Vec2.DotVV(m,this.m_ay),y=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;_=0!==y?-b/y:0;var v=s.b2Vec2.MulSV(_,h,e.SolvePositionConstraints_s_P),V=_*f,C=_*d;return i.SelfMulSub(this.m_invMassA,v),o-=this.m_invIA*V,n.SelfMulAdd(this.m_invMassB,v),a+=this.m_invIB*C,t.positions[this.m_indexA].a=o,t.positions[this.m_indexB].a=a,s.b2Abs(b)<=r.b2_linearSlop},e.prototype.GetDefinition=function(t){return t},e.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)},e.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)},e.prototype.GetReactionForce=function(t,e){return e.x=t*(this.m_impulse*this.m_ay.x+this.m_springImpulse*this.m_ax.x),e.y=t*(this.m_impulse*this.m_ay.y+this.m_springImpulse*this.m_ax.y),e},e.prototype.GetReactionTorque=function(t){return t*this.m_motorImpulse},e.prototype.GetLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.GetLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.GetLocalAxisA=function(){return this.m_localXAxisA},e.prototype.GetJointTranslation=function(){return this.GetPrismaticJointTranslation()},e.prototype.GetJointLinearSpeed=function(){return this.GetPrismaticJointSpeed()},e.prototype.GetJointAngle=function(){return this.GetRevoluteJointAngle()},e.prototype.GetJointAngularSpeed=function(){return this.GetRevoluteJointSpeed()},e.prototype.GetPrismaticJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchorA,new s.b2Vec2),o=e.GetWorldPoint(this.m_localAnchorB,new s.b2Vec2),n=s.b2Vec2.SubVV(o,i,new s.b2Vec2),r=t.GetWorldVector(this.m_localXAxisA,new s.b2Vec2);return s.b2Vec2.DotVV(n,r)},e.prototype.GetPrismaticJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB;s.b2Vec2.SubVV(this.m_localAnchorA,t.m_sweep.localCenter,this.m_lalcA);var i=s.b2Rot.MulRV(t.m_xf.q,this.m_lalcA,this.m_rA);s.b2Vec2.SubVV(this.m_localAnchorB,e.m_sweep.localCenter,this.m_lalcB);var o=s.b2Rot.MulRV(e.m_xf.q,this.m_lalcB,this.m_rB),n=s.b2Vec2.AddVV(t.m_sweep.c,i,s.b2Vec2.s_t0),r=s.b2Vec2.AddVV(e.m_sweep.c,o,s.b2Vec2.s_t1),a=s.b2Vec2.SubVV(r,n,s.b2Vec2.s_t2),l=t.GetWorldVector(this.m_localXAxisA,new s.b2Vec2),c=t.m_linearVelocity,u=e.m_linearVelocity,_=t.m_angularVelocity,p=e.m_angularVelocity;return s.b2Vec2.DotVV(a,s.b2Vec2.CrossSV(_,l,s.b2Vec2.s_t0))+s.b2Vec2.DotVV(l,s.b2Vec2.SubVV(s.b2Vec2.AddVCrossSV(u,p,o,s.b2Vec2.s_t0),s.b2Vec2.AddVCrossSV(c,_,i,s.b2Vec2.s_t1),s.b2Vec2.s_t0))},e.prototype.GetRevoluteJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a},e.prototype.GetRevoluteJointSpeed=function(){var t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t},e.prototype.IsMotorEnabled=function(){return this.m_enableMotor},e.prototype.EnableMotor=function(t){t!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t)},e.prototype.SetMotorSpeed=function(t){t!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t)},e.prototype.SetMaxMotorTorque=function(t){t!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=t)},e.prototype.GetMotorTorque=function(t){return t*this.m_motorImpulse},e.prototype.Dump=function(t){var e=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;t("  const jd: b2WheelJointDef = new b2WheelJointDef();\n"),t("  jd.bodyA = bodies[%d];\n",e),t("  jd.bodyB = bodies[%d];\n",i),t("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),t("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),t("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),t("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y),t("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),t("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),t("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque),t("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),t("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),t("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)},e.InitVelocityConstraints_s_d=new s.b2Vec2,e.InitVelocityConstraints_s_P=new s.b2Vec2,e.SolveVelocityConstraints_s_P=new s.b2Vec2,e.SolvePositionConstraints_s_d=new s.b2Vec2,e.SolvePositionConstraints_s_P=new s.b2Vec2,e}(a.b2Joint);i.b2WheelJoint=c,cc._RF.pop()},{"../../Common/b2Math":"b2Math","../../Common/b2Settings":"b2Settings","./b2Joint":"b2Joint"}],b2WorldCallbacks:[function(t,e,i){"use strict";cc._RF.push(e,"21126HdY0hA2IaoSnOO6Xxv","b2WorldCallbacks"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2RayCastCallback=i.b2QueryCallback=i.b2ContactListener=i.b2ContactImpulse=i.b2ContactFilter=i.b2DestructionListener=void 0;var o=t("../Common/b2Settings"),n=t("./b2Body"),r=function(){function t(){}return t.prototype.SayGoodbyeJoint=function(){},t.prototype.SayGoodbyeFixture=function(){},t.prototype.SayGoodbyeParticleGroup=function(){},t.prototype.SayGoodbyeParticle=function(){},t}();i.b2DestructionListener=r;var s=function(){function t(){}return t.prototype.ShouldCollide=function(t,e){var i=t.GetBody(),o=e.GetBody();if(o.GetType()===n.b2BodyType.b2_staticBody&&i.GetType()===n.b2BodyType.b2_staticBody)return!1;if(!o.ShouldCollideConnected(i))return!1;var r=t.GetFilterData(),s=e.GetFilterData();return r.groupIndex===s.groupIndex&&0!==r.groupIndex?r.groupIndex>0:0!=(r.maskBits&s.categoryBits)&&0!=(r.categoryBits&s.maskBits)},t.prototype.ShouldCollideFixtureParticle=function(){return!0},t.prototype.ShouldCollideParticleParticle=function(){return!0},t.b2_defaultFilter=new t,t}();i.b2ContactFilter=s;i.b2ContactImpulse=function(){this.normalImpulses=o.b2MakeNumberArray(o.b2_maxManifoldPoints),this.tangentImpulses=o.b2MakeNumberArray(o.b2_maxManifoldPoints),this.count=0};var a=function(){function t(){}return t.prototype.BeginContact=function(){},t.prototype.EndContact=function(){},t.prototype.BeginContactFixtureParticle=function(){},t.prototype.EndContactFixtureParticle=function(){},t.prototype.BeginContactParticleParticle=function(){},t.prototype.EndContactParticleParticle=function(){},t.prototype.PreSolve=function(){},t.prototype.PostSolve=function(){},t.b2_defaultListener=new t,t}();i.b2ContactListener=a;var l=function(){function t(){}return t.prototype.ReportFixture=function(){return!0},t.prototype.ReportParticle=function(){return!1},t.prototype.ShouldQueryParticleSystem=function(){return!0},t}();i.b2QueryCallback=l;var c=function(){function t(){}return t.prototype.ReportFixture=function(t,e,i,o){return o},t.prototype.ReportParticle=function(){return 0},t.prototype.ShouldQueryParticleSystem=function(){return!0},t}();i.b2RayCastCallback=c,cc._RF.pop()},{"../Common/b2Settings":"b2Settings","./b2Body":"b2Body"}],b2World:[function(t,e,i){"use strict";cc._RF.push(e,"bf24ayjAvxLab4vn9ywIv1Q","b2World"),Object.defineProperty(i,"__esModule",{value:!0}),i.b2World=void 0;var o=t("../Common/b2Settings"),n=t("../Common/b2Math"),r=t("../Common/b2Timer"),s=t("../Common/b2Draw"),a=t("../Collision/b2Collision"),l=t("../Collision/b2TimeOfImpact"),c=t("../Collision/Shapes/b2Shape"),u=t("./Joints/b2Joint"),_=t("./Joints/b2AreaJoint"),p=t("./Joints/b2DistanceJoint"),m=t("./Joints/b2FrictionJoint"),h=t("./Joints/b2GearJoint"),f=t("./Joints/b2MotorJoint"),d=t("./Joints/b2MouseJoint"),b=t("./Joints/b2PrismaticJoint"),y=t("./Joints/b2PulleyJoint"),v=t("./Joints/b2RevoluteJoint"),V=t("./Joints/b2RopeJoint"),C=t("./Joints/b2WeldJoint"),g=t("./Joints/b2WheelJoint"),x=t("./b2Body"),S=t("./b2ContactManager"),B=t("./b2Island"),A=t("./b2TimeStep"),P=t("./b2WorldCallbacks"),w=t("./b2WorldCallbacks"),M=t("../Common/b2Settings"),D=t("../Particle/b2Particle"),I=t("../Particle/b2ParticleSystem"),G=function(){function t(t){this.m_newFixture=!1,this.m_locked=!1,this.m_clearForces=!0,this.m_contactManager=new S.b2ContactManager,this.m_bodyList=null,this.m_jointList=null,this.m_particleSystemList=null,this.m_bodyCount=0,this.m_jointCount=0,this.m_gravity=new n.b2Vec2,this.m_allowSleep=!0,this.m_destructionListener=null,this.m_debugDraw=null,this.m_inv_dt0=0,this.m_warmStarting=!0,this.m_continuousPhysics=!0,this.m_subStepping=!1,this.m_stepComplete=!0,this.m_profile=new A.b2Profile,this.m_island=new B.b2Island,this.s_stack=[],this.m_controllerList=null,this.m_controllerCount=0,this.m_gravity.Copy(t)}return t.prototype.SetDestructionListener=function(t){this.m_destructionListener=t},t.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=t},t.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=t},t.prototype.SetDebugDraw=function(t){this.m_debugDraw=t},t.prototype.CreateBody=function(t){if(void 0===t&&(t={}),this.IsLocked())throw new Error;var e=new x.b2Body(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e},t.prototype.DestroyBody=function(t){if(this.IsLocked())throw new Error;for(var e=t.m_jointList;e;){var i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint),t.m_jointList=e}t.m_jointList=null;for(var o=t.m_controllerList;o;){var n=o;o=o.nextController,n.controller.RemoveBody(t)}for(var r=t.m_contactList;r;){var s=r;r=r.next,this.m_contactManager.Destroy(s.contact)}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var l=a;a=a.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(l),l.DestroyProxies(),l.Reset(),t.m_fixtureList=a,t.m_fixtureCount-=1}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount},t._Joint_Create=function(t){switch(t.type){case u.b2JointType.e_distanceJoint:return new p.b2DistanceJoint(t);case u.b2JointType.e_mouseJoint:return new d.b2MouseJoint(t);case u.b2JointType.e_prismaticJoint:return new b.b2PrismaticJoint(t);case u.b2JointType.e_revoluteJoint:return new v.b2RevoluteJoint(t);case u.b2JointType.e_pulleyJoint:return new y.b2PulleyJoint(t);case u.b2JointType.e_gearJoint:return new h.b2GearJoint(t);case u.b2JointType.e_wheelJoint:return new g.b2WheelJoint(t);case u.b2JointType.e_weldJoint:return new C.b2WeldJoint(t);case u.b2JointType.e_frictionJoint:return new m.b2FrictionJoint(t);case u.b2JointType.e_ropeJoint:return new V.b2RopeJoint(t);case u.b2JointType.e_motorJoint:return new f.b2MotorJoint(t);case u.b2JointType.e_areaJoint:return new _.b2AreaJoint(t)}throw new Error},t._Joint_Destroy=function(){},t.prototype.CreateJoint=function(e){if(this.IsLocked())throw new Error;var i=t._Joint_Create(e);i.m_prev=null,i.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=i),this.m_jointList=i,++this.m_jointCount,i.m_edgeA.prev=null,i.m_edgeA.next=i.m_bodyA.m_jointList,i.m_bodyA.m_jointList&&(i.m_bodyA.m_jointList.prev=i.m_edgeA),i.m_bodyA.m_jointList=i.m_edgeA,i.m_edgeB.prev=null,i.m_edgeB.next=i.m_bodyB.m_jointList,i.m_bodyB.m_jointList&&(i.m_bodyB.m_jointList.prev=i.m_edgeB),i.m_bodyB.m_jointList=i.m_edgeB;var o=i.m_bodyA,n=i.m_bodyB;if(!i.m_collideConnected)for(var r=n.GetContactList();r;)r.other===o&&r.contact.FlagForFiltering(),r=r.next;return i},t.prototype.DestroyJoint=function(e){if(this.IsLocked())throw new Error;e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_jointList&&(this.m_jointList=e.m_next);var i=e.m_bodyA,o=e.m_bodyB,n=e.m_collideConnected;if(i.SetAwake(!0),o.SetAwake(!0),e.m_edgeA.prev&&(e.m_edgeA.prev.next=e.m_edgeA.next),e.m_edgeA.next&&(e.m_edgeA.next.prev=e.m_edgeA.prev),e.m_edgeA===i.m_jointList&&(i.m_jointList=e.m_edgeA.next),e.m_edgeA.Reset(),e.m_edgeB.prev&&(e.m_edgeB.prev.next=e.m_edgeB.next),e.m_edgeB.next&&(e.m_edgeB.next.prev=e.m_edgeB.prev),e.m_edgeB===o.m_jointList&&(o.m_jointList=e.m_edgeB.next),e.m_edgeB.Reset(),t._Joint_Destroy(e),--this.m_jointCount,!n)for(var r=o.GetContactList();r;)r.other===i&&r.contact.FlagForFiltering(),r=r.next},t.prototype.CreateParticleSystem=function(t){if(this.IsLocked())throw new Error;var e=new I.b2ParticleSystem(t,this);return e.m_prev=null,e.m_next=this.m_particleSystemList,this.m_particleSystemList&&(this.m_particleSystemList.m_prev=e),this.m_particleSystemList=e,e},t.prototype.DestroyParticleSystem=function(t){if(this.IsLocked())throw new Error;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_particleSystemList&&(this.m_particleSystemList=t.m_next)},t.prototype.CalculateReasonableParticleIterations=function(t){return null===this.m_particleSystemList?1:D.b2CalculateParticleIterations(this.m_gravity.Length(),function(t){for(var e=M.b2_maxFloat,i=t.GetParticleSystemList();null!==i;i=i.m_next)e=n.b2Min(e,i.GetRadius());return e}(this),t)},t.prototype.Step=function(e,i,o,n){void 0===n&&(n=this.CalculateReasonableParticleIterations(e));var r=t.Step_s_stepTimer.Reset();this.m_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_newFixture=!1),this.m_locked=!0;var s=t.Step_s_step;s.dt=e,s.velocityIterations=i,s.positionIterations=o,s.particleIterations=n,s.inv_dt=e>0?1/e:0,s.dtRatio=this.m_inv_dt0*e,s.warmStarting=this.m_warmStarting;var a=t.Step_s_timer.Reset();if(this.m_contactManager.Collide(),this.m_profile.collide=a.GetMilliseconds(),this.m_stepComplete&&s.dt>0){for(var l=t.Step_s_timer.Reset(),c=this.m_particleSystemList;c;c=c.m_next)c.Solve(s);this.Solve(s),this.m_profile.solve=l.GetMilliseconds()}if(this.m_continuousPhysics&&s.dt>0){var u=t.Step_s_timer.Reset();this.SolveTOI(s),this.m_profile.solveTOI=u.GetMilliseconds()}s.dt>0&&(this.m_inv_dt0=s.inv_dt),this.m_clearForces&&this.ClearForces(),this.m_locked=!1,this.m_profile.step=r.GetMilliseconds()},t.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0},t.prototype.DrawParticleSystem=function(t){if(null!==this.m_debugDraw){var e=t.GetParticleCount();if(e){var i=t.GetRadius(),o=t.GetPositionBuffer();if(t.m_colorBuffer.data){var n=t.GetColorBuffer();this.m_debugDraw.DrawParticles(o,i,n,e)}else this.m_debugDraw.DrawParticles(o,i,null,e)}}},t.prototype.DrawDebugData=function(){if(null!==this.m_debugDraw){var e=this.m_debugDraw.GetFlags(),i=t.DrawDebugData_s_color.SetRGB(0,0,0);if(e&s.b2DrawFlags.e_shapeBit)for(var o=this.m_bodyList;o;o=o.m_next){var n=o.m_xf;this.m_debugDraw.PushTransform(n);for(var r=o.GetFixtureList();r;r=r.m_next)o.IsActive()?o.GetType()===x.b2BodyType.b2_staticBody?(i.SetRGB(.5,.9,.5),this.DrawShape(r,i)):o.GetType()===x.b2BodyType.b2_kinematicBody?(i.SetRGB(.5,.5,.9),this.DrawShape(r,i)):o.IsAwake()?(i.SetRGB(.9,.7,.7),this.DrawShape(r,i)):(i.SetRGB(.6,.6,.6),this.DrawShape(r,i)):(i.SetRGB(.5,.5,.3),this.DrawShape(r,i));this.m_debugDraw.PopTransform(n)}if(e&s.b2DrawFlags.e_particleBit)for(var a=this.m_particleSystemList;a;a=a.m_next)this.DrawParticleSystem(a);if(e&s.b2DrawFlags.e_jointBit)for(var l=this.m_jointList;l;l=l.m_next)this.DrawJoint(l);if(e&s.b2DrawFlags.e_aabbBit){i.SetRGB(.9,.3,.9);var c=t.DrawDebugData_s_vs;for(o=this.m_bodyList;o;o=o.m_next)if(o.IsActive())for(r=o.GetFixtureList();r;r=r.m_next)for(var u=0;u<r.m_proxyCount;++u){var _=r.m_proxies[u].treeNode.aabb;c[0].Set(_.lowerBound.x,_.lowerBound.y),c[1].Set(_.upperBound.x,_.lowerBound.y),c[2].Set(_.upperBound.x,_.upperBound.y),c[3].Set(_.lowerBound.x,_.upperBound.y),this.m_debugDraw.DrawPolygon(c,4,i)}}if(e&s.b2DrawFlags.e_centerOfMassBit)for(o=this.m_bodyList;o;o=o.m_next)(n=t.DrawDebugData_s_xf).q.Copy(o.m_xf.q),n.p.Copy(o.GetWorldCenter()),this.m_debugDraw.DrawTransform(n);if(e&s.b2DrawFlags.e_controllerBit)for(var p=this.m_controllerList;p;p=p.m_next)p.Draw(this.m_debugDraw)}},t.prototype.QueryAABB=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t[0]instanceof P.b2QueryCallback?this._QueryAABB(t[0],t[1]):this._QueryAABB(null,t[0],t[1])},t.prototype._QueryAABB=function(t,e,i){if(this.m_contactManager.m_broadPhase.Query(e,function(e){var o=e.userData.fixture;return t?t.ReportFixture(o):!i||i(o)}),t instanceof P.b2QueryCallback)for(var o=this.m_particleSystemList;o;o=o.m_next)t.ShouldQueryParticleSystem(o)&&o.QueryAABB(t,e)},t.prototype.QueryAllAABB=function(t,e){return void 0===e&&(e=[]),this.QueryAABB(t,function(t){return e.push(t),!0}),e},t.prototype.QueryPointAABB=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t[0]instanceof P.b2QueryCallback?this._QueryPointAABB(t[0],t[1]):this._QueryPointAABB(null,t[0],t[1])},t.prototype._QueryPointAABB=function(t,e,i){if(this.m_contactManager.m_broadPhase.QueryPoint(e,function(e){var o=e.userData.fixture;return t?t.ReportFixture(o):!i||i(o)}),t instanceof P.b2QueryCallback)for(var o=this.m_particleSystemList;o;o=o.m_next)t.ShouldQueryParticleSystem(o)&&o.QueryPointAABB(t,e)},t.prototype.QueryAllPointAABB=function(t,e){return void 0===e&&(e=[]),this.QueryPointAABB(t,function(t){return e.push(t),!0}),e},t.prototype.QueryFixtureShape=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t[0]instanceof P.b2QueryCallback?this._QueryFixtureShape(t[0],t[1],t[2],t[3]):this._QueryFixtureShape(null,t[0],t[1],t[2],t[3])},t.prototype._QueryFixtureShape=function(e,i,o,n,r){var s=t.QueryFixtureShape_s_aabb;if(i.ComputeAABB(s,n,o),this.m_contactManager.m_broadPhase.Query(s,function(t){var s=t.userData,l=s.fixture;if(a.b2TestOverlapShape(i,o,l.GetShape(),s.childIndex,n,l.GetBody().GetTransform())){if(e)return e.ReportFixture(l);if(r)return r(l)}return!0}),e instanceof P.b2QueryCallback)for(var l=this.m_particleSystemList;l;l=l.m_next)e.ShouldQueryParticleSystem(l)&&l.QueryAABB(e,s)},t.prototype.QueryAllFixtureShape=function(t,e,i,o){return void 0===o&&(o=[]),this.QueryFixtureShape(t,e,i,function(t){return o.push(t),!0}),o},t.prototype.QueryFixturePoint=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t[0]instanceof P.b2QueryCallback?this._QueryFixturePoint(t[0],t[1]):this._QueryFixturePoint(null,t[0],t[1])},t.prototype._QueryFixturePoint=function(t,e,i){if(this.m_contactManager.m_broadPhase.QueryPoint(e,function(o){var n=o.userData.fixture;if(n.TestPoint(e)){if(t)return t.ReportFixture(n);if(i)return i(n)}return!0}),t)for(var o=this.m_particleSystemList;o;o=o.m_next)t.ShouldQueryParticleSystem(o)&&o.QueryPointAABB(t,e)},t.prototype.QueryAllFixturePoint=function(t,e){return void 0===e&&(e=[]),this.QueryFixturePoint(t,function(t){return e.push(t),!0}),e},t.prototype.RayCast=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t[0]instanceof w.b2RayCastCallback?this._RayCast(t[0],t[1],t[2]):this._RayCast(null,t[0],t[1],t[2])},t.prototype._RayCast=function(e,i,o,n){var r=t.RayCast_s_input;if(r.maxFraction=1,r.p1.Copy(i),r.p2.Copy(o),this.m_contactManager.m_broadPhase.RayCast(r,function(r,s){var a=s.userData,l=a.fixture,c=a.childIndex,u=t.RayCast_s_output;if(l.RayCast(u,r,c)){var _=u.fraction,p=t.RayCast_s_point;if(p.Set((1-_)*i.x+_*o.x,(1-_)*i.y+_*o.y),e)return e.ReportFixture(l,p,u.normal,_);if(n)return n(l,p,u.normal,_)}return r.maxFraction}),e)for(var s=this.m_particleSystemList;s;s=s.m_next)e.ShouldQueryParticleSystem(s)&&s.RayCast(e,i,o)},t.prototype.RayCastOne=function(t,e){var i=null,o=1;return this.RayCast(t,e,function(t,e,n,r){return r<o&&(o=r,i=t),o}),i},t.prototype.RayCastAll=function(t,e,i){return void 0===i&&(i=[]),this.RayCast(t,e,function(t){return i.push(t),1}),i},t.prototype.GetBodyList=function(){return this.m_bodyList},t.prototype.GetJointList=function(){return this.m_jointList},t.prototype.GetParticleSystemList=function(){return this.m_particleSystemList},t.prototype.GetContactList=function(){return this.m_contactManager.m_contactList},t.prototype.SetAllowSleeping=function(t){if(t!==this.m_allowSleep&&(this.m_allowSleep=t,!this.m_allowSleep))for(var e=this.m_bodyList;e;e=e.m_next)e.SetAwake(!0)},t.prototype.GetAllowSleeping=function(){return this.m_allowSleep},t.prototype.SetWarmStarting=function(t){this.m_warmStarting=t},t.prototype.GetWarmStarting=function(){return this.m_warmStarting},t.prototype.SetContinuousPhysics=function(t){this.m_continuousPhysics=t},t.prototype.GetContinuousPhysics=function(){return this.m_continuousPhysics},t.prototype.SetSubStepping=function(t){this.m_subStepping=t},t.prototype.GetSubStepping=function(){return this.m_subStepping},t.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},t.prototype.GetBodyCount=function(){return this.m_bodyCount},t.prototype.GetJointCount=function(){return this.m_jointCount},t.prototype.GetContactCount=function(){return this.m_contactManager.m_contactCount},t.prototype.GetTreeHeight=function(){return this.m_contactManager.m_broadPhase.GetTreeHeight()},t.prototype.GetTreeBalance=function(){return this.m_contactManager.m_broadPhase.GetTreeBalance()},t.prototype.GetTreeQuality=function(){return this.m_contactManager.m_broadPhase.GetTreeQuality()},t.prototype.SetGravity=function(t,e){if(void 0===e&&(e=!0),!n.b2Vec2.IsEqualToV(this.m_gravity,t)&&(this.m_gravity.Copy(t),e))for(var i=this.m_bodyList;i;i=i.m_next)i.SetAwake(!0)},t.prototype.GetGravity=function(){return this.m_gravity},t.prototype.IsLocked=function(){return this.m_locked},t.prototype.SetAutoClearForces=function(t){this.m_clearForces=t},t.prototype.GetAutoClearForces=function(){return this.m_clearForces},t.prototype.ShiftOrigin=function(t){if(this.IsLocked())throw new Error;for(var e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.SelfSub(t),e.m_sweep.c0.SelfSub(t),e.m_sweep.c.SelfSub(t);for(var i=this.m_jointList;i;i=i.m_next)i.ShiftOrigin(t);this.m_contactManager.m_broadPhase.ShiftOrigin(t)},t.prototype.GetContactManager=function(){return this.m_contactManager},t.prototype.GetProfile=function(){return this.m_profile},t.prototype.Dump=function(t){if(!this.m_locked){t("const g: b2Vec2 = new b2Vec2(%.15f, %.15f);\n",this.m_gravity.x,this.m_gravity.y),t("this.m_world.SetGravity(g);\n"),t("const bodies: b2Body[] = [];\n"),t("const joints: b2Joint[] = [];\n");for(var e=0,i=this.m_bodyList;i;i=i.m_next)i.m_islandIndex=e,i.Dump(t),++e;e=0;for(var o=this.m_jointList;o;o=o.m_next)o.m_index=e,++e;for(o=this.m_jointList;o;o=o.m_next)o.m_type!==u.b2JointType.e_gearJoint&&(t("{\n"),o.Dump(t),t("}\n"));for(o=this.m_jointList;o;o=o.m_next)o.m_type===u.b2JointType.e_gearJoint&&(t("{\n"),o.Dump(t),t("}\n"))}},t.prototype.DrawJoint=function(e){if(null!==this.m_debugDraw){var i=e.GetBodyA(),o=e.GetBodyB(),n=i.m_xf,r=o.m_xf,s=n.p,a=r.p,l=e.GetAnchorA(t.DrawJoint_s_p1),c=e.GetAnchorB(t.DrawJoint_s_p2),_=t.DrawJoint_s_color.SetRGB(.5,.8,.8);switch(e.m_type){case u.b2JointType.e_distanceJoint:this.m_debugDraw.DrawSegment(l,c,_);break;case u.b2JointType.e_pulleyJoint:var p=e,m=p.GetGroundAnchorA(),h=p.GetGroundAnchorB();this.m_debugDraw.DrawSegment(m,l,_),this.m_debugDraw.DrawSegment(h,c,_),this.m_debugDraw.DrawSegment(m,h,_);break;case u.b2JointType.e_mouseJoint:var f=t.DrawJoint_s_c;f.Set(0,1,0),this.m_debugDraw.DrawPoint(l,4,f),this.m_debugDraw.DrawPoint(c,4,f),f.Set(.8,.8,.8),this.m_debugDraw.DrawSegment(l,c,f);break;default:this.m_debugDraw.DrawSegment(s,l,_),this.m_debugDraw.DrawSegment(l,c,_),this.m_debugDraw.DrawSegment(a,c,_)}}},t.prototype.DrawShape=function(e,i){if(null!==this.m_debugDraw){var o=e.GetShape();switch(o.m_type){case c.b2ShapeType.e_circleShape:var r=o,s=r.m_p,a=r.m_radius,l=n.b2Vec2.UNITX;this.m_debugDraw.DrawSolidCircle(s,a,l,i);break;case c.b2ShapeType.e_edgeShape:var u=o,_=u.m_vertex1,p=u.m_vertex2;this.m_debugDraw.DrawSegment(_,p,i);break;case c.b2ShapeType.e_chainShape:var m=o,h=m.m_count,f=m.m_vertices,d=t.DrawShape_s_ghostColor.SetRGBA(.75*i.r,.75*i.g,.75*i.b,i.a);if(_=f[0],this.m_debugDraw.DrawPoint(_,4,i),m.m_hasPrevVertex){var b=m.m_prevVertex;this.m_debugDraw.DrawSegment(b,_,d),this.m_debugDraw.DrawCircle(b,.1,d)}for(var y=1;y<h;++y)p=f[y],this.m_debugDraw.DrawSegment(_,p,i),this.m_debugDraw.DrawPoint(p,4,i),_=p;if(m.m_hasNextVertex){var v=m.m_nextVertex;this.m_debugDraw.DrawSegment(v,_,d),this.m_debugDraw.DrawCircle(v,.1,d)}break;case c.b2ShapeType.e_polygonShape:var V=o,C=V.m_count;f=V.m_vertices,this.m_debugDraw.DrawSolidPolygon(f,C,i)}}},t.prototype.Solve=function(t){for(var e=this.m_bodyList;e;e=e.m_next)e.m_xf0.Copy(e.m_xf);for(var i=this.m_controllerList;i;i=i.m_next)i.Step(t);this.m_profile.solveInit=0,this.m_profile.solveVelocity=0,this.m_profile.solvePosition=0;var o=this.m_island;for(o.Initialize(this.m_bodyCount,this.m_contactManager.m_contactCount,this.m_jointCount,this.m_contactManager.m_contactListener),e=this.m_bodyList;e;e=e.m_next)e.m_islandFlag=!1;for(var n=this.m_contactManager.m_contactList;n;n=n.m_next)n.m_islandFlag=!1;for(var s=this.m_jointList;s;s=s.m_next)s.m_islandFlag=!1;for(var a=this.s_stack,l=this.m_bodyList;l;l=l.m_next)if(!l.m_islandFlag&&l.IsAwake()&&l.IsActive()&&l.GetType()!==x.b2BodyType.b2_staticBody){o.Clear();var c=0;for(a[c++]=l,l.m_islandFlag=!0;c>0;){if(!(e=a[--c]))throw new Error;if(o.AddBody(e),e.m_awakeFlag=!0,e.GetType()!==x.b2BodyType.b2_staticBody){for(var u=e.m_contactList;u;u=u.next){var _=u.contact;if(!_.m_islandFlag&&_.IsEnabled()&&_.IsTouching()){var p=_.m_fixtureA.m_isSensor,m=_.m_fixtureB.m_isSensor;p||m||(o.AddContact(_),_.m_islandFlag=!0,(f=u.other).m_islandFlag||(a[c++]=f,f.m_islandFlag=!0))}}for(var h=e.m_jointList;h;h=h.next){var f;h.joint.m_islandFlag||(f=h.other).IsActive()&&(o.AddJoint(h.joint),h.joint.m_islandFlag=!0,f.m_islandFlag||(a[c++]=f,f.m_islandFlag=!0))}}}var d=new A.b2Profile;o.Solve(d,t,this.m_gravity,this.m_allowSleep),this.m_profile.solveInit+=d.solveInit,this.m_profile.solveVelocity+=d.solveVelocity,this.m_profile.solvePosition+=d.solvePosition;for(var b=0;b<o.m_bodyCount;++b)(e=o.m_bodies[b]).GetType()===x.b2BodyType.b2_staticBody&&(e.m_islandFlag=!1)}for(b=0;b<a.length&&a[b];++b)a[b]=null;var y=new r.b2Timer;for(e=this.m_bodyList;e;e=e.m_next)e.m_islandFlag&&e.GetType()!==x.b2BodyType.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts(),this.m_profile.broadphase=y.GetMilliseconds()},t.prototype.SolveTOI=function(e){var i=this.m_island;if(i.Initialize(2*o.b2_maxTOIContacts,o.b2_maxTOIContacts,0,this.m_contactManager.m_contactListener),this.m_stepComplete){for(var r=this.m_bodyList;r;r=r.m_next)r.m_islandFlag=!1,r.m_sweep.alpha0=0;for(var s=this.m_contactManager.m_contactList;s;s=s.m_next)s.m_toiFlag=!1,s.m_islandFlag=!1,s.m_toiCount=0,s.m_toi=1}for(;;){var a=null,c=1;for(s=this.m_contactManager.m_contactList;s;s=s.m_next)if(s.IsEnabled()&&!(s.m_toiCount>o.b2_maxSubSteps)){var u=1;if(s.m_toiFlag)u=s.m_toi;else{var _=s.GetFixtureA(),p=s.GetFixtureB();if(_.IsSensor()||p.IsSensor())continue;var m=_.GetBody(),h=p.GetBody(),f=m.m_type,d=h.m_type,b=m.IsAwake()&&f!==x.b2BodyType.b2_staticBody,y=h.IsAwake()&&d!==x.b2BodyType.b2_staticBody;if(!b&&!y)continue;var v=m.IsBullet()||f!==x.b2BodyType.b2_dynamicBody,V=h.IsBullet()||d!==x.b2BodyType.b2_dynamicBody;if(!v&&!V)continue;var C=m.m_sweep.alpha0;m.m_sweep.alpha0<h.m_sweep.alpha0?(C=h.m_sweep.alpha0,m.m_sweep.Advance(C)):h.m_sweep.alpha0<m.m_sweep.alpha0&&(C=m.m_sweep.alpha0,h.m_sweep.Advance(C));var g=s.GetChildIndexA(),S=s.GetChildIndexB(),B=t.SolveTOI_s_toi_input;B.proxyA.SetShape(_.GetShape(),g),B.proxyB.SetShape(p.GetShape(),S),B.sweepA.Copy(m.m_sweep),B.sweepB.Copy(h.m_sweep),B.tMax=1;var A=t.SolveTOI_s_toi_output;l.b2TimeOfImpact(A,B);var P=A.t;u=A.state===l.b2TOIOutputState.e_touching?n.b2Min(C+(1-C)*P,1):1,s.m_toi=u,s.m_toiFlag=!0}u<c&&(a=s,c=u)}if(null===a||1-10*o.b2_epsilon<c){this.m_stepComplete=!0;break}var w=a.GetFixtureA(),M=a.GetFixtureB(),D=w.GetBody(),I=M.GetBody(),G=t.SolveTOI_s_backup1.Copy(D.m_sweep),T=t.SolveTOI_s_backup2.Copy(I.m_sweep);if(D.Advance(c),I.Advance(c),a.Update(this.m_contactManager.m_contactListener),a.m_toiFlag=!1,++a.m_toiCount,a.IsEnabled()&&a.IsTouching()){D.SetAwake(!0),I.SetAwake(!0),i.Clear(),i.AddBody(D),i.AddBody(I),i.AddContact(a),D.m_islandFlag=!0,I.m_islandFlag=!0,a.m_islandFlag=!0;for(var R=0;R<2;++R)if((U=0===R?D:I).m_type===x.b2BodyType.b2_dynamicBody)for(var F=U.m_contactList;F&&i.m_bodyCount!==i.m_bodyCapacity&&i.m_contactCount!==i.m_contactCapacity;F=F.next){var O=F.contact;if(!O.m_islandFlag){var L=F.other;if(L.m_type!==x.b2BodyType.b2_dynamicBody||U.IsBullet()||L.IsBullet()){var j=O.m_fixtureA.m_isSensor,J=O.m_fixtureB.m_isSensor;if(!j&&!J){var E=t.SolveTOI_s_backup.Copy(L.m_sweep);L.m_islandFlag||L.Advance(c),O.Update(this.m_contactManager.m_contactListener),O.IsEnabled()&&O.IsTouching()?(O.m_islandFlag=!0,i.AddContact(O),L.m_islandFlag||(L.m_islandFlag=!0,L.m_type!==x.b2BodyType.b2_staticBody&&L.SetAwake(!0),i.AddBody(L))):(L.m_sweep.Copy(E),L.SynchronizeTransform())}}}}var k=t.SolveTOI_s_subStep;for(k.dt=(1-c)*e.dt,k.inv_dt=1/k.dt,k.dtRatio=1,k.positionIterations=20,k.velocityIterations=e.velocityIterations,k.particleIterations=e.particleIterations,k.warmStarting=!1,i.SolveTOI(k,D.m_islandIndex,I.m_islandIndex),R=0;R<i.m_bodyCount;++R){var U;if((U=i.m_bodies[R]).m_islandFlag=!1,U.m_type===x.b2BodyType.b2_dynamicBody)for(U.SynchronizeFixtures(),F=U.m_contactList;F;F=F.next)F.contact.m_toiFlag=!1,F.contact.m_islandFlag=!1}if(this.m_contactManager.FindNewContacts(),this.m_subStepping){this.m_stepComplete=!1;break}}else a.SetEnabled(!1),D.m_sweep.Copy(G),I.m_sweep.Copy(T),D.SynchronizeTransform(),I.SynchronizeTransform()}},t.prototype.AddController=function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t},t.prototype.RemoveController=function(t){return t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList===t&&(this.m_controllerList=t.m_next),--this.m_controllerCount,t.m_prev=null,t.m_next=null,t},t.Step_s_step=new A.b2TimeStep,t.Step_s_stepTimer=new r.b2Timer,t.Step_s_timer=new r.b2Timer,t.DrawDebugData_s_color=new s.b2Color(0,0,0),t.DrawDebugData_s_vs=n.b2Vec2.MakeArray(4),t.DrawDebugData_s_xf=new n.b2Transform,t.QueryFixtureShape_s_aabb=new a.b2AABB,t.RayCast_s_input=new a.b2RayCastInput,t.RayCast_s_output=new a.b2RayCastOutput,t.RayCast_s_point=new n.b2Vec2,t.DrawJoint_s_p1=new n.b2Vec2,t.DrawJoint_s_p2=new n.b2Vec2,t.DrawJoint_s_color=new s.b2Color(.5,.8,.8),t.DrawJoint_s_c=new s.b2Color,t.DrawShape_s_ghostColor=new s.b2Color,t.SolveTOI_s_subStep=new A.b2TimeStep,t.SolveTOI_s_backup=new n.b2Sweep,t.SolveTOI_s_backup1=new n.b2Sweep,t.SolveTOI_s_backup2=new n.b2Sweep,t.SolveTOI_s_toi_input=new l.b2TOIInput,t.SolveTOI_s_toi_output=new l.b2TOIOutput,t}();i.b2World=G,cc._RF.pop()},{"../Collision/Shapes/b2Shape":"b2Shape","../Collision/b2Collision":"b2Collision","../Collision/b2TimeOfImpact":"b2TimeOfImpact","../Common/b2Draw":"b2Draw","../Common/b2Math":"b2Math","../Common/b2Settings":"b2Settings","../Common/b2Timer":"b2Timer","../Particle/b2Particle":"b2Particle","../Particle/b2ParticleSystem":"b2ParticleSystem","./Joints/b2AreaJoint":"b2AreaJoint","./Joints/b2DistanceJoint":"b2DistanceJoint","./Joints/b2FrictionJoint":"b2FrictionJoint","./Joints/b2GearJoint":"b2GearJoint","./Joints/b2Joint":"b2Joint","./Joints/b2MotorJoint":"b2MotorJoint","./Joints/b2MouseJoint":"b2MouseJoint","./Joints/b2PrismaticJoint":"b2PrismaticJoint","./Joints/b2PulleyJoint":"b2PulleyJoint","./Joints/b2RevoluteJoint":"b2RevoluteJoint","./Joints/b2RopeJoint":"b2RopeJoint","./Joints/b2WeldJoint":"b2WeldJoint","./Joints/b2WheelJoint":"b2WheelJoint","./b2Body":"b2Body","./b2ContactManager":"b2ContactManager","./b2Island":"b2Island","./b2TimeStep":"b2TimeStep","./b2WorldCallbacks":"b2WorldCallbacks"}]},{},["Box2D","b2ChainShape","b2CircleShape","b2EdgeShape","b2PolygonShape","b2Shape","b2BroadPhase","b2CollideCircle","b2CollideEdge","b2CollidePolygon","b2Collision","b2Distance","b2DynamicTree","b2TimeOfImpact","b2BlockAllocator","b2Draw","b2GrowableStack","b2Math","b2Settings","b2StackAllocator","b2Timer","b2BuoyancyController","b2ConstantAccelController","b2ConstantForceController","b2Controller","b2GravityController","b2TensorDampingController","b2ChainAndCircleContact","b2ChainAndPolygonContact","b2CircleContact","b2Contact","b2ContactFactory","b2ContactSolver","b2EdgeAndCircleContact","b2EdgeAndPolygonContact","b2PolygonAndCircleContact","b2PolygonContact","b2AreaJoint","b2DistanceJoint","b2FrictionJoint","b2GearJoint","b2Joint","b2MotorJoint","b2MouseJoint","b2PrismaticJoint","b2PulleyJoint","b2RevoluteJoint","b2RopeJoint","b2WeldJoint","b2WheelJoint","b2Body","b2ContactManager","b2Fixture","b2Island","b2TimeStep","b2World","b2WorldCallbacks","b2Particle","b2ParticleGroup","b2ParticleSystem","b2StackQueue","b2VoronoiDiagram","b2Rope","IndexDebugModuleConsole","IndexDebugModuleCtrl","IndexDebugModuleFast","IndexLayer","IndexModule","IndexStorageItem","IndexView","IndexViewState","IndexViewTouchPos","BCCollection","BCCounter","BCEventer","BCIdGeneration","BCPromiseCtrl","BCType","UtilCollection","UtilMath","UtilNode","UtilObjPool","UtilObjPoolType","UtilString","ComponentNodeEventer","PlayAnimationOnEnable","PlayAudioOnEnable","MgrCfg","CfgBuffProps","CfgCommon","CfgEff","CfgEquipmentLevel","CfgEquipmentProps","CfgGameElement","CfgLevel","CfgVoiceOgg","MgrData","MgrDataItem","MgrDataType","DebugView","DebugViewBtn","DebugViewDefine","DebugViewGraphics","DebugViewGroupFast","DebugViewGroupFastBtn","DebugViewGroupMessage","DebugViewGroupMessageBtn","DebugViewGroupMessageTxt","DebugViewGroupModule","DebugViewGroupModuleBtn","DebugViewState","MgrEvter","B2ControllerRS","B2DrableWorld","B2EleSetting","B2ElementRS","B2Extend","B2JointRS","B2ShapeRS","GraphicsDrawer","Index","Jiang","MgrRes","MgrSdk","MgrSdkCore","MgrSdkCoreH5","MgrUI","UIMask","UINode","UINodeType","UIRoot","UIRootTreeJson","UIViewComponent","ViewState"]);